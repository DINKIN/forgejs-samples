(function() {
  var root = this;
  var e,g=g||{VERSION:"0.3.0",Kf:[],Ld:!1,Zl:!1};function n(a){this.R="";this.xc=this.xb=this.jb=null;this.yb=!0;this.Jd=this.md=!1;this.pf=null;this.fb=a||"BaseObject"}n.prototype.constructor=n;function aa(a){if("string"!==typeof a.R||""===a.R)a.R=g.S.jg();g.S.register(a);a.jb&&("string"===typeof a.jb&&(a.jb=[a.jb]),!0===Array.isArray(a.jb)&&g.mb.register(a))}function ba(a){""!==a.R&&!0===g.S.hb(a.R)&&g.S.unregister(a)}
function ca(a,b,d){d=d||"log";console[d].apply(console,["%c[ForgeJS]%c FORGE."+a.fb+" : "+b+" %c(@"+window.performance.now().toFixed(2)+"ms)","background: #e2edff; color: #4286f4; font-weight: 700","font-weight: 400","color: #AAA"]);if("object"===typeof b&&null!==b)console[d](b)}n.prototype.log=function(a){if(!0===g.Ld||!0===g[this.fb].DEBUG||!0===this.md)ca(this,a,"log"),this.pf||(this.pf=[]),this.pf.push(a)};
n.prototype.warn=function(a){!0!==g.Zl&&!0!==g[this.fb].WARNING&&!0!==this.Jd||ca(this,a,"warn")};n.prototype.destroy=function(){!1!==this.yb&&(ba(this),this.xc&&(this.xc.F(),this.xc.destroy(),this.xc=null),this.xb=null,this.yb=!1)};Object.defineProperty(n.prototype,"className",{get:function(){return this.fb}});Object.defineProperty(n.prototype,"uid",{get:function(){return this.R}});Object.defineProperty(n.prototype,"tags",{get:function(){return this.jb}});
Object.defineProperty(n.prototype,"alive",{get:function(){return this.yb}});Object.defineProperty(n.prototype,"data",{get:function(){return this.xb},set:function(a){this.xb=a}});Object.defineProperty(n.prototype,"debug",{get:function(){return this.md},set:function(a){this.md=!!a;!0===this.md&&(console.log("Enabling debug for a FORGE."+this.fb+" instance :"),console.log(this))}});
Object.defineProperty(n.prototype,"warning",{get:function(){return this.Jd},set:function(a){this.Jd=!!a;!0===this.Jd&&(console.log("Enabling warning for a FORGE."+this.fb+" instance :"),console.log(this))}});Object.defineProperty(n.prototype,"onDestroy",{get:function(){this.xc||(this.xc=new q(this));return this.xc}});
function t(a,b,d){n.call(this,"Viewer");this.j=a;this.Da=b||{viewer:da};this.G=this.T=this.fa=this.D=this.L=this.C=this.Aa=this.V=this.Ba=this.ra=this.$=this.Ca=this.U=this.aa=this.ja=this.O=this.I=this.Z=this.H=this.P=this.J=this.M=this.B=this.c=this.sa=null;this.ia=this.da=!1;this.u=this.m=this.o=null;this.f=d||null;window.setTimeout(this.Pl.bind(this),0)}t.prototype=Object.create(n.prototype);t.prototype.constructor=t;var da={background:"#000"};e=t.prototype;
e.Pl=function(a){this.R="FORGE-instance-"+String(g.Kf.length);g.Kf.push(this.R);aa(this);this.log("FORGE.Viewer.boot();");this.sa=new ea(this);"string"===typeof this.j&&""!==this.j&&(this.j=document.getElementById(this.j));if("undefined"===typeof this.j||null===this.j||!1===g.ka.sg(this.j))throw"FORGE.Viewer.boot : Viewer parent is invalid";this.c=new v(this,null,null,this.j);this.c.id="FORGE-main-container-"+this.R;this.B=new v(this);this.B.id="FORGE-canvas-container-"+this.R;this.c.index=0;this.B.Sb(!0);
this.c.mc(this.B);this.M=new v(this);this.M.id="FORGE-dom-hotspot-container-"+this.R;this.c.index=0;this.M.Sb(!0);this.c.mc(this.M);this.J=new v(this);this.J.id="FORGE-plugin-container-"+this.R;this.c.index=0;this.J.Sb(!0);this.c.mc(this.J);this.P=new fa(this);this.P.Sb(!0);this.B.mc(this.P);this.ja=new ga(this);this.D=new ha(this);this.H=new w(this);this.L=new ia(this);this.T=new ja(this);this.$=new x(this);this.ra=new ka(this);this.G=new y(this);this.U=new la(this);this.Z=new z(this);this.C=new B(this);
this.I=new ma(this);this.O=new na(this);this.aa=new oa(this);this.Ca=new pa(this);this.Aa=new qa(this);this.V=new ra(this);this.Ba=new sa(this);this.fa=new ta(this);this.H.boot();this.L.boot();this.$.boot();this.Z.boot();this.C.boot();this.I.boot();this.log("ForgeJS "+g.VERSION);"function"===typeof a&&a.call();this.f&&"function"===typeof this.f.boot&&this.f.boot.call();this.L.start();this.ia=!0;this.o&&this.o.F();a=this.Da;"string"===typeof a?this.Ba.json(this.R+"-configuration",a,this.Ql,this):a&&
"object"===typeof a&&ua(this,a)};e.Ql=function(a){this.log("FORGE.Viewer._configLoadComplete();");a=this.V.get(C.JSON,a.key).data;ua(this,a)};
function ua(a,b){a.Da=b;if("undefined"!==typeof b.viewer){var d=b.viewer;a.c.background="string"===typeof d.background?d.background:da.background}"undefined"!==typeof b.i18n&&a.T.ma(b.i18n);"undefined"!==typeof b.history&&a.ra.ma(b.history);"undefined"!==typeof b.audio&&a.H.ma(b.audio);"undefined"!==typeof b.playlists&&a.Z.ma(b.playlists);"undefined"!==typeof b.actions&&a.O.ma(b.actions);"undefined"!==typeof b.director&&a.aa.load(b.director);"undefined"!==typeof b.hotspots&&a.I.sj(b.hotspots);"undefined"!==
typeof b.postProcessing&&a.Ca.ma(b.postProcessing);"undefined"!==typeof b.plugins&&a.C.ma(b.plugins);a.U.ma(b.controllers);"undefined"!==typeof b.story&&a.$.load(b.story)}
e.update=function(a){!0!==this.da&&(this.D.update(a),this.sa.update(),this.Aa.update(),this.H.update(),this.C.update(),this.fa.update(),this.I.update(),this.U.update(),this.f&&"function"===typeof this.f.update&&this.f.update.call(),this.f&&"function"===typeof this.f.Fn&&this.f.Fn.call(),this.G&&this.G.render(),this.f&&"function"===typeof this.f.En&&this.f.En.call())};e.pause=function(){this.da=!0;this.m&&this.m.F()};e.resume=function(){this.da=!1;this.u&&this.u.F()};
e.destroy=function(){this.L.stop();this.j=this.Da=null;this.C.destroy();this.C=null;this.L.destroy();this.L=null;this.Ba.destroy();this.Ba=null;this.ra.destroy();this.ra=null;this.D.destroy();this.D=null;this.Aa.destroy();this.Aa=null;this.I.destroy();this.I=null;this.aa.destroy();this.aa=null;this.G.destroy();this.G=null;this.P.destroy();this.P=null;this.B.destroy();this.B=null;this.M.destroy();this.M=null;this.Ca.destroy();this.Ca=null;this.J.destroy();this.J=null;this.O.destroy();this.O=null;this.c.destroy();
this.c=null;this.sa.destroy();this.sa=null;this.Z.destroy();this.Z=null;this.H.destroy();this.H=null;this.$.destroy();this.$=null;this.V.destroy();this.V=null;this.fa.destroy();this.fa=null;this.T.destroy();this.T=null;this.U.destroy();this.f=this.U=null;this.o&&(this.o.destroy(),this.o=null);this.m&&(this.m.destroy(),this.m=null);this.u&&(this.u.destroy(),this.u=null);g.Kf.splice(this.R,1);n.prototype.destroy.call(this)};Object.defineProperty(t.prototype,"ready",{get:function(){return this.ia}});
Object.defineProperty(t.prototype,"config",{get:function(){return this.Da}});Object.defineProperty(t.prototype,"parent",{get:function(){return this.j}});Object.defineProperty(t.prototype,"display",{get:function(){return this.sa}});Object.defineProperty(t.prototype,"fullscreen",{get:function(){return this.c.zd()},set:function(a){"boolean"===typeof a&&this.c.zd()!==a&&(this.c.fullscreen=a)}});Object.defineProperty(t.prototype,"container",{get:function(){return this.c}});
Object.defineProperty(t.prototype,"canvasContainer",{get:function(){return this.B}});Object.defineProperty(t.prototype,"canvas",{get:function(){return this.P}});Object.defineProperty(t.prototype,"domHotspotContainer",{get:function(){return this.M}});Object.defineProperty(t.prototype,"pluginContainer",{get:function(){return this.J}});Object.defineProperty(t.prototype,"raf",{get:function(){return this.L}});Object.defineProperty(t.prototype,"audio",{get:function(){return this.H}});
Object.defineProperty(t.prototype,"playlists",{get:function(){return this.Z}});Object.defineProperty(t.prototype,"hotspots",{get:function(){return this.I}});Object.defineProperty(t.prototype,"actions",{get:function(){return this.O}});Object.defineProperty(t.prototype,"dependencies",{get:function(){return this.ja}});Object.defineProperty(t.prototype,"director",{get:function(){return this.aa}});Object.defineProperty(t.prototype,"story",{get:function(){return this.$}});
Object.defineProperty(t.prototype,"history",{get:function(){return this.ra}});Object.defineProperty(t.prototype,"load",{get:function(){return this.Ba}});Object.defineProperty(t.prototype,"cache",{get:function(){return this.V}});Object.defineProperty(t.prototype,"plugins",{get:function(){return this.C}});Object.defineProperty(t.prototype,"clock",{get:function(){return this.D}});Object.defineProperty(t.prototype,"tween",{get:function(){return this.fa}});Object.defineProperty(t.prototype,"i18n",{get:function(){return this.T}});
Object.defineProperty(t.prototype,"renderer",{get:function(){return this.G}});Object.defineProperty(t.prototype,"view",{get:function(){return this.G.view}});Object.defineProperty(t.prototype,"camera",{get:function(){return this.G.camera}});Object.defineProperty(t.prototype,"controllers",{get:function(){return this.U}});Object.defineProperty(t.prototype,"postProcessing",{get:function(){return this.Ca}});Object.defineProperty(t.prototype,"keyboard",{get:function(){return this.Aa}});
Object.defineProperty(t.prototype,"width",{get:function(){return this.c.width},set:function(a){this.c.width=a}});Object.defineProperty(t.prototype,"height",{get:function(){return this.c.height},set:function(a){this.c.height=a}});Object.defineProperty(t.prototype,"onReady",{get:function(){this.o||(this.o=new q(this));return this.o}});Object.defineProperty(t.prototype,"onPause",{get:function(){this.m||(this.m=new q(this));return this.m}});
Object.defineProperty(t.prototype,"onResume",{get:function(){this.u||(this.u=new q(this));return this.u}});
g.mb=function(a){a=a();a.prototype=Object.create(n.prototype);a.prototype.constructor=a;a.prototype.register=function(a){if("object"===typeof a&&"string"===typeof a.uid&&Array.isArray(a.tags)){var b=a.uid,h=a.tags;if(!0===g.S.hb(b))for(var k=0,l=h.length;k<l;k++)a=h[k],"string"!==typeof a?this.warn("Tags: An object has a tag that isn't a string!"):("undefined"===typeof this.zb[a]&&(this.zb[a]=[],null!==this.sd&&this.sd.F({tag:a})),-1===this.zb[a].indexOf(b)&&this.zb[a].push(b));else this.warn("Tags: The object you want to register in tags is not known by UID!"),
this.warn(a)}else this.warn("Tags: No uid or no tags on the object you try to register!"),this.warn(a)};a.prototype.lg=function(a,d){var b=[];if("string"===typeof a)b=this.zb[a];else if(Array.isArray(a)){var k=0;for(a=a.length;k<a;k++);}"string"===typeof d&&(b=g.S.me(b,d));return b};a.prototype.get=function(a,d){if("string"===typeof a)return g.S.get(this.zb[a],d);if(Array.isArray(a)){var b=0;for(a=a.length;b<a;b++);return g.S.get([],d)}};a.prototype.Yn=function(a,d){if(!0===this.hb(a)){a=this.zb[a];
for(var b=0,k=this.zb.length;b<k;b++)if(!0===g.S.W(a[b],d))return!0}return!1};a.prototype.hb=function(a){return"undefined"!==typeof this.zb[a]&&null!==this.zb[a]};Object.defineProperty(a.prototype,"list",{get:function(){return Object.keys(this.zb)}});Object.defineProperty(a.prototype,"onRegister",{get:function(){null===this.sd&&(this.sd=new q(this));return this.sd}});return new a}(function(){return function(){this.zb={};this.sd=null;n.call(this,"Tags")}});
g.S=function(a){a=a();a.prototype=Object.create(n.prototype);a.prototype.constructor=a;a.prototype.jg=function(){var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});return!1===g.S.hb(a)?a:g.S.jg()};a.prototype.Rk=function(a){function b(a){var d,k;for(k in a)if("uid"===k)if(d=a[k],"string"===typeof d){if(g.S.hb(d))throw"UID configuration not valid, uid "+d+" already have an object binded to!";if(-1!==h.indexOf(d))throw"UID configuration not valid, uid "+
d+" is in double in config file!";h.push(a[k])}else throw"Found a uid in configuration that is not a string!";else"object"===typeof a[k]&&b(a[k]);return!0}var h=[];return b(a)};a.prototype.register=function(a){if("object"===typeof a&&"string"===typeof a.uid){var b=a.uid;if(!1===g.S.hb(b))return this.ba[b]=a,!0;this.warn("The uid you want to register already exists!");this.warn(a)}else this.warn("No uid on the object you try to register!"),this.warn(a);return!1};a.prototype.unregister=function(a){"object"===
typeof a&&"string"===typeof a.uid?(a=a.uid,this.ba[a]=null,delete this.ba[a]):this.warn("No uid on the object you try to unregister!")};a.prototype.lg=function(a){return"undefined"===typeof a||null===a?Object.keys(this.ba):g.S.me(Object.keys(this.ba),a)};a.prototype.me=function(a,d){return a.filter(function(a){return g.S.W(a,d)?!0:!1})};a.prototype.get=function(a,d){if("undefined"===typeof a||null===a){if("string"!==typeof d)return this.ba;a=Object.keys(this.ba)}if("string"===typeof a)return this.ba[a];
if(Array.isArray(a)){"string"===typeof d&&(a=g.S.me(a,d));d=[];for(var b,k=0,l=a.length;k<l;k++)b=a[k],!0===g.S.hb(b)&&d.push(this.ba[b]);return d}};a.prototype.W=function(a,d){a=g.S.get(a);return g.K.W(a,d)};a.prototype.hb=function(a){return"undefined"!==typeof this.ba[a]&&null!==this.ba[a]};return new a}(function(){return function(){this.ba={};n.call(this,"UID")}});
function x(a){this.i=a;this.J=this.P=this.L=this.f=null;this.M="";this.c=null;this.m="";this.o=null;this.u="";this.j=this.H=this.I=this.G=this.C=this.D=this.B=null;n.call(this,"Story")}x.prototype=Object.create(n.prototype);e=x.prototype;e.constructor=x;e.boot=function(){this.log("FORGE.Story.boot();");this.c=[];this.o=[];this.L=new D(this.i);this.P=new D(this.i);this.J=new D(this.i)};
e.load=function(a){this.log("FORGE.Story.load();");"string"===typeof a?this.i.load.json("forge.story.config",a,this.Cl,this):"object"===typeof a&&va(this,a)};e.Dl=function(){return!!this.c.length};e.Ec=function(){return!!this.o.length};e.El=function(){var a=this.c.indexOf(this.m);this.Bd(a+1<this.c.length?this.c[a+1]:this.c[0])};e.Fl=function(){var a=this.c.indexOf(this.m);this.Bd(0<=a-1?this.c[a-1]:this.c[this.c.length-1])};
e.Cl=function(a){this.log("FORGE.Story.loadComplete();");a=this.i.cache.get(C.JSON,a.key).data;va(this,a)};
function va(a,b){if(!0!==g.S.Rk(b))throw"Story configuration is not valid!";a.f=b;a.R=a.f.uid;aa(a);a.M=a.f["default"];a.L.key=a.f.name;a.P.key=a.f.slug;a.J.key=a.f.description;if("undefined"!==typeof a.f.scenes&&0<a.f.scenes.length){b=a.f.scenes;for(var d,h=0,k=b.length;h<k;h++)d=new E(a.i),d.ma(b[h]),!0===d.booted&&wa(a,d)}if("undefined"!==typeof a.f.groups&&0<a.f.groups.length)for(b=a.f.groups,h=0,k=b.length;h<k;h++)d=new F(a.i,b[h]),a.o.push(d.uid);xa(a)}
function xa(a){if("undefined"===typeof a.f.scenes||a.c.length===a.f.scenes.length){a.B&&a.B.F();var b=ya().hashParameters;null!==b&&"string"===typeof b.uid?za(b.uid):""!==a.M&&null!==a.M&&g.S.hb(a.M)?za(a.M):a.Bd(0)}}function za(a){!0!==g.S.W(a,"Scene")&&!0!==g.S.W(a,"Group")||g.S.get(a).load()}e.yk=function(a){wa(this,a);xa(this)};function wa(a,b){b.onLoadStart.add(a.un,a);b.onLoadComplete.add(a.tn,a);a.c.push(b.uid)}
e.Bd=function(a){var b;"number"===typeof a?0<=a&&a<this.c.length?b=this.c[a]:this.warn("Load scene, index "+a+" is out of bounds"):"string"===typeof a&&g.S.W(a,"Scene")?b=a:"object"===typeof a&&g.K.W(a,"Scene")&&(b=a.uid);"undefined"!==typeof b&&b!==this.m&&za(b)};e.un=function(a){""!==this.m&&null!==this.m&&this.scene.Le();a=a.emitter;this.m=a.uid;!1===a.Ec()?(this.u=null,this.j&&this.j.F()):!0===a.Ec()&&!1===a.wd(this.u)&&Aa(this,a.groups[0].uid);this.D&&this.D.F({uid:a.uid})};
e.tn=function(){this.G&&this.G.F()};function Aa(a,b){!0===g.S.W(b,"Group")&&b!==a.u&&(a.u=b,a.j&&a.j.F())}e.sk=function(a){var b;"number"===typeof a?0<=a&&a<this.o.length?b=this.o[a]:this.warn("Load group, index "+a+" is out of bounds"):"string"===typeof a&&g.S.W(a,"Group")?b=a:"object"===typeof a&&g.K.W(a,"Group")&&(b=a.uid);"undefined"!==typeof b&&b!==this.u&&(Aa(this,b),za(b))};
e.destroy=function(){this.f=this.i=null;this.L.destroy();this.L=null;this.P.destroy();this.P=null;this.J.destroy();this.J=null;for(var a=0,b=this.c.length;a<b;a++)g.S.get(this.c[a]).destroy();this.c=null;a=0;for(b=this.o.length;a<b;a++)g.S.get(this.o[a]).destroy();this.o=null;this.B&&(this.B.destroy(),this.B=null);this.D&&(this.D.destroy(),this.D=null);this.C&&(this.C.destroy(),this.C=null);this.G&&(this.G.destroy(),this.G=null);this.I&&(this.I.destroy(),this.I=null);this.H&&(this.H.destroy(),this.H=
null);this.j&&(this.j.destroy(),this.j=null);n.prototype.destroy.call(this)};Object.defineProperty(x.prototype,"config",{get:function(){return this.f}});Object.defineProperty(x.prototype,"name",{get:function(){return this.L.value}});Object.defineProperty(x.prototype,"slug",{get:function(){return this.P.value}});Object.defineProperty(x.prototype,"description",{get:function(){return this.J.value}});Object.defineProperty(x.prototype,"scenes",{get:function(){return g.S.get(this.c)}});
Object.defineProperty(x.prototype,"scene",{get:function(){return null===this.m||""===this.m?null:g.S.get(this.m)},set:function(a){this.Bd(a)}});Object.defineProperty(x.prototype,"sceneUid",{get:function(){return this.m}});Object.defineProperty(x.prototype,"groups",{get:function(){return g.S.get(this.o)}});Object.defineProperty(x.prototype,"group",{get:function(){return null===this.u||""===this.u?null:g.S.get(this.u)},set:function(a){this.sk(a)}});Object.defineProperty(x.prototype,"groupUid",{get:function(){return this.u}});
Object.defineProperty(x.prototype,"onReady",{get:function(){this.B||(this.B=new q(this));return this.B}});Object.defineProperty(x.prototype,"onSceneLoadStart",{get:function(){this.D||(this.D=new q(this));return this.D}});Object.defineProperty(x.prototype,"onSceneLoadProgress",{get:function(){this.C||(this.C=new q(this));return this.C}});Object.defineProperty(x.prototype,"onSceneLoadComplete",{get:function(){this.G||(this.G=new q(this));return this.G}});
Object.defineProperty(x.prototype,"onSceneLoadError",{get:function(){this.I||(this.I=new q(this));return this.I}});Object.defineProperty(x.prototype,"onScenePreview",{get:function(){this.H||(this.H=new q(this));return this.H}});Object.defineProperty(x.prototype,"onGroupChange",{get:function(){this.j||(this.j=new q(this));return this.j}});
function F(a,b){this.i=a;this.f=b;this.o=null;this.D="#ffffff";this.B=1;this.c=this.m=this.u=null;this.j="";n.call(this,"Group");this.log("FORGE.Group._boot();");this.R=this.f.uid;this.jb=this.f.tags;aa(this);this.c=[];this.o=new D(this.i,this.f.name);this.u=new D(this.i,this.f.slug);this.m=new D(this.i,this.f.description);"string"===typeof this.f.color&&(this.D=this.f.color);"number"===typeof this.f.alpha&&(this.B=this.f.alpha);a=this.f;"undefined"!==typeof a.children&&!0===g.K.Pa(a.children,"string")?
this.c=a.children:this.warn("A group has no children in its configuration, or configuration is not valid!");"string"===typeof a["default"]&&(-1!==this.c.indexOf(a["default"])?this.j=a["default"]:this.warn("A group has a default child that is not in its children array!"))}F.prototype=Object.create(n.prototype);e=F.prototype;e.constructor=F;
e.load=function(a){this.log("FORGE.Group.load();");if(!this.c||!this.c.length)throw"Group.load() : can't load a group that have no children";var b;"undefined"===typeof a||null===a?b="string"===typeof this.j&&""!==this.j?this.j:this.c[0]:"number"===typeof a&&0<=a&&a<this.c.length?b=this.c[a]:"string"===typeof a?b=a:"object"===typeof a&&!0===this.Ve(a)&&(b=a.uid);if(-1===this.c.indexOf(b))throw'Group.load() : uid "'+b+'" is not in children of the group!';if(!0===g.S.W(b,"Scene")||!0===g.S.W(b,"Group"))g.S.get(b).load();
else throw"Impossible to load group child with uid "+b+", it seems to be neither a scene or a group!";};e.Ve=function(a){return"string"===typeof a?-1!==this.c.indexOf(a):!0===g.K.W(a,"Scene")||!0===g.K.W(a,"Group")?this.Ve(a.uid):!1};e.Wc=function(a){return"string"===typeof a&&g.S.W(a,"Scene")?-1!==this.c.indexOf(a):!0===g.K.W(a,"Scene")?this.Wc(a.uid):!1};e.wd=function(a){return"string"===typeof a&&g.S.W(a,"Group")?-1!==this.c.indexOf(a):!0===g.K.W(a,"Group")?this.wd(a.uid):!1};e.Vn=function(){return!!this.c.length};
e.og=function(a){for(var b,d=0,h=this.c.length;d<h;d++)if(b=this.c[d],g.S.W(b,a))return!0;return!1};e.We=function(){return this.og("Scene")};e.Ec=function(){return this.og("Group")};e.ud=function(a){if("string"!==typeof a)return this.c;for(var b=[],d=0,h=this.c.length;d<h;d++)g.S.W(this.c[d],a)&&b.push(this.c[d]);return b};e.oe=function(a){a=this.ud(a);return g.S.get(a)};
e.$k=function(){if(!1===this.We())this.warn("Can't do Group.nextScene() on this group that have no scenes!");else{var a=this.scenesUids,b=a.indexOf(this.i.story.sceneUid),d;-1===b&&(g.S.W(this.j,"Scene")?d=this.j:d=a[0]);b+1<a.length?d=a[b+1]:-1!==b&&(d=a[0]);this.load(d)}};
e.al=function(){if(!1===this.We())this.warn("Can't do Group.previousScene() on this group that have no scenes!");else{var a=this.scenesUids,b=a.indexOf(this.i.story.sceneUid),d;-1===b&&(g.S.W(this.j,"Scene")?d=this.j:d=a[0]);0<=b-1?d=a[b-1]:-1!==b&&(d=a[a.length-1]);this.load(d)}};e.destroy=function(){this.c=this.i=null;this.o.destroy();this.o=null;this.u.destroy();this.u=null;this.m.destroy();this.m=null;n.prototype.destroy.call(this)};Object.defineProperty(F.prototype,"config",{get:function(){return this.f}});
Object.defineProperty(F.prototype,"name",{get:function(){return this.o.value}});Object.defineProperty(F.prototype,"color",{get:function(){return this.D}});Object.defineProperty(F.prototype,"alpha",{get:function(){return this.B}});Object.defineProperty(F.prototype,"slug",{get:function(){return this.u.value}});Object.defineProperty(F.prototype,"description",{get:function(){return this.m.value}});Object.defineProperty(F.prototype,"childrenUids",{get:function(){return this.ud()}});
Object.defineProperty(F.prototype,"children",{get:function(){return this.oe()}});Object.defineProperty(F.prototype,"scenesUids",{get:function(){return this.ud("Scene")}});Object.defineProperty(F.prototype,"scenes",{get:function(){return this.oe("Scene")}});Object.defineProperty(F.prototype,"groupsUids",{get:function(){return this.ud("Group")}});Object.defineProperty(F.prototype,"groups",{get:function(){return this.oe("Group")}});
function E(a){this.i=a;this.c=null;this.D=0;this.B=!1;this.u=this.m=this.o=this.f=this.j=null;n.call(this,"Scene")}E.prototype=Object.create(n.prototype);e=E.prototype;e.constructor=E;e.Bl=function(a){this.B=!0;"string"===typeof a.data&&(a.data=JSON.parse(a.data));this.c.Jj(a.data);this.i.story.yk(this);this.u&&this.u.F()};
e.ma=function(a){this.c=new G(this.i,a);this.R=this.c.uid;this.jb=this.c.tags;aa(this);!1===this.B&&"string"===typeof a.url&&""!==a.url?this.i.load.json(this.R,a.url,this.Bl,this):this.B=!0};e.load=function(){this.log("FORGE.Scene.load();");this.i.story.scene!==this&&(this.j&&this.j.F(),this.D++,this.f&&this.f.F())};e.Le=function(){this.o&&this.o.F();this.m&&this.m.F()};e.wd=function(a){return"string"===typeof a&&!0===g.S.W(a,"Group")?g.S.get(a).Wc(this):!0===g.K.W(a,"Group")?a.Wc(this):!1};
e.Ec=function(){for(var a=this.i.story.groups,b,d=0,h=a.length;d<h;d++)if(b=a[d],!0===b.Wc(this))return!0;return!1};e.destroy=function(){this.i=null;this.c&&(this.c.destroy(),this.c=null);this.j&&(this.j.destroy(),this.j=null);this.f&&(this.f.destroy(),this.f=null);this.o&&(this.o.destroy(),this.o=null);this.m&&(this.m.destroy(),this.m=null);n.prototype.destroy.call(this)};Object.defineProperty(E.prototype,"booted",{get:function(){return this.B}});Object.defineProperty(E.prototype,"config",{get:function(){return this.c}});
Object.defineProperty(E.prototype,"viewCount",{get:function(){return this.D}});Object.defineProperty(E.prototype,"viewed",{get:function(){return!!this.D}});Object.defineProperty(E.prototype,"name",{get:function(){return this.c.name}});Object.defineProperty(E.prototype,"slug",{get:function(){return this.c.slug}});Object.defineProperty(E.prototype,"description",{get:function(){return this.c.description}});
Object.defineProperty(E.prototype,"groupsUid",{get:function(){for(var a=this.i.story.groups,b,d=[],h=0,k=a.length;h<k;h++)b=a[h],!0===b.Wc(this)&&d.push(b.uid);return d}});Object.defineProperty(E.prototype,"groups",{get:function(){return g.S.get(this.groupsUid)}});Object.defineProperty(E.prototype,"thumbnails",{get:function(){return this.c.thumbnails}});Object.defineProperty(E.prototype,"onLoadStart",{get:function(){this.j||(this.j=new q(this));return this.j}});
Object.defineProperty(E.prototype,"onLoadComplete",{get:function(){this.f||(this.f=new q(this));return this.f}});Object.defineProperty(E.prototype,"onUnloadStart",{get:function(){this.o||(this.o=new q(this));return this.o}});Object.defineProperty(E.prototype,"onUnloadComplete",{get:function(){this.m||(this.m=new q(this));return this.m}});Object.defineProperty(E.prototype,"onConfigLoadComplete",{get:function(){this.u||(this.u=new q(this));return this.u}});
function G(a,b){this.i=a;this.c=b;this.f=this.m=this.j=null;n.call(this,"SceneParser");this.R=this.c.uid;this.jb=this.c.tags;this.j=new D(this.i,this.c.name);this.m=new D(this.i,this.c.slug);this.f=new D(this.i,this.c.description)}G.prototype=Object.create(n.prototype);e=G.prototype;e.constructor=G;e.Jj=function(a){this.c=g.K.Cc(this.c,a)};
e.gk=function(){return"undefined"!==typeof this.c.sound&&"undefined"!==typeof this.c.sound.source&&("undefined"!==typeof this.c.sound.source.url&&""!==this.c.sound.source.url||"undefined"!==typeof this.c.sound.source.target&&""!==this.c.sound.source.target)?!0:!1};e.hk=function(a){return"undefined"!==typeof this.c.sound&&"undefined"!==typeof this.c.sound.source&&"undefined"!==typeof this.c.sound.source.target&&""!==this.c.sound.source.target&&this.c.sound.source.target===a?!0:!1};
e.nk=function(){return!0===this.gk()&&this.c.sound.type===g.lb.Ne?!0:!1};e.destroy=function(){this.i=null;this.j.destroy();this.j=null;this.m.destroy();this.m=null;this.f.destroy();this.f=null;n.prototype.destroy.call(this)};Object.defineProperty(G.prototype,"uid",{get:function(){return this.R}});Object.defineProperty(G.prototype,"name",{get:function(){return this.j.value}});Object.defineProperty(G.prototype,"slug",{get:function(){return this.m.value}});
Object.defineProperty(G.prototype,"description",{get:function(){return this.f.value}});Object.defineProperty(G.prototype,"tags",{get:function(){return this.jb}});Object.defineProperty(G.prototype,"thumbnails",{get:function(){return this.c.thumbnails}});Object.defineProperty(G.prototype,"media",{get:function(){return this.c.media}});Object.defineProperty(G.prototype,"sound",{get:function(){return this.c.sound}});Object.defineProperty(G.prototype,"fx",{get:function(){return this.c.fx}});
Object.defineProperty(G.prototype,"playlists",{get:function(){return this.c.playlists}});Object.defineProperty(G.prototype,"view",{get:function(){return this.c.view}});Object.defineProperty(G.prototype,"camera",{get:function(){return this.c.camera}});Object.defineProperty(G.prototype,"hotspots",{get:function(){return this.c.hotspots}});Object.defineProperty(G.prototype,"director",{get:function(){return this.c.director}});Object.defineProperty(G.prototype,"plugins",{get:function(){return this.c.plugins}});
Object.defineProperty(G.prototype,"audio",{get:function(){return this.c.audio}});g.Math={};g.Math.Wa="degrees";g.Math.Db="radians";g.Math.jh=Math.PI/180;g.Math.yi=180/Math.PI;g.Math.Fi=2*Math.PI;g.Math.ha=function(a){return a*g.Math.jh};g.Math.pc=function(a){return a*g.Math.yi};g.Math.Ed=function(a){return Math.round(10*a)/10};g.Math.ca=function(a,b,d){b="number"===typeof b&&!1===isNaN(b)?b:-Infinity;d="number"===typeof d&&!1===isNaN(d)?d:Infinity;return Math.min(Math.max(a,b),d)};
g.Math.eb=function(a,b,d){d-=b;return((a-b)%d+d)%d+b};g.Math.ko=function(a,b,d){return a*d+b*(1-d)};g.Math.ro=function(a,b,d){a=g.Math.ca((a-b)/(d-b),0,1);return a*a*(3-2*a)};g.Math.Hg=function(a){return{yaw:Math.atan2(-a.elements[2],a.elements[10]),pitch:Math.asin(-a.elements[6]),roll:Math.atan2(-a.elements[4],a.elements[5])}};
g.Math.le=function(a,b,d,h){var k=Math.cos(a);a=Math.sin(a);var l=Math.cos(-b);b=Math.sin(-b);var p=Math.cos(d);d=Math.sin(d);"undefined"===typeof h&&(h=!1);return h?(new THREE.Matrix4).set(k*p+a*b*d,-k*d+a*b*p,a*l,0,l*d,l*p,-b,0,-a*p+k*b*d,a*d+k*b*p,k*l,0,0,0,0,1):(new THREE.Matrix4).set(p*k-d*b*a,-d*l,p*a+d*b*k,0,d*k+p*b*a,p*l,d*a-p*b*k,0,-a*l,b,l*k,0,0,0,0,1)};g.Quaternion={};g.Quaternion.Ke=function(a){a=(new THREE.Euler).setFromQuaternion(a,"XYZ");return{yaw:a.x,pitch:-a.y,roll:a.z}};
g.Quaternion.Dc=function(a,b,d){"object"===typeof a&&(b=a.pitch,d=a.roll,a=a.yaw);return(new THREE.Quaternion).setFromEuler(new THREE.Euler(a,-b,d,"ZXY"))};g.Quaternion.Lk=function(a){a=g.Quaternion.Ke(a);return g.Math.le(a.yaw,a.pitch,a.roll)};g.Quaternion.On=function(a){return g.Quaternion.Dc(g.Math.Hg(a))};g.Quaternion.cancelRoll=function(a){a=g.Quaternion.Ke(a);return g.Quaternion.Dc(a.yaw,a.pitch,0)};g.Quaternion.Jn=function(a,b){return(new THREE.Quaternion).copy(a).inverse().multiply(b)};
g.Quaternion.vj=function(a,b){a=Math.abs(a.dot(b));return 1<=a?0:2*Math.acos(a)};g.Quaternion.multiplyScalar=function(a,b){return new THREE.Quaternion(a*b.x,a*b.y,a*b.z,a*b.w)};g.Quaternion.add=function(a,b){return new THREE.Quaternion(a.x+b.x,a.y+b.y,a.z+b.z,a.w+b.w)};g.Quaternion.log=function(a){var b=new THREE.Quaternion(0,0,0,0);if(1>Math.abs(a.w)){var d=Math.acos(a.w),h=Math.sin(d);0<h&&(b.x=d*a.x/h,b.y=d*a.y/h,b.z=d*a.z/h);return b}b.x=a.x;b.y=a.y;b.z=a.z;return b};
g.Quaternion.exp=function(a){var b=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z),d=Math.sin(b),h=(new THREE.Quaternion).copy(a);h.w=Math.cos(b);Math.abs(d)>Number.EPSILON&&(h.x=d*a.x/b,h.y=d*a.y/b,h.z=d*a.z/b);return h};g.Quaternion.slerp=function(a,b,d){var h=new THREE.Quaternion;THREE.Quaternion.slerp(a,b,h,d);return h};g.Quaternion.uo=function(a,b,d,h,k,l){a=g.Quaternion.slerp(a,h,l);b=g.Quaternion.slerp(b,d,l);return g.Quaternion.slerp(a,b,2*l*(1-l))};
g.Quaternion.xk=function(a,b,d){return g.Quaternion.add(g.Quaternion.multiplyScalar(1-d,a),g.Quaternion.multiplyScalar(d,b)).normalize()};g.Quaternion.Ie=function(a,b,d){var h=a.dot(b);if(.95<=Math.abs(h))return g.Quaternion.xk(a,b,d);h=Math.acos(h);return g.Quaternion.multiplyScalar(1/Math.sin(h),g.Quaternion.add(g.Quaternion.multiplyScalar(Math.sin(h*(1-d)),a),g.Quaternion.multiplyScalar(Math.sin(h*d),b)))};
g.Quaternion.Jk=function(a,b,d,h,k){a=g.Quaternion.Ie(a,h,k);b=g.Quaternion.Ie(b,d,k);return g.Quaternion.Ie(a,b,2*k*(1-k))};g.Quaternion.Og=function(a,b,d){var h=(new THREE.Quaternion).copy(b).conjugate();a=(new THREE.Quaternion).copy(h).multiply(a);d=(new THREE.Quaternion).copy(h).multiply(d);h=g.Quaternion.log(a);d=g.Quaternion.log(d);d=g.Quaternion.add(h,d);d=g.Quaternion.multiplyScalar(-.25,d);d=g.Quaternion.exp(d);return(new THREE.Quaternion).copy(b).multiply(d).normalize()};
function Ba(a,b,d,h){this.R="number"===typeof a?a:0;this.j="number"===typeof b?b:0;this.f="number"===typeof d?d:0;this.c="number"===typeof h?h:0}Ba.prototype.constructor=Ba;Object.defineProperty(Ba.prototype,"x",{get:function(){return this.R},set:function(a){"number"===typeof a&&(this.R=a)}});Object.defineProperty(Ba.prototype,"y",{get:function(){return this.j},set:function(a){"number"===typeof a&&(this.j=a)}});
Object.defineProperty(Ba.prototype,"width",{get:function(){return this.f},set:function(a){"number"===typeof a&&(this.f=a)}});Object.defineProperty(Ba.prototype,"height",{get:function(){return this.c},set:function(a){"number"===typeof a&&(this.c=a)}});Object.defineProperty(Ba.prototype,"center",{get:function(){return new THREE.Vector2(this.R+.5*this.f,this.j+.5*this.c)}});Object.defineProperty(Ba.prototype,"origin",{get:function(){return new THREE.Vector2(this.R,this.j)}});
Object.defineProperty(Ba.prototype,"size",{get:function(){return new Ca(this.f,this.c)}});function Ca(a,b){this.f=a||0;this.c=b||0}Ca.prototype.constructor=Ca;Object.defineProperty(Ca.prototype,"width",{get:function(){return this.f}});Object.defineProperty(Ca.prototype,"height",{get:function(){return this.c}});Object.defineProperty(Ca.prototype,"ratio",{get:function(){return this.f/this.c}});g.ub={};g.ub.IMAGE="image";g.ub.VIDEO="video";g.Oa={};g.Oa.cd="equi";g.Oa.Kd="cube";g.Oa.mh="flat";
g.Oa.Tl="hotspot";
function Da(a,b){this.i=a;this.j=b;this.c=this.N=this.f=null;n.call(this,"Media");a=this.j;this.warn("FORGE.Media config validator not implemented");a=a.media;this.R=a.uid;b=a.source;if(!b)throw"No source specified !";if(a.type===g.ub.IMAGE){if(!b.url)throw"Multi resolution not implemented yet !";if(b.format===g.Oa.cd)b={key:this.R,url:b.url},this.N=new H(this.i,b);else if(b.format===g.Oa.Kd)b={key:this.R,url:b.url},this.N=new H(this.i,b);else if(b.format===g.Oa.mh)throw"Flat media not supported yet !";this.N.onLoadComplete.ga(this.o,
this)}else if(a.type===g.ub.VIDEO){if(Array.isArray(b.levels)){b.url=[];for(var d=0,h=b.levels.length;d<h;d++)b.url.push(b.levels[d].url)}"undefined"!==typeof b.streaming&&b.streaming.toLowerCase()===g.nb.Pe?this.N=new I(this.i,this.R):this.N=new J(this.i,this.R,null,null,!0===this.j.hk(this.R)&&!0===this.j.nk()?!0:!1);this.N.load(b.url);this.N.onLoadedMetaData.ga(this.m,this)}this.f="undefined"!==typeof a.options?a.options:null}Da.prototype=Object.create(n.prototype);Da.prototype.constructor=Da;
Da.prototype.o=function(){this.c&&this.c.F()};Da.prototype.m=function(){this.f&&(this.N.volume="number"===typeof this.f.volume?this.f.volume:1,this.N.loop="boolean"===typeof this.f.loop?this.f.loop:!0,!0===this.f.autoPlay&&this.N.play());this.c&&this.c.F()};Da.prototype.destroy=function(){this.N&&(this.N.destroy(),this.N=null);this.c&&(this.c.destroy(),this.c=null);this.j=this.i=null};Object.defineProperty(Da.prototype,"displayObject",{get:function(){return this.N}});
Object.defineProperty(Da.prototype,"onLoadComplete",{get:function(){this.c||(this.c=new q(this));return this.c}});function y(a){this.i=a;this.c=this.B=this.u=this.m=this.G=this.f=this.o=this.I=null;this.T=g.Za.Sd;this.j=this.H=this.J=this.fa=this.C=null;this.V=this.O=this.P=!1;this.$=this.Z=this.L=this.M=null;n.call(this,"RenderManager");this.D=new THREE.Clock;this.i.onReady.add(this.ai,this,1E3)}y.prototype=Object.create(n.prototype);e=y.prototype;e.constructor=y;
e.ai=function(){var a={antialias:!0,alpha:!0,premultipliedAlpha:!1,stencil:!0,canvas:this.i.canvas.dom};try{this.I=new THREE.WebGLRenderer(a)}catch(b){this.destroy();return}this.I.autoClear=!1;this.I.autoClearDepth=!0;this.I.autoClearColor=!0;this.B=new Ea(this.i);this.f=new Fa(this.i);this.H=new Ga(this.i);this.o=new Ha(this.i);this.f.onDisplayChange.add(this.aj,this);Ia(this,this.f.rendererSize);this.C=new K(this.i);this.i.canvas.onResize.add(this.Gi,this);this.i.story.onSceneLoadStart.add(this.$h,
this)};
e.$h=function(){this.i.story.scene.onUnloadStart.ga(this.fn,this);this.j=this.i.story.scene.config;"undefined"!==typeof this.j.background&&(this.i.container.background=this.j.background);this.H.Aj();this.o.rj(this.H.renderScenes);var a=g.K.pb(this.i.config.view,this.j.view);switch("string"===typeof a.type?a.type.toLowerCase():g.Ia.Ob){case g.Ia.wc:this.Fd(g.Ia.wc);break;default:this.Fd(g.Ia.Ob)}a=g.K.pb(this.i.config.camera,this.j.camera);this.C.load(a);a=this.j;"undefined"!==typeof a.media&&"undefined"!==
typeof a.media.source?(this.T=a.media.source.format===g.Oa.Kd?g.Za.Qd:g.Za.Rd,this.m=new Da(this.i,a),this.m.onLoadComplete.ga(this.Im,this),g.K.W(this.m.displayObject,["VideoHTML5","VideoDash"])&&this.m.displayObject.onQualityChange.add(this.ff,this),this.Z&&this.Z.F()):Ja(this);a=this.j;if("undefined"!==typeof a.sound&&"undefined"!==typeof a.sound.source){var b,d,h,k;"undefined"!==typeof a.sound.options&&(b="number"===typeof a.sound.options.volume?g.Math.ca(a.sound.options.volume,0,1):1,d="boolean"===
typeof a.sound.options.loop?a.sound.options.loop:!1,h="number"===typeof a.sound.options.startTime?a.sound.options.startTime:0,k="boolean"===typeof a.sound.options.autoPlay?a.sound.options.autoPlay:!1);"undefined"!==typeof a.sound.source.url&&""!==a.sound.source.url&&(this.u=new L(this.i,a.sound.uid,a.sound.source.url,a.sound.type===g.lb.Ne?!0:!1),"undefined"!==typeof a.sound.options&&(this.u.volume=b,this.u.loop=d,this.u.startTime=h,!0===k&&this.u.play(this.u.startTime,this.u.loop,!0)))}};
e.fn=function(){this.V=this.P=this.O=!1;this.H&&this.H.df();this.B&&this.B.Ih();this.o&&this.o.gf();this.u&&(this.u.destroy(),this.u=null);this.m&&(!0===g.K.W(this.m.displayObject,["VideoHTML5","VideoDash"])&&void 0!==this.m.displayObject.onQualityChange&&this.m.displayObject.onQualityChange.has(this.ff,this)&&this.m.displayObject.onQualityChange.remove(this.ff,this),this.$&&this.$.F(),this.m.destroy(),this.m=null)};
e.Im=function(a){this.log("Media load is complete");Ka(this,this.T);this.c.displayObject=a.emitter.displayObject;a=null;"undefined"!==typeof this.j.media.fx&&null!==this.j.media.fx&&(a=this.i.postProcessing.pe(this.j.media.fx));this.o.pj(this.c.renderTarget.texture,a);"undefined"!==typeof this.j.fx&&this.o.qj(this.i.postProcessing.pe(this.j.fx))};e.ff=function(a){this.log("Media quality has changed");this.c.displayObject=a.emitter};
function Ia(a,b){a.log("Renderer size: "+b.width+"x"+b.height);var d=a.f.presentingVR,h=!0;!0===d&&(h=!1);!1===d&&a.f.setSize(b);a.I.setSize(b.width,b.height,h);a.fa=b;a.J=new Ca(b.width*(d?.5:1),b.height);a.c&&a.c.setSize(a.J);a.B.setSize(a.J);a.o.setSize(a.J);a.log("Render size change in "+(d?"VR":"screen")+" mode, resolution: "+a.J.width+"x"+a.J.height)}e.Gi=function(){this.log("_canvasResizeHandler");var a=this.i.canvas.dom;Ia(this,new Ca(a.width,a.height))};
e.aj=function(){Ia(this,this.f.rendererSize);this.B.mode=!0===this.f.presentingVR?La.Mc:La.kb};
function Ka(a,b){var d=null,h=null;a.c&&(null!==a.c.displayObject&&(d=a.c.displayObject),null!==a.c.renderTarget&&(h=a.c.renderTarget));Ja(a);b===g.Za.Rd?(a.c=new Ma(a.i,h),h=a.I.getSize(),Ia(a,new Ca(h.width,h.height))):b===g.Za.Qd&&(b={order:a.j.media.source.order||"RLUDFB",tile:a.j.media.source.tile},b.io=a.j.media.source.format,a.c=new Na(a.i,h,b));null!==d&&(a.c.displayObject=d);a.P=!0;a.M&&a.M.F()}function Ja(a){a.c&&(a.c.destroy(),a.c=null);a.P=!1}
e.render=function(){if(!1!==this.P&&!1!==this.O&&this.o&&!0===this.P){var a=this.f.presentingVR,b=this.f.Xj();this.C.update();for(var d=0,h=b.length;d<h;d++){var k=b[d],l=k.rectangle,k=k.camera;this.I.setViewport(l.origin.x,l.origin.y,l.size.width,l.size.height);this.c&&this.c.render((a?k:null)||null);this.o.render(k);this.I.clearDepth();!0===a&&(l=new THREE.Scene,l.add(k),this.I.render(l,k))}!0===this.f.presentingVR&&this.f.Zh()}};e.screenToWorld=function(a){return this.G.screenToWorld(a)};
e.worldToScreen=function(a,b){return this.G.worldToScreen(a,b||0)};e.Al=function(a){this.f.presentingVR!==a&&(this.f.Yh(a),this.j.media.source.format===g.Oa.cd&&(this.T=!0===a?g.Za.Qd:g.Za.Rd,Ka(this,this.T)))};
e.Fd=function(a){this.log("setView");this.O=!1;this.G&&(this.log("Destroy previous view"),this.G.destroy(),this.G=null);if(a===g.Ia.Ob)this.G=new Oa(this.i,this.C);else if(a===g.Ia.wc)this.G=new Pa(this.i,this.C);else throw"View type not supported "+a;this.c&&this.c.vc();this.O=!0;this.B.Qk(a);a===g.Ia.Ob?this.o.hg(!1):this.o.hg(!0,this.B.material,this.B.renderTarget);this.onViewReady.F()};
e.destroy=function(){this.i.canvas.onResize.remove(this.Gi,this);this.i.story.onSceneLoadStart.remove(this.$h,this);this.i.onReady.remove(this.ai,this);this.B&&(this.B.destroy(),this.B=null);this.M&&(this.M.destroy(),this.M=null);this.L&&(this.L.destroy(),this.L=null);null!==this.U&&(this.U.destroy(),this.U=null);this.u&&(this.u.destroy(),this.u=null);this.m&&(this.m.destroy(),this.m=null);this.H&&(this.H.destroy(),this.H=null);this.G&&(this.G.destroy(),this.G=null);this.c&&(this.c.destroy(),this.c=
null);this.C&&(this.C.destroy(),this.C=null);this.f&&(this.f.onDisplayChange.remove(this.aj,this),this.f.destroy(),this.f=null);this.o&&(this.o.destroy(),this.o=null);this.I=this.j=this.D=null;n.prototype.destroy.call(this)};Object.defineProperty(y.prototype,"viewer",{get:function(){return this.i}});Object.defineProperty(y.prototype,"media",{get:function(){return this.m}});Object.defineProperty(y.prototype,"mediaSound",{get:function(){return this.u}});
Object.defineProperty(y.prototype,"webGLRenderer",{get:function(){return this.I}});Object.defineProperty(y.prototype,"renderPipeline",{get:function(){return this.o}});Object.defineProperty(y.prototype,"backgroundRenderer",{get:function(){return this.c}});Object.defineProperty(y.prototype,"pickingManager",{get:function(){return this.B}});
Object.defineProperty(y.prototype,"view",{get:function(){return this.G},set:function(a){if("string"===typeof a&&""!==a)switch(a){case g.Ia.wc:this.Fd(g.Ia.wc);break;case g.Ia.Ob:this.Fd(g.Ia.Ob);break;default:throw"View type not supported: "+a;}}});Object.defineProperty(y.prototype,"camera",{get:function(){return this.C}});Object.defineProperty(y.prototype,"canvasResolution",{get:function(){return this.fa}});Object.defineProperty(y.prototype,"displayResolution",{get:function(){return this.J}});
Object.defineProperty(y.prototype,"presentingVR",{get:function(){return this.f.presentingVR}});Object.defineProperty(y.prototype,"display",{get:function(){return this.f}});Object.defineProperty(y.prototype,"backgroundReady",{get:function(){return this.P}});Object.defineProperty(y.prototype,"onBackgroundReady",{get:function(){this.M||(this.M=new q(this,!0));return this.M}});Object.defineProperty(y.prototype,"viewReady",{get:function(){return this.O}});
Object.defineProperty(y.prototype,"onViewReady",{get:function(){this.L||(this.L=new q(this,!0));return this.L}});Object.defineProperty(y.prototype,"objects",{get:function(){return this.H}});Object.defineProperty(y.prototype,"hotspotsReady",{get:function(){return this.V}});Object.defineProperty(y.prototype,"onHotspotsReady",{get:function(){null===this.U&&(this.U=new q(this,!0));return this.U}});Object.defineProperty(y.prototype,"onMediaReady",{get:function(){this.Z||(this.Z=new q(this));return this.Z}});
Object.defineProperty(y.prototype,"onMediaRelease",{get:function(){this.$||(this.$=new q(this));return this.$}});
function Qa(a,b,d,h){this.i=a;this.j=b;this.m=d;this.o=h;this.f=this.c=null;n.call(this,"RenderScene");this.c=new Ra(g.ab.ic,this.i.renderer.webGLRenderer);a=new Sa(this.j,this.m);a.position=g.Ma.ic;this.c.addPass(a);a=this.i.postProcessing.Ee(this.o);b=0;for(d=a.length;b<d;b++)h=a[b],h.renderToScreen=!1,h.position=g.Ma.ic,this.c.addPass(h);this.f=new Ra(g.ab.xf,this.i.renderer.webGLRenderer);a=new Sa(this.j,this.m);a.position=g.Ma.ic;this.f.addPass(a)}Qa.prototype=Object.create(n.prototype);
Qa.prototype.constructor=Qa;Qa.prototype.setSize=function(a,b){this.c.setSize(a,b);this.f.setSize(a,b)};Qa.prototype.destroy=function(){this.c.readBuffer.dispose();for(this.c.writeBuffer.dispose();0<this.c.passes.length;){var a=this.c.passes.pop();a instanceof Ta&&a.hasOwnProperty("tDiffuse")&&(a.uniforms.tDiffuse.value.texture.dispose(),a.uniforms.tDiffuse.value=null)}this.c=null;this.f.passes.length=0;this.o=this.m=this.j=this.i=this.f=null;n.prototype.destroy.call(this)};
Object.defineProperty(Qa.prototype,"scene",{get:function(){return this.j}});Object.defineProperty(Qa.prototype,"camera",{get:function(){return this.m}});Object.defineProperty(Qa.prototype,"sceneComposer",{get:function(){return this.c}});Object.defineProperty(Qa.prototype,"pickingComposer",{get:function(){return this.f}});function Ha(a){this.i=a;this.D=this.f=this.c=null;this.j=!0;n.call(this,"RenderPipeline");this.D=new THREE.Clock;this.f=[];this.c=new Ra(g.ab.pi,this.i.renderer.webGLRenderer)}
Ha.prototype=Object.create(n.prototype);e=Ha.prototype;e.constructor=Ha;
function Ua(a,b){a.log("COMPOSER: "+b.name);if(b.passes.length){for(var d=[],h=0,k=b.passes.length;h<k;h++){var l;l=b.passes[h];l=l instanceof Ta?l.hasOwnProperty("map")?"Texture("+l.map.uuid.split("-")[0].slice(0,4)+")":"Texture":l instanceof Sa?"Render":l instanceof THREE.ClearMaskPass?"ClearMask":l instanceof THREE.MaskPass?"Mask":l instanceof Va?"Shader("+l.type.replace("Shader","")+")":"Pass";d.push(l)}h="";k=0;for(l=d.length;k<l;k++){for(var p=d[k],h=h+"| ",r=0;r<p.length;r++)h+="-";h+=" |";
if(k<l-1)for(p=0;5>p;p++)h+=" "}a.log(h);k="";l=0;for(p=d.length;l<p;l++)k+="| "+d[l]+" |",l<p-1&&(k+=" --- ");!1===b.passes[b.passes.length-1].renderToScreen&&(k+=" --- tex",b.readBuffer&&"undefined"!==typeof b.readBuffer.name&&(k+="("+b.readBuffer.name+")"));a.log(k);a.log(h)}}function Wa(a){for(var b=0,d=a.f.length;b<d;b++)Ua(a,a.f[b]);Ua(a,a.c)}function Xa(a,b,d){a.f.push(b);!1===d&&(b=new Ya(b),a.c.addPass(b));Za(a)}
function $a(a,b,d){d="undefined"!==typeof d?d:a.passes.length;if(Array.isArray(b))for(var h=b.length-1;0<=h;h--)a.insertPass(b[h],d);else b instanceof THREE.Pass&&a.insertPass(b,d)}
function Za(a){var b=a.c.passes,d=[];b.filter(function(a,b){a.position===g.Ma.Id&&d.push(b)});if(0<d.length&&0<d[0]){for(var h=[],k=d.length-1;0<=k;k--){var l=b.splice(d[k],1)[0];h.push(l)}k=0;for(l=h.length;k<l;k++)a.c.insertPass(h[k],0)}var p=[];b.filter(function(a,b){a.position===g.Ma.lf&&p.push(b)});if(0<p.length&&p[p.length-1]<b.length-1){h=[];k=0;for(l=p.length;k<l;k++){var r=b.splice(p[k],1)[0];h.push(r)}k=0;for(l=h.length;k<l;k++)a.c.addPass(h[k])}h=0;for(k=a.f.length;h<k;h++){var l=a.f[h],
r=!1,u,A=a.f.length;for(u=0;u<A;u++)if(u!==h&&l.readBuffer===a.f[u].readBuffer){r=!0;break}r=r&&h>u;u=0;for(A=l.passes.length;u<A;u++)l.passes[u].clear=!0===r?!1:!u}h=!1;for(k=b.length-1;0<=k;k--)l=b[k],!0===h?l.renderToScreen=!1:!0===l.enabled&&(h=l.renderToScreen=!0);Wa(a)}e.hg=function(a,b,d){for(var h=0,k=this.f.length;h<k;h++){var l=this.f[h];l.type===g.ab.xf&&(l.enabled=a,"undefined"!==typeof b&&(l.passes[0].overrideMaterial=b),"undefined"!==typeof d&&(l.renderTarget=d))}};
e.pj=function(a,b){if("undefined"!==typeof b&&b&&0<b.length){b=this.i.postProcessing.Ee(b);for(var d=0,h=b.length;d<h;d++)b[d].position=g.Ma.Id;$a(this.c,b,0)}a=new Ta(a);a.position=g.Ma.Id;this.c.insertPass(a,0);Za(this)};e.rj=function(a){for(var b=0,d=a.length;b<d;b++)Xa(this,a[b].sceneComposer,!1),Xa(this,a[b].pickingComposer,!0);Za(this)};e.qj=function(a){a=this.i.postProcessing.Ee(a);for(var b=0,d=a.length;b<d;b++)a[b].position=g.Ma.lf;$a(this.c,a);Za(this)};
e.Tn=function(a){if(this.c)for(var b=0,d=this.c.passes.length;b<d;b++){var h=this.c.passes[b];if(h.uid===a)return h}if(this.f)for(b=0,d=this.f.length;b<d;b++)for(var h=this.f[b],k=0,l=h.passes.length;k<l;k++){var p=h.passes[k];if(p.uid===a)return p}return null};
e.setSize=function(a){for(var b=0,d=this.f.length;b<d;b++){var h=this.f[b];h.setSize(a.width,a.height);for(var k=0,l=h.passes.length;k<l;k++){var p=h.passes[k];p instanceof THREE.ShaderPass&&"undefined"!==typeof p.uniforms.resolution&&(p.uniforms.resolution.value=new THREE.Vector2(1/a.width,1/a.height))}}this.c.setSize(a.width,a.height);k=0;for(l=this.c.passes.length;k<l;k++)p=this.c.passes[k],p instanceof THREE.ShaderPass&&"undefined"!==typeof p.uniforms.resolution&&(p.uniforms.resolution.value=
new THREE.Vector2(1/a.width,1/a.height))};
e.render=function(a){if(this.c){for(var b=0,d=this.c.passes.length;b<d;b++){var h=this.c.passes[b];if(h instanceof Ya){var k=h.composer,l=k.readBuffer.texture;!0===k.passes[k.passes.length-1].needsSwap&&(l=k.writeBuffer.texture);h.uniforms.tAdd.value=l}}b=this.D.getDelta();d=this.f.concat(this.c);h=0;for(k=d.length;h<k;h++)for(var l=d[h],p=0,r=l.passes.length;p<r;p++){var u=l.passes[p];u instanceof Sa&&(u.camera=a)}a=0;for(d=this.f.length;a<d;a++)this.f[a].enabled&&this.f[a].render(b);this.c.render(b)}};
e.gf=function(){if(this.c){this.c.readBuffer.dispose();this.c.writeBuffer.dispose();for(var a=0,b=this.c.passes.length;a<b;a++){var d=this.c.passes[a];d instanceof Va&&d.uniforms.hasOwnProperty("tAdd")&&(d.uniforms.tAdd.value=null)}this.c.passes=[]}this.f=[]};
e.destroy=function(){this.gf();this.D=null;for(var a=this.f.length-1;0<a;a--){for(var b=this.f[a],d=0,h=b.passes.length;d<h;d++){var k=b.passes[d];"function"===typeof k.destroy&&k.destroy()}b.passes.length=0}this.f=null;d=0;for(h=this.c.passes.length;d<h;d++)k=this.c.passes[d],"function"===typeof k.destroy&&k.destroy();this.c.passes.length=0;this.i=this.c=null};
Object.defineProperty(Ha.prototype,"enabled",{get:function(){return this.j},set:function(a){for(var b=this.f.concat(this.c),d=0,h=b.length;d<h;d++){var k=b[d],l=a;!1===l&&(this.j=!1);for(var p=k.passes.length-1;0<=p;p--){var r=k.passes[p];r instanceof THREE.ShaderPass&&!(r instanceof Ya)&&(r.enabled=l)}k.hasOwnProperty("enabled")&&(k.enabled=l);Za(this)}this.j=a}});
function Fa(a){this.i=a;this.o=this.G=!1;this.u=this.f=this.m=this.j=this.c=null;this.I=1;this.D=this.B=null;n.call(this,"RenderDisplay");ab(this)}Fa.prototype=Object.create(n.prototype);e=Fa.prototype;e.constructor=Fa;
function ab(a){var b=a.i.renderer.webGLRenderer;a.I=b.getPixelRatio();a.u=b.getSize();a.f=a.u;a.j=[0,0,.5,1];a.m=[.5,0,.5,1];"VRFrameData"in window&&(a.B=new VRFrameData);!0===g.A.Yg?(navigator.getVRDisplays().then(function(b){a.G=0<b.length;for(var d=0,k=b.length;d<k;d++)if("VRDisplay"in window&&b[d]instanceof VRDisplay){a.c=b[d];break}}),bb(a)):a.warn("missing api navigator.getVRDisplays")}
function bb(a){a.i.container.onFullscreenEnter.add(a.Uc,a);a.i.container.onFullscreenExit.add(a.Uc,a);window.addEventListener("vrdisplaypresentchange",a.Uc.bind(a),!1)}
e.Uc=function(){var a=this.o,b=this.i.renderer.webGLRenderer;this.o="undefined"!==typeof this.c&&(!0===this.c.isPresenting||!1===this.G&&document[g.A.fullscreenElement]instanceof window.HTMLElement);if(!0===this.o){var d=this.c.getEyeParameters("left");!0===this.G&&(this.H=d.renderWidth,this.C=d.renderHeight,this.log("Window size: "+window.innerWidth+"x"+window.innerHeight),this.log("Render size: "+this.H+"x"+this.C),this.j=[0,0,.5,1],this.m=[.5,0,.5,1],this.c.getLayers&&(d=this.c.getLayers(),0<d.length&&
d[0].leftBounds&&4===d[0].leftBounds.length&&(this.j=d[0].leftBounds,this.m=d[0].rightBounds)),this.log("Bounds L:["+this.j[0]+", "+this.j[1]+", "+this.j[2]+", "+this.j[3]+"], R:["+this.m[0]+", "+this.m[1]+", "+this.m[2]+", "+this.m[3]+"]"));!1===a&&(this.I=b.getPixelRatio(),this.u=b.getSize(),this.f=new Ca(2*this.H,this.C),b.setPixelRatio(1))}else!0===a&&(this.f=this.u,b.setPixelRatio(this.I));this.o!==a&&this.D&&this.D.F()};
function cb(a,b){var d=a.i.renderer.webGLRenderer.domElement;new Promise(function(a,k){"undefined"===typeof this.c?k(Error("No VR hardware found.")):this.o===b?a():!0===this.G&&(b?a(this.c.requestPresent([{source:d}])):a(this.c.exitPresent()))}.bind(a))}e.Yh=function(a){!0===a?(this.i.raf.stop(),this.i.raf.start(this.c),cb(this,!0)):(this.i.raf.stop(),this.i.raf.start(window),cb(this,!1))};
e.Vj=function(){if(!this.c)return null;var a=new THREE.Quaternion;if("function"===typeof this.c.getPose){var b=this.c.getPose();b.orientation&&(a=b.orientation,a=new THREE.Quaternion(-a[1],-a[0],-a[2],a[3]))}return a};
e.Xj=function(){var a=this.i.renderer.camera,b=[];if("undefined"!==typeof this.c&&this.c&&!0===this.o){var d=this.f.width*this.j[0],h=this.f.height*this.j[1],k=this.f.width*this.j[2],l=this.f.height*this.j[3],p=new Ba(d,h,k,l),d=this.f.width*this.m[0],h=this.f.height*this.m[1],k=this.f.width*this.m[2],l=this.f.height*this.m[3],d=new Ba(d,h,k,l);b.push(new db(p,a.left));b.push(new db(d,a.right))}else b.push(new db(new Ba(0,0,this.u.width,this.u.height),a.main));return b};
e.setSize=function(a){this.u=a;this.i.renderer.webGLRenderer.setPixelRatio(1)};e.Zh=function(){!0===this.G&&"undefined"!==typeof this.c&&!0===this.o&&!0===this.c.capabilities.hasExternalDisplay&&this.c.submitFrame()};e.destroy=function(){this.i.container.onFullscreenEnter.remove(this.Uc,this);this.i.container.onFullscreenExit.remove(this.Uc,this);window.removeEventListener("vrdisplaypresentchange",this.Uc.bind(this));this.i=this.f=this.m=this.j=this.B=this.c=null};
Object.defineProperty(Fa.prototype,"presentingVR",{get:function(){return this.o}});Object.defineProperty(Fa.prototype,"vrDisplay",{get:function(){return this.c}});Object.defineProperty(Fa.prototype,"vrFrameData",{get:function(){return this.c&&"function"===typeof this.c.getFrameData&&this.B?(this.c.getFrameData(this.B),this.B):null}});Object.defineProperty(Fa.prototype,"rendererSize",{get:function(){return this.f}});
Object.defineProperty(Fa.prototype,"onDisplayChange",{get:function(){this.D||(this.D=new q(this));return this.D}});function db(a,b){this.f=a||null;this.c=b||null}db.prototype.constructor=db;Object.defineProperty(db.prototype,"rectangle",{get:function(){return this.f}});Object.defineProperty(db.prototype,"camera",{get:function(){return this.c}});function eb(a,b,d){this.i=a;this.I=this.j=this.f=null;this.B=b||null;n.call(this,d||"BackgroundRenderer");this.ed()}eb.prototype=Object.create(n.prototype);
e=eb.prototype;e.constructor=eb;e.ed=function(){this.j=new THREE.Scene;this.B||(this.B=new THREE.WebGLRenderTarget(this.i.renderer.canvasResolution.width,this.i.renderer.canvasResolution.height,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,Go:!1}))};e.vc=function(){throw Error(this.fb+"::updateAfterViewChange not implemented");};e.setSize=function(a){null!==this.renderTarget&&this.renderTarget.setSize(a.width,a.height)};
e.render=function(a){if(null!==this.i.renderer&&this.B){if(this.f.material instanceof THREE.ShaderMaterial){var b=this.i.renderer.displayResolution;this.f.material.uniforms.hasOwnProperty("tViewportResolution")&&(this.f.material.uniforms.tViewportResolution.value=new THREE.Vector2(b.width,b.height));this.f.material.uniforms.hasOwnProperty("tViewportResolutionRatio")&&(this.f.material.uniforms.tViewportResolutionRatio.value=b.ratio);this.f.material.uniforms.hasOwnProperty("tModelViewMatrixInverse")&&
(this.f.material.uniforms.tModelViewMatrixInverse.value=this.i.renderer.camera.modelViewInverse);this.i.renderer.view.Gc(this.f.material.uniforms)}a?this.i.renderer.webGLRenderer.render(this.j,a,this.B,!0):this.i.renderer.webGLRenderer.render(this.j,this.I,this.B,!0)}};e.destroy=function(){this.I=null;this.B&&(this.B.dispose(),this.B=null);for(;0<this.j.children.length;){var a=this.j.children.pop();null!==a.geometry&&(a.geometry.dispose(),a.geometry=null);this.j.remove(a)}this.i=this.j=null;n.prototype.destroy.call(this)};
Object.defineProperty(eb.prototype,"renderTarget",{get:function(){return this.B}});Object.defineProperty(eb.prototype,"displayObject",{get:function(){return this.N},set:function(a){null===a?this.Xd():this.gj(a)}});g.Za={};g.Za.Sd="undefined";g.Za.Rd="shader";g.Za.Qd="mesh";function Na(a,b,d){this.D=this.u=this.c=this.N=null;this.J=d.order||"RLUDFB";this.m=new THREE.Vector2(0,0);this.M=d.tile;this.H=d.io||g.Oa.Kd;this.o=this.G=0;this.C=1;eb.call(this,a,b,"BackgroundMeshRenderer")}Na.prototype=Object.create(eb.prototype);
e=Na.prototype;e.constructor=Na;e.ed=function(){eb.prototype.ed.call(this);this.I=this.i.renderer.camera.main;this.i.renderer.camera.fovMin=this.i.renderer.view.fovMin;this.i.renderer.camera.fovMax=this.i.renderer.view.fovMax;this.G=1E3;this.o=32;this.vc()};
e.gj=function(a){this.N=a;if(g.K.W(a,"Image"))this.c=new THREE.Texture,this.c.image=a.element;else if(g.K.W(a,"Canvas"))this.c=new THREE.Texture,this.c.image=a.element;else if(g.K.W(a,["VideoHTML5","VideoDash"]))"safari"===g.A.Bb.toLowerCase()&&1440<a.originalHeight&&(this.C=2),this.u=document.createElement("canvas"),this.u.width=a.originalWidth/this.C,this.u.height=a.originalHeight/this.C,this.D=this.u.getContext("2d"),this.c=new THREE.Texture(this.u);else throw"Wrong type of display object "+a.type;
this.c.format=THREE.RGBAFormat;this.c.mapping=THREE.Texture.DEFAULT_MAPPING;this.c.magFilter=THREE.LinearFilter;this.c.minFilter=THREE.LinearFilter;this.c.wrapS=THREE.ClampToEdgeWrapping;this.c.wrapT=THREE.ClampToEdgeWrapping;this.c.generateMipmaps=!1;this.c.needsUpdate=!0;this.m.x=this.c.image.width/this.M;this.m.y=this.c.image.height/this.M;this.f.onBeforeRender=this.Uk.bind(this);this.H!==g.Oa.cd&&this.f.geometry.attributes.uv.set(fb(this))};
e.Uk=function(){this.f.material.uniforms.tTexture.value=this.c};
function fb(a){function b(a,b,k,ic,Ob){if(-1===a)throw"Unknown face for cube mapping.";var A,ob=a%b/b;a=1-(1+parseInt(a/b,10))/k;if(Ob)for(Ob=0,k=ic;Ob<=k;Ob++)for(b=0,A=ic;b<=A;b++)d[h.next().value]=r+l*b+ob,d[h.next().value]=u+p*Ob+a;else for(Ob=0,k=ic;Ob<=k;k--)for(b=0,A=ic;b<=A;A--)d[h.next().value]=r+l*A+ob,d[h.next().value]=u+p*k+a}var d=new Float32Array((a.o+1)*(a.o+1)*12),h=d.keys(),k=a.J.split(""),l=1/1.01*(1/a.m.x/a.o),p=1/1.01*(1/a.m.y/a.o),r=1/a.m.x*.005,u=1/a.m.y*.005;b(k.indexOf("R"),
a.m.x,a.m.y,a.o);b(k.indexOf("L"),a.m.x,a.m.y,a.o);b(k.indexOf("U"),a.m.x,a.m.y,a.o,!0);b(k.indexOf("D"),a.m.x,a.m.y,a.o,!0);b(k.indexOf("B"),a.m.x,a.m.y,a.o);b(k.indexOf("F"),a.m.x,a.m.y,a.o);return d}
e.render=function(a){if(null!==this.i.renderer){if(this.c&&this.u&&this.D&&this.N&&null!==this.N.element){var b=this.N.element;b&&b instanceof HTMLVideoElement&&b.readyState===b.HAVE_ENOUGH_DATA&&this.D&&(this.D.drawImage(b,0,0,b.videoWidth,b.videoHeight,0,0,this.u.width,this.u.height),this.c.needsUpdate=!0,this.log("texture update done"))}eb.prototype.render.call(this,a)}};e.Xd=function(){this.i.renderer.webGLRenderer.clearColor()};
e.vc=function(){var a=g.K.clone(this.i.renderer.view.sc),a=this.H===g.Oa.cd?a.equirectangular:a.mapping,b=g.ShaderLib.sb(a.vertexShader),d=g.ShaderLib.sb(a.fragmentShader),a=new THREE.RawShaderMaterial({fragmentShader:d,vertexShader:b,uniforms:a.uniforms,name:"BackgroundMeshMaterial",side:THREE.BackSide});this.c&&(a.uniforms.tTexture.value=this.c);0===this.j.children.length?(b=new THREE.BoxBufferGeometry(this.G,this.G,this.G,this.o,this.o,this.o),this.f=new THREE.Mesh(b,a),this.j.add(this.f)):(this.f=
this.j.children[0],this.f.material.dispose());this.f.material=a;a.needsUpdate=!0};e.destroy=function(){this.Xd();this.D=this.u=this.N=null;this.c&&(this.c.dispose(),this.c=null);eb.prototype.destroy.call(this)};Object.defineProperty(Na.prototype,"texture",{get:function(){return this.c}});function Ma(a,b){this.o=this.m=this.c=this.N=null;this.u=1;eb.call(this,a,b,"BackgroundShaderRenderer")}Ma.prototype=Object.create(eb.prototype);e=Ma.prototype;e.constructor=Ma;
e.ed=function(){eb.prototype.ed.call(this);this.vc();this.I=new THREE.OrthographicCamera(-1,1,1,-1,-1,1)};
e.gj=function(a){this.N=a;if(g.K.W(a,"Image")||g.K.W(a,"Canvas"))this.c=new THREE.Texture,this.c.image=a.element;else if(g.K.W(a,["VideoHTML5","VideoDash"]))"safari"===g.A.Bb.toLowerCase()&&1440<a.originalHeight&&(this.u=2),this.N.onQualityChange.has(this.fd,this)&&this.N.onQualityChange.remove(this.fd,this),this.N.onQualityChange.add(this.fd,this),this.m=document.createElement("canvas"),this.m.width=a.originalWidth/this.u,this.m.height=a.originalHeight/this.u,this.o=this.m.getContext("2d"),this.c=
new THREE.Texture(this.m);else throw"Wrong type of display object "+a.className;this.c.format=THREE.RGBFormat;this.c.mapping=THREE.Texture.DEFAULT_MAPPING;this.c.magFilter=THREE.LinearFilter;this.c.minFilter=THREE.LinearFilter;this.c.wrapS=THREE.ClampToEdgeWrapping;this.c.wrapT=THREE.ClampToEdgeWrapping;this.c.generateMipmaps=!1;this.c.needsUpdate=!0;this.f.material.uniforms.tTexture.value=this.c};
e.fd=function(a){this.log("Media quality has changed");a=a.emitter;this.m.width=a.originalWidth/this.u;this.m.height=a.originalHeight/this.u};e.Xd=function(){this.i.renderer.webGLRenderer.clearColor()};
e.render=function(a){if(null!==this.i.renderer){a=null;if(this.c&&this.m&&this.o&&this.N&&null!==this.N.element){var b=this.N.element;b instanceof HTMLVideoElement&&b.readyState===b.HAVE_ENOUGH_DATA&&this.o&&(this.o.drawImage(b,0,0,b.videoWidth,b.videoHeight,0,0,this.m.width,this.m.height),this.c.needsUpdate=!0,this.log("texture update done"))}eb.prototype.render.call(this,a)}};
e.vc=function(){var a=this.i.renderer.view.Yc,b=g.ShaderLib.sb(a.vertexShader),d=g.ShaderLib.sb(a.fragmentShader),a=new THREE.ShaderMaterial({uniforms:a.uniforms,vertexShader:b,fragmentShader:d,side:THREE.FrontSide});this.c&&(a.uniforms.tTexture.value=this.c);0===this.j.children.length?(b=new THREE.PlaneBufferGeometry(2,2),this.f=new THREE.Mesh(b,a),this.j.add(this.f)):(this.f=this.j.children[0],this.f.material=null);this.f.material=a;a.needsUpdate=!0};
e.destroy=function(){this.Xd();"undefined"!==typeof this.N.onQualityChange&&this.N.onQualityChange.has(this.fd,this)&&this.N.onQualityChange.remove(this.fd,this);this.o=this.m=this.N=null;this.c&&(this.c.dispose(),this.c=null);eb.prototype.destroy.call(this)};Object.defineProperty(Ma.prototype,"texture",{get:function(){return this.c}});function pa(a){this.i=a;this.c=this.f=null;n.call(this,"PostProcessing");this.c={}}pa.prototype=Object.create(n.prototype);e=pa.prototype;e.constructor=pa;
e.Ee=function(a){if("undefined"===typeof a||null===a||0===a.length)return[];for(var b=[],d=0,h=a.length;d<h;d++){var k=a[d],l;if(THREE.hasOwnProperty(k.type)){l=new Va(k.uid,k.type,THREE[k.type]);if("undefined"!==typeof l.uniforms)for(var p in k.params){var r=k.params[p],u=r;if("object"===typeof r&&r.hasOwnProperty("type")&&r.hasOwnProperty("args")){var A=r.args;switch(r.type){case "THREE.Color":if(3===A.length)u=new THREE.Color(A[0],A[1],A[2]);else if("string"===typeof A||"number"===typeof A)u=new THREE.Color(A);
else throw Error("Cannot create THREE.Color with "+typeof A+" (length "+A.length+")");break;case "THREE.Vector2":u=new THREE.Vector2(A[0],A[1]);break;case "THREE.Vector3":u=new THREE.Vector3(A[0],A[1],A[2])}}l.uniforms[p].value=u}b.push(l)}else this.warn("Unknown image effect ("+k.type+")")}return b};e.pe=function(a){return this.c[a]};
e.ma=function(a){a=this.f=a;this.R=a.uid;if("undefined"!==typeof a.fxSets&&0<a.fxSets.length)for(var b=0,d=a.fxSets.length;b<d;b++){var h=a.fxSets[b];this.c[h.uid]=h.set}};e.destroy=function(){this.c=this.i=null};g.ab={};g.ab.pi="main";g.ab.ic="render";g.ab.xf="picking";function Ra(a,b,d){this.m=a||g.ab.ic;this.f="";this.c=!0;THREE.EffectComposer.call(this,b,d);this.f=gb(this.m)}Ra.prototype=Object.create(THREE.EffectComposer.prototype);Ra.prototype.constructor=Ra;
Ra.prototype.destroy=function(){this.writeBuffer.dispose();this.writeBuffer=null;this.readBuffer.dispose();this.readBuffer=null};Ra.uid=0;function gb(a){return"FORGE.EffectComposer."+a+"."+Ra.uid++}Object.defineProperty(Ra.prototype,"type",{get:function(){return this.m}});Object.defineProperty(Ra.prototype,"renderTarget",{get:function(){return this.readBuffer},set:function(a){this.readBuffer&&this.readBuffer.dispose();this.readBuffer=a}});
Object.defineProperty(Ra.prototype,"enabled",{get:function(){return this.c},set:function(a){this.c=a}});Object.defineProperty(Ra.prototype,"name",{get:function(){return this.f}});g.Ma={};g.Ma.Td="";g.Ma.Id="background";g.Ma.ic="render";g.Ma.lf="global";function Ta(a,b){this.c="";THREE.TexturePass.call(this,a,b)}Ta.prototype=Object.create(THREE.TexturePass.prototype);Ta.prototype.constructor=Ta;Object.defineProperty(Ta.prototype,"position",{get:function(){return this.c},set:function(a){this.c=a}});
function Va(a,b,d,h){this.o=a;this.m=b||"shader";this.R=g.Ma.Td;this.f=0;THREE.ShaderPass.call(this,d,h||"tDiffuse")}Va.prototype=Object.create(THREE.ShaderPass.prototype);Va.prototype.constructor=Va;Va.prototype.render=function(a,b,d,h,k){this.f+=h;this.uniforms.hasOwnProperty("time")&&(this.uniforms.time.value=this.f);THREE.ShaderPass.prototype.render.call(this,a,b,d,h,k)};Object.defineProperty(Va.prototype,"uid",{get:function(){return this.o}});Object.defineProperty(Va.prototype,"type",{get:function(){return this.m}});
Object.defineProperty(Va.prototype,"position",{get:function(){return this.R},set:function(a){this.R=a}});function Ya(a){this.j=a;this.c=null;a=g.ShaderLib.sb(g.ShaderChunk.wts_vert_rectilinear);var b=g.ShaderLib.sb(g.ShaderChunk.wts_frag_addition);this.c=new THREE.RawShaderMaterial({fragmentShader:b,vertexShader:a,uniforms:{tTexture:{type:"t",value:null},tAdd:{type:"t",value:null}},side:THREE.FrontSide,name:"FORGE.AdditionPassMaterial"});Va.call(this,"","Addition",this.c,"tTexture")}
Ya.prototype=Object.create(Va.prototype);Ya.prototype.constructor=Ya;Ya.prototype.destroy=function(){this.c||(this.c.dispose(),this.c=null);this.j=null};Object.defineProperty(Ya.prototype,"composer",{get:function(){return this.j}});function Sa(a,b,d,h,k){this.c="";THREE.RenderPass.call(this,a,b,d,h,k)}Sa.prototype=Object.create(THREE.RenderPass.prototype);Sa.prototype.constructor=Sa;Object.defineProperty(Sa.prototype,"position",{get:function(){return this.c},set:function(a){this.c=a}});
g.ShaderChunk={};g.ShaderChunk.coordinates="\nvec3 toCartesian(in vec3 rtp) {\n    float r = rtp.x;\n    float theta = rtp.y;\n    float phi = rtp.z;\n    float x = r * cos(phi) * sin(theta);\n    float y = r * sin(phi);\n    float z = r * cos(phi) * cos(theta);\n    return vec3(x,y,z);\n}\nvec3 toSpherical(in vec3 pt) {\n    float r = length(pt);\n    float theta = -atan(pt.x, pt.z);\n    float phi = asin(pt.y / r);\n    return vec3(r,theta,phi);\n}\n";g.ShaderChunk.defines="precision highp float;\nprecision highp int;\n#define PI  3.141592653589793\n#define PI2 6.28318530717959\n#define RECIPROCAL_PI2 0.1591549430919\n";
g.ShaderChunk.helpers="\nfloat wrap(in float x, in float min, in float max) {\n    return x - ((max - min) * (1.0 - step(x, min) - step(x, max)));\n}\nvec2 getFragment() {\n    return (2.0 * gl_FragCoord.xy / tViewportResolution - 1.0) * vec2(tViewportResolutionRatio, 1.0);\n}\n";g.ShaderChunk.texcoords="\nvec2 toEquirectangularTexCoords(in vec2 thetaphi) {\n    thetaphi.x = wrap(thetaphi.x + PI, -PI, PI);\n    vec2 coords = 0.5 + thetaphi / vec2(PI2, PI);\n    return coords;\n}\n";
g.ShaderChunk.uniforms="uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\n";g.ShaderChunk.vert_attributes="attribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n";g.ShaderChunk.stw_frag_proj_gopro="\n#include <defines>\nuniform sampler2D tTexture;\nuniform vec2 tViewportResolution;\nuniform float tViewportResolutionRatio;\nuniform mat4 tModelViewMatrixInverse;\nuniform float tProjectionDistance;\nuniform float tProjectionScale;\n#include <helpers>\n#include <coordinates>\n#include <texcoords>\nvec2 projection() {\n    vec2 frag = getFragment();\n    vec2 c = tProjectionScale * frag;\n    float zs = tProjectionDistance;\n    float xy2 = dot(c,c);\n    float zs12 = (zs+1.0)*(zs+1.0);\n    float delta = 4.0*(zs*zs*xy2*xy2 - (xy2+zs12)*(xy2*zs*zs-zs12));\n    if (delta < 0.0) {return vec2(-1.);}\n    float z = (2.0*zs*xy2 - sqrt(delta)) / (2.0 * (zs12 + xy2));\n    float x = c.x * ((zs-z) / (zs+1.0));\n    float y = c.y * ((zs-z) / (zs+1.0));\n    vec3 vx = vec3(tModelViewMatrixInverse * vec4(x, y, z, 1.0));\n    return toSpherical(vx).yz;\n}\nvoid main() {\n    vec2 texCoords = toEquirectangularTexCoords(projection());\n    gl_FragColor = vec4(texture2D(tTexture, texCoords).rgb, 1.0);\n}\n";
g.ShaderChunk.stw_frag_proj_rectilinear="\n#include <defines>\nuniform sampler2D tTexture;\nuniform vec2 tViewportResolution;\nuniform float tViewportResolutionRatio;\nuniform mat4 tModelViewMatrixInverse;\nuniform float tProjectionScale;\n#include <helpers>\n#include <coordinates>\n#include <texcoords>\nvec2 projection() {\n    vec2 frag = tProjectionScale * getFragment();\n    vec4 screenPT = vec4(frag, -1.0, 1.0);\n    vec4 worldPT = tModelViewMatrixInverse * screenPT;\n    return toSpherical(worldPT.xyz).yz;\n}\nvoid main() {\n    vec2 texCoords = toEquirectangularTexCoords(projection());\n    gl_FragColor = vec4(texture2D(tTexture, texCoords).rgb, 1.0);\n}\n";
g.ShaderChunk.stw_vert_proj="\n#include <defines>\nvoid main() {\n   gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n";g.ShaderChunk.wts_frag="\n#include <defines>\nuniform sampler2D tTexture;\nvarying vec2 vUv;\nvoid main() {\n    gl_FragColor = texture2D( tTexture, vUv );\n}\n";g.ShaderChunk.wts_frag_addition="\n#include <defines>\nuniform sampler2D tTexture;\nuniform sampler2D tAdd;\nvarying vec2 vUv;\nvoid main() {\n    vec4 texel = texture2D( tTexture, vUv );\n    vec4 texelAdd = texture2D( tAdd, vUv );\n    gl_FragColor = vec4(vec3(texelAdd.a * texelAdd.rgb + (1.0 - texelAdd.a) * texel.rgb), 1.0);\n}\n";
g.ShaderChunk.wts_frag_color="\n#include <defines>\nuniform vec3 tColor;\nvarying vec2 vUv;\nvoid main() {\n    vec2 texCoords = vUv;\n    gl_FragColor = vec4(tColor, 1.0);\n}\n";g.ShaderChunk.wts_frag_depth_drawing="\n#include <defines>\nvarying float vDepth;\nvoid main() {\n    gl_FragColor = vec4(vDepth, vDepth, vDepth, 1.0);\n}\n";g.ShaderChunk.wts_frag_equirectangular="\n#include <defines>\nuniform sampler2D tTexture;\nvarying vec3 vWorldPosition;\nvoid main() {\n    vec3 direction = normalize( vWorldPosition );\n    vec2 sampleUV;\n    sampleUV.y = clamp( direction.y * 0.5 + 0.5, 0.0, 1.0 );\n    sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 - 0.25;\n    sampleUV.x += (1.0 - step(0.0, sampleUV.x));\n    gl_FragColor = texture2D( tTexture, sampleUV );\n}\n";
g.ShaderChunk.wts_vert_gopro="\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tProjectionDistance;\nuniform float tProjectionScale;\nuniform float tViewportResolutionRatio;\nvarying vec2 vUv;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    vec4 origin = vec4(vec3(0.0), 1.0);\n    camPt.z -= tProjectionDistance * distance(camPt, origin);\n    camPt.xyz /= max(1.0, tProjectionScale);\n    gl_Position = projectionMatrix * camPt;\n    vUv = uv;\n}\n";
g.ShaderChunk.wts_vert_gopro_equirectangular="\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tProjectionDistance;\nuniform float tProjectionScale;\nuniform float tViewportResolutionRatio;\nvarying vec3 vWorldPosition;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    vec4 origin = vec4(vec3(0.0), 1.0);\n    camPt.z -= tProjectionDistance * distance(camPt, origin);\n    camPt.xyz /= max(1.0, tProjectionScale);\n    gl_Position = projectionMatrix * camPt;\n    vWorldPosition = vec3(position);\n}\n";
g.ShaderChunk.wts_vert_littleplanet="\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tProjectionScale;\nuniform float tViewportResolutionRatio;\nvarying vec2 vUv;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    camPt.z -= distance(camPt, vec4(vec3(0.0), 1.0));\n    camPt.xyz /= tProjectionScale;\n    gl_Position = projectionMatrix * camPt;\n    vUv = uv;\n}\n";g.ShaderChunk.wts_vert_littleplanet_equirectangular="\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tProjectionScale;\nuniform float tViewportResolutionRatio;\nvarying vec3 vWorldPosition;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    camPt.z -= distance(camPt, vec4(vec3(0.0), 1.0));\n    camPt.xyz /= tProjectionScale;\n    gl_Position = projectionMatrix * camPt;\n    vWorldPosition = vec3(position);\n}\n";
g.ShaderChunk.wts_vert_rectilinear="\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tViewportResolutionRatio;\nvarying vec2 vUv;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    gl_Position = projectionMatrix * camPt;\n    vUv = uv;\n}\n";g.ShaderChunk.wts_vert_rectilinear_equirectangular="\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tViewportResolutionRatio;\nvarying vec3 vWorldPosition;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    gl_Position = projectionMatrix * camPt;\n    vWorldPosition = vec3( position );\n}\n";
g.ShaderLib={screenToWorld:{rectilinear:{uniforms:{tTexture:{type:"t",value:null},tViewportResolution:{type:"v2",value:new THREE.Vector2},tViewportResolutionRatio:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:new THREE.Matrix4},tProjectionScale:{type:"f",value:1}},vertexShader:g.ShaderChunk.stw_vert_proj,fragmentShader:g.ShaderChunk.stw_frag_proj_rectilinear},gopro:{uniforms:{tTexture:{type:"t",value:null},tViewportResolution:{type:"v2",value:new THREE.Vector2},tViewportResolutionRatio:{type:"f",
value:1},tModelViewMatrixInverse:{type:"m4",value:new THREE.Matrix4},tProjectionDistance:{type:"f",value:0},tProjectionScale:{type:"f",value:1}},vertexShader:g.ShaderChunk.stw_vert_proj,fragmentShader:g.ShaderChunk.stw_frag_proj_gopro}},worldToScreen:{rectilinear:{mapping:{uniforms:{tTexture:{type:"t",value:null},tProjectionScale:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:g.ShaderChunk.wts_vert_rectilinear,fragmentShader:g.ShaderChunk.wts_frag},equirectangular:{uniforms:{tTexture:{type:"t",
value:null},tProjectionScale:{type:"f",value:1},tViewportResolutionRatio:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:g.ShaderChunk.wts_vert_rectilinear_equirectangular,fragmentShader:g.ShaderChunk.wts_frag_equirectangular}},littlePlanet:{equirectangular:{uniforms:{tTexture:{type:"t",value:null},tProjectionScale:{type:"f",value:1},tViewportResolutionRatio:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:g.ShaderChunk.wts_vert_littleplanet_equirectangular,
fragmentShader:g.ShaderChunk.wts_frag_equirectangular}},gopro:{mapping:{uniforms:{tTexture:{type:"t",value:null},tProjectionScale:{type:"f",value:1},tProjectionDistance:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:g.ShaderChunk.wts_vert_gopro,fragmentShader:g.ShaderChunk.wts_frag},equirectangular:{uniforms:{tTexture:{type:"t",value:null},tProjectionScale:{type:"f",value:1},tProjectionDistance:{type:"f",value:1},tViewportResolutionRatio:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",
value:null}},vertexShader:g.ShaderChunk.wts_vert_gopro_equirectangular,fragmentShader:g.ShaderChunk.wts_frag_equirectangular}}}};g.ShaderLib.sb=function(a){return a.replace(/#include +<([\w\d.]+)>/g,function(a,d){a=g.ShaderChunk[d];if("undefined"===typeof a&&(a=THREE.ShaderChunk[d],"undefined"===typeof a))throw Error("Can not resolve #include <"+d+">");return g.ShaderLib.sb(a)})};g.Ia={};g.Ia.Sd="undefined";g.Ia.Ob="rectilinear";g.Ia.wc="gopro";
function hb(a,b,d,h){this.i=a;this.c=b;this.f=1;this.m=h;n.call(this,d||"ViewBase")}hb.prototype=Object.create(n.prototype);e=hb.prototype;e.constructor=hb;e.Yc=g.ShaderLib.screenToWorld.rectilinear;e.sc=g.ShaderLib.worldToScreen.rectilinear;e.Lc=function(){};e.Gc=function(a){this.log(a);throw"Please implement "+this.fb+"::updateScreenToWorld";};e.worldToScreen=function(a,b){this.log(a);this.log(b);throw"Please implement "+this.fb+"::worldToScreen";};
e.screenToWorld=function(a){this.log(a);throw"Please implement "+this.fb+"::screenToWorld";};e.destroy=function(){this.c=this.i=null;n.prototype.destroy.call(this)};Object.defineProperty(hb.prototype,"type",{get:function(){return this.m}});Object.defineProperty(hb.prototype,"fovMin",{get:function(){return this.c.fovMin}});Object.defineProperty(hb.prototype,"fovMax",{get:function(){return this.c.fovMax}});function Pa(a,b){hb.call(this,a,b,"ViewGoPro",g.Ia.wc);this.Lc()}Pa.prototype=Object.create(hb.prototype);
e=Pa.prototype;e.constructor=Pa;e.Yc=g.ShaderLib.screenToWorld.gopro;e.sc=g.ShaderLib.worldToScreen.gopro;e.Lc=function(){hb.prototype.Lc.call(this);this.c.fovMin=10;this.c.fovMax=160};e.Gc=function(a){var b,d=g.Math.ca(this.c.fov,this.c.fovMin,this.c.fovMax);b=60>d?0:180<d?1:.5*(1+Math.sin(Math.PI/2*((d-60)/120*2-1)));a.tProjectionDistance.value=b;d=Math.PI*d/360;this.f=(b+1)*Math.sin(d)/(b+Math.cos(d));a.tProjectionScale.value=this.f};e.destroy=function(){hb.prototype.destroy.call(this)};
function Oa(a,b){hb.call(this,a,b,"ViewRectilinear",g.Ia.Ob);this.Lc()}Oa.prototype=Object.create(hb.prototype);e=Oa.prototype;e.constructor=Oa;e.Yc=g.ShaderLib.screenToWorld.rectilinear;e.sc=g.ShaderLib.worldToScreen.rectilinear;e.Lc=function(){hb.prototype.Lc.call(this);this.c.fovMin=10;this.c.fovMax=170};e.Gc=function(a){this.f=Math.tan(g.Math.ha(g.Math.ca(this.c.fov,this.c.fovMin,this.c.fovMax)/2));a.tProjectionScale.value=this.f};
e.worldToScreen=function(a,b){b=b||0;a=new THREE.Vector4(a.x,a.y,a.z,1);var d=g.Math.Hg(this.c.modelView),d=g.Math.le(d.yaw,d.pitch,d.roll,!0),d=d.transpose();a.applyMatrix4(d);if(0>a.z)return new THREE.Vector2(Infinity,Infinity);d=Math.max(Number.EPSILON,a.z);a=(new THREE.Vector2(a.x,a.y)).divideScalar(d);a.x/=(1+b)*this.f;a.y/=this.f;b=this.i.renderer.displayResolution;a.x=b.width/2*(a.x/b.ratio+1);a.y=b.height/2*(a.y/b.ratio+1);return new THREE.Vector2(Math.round(a.x),b.height-Math.round(a.y))};
e.screenToWorld=function(a){var b=this.i.renderer.displayResolution;a=new THREE.Vector2(2*(a.x/b.width-1)*b.ratio,2*(a.y/b.height-1)*b.ratio);a.multiplyScalar(this.f);a=(new THREE.Vector4(a.x,a.y,-1,0)).applyMatrix4(this.c.modelViewInverse).normalize();return new THREE.Vector3(a.x,a.y,a.z)};e.destroy=function(){hb.prototype.destroy.call(this)};function ib(a){this.c=a||[];n.call(this,"Timeline");g.K.Pa(this.c,"Keyframe")?this.c=g.K.Gd(this.c,"time"):this.c=[]}ib.prototype=Object.create(n.prototype);
e=ib.prototype;e.constructor=ib;e.Wn=function(){return!!this.c&&0<this.c.length};e.Pb=function(a){g.K.W(a,"Keyframe")&&(this.c.push(a),this.c=g.K.Gd(this.c,"time"))};e.Rn=function(a){a=this.qe(a);return{previous:this.c[a.previous],next:this.c[a.next]||null}};e.qe=function(a){for(var b=-1,d=-1,h=this.c.length-1;0<=h;h--)if(a>=this.c[h].time){b=h;break}b!==this.c.length-1&&(d=b+1);return{previous:b,next:d}};
e.Yj=function(a){a=this.Zj(a);return{previous:this.c[a.previous]||null,next:this.c[a.next]||null}};e.Zj=function(a){a=this.qe(a);var b=0,d=a.next;0<a.previous&&(b=a.previous-1);a.next<this.c.length-2&&(d=a.next+1);return{previous:b,next:d}};e.Ln=function(){for(;0<this.c.length;)this.c.pop().data=null;this.c=[]};e.destroy=function(){for(;0<this.c.length;)this.c.pop().data=null;this.c=null;n.prototype.destroy.call(this)};
Object.defineProperty(ib.prototype,"keyframes",{get:function(){return this.c},set:function(a){g.K.Pa(a,"Keyframe")&&(this.c=g.K.Gd(a,"time"))}});function jb(a,b){n.call(this,"Keyframe");this.c=a;this.xb=b}jb.prototype=Object.create(n.prototype);jb.prototype.constructor=jb;Object.defineProperty(jb.prototype,"time",{get:function(){return this.c},set:function(a){"number"===typeof a&&(this.c=a)}});Object.defineProperty(jb.prototype,"data",{get:function(){return this.xb},set:function(a){this.xb=a}});
function kb(a,b){this.i=a;this.ta=b||null;this.u=this.C=this.m=this.Ra=null;this.J=this.H=0;this.U=!1;this.f=null;this.P=0;this.Z=!1;this.B=this.G=this.I=this.D=this.fa=this.V=null;n.call(this,"Animation");this.Se()}kb.prototype=Object.create(n.prototype);e=kb.prototype;e.constructor=kb;e.Se=function(){this.f=new lb(this.i,this);this.f.onStart.add(this.nn,this);this.f.onStop.add(this.pn,this);this.f.onProgress.add(this.Tk,this);this.f.onComplete.add(this.mn,this);this.i.tween.add(this.f);this.m=new ib};
function mb(a,b){a=a.split(".");for(var d=0,h=a.length;d<h-1;d++)b=b[a[d]];return[b,a[d]]}
function nb(a,b){b=b||a.H;var d=a.m.qe(b||a.H);a.u=a.m.keyframes[d.next];a.C=a.m.keyframes[d.previous];if(!a.u||-1===d.next)return!1;if(a.Z){var h=a.m.Yj(b);if(h.previous&&null!==h.next){b=(new THREE.Quaternion).copy(a.C.data.quaternion).normalize();var d=(new THREE.Quaternion).copy(a.u.data.quaternion).normalize(),k=(new THREE.Quaternion).copy(h.previous.data.quaternion).normalize(),h=(new THREE.Quaternion).copy(h.next.data.quaternion).normalize();a.V=g.Quaternion.Og(k,b,d);a.fa=g.Quaternion.Og(b,
d,h)}}a.J=a.u.time-a.C.time;a.f.kf({tweenTime:1},a.J);a.P=0;a.f.start();return!0}e.nn=function(){!0!==this.U&&(this.D&&this.D.F(),this.U=!0)};e.pn=function(){this.U=!1;this.I&&this.I.F()};
e.Tk=function(){var a=this.P;if(this.u){this.H=a*this.J+this.C.time;var b=[],d,h,k;Array.isArray(this.Ra.prop)||(this.Ra.prop=[this.Ra.prop]);k=this.Ra.prop.length;for(h=0;h<k;h++)b.push(mb(this.Ra.prop[h],this.ta));if(!0===this.Ra.smooth&&"quaternion"===this.Ra.prop[0])d=b[0],d[0].quaternion=g.Quaternion.Jk(this.C.data.quaternion,this.V,this.fa,this.u.data.quaternion,a);else if("quaternion"===this.Ra.prop[0])d=b[0],d[0].quaternion=g.Quaternion.slerp(this.C.data.quaternion,this.u.data.quaternion,
a);else{var l=this.f.easing(a),p,r,u=0;for(h=0;h<k;h++){p=mb(this.Ra.prop[h],this.C.data);r=mb(this.Ra.prop[h],this.u.data);d=b[h];p=p[0][p[1]];r=r[0][r[1]];if(this.Ra.eb&&this.Ra.eb[h]){var A=this.Ra.eb[h][0],ob=this.Ra.eb[h][1],u=Math.abs(A-ob)/2;Math.abs(p-r)>u?(p=g.Math.eb(p+u,A,ob),r=g.Math.eb(r+u,A,ob)):u=0}d[0][d[1]]=(1-l)*p+l*r-u}}"function"===typeof this.Ra.Qj&&this.Ra.Qj.call(this,a)}this.G&&this.G.F({progress:this.H/this.J})};e.mn=function(){nb(this)||this.B&&this.B.F()};
e.play=function(){this.H=0;this.C=this.m.keyframes[0];this.u=this.m.keyframes[1];nb(this,0)};e.stop=function(){this.f.stop()};e.resume=function(){nb(this)};e.destroy=function(){this.m&&(this.m.destroy(),this.m=null);this.f&&(this.f.destroy(),this.f=null);this.D&&(this.D.destroy(),this.D=null);this.I&&(this.I.destroy(),this.I=null);this.G&&(this.G.destroy(),this.G=null);this.B&&(this.B.destroy(),this.B=null);n.prototype.destroy.call(this)};Object.defineProperty(kb.prototype,"timeline",{get:function(){return this.m}});
Object.defineProperty(kb.prototype,"instruction",{get:function(){return this.Ra},set:function(a){this.Ra=a}});Object.defineProperty(kb.prototype,"tween",{get:function(){return this.f},set:function(a){this.f=a}});Object.defineProperty(kb.prototype,"tweenTime",{get:function(){return this.P},set:function(a){this.P=a}});Object.defineProperty(kb.prototype,"smooth",{get:function(){return this.Z},set:function(a){this.Z=a}});
Object.defineProperty(kb.prototype,"onPlay",{get:function(){this.D||(this.D=new q(this));return this.D}});Object.defineProperty(kb.prototype,"onStop",{get:function(){this.I||(this.I=new q(this));return this.I}});Object.defineProperty(kb.prototype,"onProgress",{get:function(){this.G||(this.G=new q(this));return this.G}});Object.defineProperty(kb.prototype,"onComplete",{get:function(){this.B||(this.B=new q(this));return this.B}});
function pb(a,b,d){this.i=a;this.ta=b||null;this.c=null;this.D=0;this.o=this.j=null;n.call(this,d)}pb.prototype=Object.create(n.prototype);e=pb.prototype;e.constructor=pb;e.stop=function(){for(var a=0,b=this.c;a<b;a++)this.c[a].stop()};e.resume=function(){for(var a=0,b=this.c;a<b;a++)this.c[a].resume()};e.Ac=function(){this.D++;this.D===this.c.length&&this.o&&this.o.F()};
function qb(a,b,d,h,k,l){var p=null,r=null;d=g.K.Gd(d,"time");for(var u=0;u<d.length;u++){var A="string"===typeof l?d[u].data[l][h]:d[u].data[h];if("undefined"!==typeof A&&null!==A&&(d[u].time<b&&(p=d[u]),d[u].time>b)){r=d[u];break}}null===p&&(p={time:0,data:{}},"string"===typeof l?p.data[l]=a.ta[l]:p.data[h]=a.ta[h]);if(null===r)return"string"===typeof l?p.data[l][h]:p.data[h];a=g.X[k]((b-p.time)/(r.time-p.time));return(1-a)*("string"===typeof l?p.data[l][h]:p.data[h])+a*("string"===typeof l?r.data[l][h]:
r.data[h])}function rb(a){for(var b;a.c&&0<a.c.length;)b=a.c.pop(),b.onComplete.remove(a.Ac,a),b.destroy();a.c=[];a.D=0}e.destroy=function(){n.prototype.destroy.call(this)};Object.defineProperty(pb.prototype,"onComplete",{get:function(){this.o||(this.o=new q(this));return this.o}});function sb(a){this.f=this.B=this.D=null;this.u=0;this.j=null;this.m=0;n.call(this,a)}sb.prototype=Object.create(n.prototype);sb.prototype.constructor=sb;
sb.prototype.c=function(a){this.R=a.uid;this.D=a.name;this.B=a.description;this.f=a.keyframes;this.j="LINEAR";this.m=0;"object"===typeof a.easing&&null!==a.easing&&(this.j=a.easing["default"]||this.j,this.m=a.easing.offset||this.m);aa(this)};sb.prototype.destroy=function(){ba(this)};Object.defineProperty(sb.prototype,"name",{get:function(){return this.D}});Object.defineProperty(sb.prototype,"description",{get:function(){return this.B}});Object.defineProperty(sb.prototype,"keyframes",{get:function(){return this.f}});
Object.defineProperty(sb.prototype,"count",{set:function(a){"number"===typeof a&&(this.u=a)},get:function(){return this.u}});Object.defineProperty(sb.prototype,"easing",{get:function(){return this.j}});Object.defineProperty(sb.prototype,"offset",{get:function(){return this.m}});Object.defineProperty(sb.prototype,"duration",{get:function(){for(var a,b=0,d=this.f.length;b<d;b++)this.f[b].time>a&&(a=this.f[b].time);return a}});
function tb(a,b){this.i=a;this.c=null;this.$="";this.T=this.M=!0;this.o=null;this.U=this.O=!1;this.G=this.B=this.D=this.I=null;n.call(this,b||"Object3D");this.bf()}tb.prototype=Object.create(n.prototype);e=tb.prototype;e.constructor=tb;e.bf=function(){this.o={};this.c=new THREE.Mesh;this.i.renderer.objects.register(this)};e.click=function(){this.log("click "+this.c.id);!0===g.K.W(this.o.onClick,"ActionEventDispatcher")&&this.o.onClick.F();this.I&&this.I.F()};
e.cf=function(){this.log("over "+this.c.id);!0===g.K.W(this.o.onOver,"ActionEventDispatcher")&&this.o.onOver.F();this.D&&this.D.F()};e.Nd=function(){this.log("out "+this.c.id);!0===g.K.W(this.o.onOut,"ActionEventDispatcher")&&this.o.onOut.F();this.B&&this.B.F()};
e.destroy=function(){this.i.renderer.objects.unregister(this);this.c&&(this.c.c=null,this.c.geometry&&(this.c.geometry.dispose(),this.c.geometry=null),this.c=this.c.material=null);this.I&&(this.I.destroy(),this.I=null);this.D&&(this.D.destroy(),this.D=null);this.B&&(this.B.destroy(),this.B=null);this.G&&(this.G.destroy(),this.G=null);this.i=null;n.prototype.destroy.call(this)};Object.defineProperty(tb.prototype,"mesh",{get:function(){return this.c}});
Object.defineProperty(tb.prototype,"visible",{get:function(){return this.M},set:function(a){this.M=!!a;this.c&&(this.c.visible=this.M)}});Object.defineProperty(tb.prototype,"hovered",{get:function(){return this.O},set:function(a){this.O=!!a}});Object.defineProperty(tb.prototype,"interactive",{get:function(){return this.T},set:function(a){this.T=!!a}});Object.defineProperty(tb.prototype,"fx",{get:function(){return this.$}});Object.defineProperty(tb.prototype,"events",{get:function(){return this.o}});
Object.defineProperty(tb.prototype,"ready",{get:function(){return this.U}});Object.defineProperty(tb.prototype,"onClick",{get:function(){this.I||(this.I=new q(this));return this.I}});Object.defineProperty(tb.prototype,"onOver",{get:function(){this.D||(this.D=new q(this));return this.D}});Object.defineProperty(tb.prototype,"onOut",{get:function(){this.B||(this.B=new q(this));return this.B}});Object.defineProperty(tb.prototype,"onReady",{get:function(){this.G||(this.G=new q(this));return this.G}});
function Ga(a){this.i=a;this.c=this.ba=null;n.call(this,"ObjectRenderer");this.ba=[];this.c=[]}Ga.prototype=Object.create(n.prototype);e=Ga.prototype;e.constructor=Ga;function ub(a,b){var d=[];return d="undefined"===typeof b||""===b||null===b?a.ba.filter(function(a){return"undefined"===typeof a.fx||""===a.fx||null===a.fx}):a.ba.filter(function(a){return a.fx===b})}function vb(a){var b=ub(a,null);return g.K.wj(a.ba,b)}
function wb(a){return vb(a).reduce(function(a,d){0>a.indexOf(d.fx)&&a.push(d.fx);return a},[])}e.register=function(a){this.ba.push(a)};e.unregister=function(a){this.ba.splice(this.ba.indexOf(a),1)};
e.Aj=function(){var a=this.i.renderer.camera.main,b=ub(this,null);if(0<b.length){for(var d=new THREE.Scene,h=0,k=b.length;h<k;h++)d.add(b[h].mesh);k=new Qa(this.i,d,a,null);this.c.push(k)}b=wb(this);d=0;for(h=b.length;d<h;d++){for(var k=b[d],l=ub(this,k),p=new THREE.Scene,r=0,u=l.length;r<u;r++)p.add(l[r].mesh);k=new Qa(this.i,p,a,this.i.postProcessing.pe(k));this.c.push(k)}};e.Wj=function(){return this.ba.filter(function(a){return!0===a.ready&&!0===a.interactive})};
e.Tj=function(a){for(var b=0,d=this.ba.length;b<d;b++)if(this.ba[b].mesh===a)return this.ba[b];return null};e.df=function(){for(var a=this.c.length;a--;)this.c.pop().destroy()};e.destroy=function(){this.df();this.i=this.c=null;n.prototype.destroy.call(this)};Object.defineProperty(Ga.prototype,"all",{get:function(){return this.ba}});Object.defineProperty(Ga.prototype,"renderScenes",{get:function(){return this.c}});function xb(a){this.i=a;this.c=this.f=null;n.call(this,"Raycaster")}xb.prototype=Object.create(n.prototype);
e=xb.prototype;e.constructor=xb;
e.start=function(a){this.log("Raycaster start");this.f||(this.f=new THREE.Raycaster);a===La.kb?(this.log("Raycating start pointer"),!1===this.i.canvas.pointer.onClick.has(this.Vd,this)&&this.i.canvas.pointer.onClick.add(this.Vd,this),!1===this.i.canvas.pointer.onMove.has(this.Wd,this)&&this.i.canvas.pointer.onMove.add(this.Wd,this)):a===La.Mc&&(this.log("Raycating start gaze"),!1===this.i.renderer.camera.onCameraChange.has(this.Ud,this)&&this.i.renderer.camera.onCameraChange.add(this.Ud,this))};
e.stop=function(){this.log("Raycaster stop");this.i.canvas.pointer.onClick.has(this.Vd,this)&&this.i.canvas.pointer.onClick.remove(this.Vd,this);this.i.canvas.pointer.onMove.has(this.Wd,this)&&this.i.canvas.pointer.onMove.remove(this.Wd,this);!1===this.i.renderer.camera.onCameraChange.has(this.Ud,this)&&this.i.renderer.camera.onCameraChange.remove(this.Ud,this);yb(this);this.f=null};e.Vd=function(a){a.data.center=a.data.center||{x:a.data.x,y:a.data.y};zb(this,"click",a.data.center)};
e.Wd=function(a){a.data.center=a.data.center||{x:a.data.x,y:a.data.y};zb(this,"move",a.data.center)};e.Ud=function(){zb(this,"move")};
function zb(a,b,d){var h=a.i.renderer.canvasResolution;d=d||{x:h.width/2,y:h.height/2};var k=a.i.renderer.camera,l=(new THREE.Vector2(d.x/h.width,1-d.y/h.height)).multiplyScalar(2).addScalar(-1),h=a.i.renderer.objects.Wj();d=0;for(var p=h.length;d<p;d++)h[d].hovered=!1;d=null;a.f.setFromCamera(l,k.main);k=[];l=0;for(p=h.length;l<p;l++)k.push(h[l].mesh);for(h=a.f.intersectObjects(k);null===d&&0<h.length;){var k=h.shift(),l=k.object,r=k.uv,k=a.i.renderer.objects.Tj(l);if(!1===l.material.transparent)d=
k;else{p=k;l=r;r=null;if(null!==p.mesh&&null!==p.mesh.material&&"undefined"!==typeof p.mesh.material.uniforms.tTexture){var u=p.mesh.material.uniforms.tTexture.value,p=null;null!==u.image&&("img"===u.image.nodeName.toLowerCase()?(p=document.createElement("canvas"),p.width=u.image.width,p.height=u.image.height,p.getContext("2d").drawImage(u.image,0,0)):"canvas"===u.image.nodeName.toLowerCase()&&(p=u.image),null!==p&&(r=p.width,u=p.height,l=4*(Math.floor(u-l.y*u)*r+Math.floor(l.x*r)),p=p.getContext("2d").getImageData(0,
0,r,u).data,r=new Ab(0,0,0,p[l+3])))}else"undefined"!==typeof p.mesh.material.color&&(r=p.mesh.material.color);(l=r)&&10<l.alpha&&(d=k)}}d?"click"===b?a.click():"move"===b&&d!==a.c&&(yb(a),a.c=d,d.cf(),a.i.renderer.pickingManager.mode===La.Mc&&a.i.renderer.camera.gaze.start()):yb(a)}function yb(a){a.c&&(a.c.Nd(),a.c=null,a.i.renderer.pickingManager.mode===La.Mc&&a.i.renderer.camera.gaze.stop())}e.click=function(){this.c&&this.c.click()};e.Xh=function(){this.c=null};
Object.defineProperty(xb.prototype,"hoveredObject",{get:function(){return this.c}});
function Bb(a){this.i=a;this.c=this.f=this.ta=null;n.call(this,"PickingDrawPass");a=g.K.clone(this.i.renderer.view.sc.mapping);a.uniforms.tColor={type:"c",value:new THREE.Color(0)};this.f=new THREE.RawShaderMaterial({fragmentShader:g.ShaderLib.sb(g.ShaderChunk.wts_frag_color),vertexShader:g.ShaderLib.sb(a.vertexShader),uniforms:a.uniforms,side:THREE.FrontSide,name:"PickingMaterial"});this.ta=new THREE.WebGLRenderTarget(this.i.renderer.canvasResolution.width/3,this.i.renderer.canvasResolution.height/
3,{format:THREE.RGBAFormat});this.ta.name="Picking RenderTarget"}Bb.prototype=Object.create(n.prototype);e=Bb.prototype;e.constructor=Bb;function Cb(a){return new THREE.Color(a.id)}
function Db(a,b){b.data.center=b.data.center||{x:b.data.x,y:b.data.y};var d=new Uint8Array(4);a.i.renderer.webGLRenderer.readRenderTargetPixels(a.ta,b.data.center.x/b.data.target.width*a.ta.width,(1-b.data.center.y/b.data.target.height)*a.ta.height,1,1,d);b=new THREE.Color(d[0],d[1],d[2]);var h;a:{a=a.i.renderer.objects.all;for(h in a)if(a[h].mesh.id===((b.r&255)<<16|((b.g&255)<<8)+(b.b&255))){h=a[h];break a}h=null}return h}e.rd=function(a){(a=Db(this,a))&&a.click()};
e.ce=function(a){a=Db(this,a);a?a!==this.c&&(this.c&&this.c.Nd(),a.cf(),this.c=a):this.c&&(this.c.Nd(),this.c=null)};e.start=function(){this.i.canvas.pointer.enabled=!0;!1===this.i.canvas.pointer.onClick.has(this.rd,this)&&this.i.canvas.pointer.onClick.add(this.rd,this);!1===this.i.canvas.pointer.onMove.has(this.ce,this)&&this.i.canvas.pointer.onMove.add(this.ce,this)};
e.stop=function(){this.i.canvas.pointer.onClick.has(this.rd,this)&&this.i.canvas.pointer.onClick.remove(this.rd,this);this.i.canvas.pointer.onMove.has(this.ce,this)&&this.i.canvas.pointer.onMove.remove(this.ce,this)};e.click=function(){this.c&&this.i.canvas.pointer.onClick.has(this.rd,this)&&this.c.click()};e.setSize=function(a){this.ta&&this.ta.setSize(a.width,a.height)};e.Hh=function(){this.c=null};
e.destroy=function(){this.f&&(this.f.dispose(),this.f=null);this.ta&&(this.ta.dispose(),this.ta=null);this.i=null;n.prototype.destroy.call(this)};Object.defineProperty(Bb.prototype,"material",{get:function(){return this.f}});Object.defineProperty(Bb.prototype,"renderTarget",{get:function(){return this.ta}});function Ea(a){this.i=a;this.f=this.c=null;this.j=La.kb;n.call(this,"PickingManager")}Ea.prototype=Object.create(n.prototype);Ea.prototype.constructor=Ea;var La={kb:"pointer",Mc:"gaze"};e=Ea.prototype;
e.Qk=function(a){a===g.Ia.Ob?this.f||(this.c&&(this.c.stop(),this.c.destroy(),this.c=null),this.f=new xb(this.i),this.f.start(this.j)):this.c||(this.f&&(this.f.stop(),this.f.destroy(),this.f=null),this.c=new Bb(this.i),this.c.start())};e.Ih=function(){this.f&&this.f.Xh();this.c&&this.c.Hh()};e.setSize=function(a){this.c&&this.c.setSize(a)};e.click=function(){this.f&&this.f.click();this.c&&this.c.click()};e.start=function(){this.f&&this.f.start(this.j);this.c&&this.c.start()};
e.stop=function(){this.f&&this.f.stop();this.c&&this.c.stop()};e.destroy=function(){this.f&&(this.f.stop(),this.f.destroy(),this.f=null);this.c&&(this.c.stop(),this.c.destroy(),this.c=null);n.prototype.destroy.call(this)};Object.defineProperty(Ea.prototype,"renderTarget",{get:function(){return this.c?this.c.renderTarget:null}});Object.defineProperty(Ea.prototype,"material",{get:function(){return this.c?this.c.material:null}});
Object.defineProperty(Ea.prototype,"mode",{get:function(){return this.j},set:function(a){a!==La.kb&&a!==La.Mc||a===this.j||(this.stop(),this.j=a,this.start())}});function ma(a){this.i=a;this.c=[];n.call(this,"HotspotManager")}ma.prototype=Object.create(n.prototype);e=ma.prototype;e.constructor=ma;e.cl=function(){var a=this.i.story.scene;a.onUnloadStart.ga(this.vn,this);"undefined"!==typeof a.config.hotspots&&this.ma(a.config.hotspots)};e.vn=function(){this.Xe()};
e.boot=function(){this.i.story.onSceneLoadStart.add(this.cl,this)};e.Qn=function(a){return this.c.filter(function(b){return b.type===a})};e.ma=function(a){for(var b=0,d=a.length;b<d;b++){var h=a[b],k=null;switch(h.type||g.Nc.Jf){case g.Nc.Jf:k=new Eb(this.i,h)}k&&this.c.push(k)}};e.sj=function(a){if(null!==a.tracks){a=a.tracks;for(var b=0,d=a.length;b<d;b++)new Fb(a[b])}};e.update=function(){for(var a=0,b=this.c.length;a<b;a++)this.c[a].update()};e.Xe=function(){for(var a=this.c.length;a--;)this.c.pop().destroy()};
e.destroy=function(){this.Xe();this.c=this.i=null;n.prototype.destroy.call(this)};Object.defineProperty(ma.prototype,"all",{get:function(){return this.c}});Object.defineProperty(ma.prototype,"count",{get:function(){return this.c}});function Eb(a,b){this.H=b;this.P="";this.u=this.C=this.fa=this.j=this.f=null;this.Z=!1;this.J=this.L=null;tb.call(this,a,"Hotspot3D")}Eb.prototype=Object.create(tb.prototype);e=Eb.prototype;e.constructor=Eb;
e.bf=function(){tb.prototype.bf.call(this);this.f=new Gb;this.u=new Hb(this.i,this.f);this.j=new Ib(this.i);if("undefined"!==typeof this.H&&this.H){var a=this.H;this.R=a.uid;this.jb=a.tags;aa(this);this.m=a.type;this.P=a.name;this.M=a.visible;this.Z=a.facingCenter||!1;"undefined"!==typeof a.transform&&this.f.load(a.transform);"undefined"!==typeof a.animation&&(this.u.load(a.animation),this.u.onProgress.add(this.lj,this));this.j.onReady.add(this.Qi,this);var b;"undefined"!==typeof a.material?b=a.material:
b=Jb.Ei;!0===this.md&&(b=g.K.pb(b,Jb.Ld));this.j.load(b);"undefined"!==typeof a.sound&&(this.C=new Kb(this.i),this.C.load(a.sound,a.transform));"string"===typeof a.fx&&(this.$=a.fx);if("object"===typeof a.events){var a=a.events,d;for(d in a)b=new Lb(this.i),b.c(a[d]),this.o[d]=b}}this.L=this.bl.bind(this);this.J=this.Lm.bind(this)};
e.bl=function(a,b,d,h,k){a=this.i.renderer.webGLRenderer.getContext();this.i.renderer.view.Gc(k.uniforms);"HotspotMaterial"===k.name?this.j.type===Mb.Pd?k.uniforms.tColor.value=new THREE.Color(this.j.color):k.uniforms.tTexture.value=this.j.c:"PickingMaterial"===k.name&&k.program&&(b=this.fa,a.useProgram(k.program.program),k.program.getUniforms().map.tColor.setValue(a,b),k.uniforms.tColor.value=b)};e.Lm=function(){};
e.Qi=function(){this.f.m(this.j);this.c.material=this.j.material;this.c.geometry=new THREE.PlaneBufferGeometry(this.f.size.width,this.f.size.height,8,8);this.c.material=this.j.material;this.c.c=this.H;this.c.f=this.i.renderer.view instanceof Oa;this.lj();this.U=!0;this.G&&this.G.F();this.fa=Cb(this.c);this.c.onBeforeRender=this.L;this.c.onAfterRender=this.J;!0===this.u.autoPlay&&this.u.play()};
e.lj=function(){var a=g.Math.eb(Math.PI-g.Math.ha(this.f.position.theta),-Math.PI,Math.PI),b=g.Math.ha(this.f.position.phi),d=this.f.position.radius,d=d+50*this.i.renderer.camera.parallax,d=g.K.Qg(d,a,b);this.c.position.copy((new THREE.Vector3).setFromSpherical(d));!0===this.Z?(this.c.rotation.set(b,a+Math.PI,0,"YXZ"),this.c.rotation.x+=-g.Math.ha(this.f.rotation.x),this.c.rotation.y+=g.Math.ha(this.f.rotation.y),this.c.rotation.z+=g.Math.ha(this.f.rotation.z)):this.c.rotation.set(-g.Math.ha(this.f.rotation.x),
g.Math.ha(this.f.rotation.y),g.Math.ha(this.f.rotation.z),"YXZ")};e.update=function(){this.j&&this.j.update();this.C&&this.C.update()};e.destroy=function(){this.j.onReady.remove(this.Qi,this);this.J=this.L=null;this.f&&(this.f.destroy(),this.f=null);this.u&&(this.u.destroy(),this.u=null);this.j&&(this.j.destroy(),this.j=null);this.C&&(this.C.destroy(),this.C=null);tb.prototype.destroy.call(this)};Object.defineProperty(Eb.prototype,"type",{get:function(){return this.m}});
Object.defineProperty(Eb.prototype,"name",{get:function(){return this.P}});Object.defineProperty(Eb.prototype,"animation",{get:function(){return this.u}});function Kb(a){this.i=a;this.c=this.u=this.f=null;this.D=0;this.B=1;this.G=!1;this.I=0;this.C=!1;this.m={radius:200,theta:0,phi:0};this.o=360;n.call(this,"HotspotSound")}Kb.prototype=Object.create(n.prototype);e=Kb.prototype;e.constructor=Kb;e.dl=function(){this.log("Sound load complete");this.f&&this.f.F()};
e.load=function(a,b){if("undefined"!==typeof a.source&&"object"===typeof a.source)if(this.R=a.uid,"undefined"!==typeof a.source.url&&"string"===typeof a.source.url&&""!==a.source.url){this.j=a.source.url;if("undefined"!==typeof a.options&&"object"===typeof a.options){if("number"===typeof a.options.volume)this.B=a.options.volume;else if("object"===typeof a.options.volume){var d=a.options.volume;this.D="number"===typeof d.min?g.Math.ca(d.min,0,1):0;this.B="number"===typeof d.max?g.Math.ca(d.max,0,1):
1}this.G="boolean"===typeof a.options.loop?a.options.loop:!1;this.I="number"===typeof a.options.startTime?a.options.startTime:0;this.C="boolean"===typeof a.options.autoPlay?a.options.autoPlay:!1;this.o="number"===typeof a.options.range?g.Math.ca(a.options.range,1,360):360}"undefined"!==typeof b&&"undefined"!==typeof b.position&&(this.m.theta="number"===typeof b.position.theta?g.Math.ca(b.position.theta,-180,180):0,this.m.phi="number"===typeof b.position.phi?g.Math.ca(b.position.phi,-90,90):0);this.c=
new L(this.i,this.R,this.j||"");this.c.onCanPlayThrough.ga(this.dl,this);!0===360>this.o&&(a=g.K.Qg(1,g.Math.ha(-this.m.theta),g.Math.ha(this.m.phi)),this.u=(new THREE.Vector3).setFromSpherical(a),this.c.spatialized=360>this.o,this.c.x=this.u.x,this.c.y=this.u.y,this.c.z=this.u.z);this.c.volume=this.B;this.c.loop=this.G;this.c.startTime=this.I;!0===this.C&&this.c.play(this.I,this.G,!0)}else"undefined"!==typeof a.source.target&&!0===g.S.hb(a.source.target)&&g.S.get(a.source.target)};
e.update=function(){if(!1===this.i.audio.enabled)this.c&&this.c.stop();else if(!0===360>this.o&&!0===360>this.o&&"number"===typeof this.o){var a=this.i.renderer.camera,a=g.Quaternion.Dc(g.Math.ha(a.yaw),g.Math.ha(a.pitch),0),b=g.Quaternion.Dc(g.Math.ha(this.m.theta),g.Math.ha(this.m.phi),0),a=g.Quaternion.vj(b,a),b=g.Math.ha(this.o/2);this.c.volume=a<b?this.D+(this.B-this.D)*(1-a/b):this.D}};e.destroy=function(){this.c&&(this.c.destroy(),this.c=null);this.m=this.u=null;this.f&&this.f.destroy();n.prototype.destroy.call(this)};
Object.defineProperty(Kb.prototype,"sound",{get:function(){return this.c}});Object.defineProperty(Kb.prototype,"onReady",{get:function(){this.f||(this.f=new q(this));return this.f}});function Ib(a){this.i=a;this.o=null;this.m="";this.f=this.c=null;this.D=1;this.u=!1;this.B=16777215;this.N=null;this.G=!1;this.j=null;n.call(this,"HotspotMaterial")}Ib.prototype=Object.create(n.prototype);Ib.prototype.constructor=Ib;
var Mb={IMAGE:"image",ui:"plugin",Pd:"graphics"},Jb={Ei:{color:"#ffffff",opacity:0,transparent:!1},Ld:{color:"#00ff00",opacity:.8,transparent:!1}};e=Ib.prototype;
e.ym=function(a){a=a.emitter;this.log("Texture load complete (Image) : "+a.element.src);this.N=a;this.c=new THREE.Texture(a.element);this.c.image.crossOrigin="anonymous";this.c.wrapS=THREE.ClampToEdgeWrapping;this.c.wrapT=THREE.ClampToEdgeWrapping;this.c.minFilter=THREE.LinearFilter;this.c.magFilter=THREE.LinearFilter;this.c.needsUpdate=!0;this.log("Map new texture from image");Nb(this)};
e.Yi=function(a){a=a.data;a.uid===this.o.plugin&&(this.i.plugins.onInstanceCreate.remove(this.Yi,this),Pb(this,a))};function Pb(a,b){!0===b.instanceReady?Qb(a,b):b.onInstanceReady.ga(a.rn,a)}e.rn=function(a){a=a.emitter;if(null===a.instance||!1===a.instanceReady)throw Error("Plugin instance not available");Qb(this,a)};
function Qb(a,b){a.N=b.instance.texture;a.c=new THREE.Texture(a.N.dom);a.c.format=THREE.RGBAFormat;a.c.wrapS=THREE.ClampToEdgeWrapping;a.c.wrapT=THREE.ClampToEdgeWrapping;a.c.magFilter=THREE.LinearFilter;a.c.minFilter=THREE.LinearFilter;a.c.generateMipmaps=!1;a.c.needsUpdate=!0;a.log("Map new texture from plugin");Nb(a)}
e.Ye=function(){this.f&&(this.f.dispose(),this.f=null);var a=g.K.clone(this.i.renderer.view.sc.mapping);this.m===Mb.Pd&&(a.fragmentShader=g.ShaderChunk.wts_frag_color,a.uniforms.tColor={type:"c",value:new THREE.Color(2105376)});var b=g.ShaderLib.sb(a.vertexShader),d=g.ShaderLib.sb(a.fragmentShader);this.f=new THREE.RawShaderMaterial({fragmentShader:d,vertexShader:b,uniforms:a.uniforms,side:THREE.DoubleSide,name:"HotspotMaterial"});this.c&&(this.f.transparent=this.u,this.f.needsUpdate=!0);this.f.needsUpdate=
!0;this.j&&this.j.F()};function Nb(a){!0===a.i.renderer.viewReady&&a.Ye();a.i.renderer.onViewReady.add(a.Ye,a)}
e.load=function(a){a=this.o=a;this.D="number"===typeof a.opacity?g.Math.ca(a.opacity,0,1):1;this.u="boolean"===typeof a.transparent?a.transparent:!1;this.B="string"===typeof a.color?a.color:16777215;this.G="boolean"===typeof a.update?a.update:!1;"undefined"!==typeof a.image&&null!==a.image?(a=a.image,this.m=Mb.IMAGE,this.N=new Rb(this.i,a),this.N.onLoadComplete.ga(this.ym,this)):"undefined"!==typeof a.plugin&&null!==a.plugin?(a=a.plugin,this.m=Mb.ui,a=this.i.plugins.get(a),"undefined"===typeof a||
null===a?this.i.plugins.onInstanceCreate.add(this.Yi,this):Pb(this,a)):(this.m=Mb.Pd,Nb(this))};e.update=function(){this.f&&this.f.uniforms&&(this.f.uniforms.tTexture.value=this.c);this.c&&!0===this.G&&(this.c.needsUpdate=!0)};e.destroy=function(){this.i.renderer.onViewReady.remove(this.Ye,this);this.c&&(this.c.dispose(),this.c=null);this.f&&(this.f.dispose(),this.f=null);this.m===Mb.IMAGE&&this.N&&this.N.destroy();this.N=null;this.j&&(this.j.destroy(),this.j=null);this.i=null;n.prototype.destroy.call(this)};
Object.defineProperty(Ib.prototype,"type",{get:function(){return this.m}});Object.defineProperty(Ib.prototype,"texture",{get:function(){return this.c}});Object.defineProperty(Ib.prototype,"material",{get:function(){return this.f}});Object.defineProperty(Ib.prototype,"opacity",{get:function(){return this.D}});Object.defineProperty(Ib.prototype,"transparent",{get:function(){return this.u}});Object.defineProperty(Ib.prototype,"color",{get:function(){return this.B}});
Object.defineProperty(Ib.prototype,"displayObject",{get:function(){return this.N}});Object.defineProperty(Ib.prototype,"onReady",{get:function(){this.j||(this.j=new q(this));return this.j}});function Gb(a,b){this.f=a||{radius:200,theta:0,phi:0};this.j=b||{x:0,y:0,z:0};this.c={theta:10,phi:10,width:0,height:0};n.call(this,"HotspotTransform")}Gb.prototype=Object.create(n.prototype);Gb.prototype.constructor=Gb;
Gb.prototype.m=function(a){a=a.texture;var b=1,d=1;null!==a&&"undefined"!==typeof a.image&&(b=a.image.width,d=a.image.height);a=b/d;"number"===typeof this.c.phi&&(d=g.Math.ha(this.c.phi),d=2*this.f.radius*Math.tan(d/2),"auto"===this.c.theta&&(b=d*a));"number"===typeof this.c.theta&&(b=g.Math.ha(this.c.theta),b=2*this.f.radius*Math.tan(b/2),"auto"===this.c.phi&&(d=b/a));this.c.width=b;this.c.height=d};
Gb.prototype.load=function(a){"undefined"!==typeof a.position&&(this.f.radius="number"===typeof a.position.radius?a.position.radius:0,this.f.theta="number"===typeof a.position.theta?a.position.theta:0,this.f.phi="number"===typeof a.position.phi?a.position.phi:0);if("undefined"!==typeof a.rotation&&"auto"!==a.rotation)this.j.x="number"===typeof a.rotation.x?a.rotation.x:0,this.j.y="number"===typeof a.rotation.y?a.rotation.y:0,this.j.z="number"===typeof a.rotation.z?a.rotation.z:0;else if("undefined"===
typeof a.rotation||"auto"===a.rotation){var b=this.f,d={x:0,y:0,z:0};"undefined"!==typeof b&&(d.y="number"===typeof b.theta?-b.theta:0,d.x="number"===typeof b.phi?-b.phi:0);this.j=d}"undefined"!==typeof a.size&&(this.c.theta="number"===typeof a.size.theta?a.size.theta:"auto",this.c.phi="number"===typeof a.size.phi?a.size.phi:"auto")};Gb.prototype.destroy=function(){n.prototype.destroy.call(this)};Object.defineProperty(Gb.prototype,"position",{get:function(){return this.f}});
Object.defineProperty(Gb.prototype,"rotation",{get:function(){return this.j}});Object.defineProperty(Gb.prototype,"size",{get:function(){return this.c}});function Hb(a,b){this.f=this.B=null;this.G=this.u=this.I=!1;this.m=null;pb.call(this,a,b,"HotspotAnimation");this.j=[{prop:["rotation.x","rotation.y","rotation.z"],eb:[[-180,180],[-180,180],[-180,180]],smooth:!1},{prop:["position.radius","position.theta","position.phi"],eb:[null,[-180,180],[-180,180]],smooth:!1}]}Hb.prototype=Object.create(pb.prototype);
e=Hb.prototype;e.constructor=Hb;e.load=function(a){!0===a.enabled&&(this.I="boolean"===typeof a.loop?a.loop:!1,this.u="boolean"===typeof a.random?a.random:!1,this.G="boolean"===typeof a.autoPlay?a.autoPlay:!1,null!==a.tracks&&g.K.Pa(a.tracks,"string")&&(this.f=!0===this.u?g.K.Dd(a.tracks):a.tracks))};e.Ac=function(){if(1<this.f.length){var a=this.f.indexOf(this.B)+1;if(a<this.f.length){this.play(a);return}}!0===this.I?(!0===this.u&&(this.f=g.K.Dd(this.f)),this.play(0)):pb.prototype.Ac.call(this)};
e.Dh=function(){this.m&&this.m.F()};
e.play=function(a){this.B="number"===typeof a?this.f[a]:"string"===typeof a?a:this.f[0];a=g.S.get(this.B);rb(this);var b,d=a.offset,h=new kb(this.i,this.ta);h.tween.easing=g.X[a.easing];h.instruction=this.j[0];h.instruction.smooth=a.smooth;h.onComplete.add(this.Ac,this);h.onProgress.add(this.Dh,this);for(var k,l,p,r=0,u=a.keyframes.length;r<u;r++)b=a.keyframes[r].time+d,k=a.keyframes[r].data.rotation,"undefined"!==typeof k&&null!==k&&(l="undefined"!==typeof k.x&&null!==k.x?k.x:qb(this,b,a.keyframes,
"x",a.easing,"rotation"),p="undefined"!==typeof k.y&&null!==k.y?k.y:qb(this,b,a.keyframes,"y",a.easing,"rotation"),k="undefined"!==typeof k.z&&null!==k.z?k.z:qb(this,b,a.keyframes,"z",a.easing,"rotation"),b=new jb(b+d,{rotation:{x:l,y:p,z:k}}),h.timeline.Pb(b));if(0<h.timeline.keyframes.length&&0<h.timeline.keyframes[0].time||0<d)r={rotation:g.K.clone(this.ta.rotation)},b=new jb(0,r),h.timeline.Pb(b);this.c.push(h);h=new kb(this.i,this.ta);h.tween.easing=g.X[a.easing];h.instruction=this.j[1];h.instruction.smooth=
a.smooth;h.onComplete.add(this.Ac,this);h.onProgress.add(this.Dh,this);r=0;for(u=a.keyframes.length;r<u;r++)b=a.keyframes[r].time+d,k=a.keyframes[r].data.position,"undefined"!==typeof k&&null!==k&&(l="undefined"!==typeof k.radius&&null!==k.radius?k.radius:qb(this,b,a.keyframes,"radius",a.easing,"position"),p="undefined"!==typeof k.theta&&null!==k.theta?g.Math.eb(k.theta,-180,180):qb(this,b,a.keyframes,"theta",a.easing,"position"),k="undefined"!==typeof k.phi&&null!==k.phi?g.Math.eb(k.phi,-180,180):
qb(this,b,a.keyframes,"phi",a.easing,"position"),b=new jb(b+d,{position:{radius:l,theta:p,phi:k}}),h.timeline.Pb(b));if(0<h.timeline.keyframes.length&&0<h.timeline.keyframes[0].time||0<d)r={position:g.K.clone(this.ta.position)},b=new jb(0,r),h.timeline.Pb(b);this.c.push(h);this.c[0].play();this.c[1].play()};Object.defineProperty(Hb.prototype,"autoPlay",{get:function(){return this.G}});Object.defineProperty(Hb.prototype,"onProgress",{get:function(){this.m||(this.m=new q(this));return this.m}});
function Fb(a){sb.call(this,"HotspotAnimationTrack");this.c(a)}Fb.prototype=Object.create(sb.prototype);Fb.prototype.constructor=Fb;Fb.prototype.c=function(a){sb.prototype.c.call(this,a)};g.Nc={};g.Nc.Jf="3d";
function K(a){this.i=a;this.U=null;this.T=this.fa=this.M=this.$=this.O=this.H=this.V=this.aa=this.J=0;this.I=Math.PI/2;this.C=this.L=this.P=0;this.f=this.j=this.c=this.o=this.G=this.B=null;this.Z=0;this.m=this.u=this.D=null;n.call(this,"Camera");this.B=new THREE.Matrix4;this.G=new THREE.Matrix4;this.o=new THREE.Quaternion;this.u=new Sb(this.i,Tb.gaze);Ub(this);this.j=this.c.clone();this.j.name="CameraLeft";this.j.layers.enable(1);this.j.add(this.u.object);this.f=this.c.clone();this.f.name="CameraRight";
this.f.layers.enable(2)}K.prototype=Object.create(n.prototype);K.prototype.constructor=K;var Tb={parallax:0,yaw:{default:0},pitch:{default:0,min:-90,max:90},roll:{default:0},fov:{default:90},gaze:{delay:2E3,cursor:{innerRadius:.02,outerRadius:.04,color:16777215,opacity:.5},progress:{innerRadius:.02,outerRadius:.04,color:16711680,opacity:.5}}};
function Ub(a){"undefined"!==typeof a.i.renderer&&(a.c=new THREE.PerspectiveCamera(a.I,a.i.renderer.displayResolution.ratio,.01,1E4),a.c.name="CameraMain",a.c.matrixAutoUpdate=!1)}
function Vb(a,b){var d=Math.tan(g.Math.ha(a.upDegrees)),h=Math.tan(g.Math.ha(a.downDegrees)),k=Math.tan(g.Math.ha(a.leftDegrees)),l=Math.tan(g.Math.ha(a.rightDegrees));a=2/(k+l);var k=(k-l)*a*.5,l=2/(d+h),d=(d-h)*l*.5,h=new THREE.Matrix4,p=h.elements;p[0]=a;p[1]=0;p[2]=-k;p[3]=0;p[4]=0;p[5]=l;p[6]=d;p[7]=0;p[8]=0;p[9]=0;p[10]=b.far/(b.near-b.far);p[11]=b.far*b.near/(b.near-b.far);p[12]=0;p[13]=0;p[14]=-1;p[15]=0;h.transpose();return h}
function Wb(a){a.B=g.Math.le(a.J,a.H,a.M,!1);a.G=a.B.clone().transpose();a.o=g.Quaternion.Dc(a.J,a.H,a.M)}function Xb(a){a.B=g.Quaternion.Lk(a.o);a.G=a.B.clone().transpose();var b=g.Quaternion.Ke(a.o),d=b.pitch,h=b.roll,k=g.Math.Db;Yb(a,b.yaw,k);Zb(a,d,k);$b(a,h,k);ac(a,null,k)}function bc(a){a.m&&a.m.F(null,!0)}
function Yb(a,b,d){if("number"!==typeof b||!0===isNaN(b))return!1;d=d===g.Math.Wa||d===g.Math.Db?d:g.Math.Db;b=d===g.Math.Wa?g.Math.ha(b):b;b=g.Math.eb(b,-Math.PI,Math.PI);b=g.Math.ca(b,a.aa,a.V);d=a.J!==b;a.J=b;return d}function Zb(a,b,d){if("number"!==typeof b||!0===isNaN(b))return!1;d=d===g.Math.Wa||d===g.Math.Db?d:g.Math.Db;b=d===g.Math.Wa?g.Math.ha(b):b;b=g.Math.eb(b,-Math.PI,Math.PI);b=g.Math.ca(b,a.O,a.$);d=a.H!==b;a.H=b;return d}
function $b(a,b,d){if("number"!==typeof b||!0===isNaN(b))return!1;d=d===g.Math.Wa||d===g.Math.Db?d:g.Math.Db;b=d===g.Math.Wa?g.Math.ha(b):b;b=g.Math.eb(b,-Math.PI,Math.PI);b=g.Math.ca(b,a.fa,a.T);d=a.M!==b;a.M=b;return d}function ac(a,b,d){if("number"!==typeof b||!0===isNaN(b))return!1;d=d===g.Math.Wa||d===g.Math.Db?d:g.Math.Db;b=d===g.Math.Wa?g.Math.ha(b):b;b=g.Math.ca(b,a.P,a.L);d=a.I!==b;a.I=b;return d}
K.prototype.load=function(a){a=this.U=g.K.pb(Tb,a);this.C=a.parallax;this.Z=50*this.C;this.aa=g.Math.ha(a.yaw.min);this.V=g.Math.ha(a.yaw.max);Yb(this,a.yaw["default"],g.Math.Wa);this.O=g.Math.ha(a.pitch.min);this.$=g.Math.ha(a.pitch.max);Zb(this,a.pitch["default"],g.Math.Wa);this.fa=g.Math.ha(a.roll.min);this.T=g.Math.ha(a.roll.max);$b(this,a.roll["default"],g.Math.Wa);"undefined"!==typeof a.fov.min&&(this.P=g.Math.ha(a.fov.min));"undefined"!==typeof a.fov.max&&(this.L=g.Math.ha(a.fov.max));ac(this,
a.fov["default"],g.Math.Wa);Wb(this);bc(this);this.u.load(a.gaze)};K.prototype.uk=function(a,b,d,h,k){if("number"!==typeof k||!k)k=g.Math.Wa,Yb(this,a,k),Zb(this,b,k),$b(this,d,k),ac(this,h,k),Wb(this),bc(this);else if(null!==a||null!==b||null!==d||null!==h)a=new cc({keyframes:[{time:k,data:{yaw:a,pitch:b,roll:d,fov:h}}]}),this.animation.play(a.uid)};
K.prototype.update=function(){if(this.c){var a=(new THREE.Matrix4).copy(this.G);this.C&&a.multiply((new THREE.Matrix4).makeTranslation(0,0,-this.Z));this.c.quaternion.setFromRotationMatrix(a);this.c.matrixWorld=a;this.c.matrixWorldInverse.getInverse(a);this.c.fov=g.Math.pc(this.I);this.c.aspect=this.i.renderer.displayResolution.ratio;this.c.updateProjectionMatrix()}if(!0===this.i.renderer.display.presentingVR){this.u.update();var a=this.i.renderer.display,b=a.Vj();null!==b&&(this.o=b,Xb(this));var b=
a.vrDisplay.getEyeParameters("left"),d=a.vrDisplay.getEyeParameters("right");this.c.matrixWorld.decompose(this.j.position,this.j.quaternion,this.j.scale);this.j.matrixWorld=(new THREE.Matrix4).makeRotationFromQuaternion(this.c.quaternion);this.c.matrixWorld.decompose(this.f.position,this.f.quaternion,this.f.scale);this.f.matrixWorld=(new THREE.Matrix4).makeRotationFromQuaternion(this.c.quaternion);this.j.matrixWorld.elements[12]=this.c.matrixWorld.elements[12]+b.offset[0];this.j.matrixWorld.elements[13]=
this.c.matrixWorld.elements[13]+b.offset[1];this.j.matrixWorld.elements[14]=this.c.matrixWorld.elements[14]+b.offset[2];this.f.matrixWorld.elements[12]=this.c.matrixWorld.elements[12]+d.offset[0];this.f.matrixWorld.elements[13]=this.c.matrixWorld.elements[13]+d.offset[1];this.f.matrixWorld.elements[14]=this.c.matrixWorld.elements[14]+d.offset[2];a=a.vrFrameData;null!==a?(this.j.projectionMatrix.elements=a.leftProjectionMatrix,this.f.projectionMatrix.elements=a.rightProjectionMatrix):(this.j.projectionMatrix=
Vb({upDegrees:b.fieldOfView.upDegrees,downDegrees:b.fieldOfView.downDegrees,leftDegrees:b.fieldOfView.leftDegrees,rightDegrees:b.fieldOfView.rightDegrees},this.c),this.f.projectionMatrix=Vb({upDegrees:d.fieldOfView.upDegrees,downDegrees:d.fieldOfView.downDegrees,leftDegrees:d.fieldOfView.leftDegrees,rightDegrees:d.fieldOfView.rightDegrees},this.c));bc(this);a=0;for(b=this.f.children.length;a<b;a++)this.f.remove(this.f.children[a]);b=0;for(d=this.j.children.length;b<d;b++)a=this.j.children[b].clone(),
this.f.add(a)}};K.prototype.destroy=function(){this.c=this.o=this.G=this.B=null;this.u.destroy();this.u=null;this.m&&(this.m.destroy(),this.m=null);this.D&&(this.D.destroy(),this.D=null);this.i=null;n.prototype.destroy.call(this)};Object.defineProperty(K.prototype,"config",{get:function(){return this.U},set:function(a){this.load(a)}});Object.defineProperty(K.prototype,"yaw",{get:function(){return g.Math.pc(this.J)},set:function(a){!0===Yb(this,a,g.Math.Wa)&&(Wb(this),bc(this))}});
Object.defineProperty(K.prototype,"pitch",{get:function(){return g.Math.pc(this.H)},set:function(a){Zb(this,a,g.Math.Wa)&&(Wb(this),bc(this))}});Object.defineProperty(K.prototype,"roll",{get:function(){return g.Math.pc(this.M)},set:function(a){!0===$b(this,a,g.Math.Wa)&&(Wb(this),bc(this))}});Object.defineProperty(K.prototype,"fov",{get:function(){return g.Math.pc(this.I)},set:function(a){!0===ac(this,a,g.Math.Wa)&&bc(this)}});
Object.defineProperty(K.prototype,"fovMin",{get:function(){return g.Math.pc(this.P)},set:function(a){this.P=g.Math.ha(a)}});Object.defineProperty(K.prototype,"fovMax",{get:function(){return g.Math.pc(this.L)},set:function(a){this.L=g.Math.ha(a)}});Object.defineProperty(K.prototype,"quaternion",{get:function(){return this.o},set:function(a){this.o=a;Xb(this);bc(this)}});Object.defineProperty(K.prototype,"animation",{get:function(){this.D||(this.D=new dc(this.i,this));return this.D}});
Object.defineProperty(K.prototype,"parallax",{get:function(){return this.C},set:function(a){this.C=g.Math.ca(a,0,1);bc(this)}});Object.defineProperty(K.prototype,"modelView",{get:function(){return this.B}});Object.defineProperty(K.prototype,"modelViewInverse",{get:function(){return this.G}});Object.defineProperty(K.prototype,"main",{get:function(){this.c||Ub(this);return this.c}});Object.defineProperty(K.prototype,"perspectiveCameraRadius",{get:function(){return this.Z}});
Object.defineProperty(K.prototype,"left",{get:function(){return this.j}});Object.defineProperty(K.prototype,"right",{get:function(){return this.f}});Object.defineProperty(K.prototype,"gaze",{get:function(){return this.u}});Object.defineProperty(K.prototype,"onCameraChange",{get:function(){this.m||(this.m=new q(this));return this.m}});function dc(a,b){pb.call(this,a,b,"CameraAnimation");ec(this)}dc.prototype=Object.create(pb.prototype);dc.prototype.constructor=dc;
function ec(a){a.j=[{prop:"quaternion",smooth:!0,Qj:function(){!0===this.Ra.cancelRoll&&(this.ta.quaternion=g.Quaternion.cancelRoll(this.ta.quaternion))},cancelRoll:!0},{prop:"fov",smooth:!1}]}
dc.prototype.play=function(a){"string"===typeof a&&(a=g.S.get(a));rb(this);var b=new kb(this.i,this.ta);b.tween.easing=g.X[a.easing];b.instruction=this.j[0];b.instruction.smooth=a.smooth;b.smooth=a.smooth;b.instruction.cancelRoll=a.cancelRoll;b.onComplete.add(this.Ac,this);this.c.push(b);var d=new kb(this.i,this.ta);d.tween.easing=g.X[a.easing];d.instruction=this.j[1];d.instruction.smooth=a.smooth;d.onComplete.add(this.Ac,this);this.c.push(d);var h=a.keyframes,k=a.offset;a=a.easing;for(var k=k||0,
l,p,r,u,A=0,ob=h.length;A<ob;A++)p=h[A].data,l="undefined"!==typeof p.yaw&&null!==p.yaw?p.yaw:qb(this,h[A].time+k,h,"yaw",a),r="undefined"!==typeof p.pitch&&null!==p.pitch?p.pitch:qb(this,h[A].time+k,h,"pitch",a),u="undefined"!==typeof p.roll&&null!==p.roll?p.roll:qb(this,h[A].time+k,h,"roll",a),l=g.Math.ha(l),r=g.Math.ha(r),u=g.Math.ha(u),"undefined"!==typeof l&&null!==l&&"undefined"!==typeof r&&null!==r&&"undefined"!==typeof u&&null!==u&&(l=g.Quaternion.Dc(l,r,u),l=new jb(h[A].time+k,{quaternion:l}),
this.c[0].timeline.Pb(l)),"undefined"!==typeof p.fov&&null!==p.fov&&(p=p.fov,l=new jb(h[A].time+k,{fov:p}),this.c[1].timeline.Pb(l));if(0<h[0].time||0<k)l=new jb(0,{quaternion:g.K.clone(this.ta.quaternion)}),this.c[0].timeline.Pb(l),l=new jb(0,{fov:this.ta.fov}),this.c[1].timeline.Pb(l);b.play();d.play()};dc.prototype.destroy=function(){pb.prototype.destroy.call(this)};
function Sb(a,b){this.i=a;this.f=b;this.c=null;this.B=!1;this.u=this.m=null;this.o=0;n.call(this,"CameraGaze");this.m=this.i.clock.create(!1);this.c=new THREE.Object3D;this.c.name="CameraGaze";this.c.position.z=-2;fc(this)}Sb.prototype=Object.create(n.prototype);e=Sb.prototype;e.constructor=Sb;function gc(a,b,d,h,k,l){l=l||2*Math.PI;return new THREE.RingBufferGeometry(a||.02,b||.04,d||32,h||1,k||0,l)}
function fc(a){var b=new THREE.MeshBasicMaterial({color:a.f.cursor.color,opacity:a.f.cursor.opacity,transparent:!0}),b=new THREE.Mesh(gc(a.f.cursor.innerRadius,a.f.cursor.outerRadius),b);b.name="cursor";a.c.add(b)}
function hc(a){var b=new THREE.MeshBasicMaterial({color:a.f.progress.color,opacity:a.f.progress.opacity,transparent:!0,side:THREE.DoubleSide}),b=new THREE.Mesh(gc(a.f.progress.innerRadius,a.f.progress.outerRadius,32,1,Math.PI/2,a.o/100*g.Math.Fi),b);b.name="progress";b.rotateY(Math.PI);a.c.add(b)}function jc(a,b){for(var d=null,h=0,k=a.c.children.length;h<k;h++)a.c.children[h].name===b&&(d=a.c.children[h]);null!==d&&(a.c.remove(d),d.geometry.dispose(),d.material.dispose())}
e.yn=function(){this.stop();this.i.renderer.pickingManager.click()};e.load=function(a){this.f=a;jc(this,"progress");jc(this,"cursor");fc(this);!0===this.B&&this.o&&hc(this)};e.start=function(){this.log("startGazeAnimation");this.B=!0;this.o=0;jc(this,"progress");hc(this);this.m&&(this.m.stop(),this.u=this.m.add(2E3,this.yn,this),this.m.start())};
e.stop=function(){this.log("stopGazeAnimation");this.B=!1;this.m.stop();this.u=null;this.o=0;var a=this.c.children[1];"undefined"!==typeof a&&null!==a&&(this.c.remove(a),a.geometry.dispose(),a.material.dispose())};e.update=function(){if(!0===this.B&&this.u){var a=100*(this.u.delay-this.m.duration)/this.u.delay;this.log("timer update : "+a+"%");this.o=a;jc(this,"progress");hc(this)}};
e.destroy=function(){this.stop();this.c&&("undefined"!==typeof this.c.geometry&&null!==this.c.geometry&&this.c.geometry.dispose(),"undefined"!==typeof this.c.material&&null!==this.c.material&&this.c.material.dispose(),this.c=null);this.j=null};Object.defineProperty(Sb.prototype,"visible",{get:function(){return this.c.visible},set:function(a){this.c.visible=a}});Object.defineProperty(Sb.prototype,"object",{get:function(){return this.c}});g.tb={};g.tb.kb="pointer";g.tb.rf="keyboard";
function la(a){this.i=a;this.c=[];this.m=!0;this.f=this.j=null;n.call(this,"ControllerManager")}la.prototype=Object.create(n.prototype);la.prototype.constructor=la;var kc={enabled:!0,instances:[{uid:"controller-pointer-0",type:g.tb.kb,enabled:!0},{uid:"controller-keyboard-0",type:g.tb.rf,enabled:!0}]};e=la.prototype;e.Be=function(a){this.j&&this.j.F({controller:a})};e.Ae=function(a){this.f&&this.f.F({controller:a})};
e.update=function(){if(this.c)for(var a=0,b=this.c.length;a<b;a++)"function"===typeof this.c[a].update&&this.c[a].update()};e.ma=function(a){a="undefined"!==typeof a?a:kc;this.m="boolean"===typeof a.enabled?a.enabled:!0;if("undefined"!==typeof a.instances)for(var b,d=0,h=a.instances.length;d<h;d++){b=a.instances[d];switch(b.type){case g.tb.kb:b=new lc(this.i,b);break;case g.tb.rf:b=new mc(this.i,b);break;default:b=null}b&&this.c.push(b)}};
e.destroy=function(){for(var a=this.c.length-1;a--;)this.c[a].destroy(),this.c[a]=null;this.c=null;this.j&&(this.j.destroy(),this.j=null);this.f&&(this.f.destroy(),this.f=null);n.prototype.destroy.call(this)};Object.defineProperty(la.prototype,"all",{get:function(){return this.c}});Object.defineProperty(la.prototype,"enabled",{get:function(){return this.m},set:function(a){this.m=!!a}});
Object.defineProperty(la.prototype,"active",{get:function(){for(var a=0,b=this.c.length;a<b;a++)if(!0===this.c[a].active)return!0;return!1}});Object.defineProperty(la.prototype,"onControlStart",{get:function(){this.j||(this.j=new q(this));return this.j}});Object.defineProperty(la.prototype,"onControlEnd",{get:function(){this.f||(this.f=new q(this));return this.f}});function nc(a,b){this.i=a;this.c=null;this.D=this.B=!1;this.f=this.j=null;n.call(this,b||"ControllerBase");this.gd()}nc.prototype=Object.create(n.prototype);
e=nc.prototype;e.constructor=nc;e.gd=function(){this.i.canvas.pointer.enabled=!0;this.c=this.i.renderer.camera};e.enable=function(){!0!==this.B&&(this.B=!0)};e.cc=function(){!1!==this.B&&(this.B=!0)};e.destroy=function(){this.i=this.c=null;this.j&&(this.j.destroy(),this.j=null);this.f&&(this.f.destroy(),this.f=null);n.prototype.destroy.call(this)};Object.defineProperty(nc.prototype,"enabled",{get:function(){return this.B},set:function(a){!0===!!a?this.enable():this.cc()}});
Object.defineProperty(nc.prototype,"active",{get:function(){return this.D}});Object.defineProperty(nc.prototype,"onControlStart",{get:function(){this.j||(this.j=new q(this));return this.j}});Object.defineProperty(nc.prototype,"onControlEnd",{get:function(){this.f||(this.f=new q(this));return this.f}});function lc(a,b){this.H=b;this.I=this.m=this.G=this.o=null;nc.call(this,a,"ControllerPointer")}lc.prototype=Object.create(nc.prototype);lc.prototype.constructor=lc;
var oc={orientation:{hardness:.6,damping:.15,velocityMax:300,invert:!1},zoom:{hardness:5,invert:!1}};e=lc.prototype;e.gd=function(){nc.prototype.gd.call(this);this.I=new THREE.Vector2;this.m=new THREE.Vector2;this.o=new THREE.Vector2;this.G=new THREE.Vector2;var a=this.H;this.R=a.uid;aa(this);var b=a.options||{};this.u=g.K.pb(oc.orientation,b.orientation);this.C=g.K.pb(oc.zoom,b.zoom);this.B="boolean"===typeof a.enabled?a.enabled:!0;!0===this.B&&this.enable()};
e.ph=function(a){!1!==this.i.controllers.enabled&&(this.i.canvas.pointer.onPanMove.add(this.Te,this),this.log("_panStartHandler ("+a.data.velocityX.toFixed(2)+", "+a.data.velocityY.toFixed(2)+")"),this.D=!0,this.o=new THREE.Vector2(a.data.center.x,a.data.center.y),this.G.copy(this.o),this.m.set(0,0),this.j&&this.j.F(),this.i.controllers.Be(this))};e.Te=function(a){!1!==this.i.controllers.enabled&&this.G.set(a.data.center.x,a.data.center.y)};
e.oh=function(){this.i.canvas.pointer.onPanMove.remove(this.Te,this);this.log("_panEndHandler");this.D=!1;this.m.set(0,0);this.o.set(0,0);this.G.copy(this.o);this.f&&this.f.F();this.i.controllers.Ae(this)};e.rh=function(a){!1!==this.i.controllers.enabled&&(this.i.canvas.pointer.onPinchMove.add(this.qh,this),this.log("_pinchStartHandler "+a))};e.qh=function(a){!1!==this.i.controllers.enabled&&this.log("_pinchMoveHandler "+a.data.pinch)};
e.Ue=function(a){this.i.canvas.pointer.onPinchMove.remove(this.qh,this);this.log("_pinchEndHandler "+a)};e.sh=function(a){if(!1!==this.i.controllers.enabled){a.data.preventDefault();var b=(this.C.invert?1:-1)/this.C.hardness;a.data.deltaY&&(b*=a.data.deltaY/5);this.c.fov=this.c.fov-b;this.log("_wheelHandler (fov:"+this.c.fov+")")}};
e.enable=function(){nc.prototype.enable.call(this);this.i.canvas.pointer.onPanStart.add(this.ph,this);this.i.canvas.pointer.onPanEnd.add(this.oh,this);this.i.canvas.pointer.onPinchStart.add(this.rh,this);this.i.canvas.pointer.onPinchEnd.add(this.Ue,this);this.i.canvas.pointer.onWheel.add(this.sh,this)};
e.cc=function(){nc.prototype.cc.call(this);this.i.canvas.pointer.onPanStart.remove(this.ph,this);this.i.canvas.pointer.onPanMove.remove(this.Te,this);this.i.canvas.pointer.onPanEnd.remove(this.oh,this);this.i.canvas.pointer.onPinchStart.remove(this.rh,this);this.i.canvas.pointer.onPinchMove.remove(this.Ue,this);this.i.canvas.pointer.onPinchEnd.remove(this.Ue,this);this.i.canvas.pointer.onWheel.remove(this.sh,this)};
e.update=function(){var a=this.i.renderer.displayResolution,a=1/(this.u.hardness*Math.min(a.width,a.height));this.m.subVectors(this.G,this.o);this.m.length()>this.u.velocityMax&&this.m.setLength(this.u.velocityMax);this.m.multiplyScalar(a);var a=this.u.invert?-1:1,b=a*(this.m.x+this.I.x);.05<Math.abs(b)&&(this.c.yaw+=b);a*=this.m.y+this.I.y;.05<Math.abs(a)&&(this.c.pitch-=a);this.I.add(this.m).multiplyScalar(g.Math.ca(1-this.u.damping,0,1))};e.destroy=function(){nc.prototype.destroy.call(this)};
function mc(a,b){this.M=b;this.m=this.I=this.u=this.o=this.C=null;nc.call(this,a,"ControllerKeyboard")}mc.prototype=Object.create(nc.prototype);mc.prototype.constructor=mc;var pc={orientation:{hardness:.6,damping:.15,velocityMax:300,invert:!1},zoom:{hardness:5,invert:!1}};e=mc.prototype;
e.gd=function(){nc.prototype.gd.call(this);this.m=[];this.I=new THREE.Vector2;this.u=new THREE.Vector2;this.C=new THREE.Vector2;this.o=new THREE.Vector2;var a=this.M;this.R=a.uid;aa(this);var b=a.options||{};this.G=g.K.pb(pc.orientation,b.orientation);this.H=g.K.pb(pc.zoom,b.zoom);this.B="boolean"===typeof a.enabled?a.enabled:!0;!1!==b["default"]&&(a=new M(this.i,[81,37],this.de,this.fe,this.ee,[68,39],this,"left"),this.m.push(a),a=new M(this.i,[68,39],this.de,this.fe,this.ee,[81,37],this,"right"),
this.m.push(a),a=new M(this.i,[90,38],this.de,this.fe,this.ee,[83,40],this,"up"),this.m.push(a),a=new M(this.i,[83,40],this.de,this.fe,this.ee,[90,38],this,"down"),this.m.push(a),a=new M(this.i,107,this.mj,this.oj,this.nj,109,this,"plus"),this.m.push(a),a=new M(this.i,109,this.mj,this.oj,this.nj,107,this,"minus"),this.m.push(a));if(!0===Array.isArray(b.bindings))for(var a=0,d=b.bindings.length;a<d;a++){var h=b.bindings[a],k=h.in,l=h.out,p=h.name,h=h.events;!1===g.K.W(k,"number")&&!1===g.K.Pa(k,"number")?
this.warn("Can't add custom keyboard binding, keys in are invalid!"):"object"!==typeof h&&null===h?this.warn("Can't add custom keyboard binding, events are invalid!"):(k=new M(this.i,k,h.onDown,h.onUp,h.onHold,l,this,p),this.m.push(k))}!0===this.B&&this.enable()};e.de=function(a){if(!1!==this.i.controllers.enabled){this.D=!0;switch(a.name){case "left":case "right":this.u.setX(0);break;case "up":case "down":this.u.setY(0)}this.j&&this.j.F();this.i.controllers.Be(this)}};
e.ee=function(a){if(!1!==this.i.controllers.enabled)switch(a.name){case "left":this.o.setX(this.o.x-5);break;case "right":this.o.setX(this.o.x+5);break;case "up":this.o.setY(this.o.y-5);break;case "down":this.o.setY(this.o.y+5)}};e.fe=function(a){this.D=!1;switch(a.name){case "left":case "right":this.u.setX(0);this.o.setX(0);break;case "up":case "down":this.u.setY(0),this.o.setY(0)}this.f&&this.f.F();this.i.controllers.Ae(this)};
e.mj=function(a){!1!==this.i.controllers.enabled&&(this.D=!0,qc(this,a),this.j&&this.j.F(),this.i.controllers.Be(this))};e.nj=function(a){qc(this,a)};e.oj=function(){this.D=!1;this.f&&this.f.F();this.i.controllers.Ae(this)};function qc(a,b){var d=(a.H.invert?1:-1)/a.H.hardness;switch(b.name){case "minus":d*=10;break;case "plus":d*=-10}a.c.fov=a.c.fov-d}e.enable=function(){nc.prototype.enable.call(this);for(var a,b=0,d=this.m.length;b<d;b++)a=this.m[b],this.i.keyboard.Wf(a)};
e.cc=function(){nc.prototype.cc.call(this);for(var a,b=0,d=this.m.length;b<d;b++)a=this.m[b],this.i.keyboard.He(a)};
e.update=function(){var a=this.i.renderer.displayResolution,a=1/(this.G.hardness*Math.min(a.width,a.height));this.u.subVectors(this.o,this.C);this.u.length()>this.G.velocityMax&&this.u.setLength(this.G.velocityMax);this.u.multiplyScalar(a);a=this.G.invert?-1:1;this.c.yaw+=a*(this.u.x+this.I.x);this.c.pitch-=a*(this.u.y+this.I.y);this.I.add(this.u).multiplyScalar(g.Math.ca(1-this.G.damping,0,1))};e.destroy=function(){nc.prototype.destroy.call(this)};
function w(a){this.i=a;this.L=null;this.j=1;this.$=!1;this.U=this.H=this.Z=1;this.C=!1;this.P=!0;this.c=null;this.J=!1;this.m=!0;this.B=this.u=this.I=this.G=this.D=this.o=this.M=this.f=null;n.call(this,"SoundManager")}w.prototype=Object.create(n.prototype);e=w.prototype;e.constructor=w;
e.boot=function(){this.c=[];if(!0===g.A.Wg)try{"function"===typeof window.AudioContext?this.f=new window.AudioContext:this.f=new window.webkitAudioContext}catch(a){this.f=null,this.m=!1}!0!==g.A.Xf||this.f||(this.m=!1,this.J=!0);this.f&&(this.o="undefined"===typeof this.f.createGain?this.f.createGainNode():this.f.createGain(),this.M=this.f.createAnalyser(),this.M.connect(this.o),this.o.gain.value=this.j,this.o.connect(this.f.destination),this.f.listener.setOrientation(0,0,-1,0,1,0));this.i.story.onSceneLoadStart.add(this.bi,
this)};e.bi=function(){if("undefined"!==typeof this.i.story.scene.config.audio){var a=g.K.pb(this.L,this.i.story.scene.config.audio);rc(this,a)}else rc(this,this.L);!1===this.P?this.u&&this.u.F():this.B&&this.B.F()};
function rc(a,b){b&&(a.P="undefined"!==typeof b.enabled?!!b.enabled:!0,a.H="undefined"!==typeof b.volume&&"number"===b.volume.max?g.Math.ca(b.volume.max,0,1):1,a.Z=!1===a.$?"undefined"!==typeof b.volume&&"number"===typeof b.volume["default"]?g.Math.ca(b.volume["default"],0,a.H):1:g.Math.ca(a.j,0,a.H))}e.ma=function(a){this.L=a;rc(this,a);"number"===typeof this.Z&&!1===this.$&&(this.j=g.Math.ca(this.Z,0,1));sc(this)};
e.update=function(){for(var a=0,b=this.c.length;a<b;a++)this.c[a].update();if(!0===this.m&&null!==this.i.renderer.camera.main){a=new THREE.Vector3;b=this.i.renderer.camera.main.quaternion;a.set(0,0,1);a.applyQuaternion(b);var d=a.clone();a.set(0,1,0);a.applyQuaternion(b);this.f.listener.setOrientation(d.x,d.y,d.z,a.x,a.y,a.z)}};e.add=function(a){-1===tc(this,a)&&this.c.push(a)};e.remove=function(a){a=tc(this,a);-1<a&&this.c.splice(a,1)};
function tc(a,b){if(!a.c)return-1;for(var d,h=0,k=a.c.length;h<k;h++)if(d=a.c[h],d===b)return h;return-1}e.Zf=function(){if(this.f&&"undefined"!==typeof this.f.suspend&&!0===this.m&&"running"===this.f.state){for(var a=!0,b=0,d=this.c.length;b<d;b++)if(!0===this.c[b].playing||!0===this.c[b].paused){a=!1;break}!0===a&&this.f.suspend()}};
e.Yf=function(){if(this.f&&"undefined"!==typeof this.f.resume&&!0===this.m&&"suspended"===this.f.state)for(var a=0,b=this.c.length;a<b;a++)if(!0===this.c[a].playing||!0===this.c[a].paused){this.f.resume();break}};e.qb=function(){!0!==this.C&&(this.C=!0,this.U=this.j,this.j=0,!0===this.m&&(this.U=this.o.gain.value),sc(this),this.D&&this.D.F())};e.ci=function(){!1!==this.C&&(this.C=!1,this.j=this.U,sc(this),this.G&&this.G.F())};
function sc(a){if(!0===a.m)a.o.gain.value=a.j;else if(!0===a.J)for(var b=0;b<a.c.length;b++)a.c[b].c.data.volume=g.Math.ca(a.c[b].D,0,1)*a.j;a.$=!0;a.I&&a.I.F()}
e.destroy=function(){this.i.story.onSceneLoadStart.remove(this.bi,this);this.L=this.i=null;for(var a=this.c.length;a--;)this.c[a].destroy();this.o=this.M=this.f=this.c=null;this.D&&(this.D.destroy(),this.D=null);this.G&&(this.G.destroy(),this.G=null);this.I&&(this.I.destroy(),this.I=null);this.u&&(this.u.destroy(),this.u=null);this.B&&(this.B.destroy(),this.B=null);n.prototype.destroy.call(this)};Object.defineProperty(w.prototype,"context",{get:function(){return this.f}});
Object.defineProperty(w.prototype,"analyser",{get:function(){return this.M}});Object.defineProperty(w.prototype,"inputNode",{get:function(){return this.M}});Object.defineProperty(w.prototype,"masterGain",{get:function(){return this.o}});Object.defineProperty(w.prototype,"useWebAudio",{get:function(){return this.m},set:function(a){"boolean"===typeof a&&(this.m=a,this.J=!a)}});
Object.defineProperty(w.prototype,"useAudioTag",{get:function(){return this.J},set:function(a){"boolean"===typeof a&&(this.J=a,this.m=!a)}});Object.defineProperty(w.prototype,"enabled",{get:function(){return this.P}});Object.defineProperty(w.prototype,"muted",{get:function(){return this.C},set:function(a){"boolean"===typeof a&&(!0===a?this.qb():this.ci())}});
Object.defineProperty(w.prototype,"volume",{get:function(){return!0===this.m?this.o.gain.value:this.j},set:function(a){"number"===typeof a&&(a=g.Math.ca(a,0,1),this.j=this.H<a?this.H:a,0<this.j&&(this.C=!1),sc(this))}});Object.defineProperty(w.prototype,"onMute",{get:function(){this.D||(this.D=new q(this));return this.D}});Object.defineProperty(w.prototype,"onUnmute",{get:function(){this.G||(this.G=new q(this));return this.G}});
Object.defineProperty(w.prototype,"onVolumeChange",{get:function(){this.I||(this.I=new q(this));return this.I}});Object.defineProperty(w.prototype,"onDisable",{get:function(){this.u||(this.u=new q(this));return this.u}});Object.defineProperty(w.prototype,"onEnable",{get:function(){this.B||(this.B=new q(this));return this.B}});g.lb={};g.lb.Yl="stereo";g.lb.Xl="3d";g.lb.Ne="ambisonic";
function L(a,b,d,h){this.i=a;this.la=b;this.j=d;this.va=this.D=1;this.ia=!1;this.L=!0;this.da=!1;this.B=this.Ea=this.H=this.M=this.o=0;this.u=this.P=!1;this.Fa=0;this.C=!1;this.I=this.Ja=this.f=this.m=this.na=this.c=this.J=null;this.Ka=this.wa=this.Ga=0;this.qa=null;this.pa=h||!1;this.Na=[0,1,2,3];this.ja=this.Da=!1;this.ya=this.xa=null;this.Ba=!1;this.$=this.aa=this.V=this.sa=this.G=this.Aa=this.ra=this.fa=this.Z=this.U=this.T=this.O=this.Ca=null;n.call(this,"Sound");!0===this.pa&&!1===uc(this)&&
(this.log("FORGE.Sound: can't manage ambisonic sound without Google Chrome Omnitone library and WebAudio API."),this.pa=!1);this.R=this.la;aa(this);!0===this.i.audio.useWebAudio&&(this.f=this.i.audio.context,this.Ja=this.i.audio.inputNode,this.I="undefined"===typeof this.f.createGain?this.f.createGainNode():this.f.createGain(),this.I.gain.value=this.D*this.i.audio.volume,this.I.connect(this.Ja));if(!0===this.i.audio.useAudioTag||!0===uc(this))!0===this.i.cache.has(C.Eb,this.la)&&this.ei(this.i.cache.get(C.Eb,
this.la)),this.i.audio.onVolumeChange.add(this.fi,this);this.i.audio.onDisable.add(this.di,this);""!==this.j&&(this.i.load.sound(this.la,this.j,this.ei,this,uc(this)),this.O&&this.O.F());this.i.audio.add(this)}L.prototype=Object.create(n.prototype);e=L.prototype;e.constructor=L;
e.ei=function(a){this.J=a;this.ja=!0;this.T&&this.T.F();!0===this.i.audio.useWebAudio?(a=this.J)&&!1===this.Ba&&(this.xa=this.Hi.bind(this),this.ya=this.sm.bind(this),!0===uc(this)?(this.qa=Omnitone.createFOADecoder(this.f,a.data,{channelMap:this.Na}),this.qa.initialize().then(this.xa,this.ya)):this.f.decodeAudioData(a.data,this.xa,this.ya)):(vc(this),this.Hi(null))};e.sm=function(){this.J&&(this.J.data=null,this.Ba=!1)};function vc(a){a.Ca&&a.Ca.F();a.U&&a.U.F();a.Z&&a.Z.F()}
e.Hi=function(a){if(this.J){a&&(this.J.data=a);this.Ba=!0;vc(this);if(!0===this.i.audio.useAudioTag||!0===uc(this))this.c=this.i.cache.get(C.Eb,this.la),wc(this),this.o=0,this.c.data.duration&&(this.o=this.c.data.duration,this.M=Math.ceil(1E3*this.o));!0===this.Da&&this.play(this.B,this.P,!0)}};e.fi=function(){wc(this)};function wc(a){!a.c||!0!==a.i.audio.useAudioTag&&!0!==uc(a)||(a.c.data.volume=g.Math.ca(a.D,0,1)*a.i.audio.volume)}e.di=function(){!0===this.u?this.pause():!1===this.paused&&this.stop()};
function xc(a){a.B=0;a.Da=!1;a.u=!1;a.C=!1}function yc(a,b){null===a.m&&(a.m=a.f.createPanner(),a.m.panningModel="HRTF",a.m.distanceModel="inverse",a.m.refDistance=1,a.m.maxDistance=1E4,a.m.rolloffFactor=1,a.m.coneInnerAngle=360,a.m.coneOuterAngle=0,a.m.coneOuterGain=0,a.m.setOrientation(0,0,0),a.m.setPosition(0,0,0));a.m.setPosition(a.Ga,a.wa,a.Ka);!0===b&&(a.c.connect(a.m),a.m.connect(a.I))}function uc(a){return!0===a.pa&&!0===a.i.audio.useWebAudio&&"undefined"!==typeof Omnitone}
e.update=function(){if(!0===this.u&&!1===this.C){var a=this.i.clock.time-this.H;if(a>=this.M){if(this.B=this.M,!0===this.i.audio.useWebAudio||!0===this.i.audio.useAudioTag)this.stop(!0),this.$&&this.$.F(),!0===this.P&&(this.B=0,this.resume())}else this.B=a}this.qa&&!0===this.u&&this.qa.setRotationMatrixFromCamera(this.i.renderer.camera.modelViewInverse)};
e.play=function(a,b,d){if(!1===this.i.audio.enabled||!1===this.L)this.C=this.u=!1;else{this.P=b||this.P;if(!0===this.u)if(!0===d)this.stop();else return;if(!1===this.ja)this.Da=!0;else if(!0===this.i.audio.useWebAudio&&!1===uc(this))!0===this.Ba?(this.na||(this.na=this.J.data),this.c=this.f.createBufferSource(),this.c.buffer=this.na,!0===this.da?yc(this,!0):this.c.connect(this.I),this.o=this.c.buffer.duration,this.M=Math.ceil(1E3*this.o),!isNaN(a)&&a<this.M?this.H=this.i.clock.time-a:(a=0,this.H=
this.i.clock.time),b=g.Math.Ed(a/1E3),"undefined"===typeof this.c.start?this.c.noteGrainOn(0,b%this.o,this.o):this.c.start(0,b%this.o,this.o),this.u=!0,this.B=a,this.Fa++,this.G&&this.G.F(),this.i.audio.Yf()):(this.log("Sound is not decoded yet"),this.Da=!0);else if(!0===this.i.audio.useAudioTag||!0===uc(this))this.o?Infinity===this.o&&(this.c.data.loop=!0):(this.o=this.c.data.duration,this.M=Math.ceil(1E3*this.o)),!isNaN(a)&&this.M&&a<this.M?(this.c.data.currentTime=g.Math.Ed(a/1E3),this.H=this.i.clock.time-
a):(a=0,this.c.data.currentTime=a,this.H=this.i.clock.time),this.c.data.play(),this.u=!0,this.B=a,this.Fa++,this.G&&this.G.F()}};e.stop=function(a){this.c?(zc(this,!0),this.H=this.Ea=this.i.clock.time,this.C=this.u=this.Da=!1,this.sa&&!0===a&&this.sa.F(),this.i.audio.Zf()):!1!==this.ja&&!0===this.Ba||xc(this)};
function zc(a,b){if(!0===a.i.audio.useWebAudio&&!1===uc(a)){if("undefined"===typeof a.c.stop)a.c.noteOff(0);else try{a.c.stop(0)}catch(d){}a.c.disconnect(0);!0===b&&(a.B=0)}else if(!0===a.i.audio.useAudioTag||!0===uc(a))a.c.data.pause(),!0===b&&(a.B=0,a.c.data.currentTime=0)}e.pause=function(){!0===this.u&&this.c?(zc(this,!1),this.C=!0,this.Ea=this.i.clock.time,this.u=this.Da=!1,this.V&&this.V.F(),this.i.audio.Zf()):!1!==this.ja&&!0===this.Ba||xc(this)};
e.resume=function(){if(!1!==this.i.audio.enabled&&!1!==this.L)if(!0===this.C||!1===this.u)if(this.c){this.H=this.i.clock.time-(this.Ea-this.H);this.B=this.i.clock.time-this.H;var a=g.Math.Ed(this.B/1E3);if(!0===this.i.audio.useWebAudio&&!1===uc(this)){this.c=this.f.createBufferSource();this.c.buffer=this.na;!0===this.da?yc(this,!0):this.c.connect(this.I);var b=Math.ceil((this.M-this.B)/1E3);"undefined"===typeof this.c.start?this.c.noteGrainOn(0,a%this.o,b):this.c.start(0,a%this.o,b)}else if(!0===
this.i.audio.useAudioTag||!0===uc(this))this.c.data.currentTime=g.Math.Ed(a/1E3),this.c.data.play();this.u=!0;this.C=!1;this.aa&&this.aa.F();this.i.audio.Yf()}else this.play(this.B,this.P,!0);else if(!1===this.ja||!1===this.Ba)xc(this),this.Da=!0};
e.qb=function(){!0!==this.ia&&!1!==this.i.audio.enabled&&!1!==this.L&&(this.ia=!0,this.va=this.D,this.D=0,!0===this.i.audio.useWebAudio&&!1===uc(this)?this.I.gain.value=this.D:!0!==this.i.audio.useAudioTag&&!0!==uc(this)||!this.c||(this.c.data.volume=this.D),this.fa&&this.fa.F())};
e.gi=function(){!1!==this.ia&&!1!==this.i.audio.enabled&&!1!==this.L&&(this.ia=!1,this.D=this.va,!0===this.i.audio.useWebAudio&&!1===uc(this)?this.I.gain.value=this.va:!0!==this.i.audio.useAudioTag&&!0!==uc(this)||!this.c||(this.c.data.volume=this.va),this.ra&&this.ra.F())};
e.destroy=function(){this.stop();!0!==this.i.audio.useAudioTag&&!0!==uc(this)||this.i.audio.onVolumeChange.remove(this.fi,this);this.i.audio.onDisable.remove(this.di,this);this.i.audio.remove(this);this.ya=this.xa=this.m=this.I=this.Ja=this.f=this.na=this.c=this.J=this.i=null;this.Ca&&(this.Ca.destroy(),this.Ca=null);this.O&&(this.O.destroy(),this.O=null);this.T&&(this.T.destroy(),this.T=null);this.U&&(this.U.destroy(),this.U=null);this.Z&&(this.Z.destroy(),this.Z=null);this.fa&&(this.fa.destroy(),
this.fa=null);this.ra&&(this.ra.destroy(),this.ra=null);this.Aa&&(this.Aa.destroy(),this.Aa=null);this.G&&(this.G.destroy(),this.G=null);this.sa&&(this.sa.destroy(),this.sa=null);this.V&&(this.V.destroy(),this.V=null);this.aa&&(this.aa.destroy(),this.aa=null);this.$&&(this.$.destroy(),this.$=null);n.prototype.destroy.call(this)};Object.defineProperty(L.prototype,"enabled",{get:function(){return this.L},set:function(a){"boolean"===typeof a&&(this.L=a,!1!==this.L||!0!==this.u&&!0!==this.C||this.stop())}});
Object.defineProperty(L.prototype,"currentTime",{get:function(){return this.B},set:function(a){"number"===typeof a&&(this.pause(),this.B=a,!0===this.u&&this.resume())}});Object.defineProperty(L.prototype,"spatialized",{get:function(){return this.da},set:function(a){"boolean"===typeof a&&(this.da=a)}});Object.defineProperty(L.prototype,"ambisonic",{get:function(){return this.pa}});Object.defineProperty(L.prototype,"duration",{get:function(){return this.o}});
Object.defineProperty(L.prototype,"muted",{get:function(){return this.ia||this.i.audio.qb},set:function(a){"boolean"===typeof a&&(!0===a?this.qb():this.gi())}});Object.defineProperty(L.prototype,"volume",{get:function(){return this.D},set:function(a){"number"===typeof a&&!0!==isNaN(a)&&(a=g.Math.ca(a,0,1),a!==this.D&&!1!==this.i.audio.enabled&&!1!==this.L&&(this.D=a,0<this.D&&(this.ia=!1),!0===this.i.audio.useWebAudio&&!1===uc(this)?this.I.gain.value=a:wc(this),this.Aa&&this.Aa.F()))}});
Object.defineProperty(L.prototype,"decoded",{get:function(){return this.J?this.Ba:!1}});Object.defineProperty(L.prototype,"playCount",{get:function(){return this.Fa}});Object.defineProperty(L.prototype,"playing",{get:function(){return this.u}});Object.defineProperty(L.prototype,"ready",{get:function(){return this.ja}});Object.defineProperty(L.prototype,"paused",{get:function(){return this.C}});
Object.defineProperty(L.prototype,"loop",{get:function(){return this.P},set:function(a){"boolean"===typeof a&&(this.P=a,!0!==this.i.audio.useAudioTag&&!0!==uc(this)||!this.c||Infinity!==this.o||(this.c.data.loop=this.P))}});Object.defineProperty(L.prototype,"x",{get:function(){return this.Ga},set:function(a){"number"===typeof a&&(this.Ga=a,!0===this.i.audio.useWebAudio&&!1===uc(this)&&this.c&&null!==this.m&&!0===this.da&&yc(this))}});
Object.defineProperty(L.prototype,"y",{get:function(){return this.wa},set:function(a){"number"===typeof a&&(this.wa=a,!0===this.i.audio.useWebAudio&&!1===uc(this)&&this.c&&null!==this.m&&!0===this.da&&yc(this))}});Object.defineProperty(L.prototype,"z",{get:function(){return this.wa},set:function(a){"number"===typeof a&&(this.Ka=a,!0===this.i.audio.useWebAudio&&!1===uc(this)&&this.c&&null!==this.m&&!0===this.da&&yc(this))}});
Object.defineProperty(L.prototype,"onSoundDecode",{get:function(){this.Ca||(this.Ca=new q(this));return this.Ca}});Object.defineProperty(L.prototype,"onLoadStart",{get:function(){this.O||(this.O=new q(this));return this.O}});Object.defineProperty(L.prototype,"onLoadedData",{get:function(){this.T||(this.T=new q(this));return this.T}});Object.defineProperty(L.prototype,"onCanPlay",{get:function(){this.U||(this.U=new q(this));return this.U}});
Object.defineProperty(L.prototype,"onCanPlayThrough",{get:function(){this.Z||(this.Z=new q(this));return this.Z}});Object.defineProperty(L.prototype,"onMute",{get:function(){this.fa||(this.fa=new q(this));return this.fa}});Object.defineProperty(L.prototype,"onUnmute",{get:function(){this.ra||(this.ra=new q(this));return this.ra}});Object.defineProperty(L.prototype,"onVolumeChange",{get:function(){this.Aa||(this.Aa=new q(this));return this.Aa}});
Object.defineProperty(L.prototype,"onPlay",{get:function(){this.G||(this.G=new q(this));return this.G}});Object.defineProperty(L.prototype,"onStop",{get:function(){this.sa||(this.sa=new q(this));return this.sa}});Object.defineProperty(L.prototype,"onPause",{get:function(){this.V||(this.V=new q(this));return this.V}});Object.defineProperty(L.prototype,"onResume",{get:function(){this.aa||(this.aa=new q(this));return this.aa}});
Object.defineProperty(L.prototype,"onEnded",{get:function(){this.$||(this.$=new q(this));return this.$}});
function N(a,b){this.i=a;this.j=b;this.M=this.c=null;this.f=this.P="";this.J=this.m=1;this.H=this.L=this.C=!0;this.o=this.G=this.u=this.I=this.B=this.D=null;n.call(this,"Playlist");this.R=this.j.uid;aa(this);this.M=new D(this.i,this.j.name);this.c=[];a=this.j;this.C="undefined"!==typeof a.autoPlay?!!a.autoPlay:!0;this.H="undefined"!==typeof a.loop?!!a.loop:!0;this.m="undefined"!==typeof a.volume&&"number"===typeof a.volume.max?g.Math.ca(a.volume.max,0,1):1;this.J="undefined"!==typeof a.volume&&"number"===
typeof a.volume["default"]?g.Math.ca(a.volume["default"],0,this.m):g.Math.ca(1,0,this.m);a=this.j;"undefined"!==typeof a.tracks&&!0===g.K.Pa(a.tracks,"string")?this.c=a.tracks:this.warn("A playlist has no track in its configuration, or configuration is not valid!");"string"===typeof a["default"]&&""!==a["default"]?this.P=a["default"]:"number"===typeof a["default"]&&0<=a["default"]&&a["default"]<this.c.length?this.P=this.c[a["default"]].uid:this.warn("A playlist has a default track that is not in its tracks array!");
this.f=this.P;this.D&&this.D.F()}N.prototype=Object.create(n.prototype);e=N.prototype;e.constructor=N;e.he=function(){0<this.c.length&&this.c.indexOf(this.f)+1===this.c.length&&(!1===this.H||!0===this.track.loop)?this.f=this.c[0]:this.Cd()};e.rl=function(){this.B&&this.B.F()};e.tl=function(){this.I&&this.I.F()};e.ql=function(){this.u&&this.u.F()};e.sl=function(){this.G&&this.G.F()};e.pl=function(){this.o&&this.o.F()};e.ul=function(){return!!this.c.length};
e.play=function(a,b){this.L="undefined"!==typeof b?b:!1;var d;if("string"===typeof a&&g.S.W(a,"PlaylistTrack"))d=a;else if(g.K.W(a,"PlaylistTrack"))d=a.uid;else if("number"===typeof a&&0<=a&&a<this.c.length)d=this.c[a];else if(""!==this.f)d=this.f;else if("undefined"===typeof a||""===a)d=this.c[0];if("undefined"!==typeof d){this.stop();this.f=d;if(!0===this.L&&!1===this.C)return this.warn("FORGE.Playlist.play(); autoPlay is disabled"),this.track;this.track.play();!1===this.track.onEnded.has(this.he,
this)&&this.track.onEnded.add(this.he,this);this.log("FORGE.Playlist.play(); [uid: "+this.f+"]");return this.track}return null};e.stop=function(){null!==this.track&&(this.track.stop(),"undefined"!==typeof this.track.onEnded&&!1===this.track.onEnded.has(this.he,this)&&this.track.onEnded.remove(this.he,this))};e.pause=function(){null!==this.track&&this.track.pause()};e.resume=function(){null!==this.track&&this.track.resume()};
e.Cd=function(){var a=-1;0<this.c.length&&(a=this.c.indexOf(this.f)+1,a===this.c.length&&(a=0));this.play(a,this.L);!0===this.paused&&this.pause()};e.Ge=function(){var a=-1;0<this.c.length&&(a=this.c.indexOf(this.f)-1,-1===a&&(a=this.c.length-1));this.play(a,this.L);!0===this.paused&&this.pause()};e.destroy=function(){this.stop();this.i=null;this.M.destroy();this.M=null;0<this.c.length&&(this.c.length=0,this.c=null);this.j=null;n.prototype.destroy.call(this)};
Object.defineProperty(N.prototype,"tracks",{get:function(){return this.c}});Object.defineProperty(N.prototype,"name",{get:function(){return this.M.value}});Object.defineProperty(N.prototype,"ready",{get:function(){return null!==this.track?this.track.ready:!1}});Object.defineProperty(N.prototype,"decoded",{get:function(){return null!==this.track?this.track.decoded:!1}});Object.defineProperty(N.prototype,"playing",{get:function(){return null!==this.track?this.track.playing:!1}});
Object.defineProperty(N.prototype,"paused",{get:function(){return null!==this.track?this.track.paused:!1}});Object.defineProperty(N.prototype,"track",{get:function(){return!0===g.S.W(this.f,"PlaylistTrack")?g.S.get(this.f,"PlaylistTrack"):null}});Object.defineProperty(N.prototype,"loop",{get:function(){return this.H},set:function(a){this.H=!!a}});Object.defineProperty(N.prototype,"autoPlay",{get:function(){return this.C},set:function(a){this.C=!!a}});
Object.defineProperty(N.prototype,"volume",{get:function(){return this.J},set:function(a){"number"===typeof a&&(a=g.Math.ca(a,0,1),this.J=this.m<a?this.m:a,!0===g.S.W(this.f,"PlaylistTrack")&&(a=g.S.get(this.f,"PlaylistTrack"),null!==a&&(a.volume=this.J*this.i.playlists.volume)))}});Object.defineProperty(N.prototype,"onPlay",{get:function(){this.B||(this.B=new q(this));return this.B}});Object.defineProperty(N.prototype,"onStop",{get:function(){this.I||(this.I=new q(this));return this.I}});
Object.defineProperty(N.prototype,"onPause",{get:function(){this.u||(this.u=new q(this));return this.u}});Object.defineProperty(N.prototype,"onResume",{get:function(){this.G||(this.G=new q(this));return this.G}});Object.defineProperty(N.prototype,"onEnded",{get:function(){this.o||(this.o=new q(this));return this.o}});Object.defineProperty(N.prototype,"onReady",{get:function(){this.D||(this.D=new q(this));return this.D}});
function z(a){this.i=a;this.u=this.c=this.M=null;this.f=this.j="";this.J=this.B=1;this.m=!0;this.o=this.P=!1;this.D=this.C=this.G=this.H=this.I=this.L=null;n.call(this,"PlaylistManager")}z.prototype=Object.create(n.prototype);e=z.prototype;e.constructor=z;e.boot=function(){this.c=[];this.u=[];this.i.audio.onEnable.add(this.Ki,this);this.i.story.onSceneLoadStart.add(this.Jh,this)};
e.Ki=function(){!0===this.m&&0<this.c.length&&!0===this.ready&&!0===this.decoded&&!1===this.o&&(!0===this.paused?this.resume():!1===this.playing&&this.play())};
e.Jh=function(){if("undefined"!==typeof this.i.story.scene.config.playlists){var a=g.K.pb(this.M,this.i.story.scene.config.playlists);Ac(this,a);!1===this.o&&(!1===this.m?Bc(this):Cc(this,this.f)||!0===this.playing&&Bc(this))}else Ac(this,this.M),!1===this.o&&this.f!==this.j&&(!1!==this.m&&!1!==this.ready&&!1!==this.decoded&&!0!==this.playing||Bc(this),Cc(this,this.f))};
function Ac(a,b){b&&(a.m="undefined"!==typeof b.enabled?!!b.enabled:!0,"undefined"!==typeof b["default"]&&("string"===typeof b["default"]&&""!==b["default"]?a.f=b["default"]:"number"===typeof b["default"]&&0<=b["default"]&&b["default"]<a.c.length&&(a.f=a.c[b["default"]].uid)),a.B="undefined"!==typeof b.volume&&"number"===typeof b.volume.max?g.Math.ca(b.volume.max,0,1):1,a.J="undefined"!==typeof b.volume&&"number"===typeof b.volume["default"]?g.Math.ca(b.volume["default"],0,a.B):g.Math.ca(1,0,a.B))}
e.ma=function(a){var b;this.M=a;if("undefined"!==typeof a.lists)for(var d=0,h=a.lists.length;d<h;d++)b=new N(this.i,a.lists[d]),this.add(b);if("undefined"!==typeof a.tracks)for(d=0,h=a.tracks.length;d<h;d++)b=new O(this.i,a.tracks[d]),this.Kh(b),!0===this.P&&this.warn("Preload is not supported yet.");Ac(this,a);"undefined"!==typeof a.lists&&0<a.lists.length&&(""===this.f&&this.warn("The playlist manager has a default playlist that is not in its playlists array!"),this.j=this.f);if(!(0>=this.c.length)){var k;
"string"===typeof this.f&&""!==this.f?k=this.f:k=this.c[0].uid;void 0===g.S.get(k)&&this.warn('PlaylistManager : uid "'+k+'" is not into playlists');!0===g.S.W(k,"Playlist")?this.play(k,!0):this.warn("Impossible to play the playlist with uid "+k+", it doesn't seem to be a playlist!")}};
function Cc(a,b){return null!==b&&!0===g.S.W(b,"Playlist")?(null!==a.playlist&&a.playlist.uid===b?null!==a.playlist.track&&"undefined"!==typeof a.playlist.track.uid&&""!==a.playlist.track.uid?!0===a.paused?a.resume():!1===a.playing&&a.play(b,!0):(a.stop(),a.play(b,!0)):(a.stop(),a.play(b,!0)),!0):!1}function Bc(a){!0===a.playing?a.pause():a.stop()}e.ll=function(){this.I&&this.I.F();null!==this.playlist&&N.prototype.rl.call(this.playlist)};e.nl=function(){this.H&&this.H.F();null!==this.playlist&&N.prototype.tl.call(this.playlist)};
e.kl=function(){this.G&&this.G.F();null!==this.playlist&&N.prototype.ql.call(this.playlist)};e.ml=function(){this.C&&this.C.F();null!==this.playlist&&N.prototype.sl.call(this.playlist)};e.jl=function(){this.D&&this.D.F();null!==this.playlist&&N.prototype.pl.call(this.playlist)};e.add=function(a){this.c.push(a)};e.Kh=function(a){this.u.push(a)};e.Xn=function(){return!!this.c.length};e.ol=function(){return!!this.u.length};
e.play=function(a,b){var d;if("string"===typeof a&&g.S.W(a,"Playlist"))d=a;else if(g.K.W(a,"Playlist"))d=a.uid;else if("number"===typeof a&&0<=a&&a<this.c.length)d=this.c[a].uid;else if(""!==this.j)d=this.j;else if("undefined"===typeof a||""===a)d=this.c[0].uid;"undefined"!==typeof d&&(!0===this.playing&&this.stop(),this.j=d,!0===this.m&&(this.o=!1,this.playlist.play(null,b),this.log("FORGE.PlaylistManager.play(); [uid: "+this.j+"]")))};e.stop=function(){null!==this.playlist&&this.playlist.stop()};
e.pause=function(){null!==this.playlist&&!0===this.playlist.playing&&(this.o=!0,this.playlist.pause())};e.resume=function(){if(null!==this.playlist&&!0===this.m&&!0===this.playlist.paused){var a=this.o;this.o=!1;!0===a&&this.f!==this.j?Cc(this,this.f):this.playlist.resume()}};e.Cd=function(){null!==this.playlist&&!0===this.m&&this.playlist.Cd()};e.Ge=function(){null!==this.playlist&&!0===this.m&&this.playlist.Ge()};
e.destroy=function(){this.stop();this.i.audio.onEnable.remove(this.Ki,this);this.i.story.onSceneLoadStart.remove(this.Jh,this);this.M=this.i=null;for(var a=this.c.length;a--;)this.c[a].destroy();this.c=null;for(a=this.u.length;a--;)this.u[a].destroy();this.u=null;n.prototype.destroy.call(this)};Object.defineProperty(z.prototype,"playlists",{get:function(){return this.c}});Object.defineProperty(z.prototype,"tracks",{get:function(){return this.u}});
Object.defineProperty(z.prototype,"playlist",{get:function(){return!0===g.S.W(this.j,"Playlist")?g.S.get(this.j,"Playlist"):null}});Object.defineProperty(z.prototype,"loop",{get:function(){return null!==this.playlist?this.playlist.loop:!0}});Object.defineProperty(z.prototype,"autoPlay",{get:function(){return null!==this.playlist?this.playlist.autoPlay:!0}});Object.defineProperty(z.prototype,"preload",{get:function(){return this.P},set:function(a){this.P=!!a}});
Object.defineProperty(z.prototype,"enabled",{get:function(){return this.m}});Object.defineProperty(z.prototype,"ready",{get:function(){return null!==this.playlist?this.playlist.ready:!1}});Object.defineProperty(z.prototype,"decoded",{get:function(){return null!==this.playlist?this.playlist.decoded:!1}});Object.defineProperty(z.prototype,"playing",{get:function(){return null!==this.playlist?this.playlist.playing:!1}});
Object.defineProperty(z.prototype,"paused",{get:function(){return null!==this.playlist?this.playlist.paused:!1}});Object.defineProperty(z.prototype,"volume",{get:function(){return this.J},set:function(a){if("number"===typeof a&&(a=g.Math.ca(a,0,1),this.J=this.B<a?this.B:a,!0===g.S.W(this.j,"Playlist")&&(a=g.S.get(this.j,"Playlist"),null!==a))){var b=a.track;null!==b&&(b.volume=a.volume*this.J)}}});Object.defineProperty(z.prototype,"onReady",{get:function(){this.L||(this.L=new q(this));return this.L}});
Object.defineProperty(z.prototype,"onPlay",{get:function(){this.I||(this.I=new q(this));return this.I}});Object.defineProperty(z.prototype,"onStop",{get:function(){this.H||(this.H=new q(this));return this.H}});Object.defineProperty(z.prototype,"onPause",{get:function(){this.G||(this.G=new q(this));return this.G}});Object.defineProperty(z.prototype,"onResume",{get:function(){this.C||(this.C=new q(this));return this.C}});
Object.defineProperty(z.prototype,"onEnded",{get:function(){this.D||(this.D=new q(this));return this.D}});function O(a,b){this.i=a;this.u=b;this.o=this.m=null;this.j="";this.f=!1;this.c=null;n.call(this,"PlaylistTrack");this.R=this.u.uid;aa(this);a=this.u;ba(this);this.R=a.uid;aa(this);this.m=new D(this.i,a.name);this.o=new D(this.i,a.author);this.j=a.url;this.f=a.loop||!1}O.prototype=Object.create(n.prototype);e=O.prototype;e.constructor=O;e.Nh=function(){z.prototype.ll.call(this.i.playlists)};
e.Ui=function(){z.prototype.nl.call(this.i.playlists)};e.Mh=function(){z.prototype.kl.call(this.i.playlists)};e.Ti=function(){z.prototype.ml.call(this.i.playlists)};e.Lh=function(){z.prototype.jl.call(this.i.playlists)};
e.play=function(){this.c||(this.c=new L(this.i,this.R+"-sound",this.j),this.c.volume=this.i.playlists.volume*this.i.playlists.playlist.volume,!0===this.f&&(this.c.loop=this.f),this.c.onPlay.add(this.Nh,this),this.c.onStop.add(this.Ui,this),this.c.onPause.add(this.Mh,this),this.c.onResume.add(this.Ti,this),this.c.onEnded.add(this.Lh,this));this.c.play()};e.stop=function(){this.c&&this.c.stop(!0)};e.pause=function(){this.c&&this.c.pause()};e.resume=function(){this.c&&this.c.resume()};
e.destroy=function(){this.u=this.i=null;this.m.destroy();this.m=null;this.o.destroy();this.o=null;this.c&&(this.c.onPlay.remove(this.Nh,this),this.c.onStop.remove(this.Ui,this),this.c.onPause.remove(this.Mh,this),this.c.onResume.remove(this.Ti,this),this.c.onEnded.remove(this.Lh,this),this.c.destroy(),this.c=null);n.prototype.destroy.call(this)};Object.defineProperty(O.prototype,"name",{get:function(){return this.m.value}});Object.defineProperty(O.prototype,"author",{get:function(){return this.o.value}});
Object.defineProperty(O.prototype,"currentTime",{get:function(){return this.c?this.c.currentTime:0},set:function(a){this.c&&(this.c.currentTime=a)}});Object.defineProperty(O.prototype,"volume",{get:function(){return this.c?this.c.volume:!1},set:function(a){if(!this.c)return!1;this.c.volume=a}});Object.defineProperty(O.prototype,"ready",{get:function(){return this.c?this.c.ready:!1}});Object.defineProperty(O.prototype,"decoded",{get:function(){return this.c?this.c.decoded:!1}});
Object.defineProperty(O.prototype,"playing",{get:function(){return this.c?this.c.playing:!1}});Object.defineProperty(O.prototype,"paused",{get:function(){return this.c?this.c.paused:!1}});Object.defineProperty(O.prototype,"loop",{get:function(){return this.f},set:function(a){this.f=!!a}});Object.defineProperty(O.prototype,"onPlay",{get:function(){if(this.c)return this.c.onPlay}});Object.defineProperty(O.prototype,"onStop",{get:function(){if(this.c)return this.c.onStop}});
Object.defineProperty(O.prototype,"onPause",{get:function(){if(this.c)return this.c.onPause}});Object.defineProperty(O.prototype,"onResume",{get:function(){if(this.c)return this.c.onResume}});Object.defineProperty(O.prototype,"onEnded",{get:function(){if(this.c)return this.c.onEnded}});function oa(a){this.i=a;this.j=this.c=null;this.O=this.$=this.T=!1;this.L=-1;this.M=this.o=null;n.call(this,"Director");this.Se()}oa.prototype=Object.create(n.prototype);e=oa.prototype;e.constructor=oa;
e.Se=function(){this.o=this.i.clock.create(!1);this.i.story.onSceneLoadComplete.add(this.fj,this);this.i.onReady.add(this.th,this)};e.load=function(a){if(null!==a.tracks&&Array.isArray(a.tracks))for(var b=0,d=a.tracks.length;b<d;b++)new cc(a.tracks[b])};e.th=function(){this.i.controllers.onControlStart.add(this.od,this);this.i.controllers.onControlEnd.add(this.nd,this)};
e.fj=function(){var a=this.i.story.scene;this.stop();Dc(this);this.c=null;this.j=[];"undefined"!==typeof a.config.director&&(a=a.config.director.animation,"undefined"!==typeof a&&null!==a&&!1!==a.enabled&&(this.T="boolean"===typeof a.loop?a.loop:!1,this.$="boolean"===typeof a.random?a.random:!1,this.O="boolean"===typeof a.stoppable?a.stoppable:!1,this.L="number"===typeof a.idleTime?a.idleTime:0,null!==a.tracks&&g.K.Pa(a.tracks,"string")&&(this.j=!0===this.$?g.K.Dd(a.tracks):a.tracks),this.i.renderer.camera.animation.onComplete.add(this.Vi,
this),"undefined"!==typeof this.i.story.scene.config.media&&this.i.story.scene.config.media.type===g.ub.VIDEO&&(this.i.renderer.media.displayObject.onPause.add(this.ge,this),this.i.renderer.media.displayObject.onWaiting.add(this.lc,this),this.i.renderer.media.displayObject.onStalled.add(this.lc,this),this.i.renderer.media.displayObject.onEnded.add(this.Li,this),this.i.renderer.media.displayObject.onCurrentTimeChange.add(this.jj,this),document.addEventListener(g.A.Sg,null)),"number"===typeof a.delay&&
(this.M=this.o.add(a.delay,this.Qf,this),this.o.start())))};e.ge=function(){this.stop();this.i.renderer.media.displayObject.onPause.remove(this.ge,this);this.i.renderer.media.displayObject.onPlay.add(this.Sf,this);this.i.controllers.onControlStart.remove(this.od,this);this.i.controllers.onControlEnd.remove(this.nd,this)};
e.Sf=function(){null!==this.c&&this.play(this.c);this.i.renderer.media.displayObject.onPause.add(this.ge,this);this.i.renderer.media.displayObject.onPlay.remove(this.Sf,this);this.i.controllers.onControlStart.add(this.od,this);this.i.controllers.onControlEnd.add(this.nd,this)};
e.lc=function(){this.stop();this.i.renderer.media.displayObject.onWaiting.remove(this.lc,this);this.i.renderer.media.displayObject.onStalled.remove(this.lc,this);this.i.renderer.media.displayObject.onPlaying.add(this.Tf,this);this.i.controllers.onControlStart.remove(this.od,this);this.i.controllers.onControlEnd.remove(this.nd,this)};
e.Tf=function(){null!==this.c&&this.play(this.c);this.i.renderer.media.displayObject.onPlaying.remove(this.Tf,this);this.i.renderer.media.displayObject.onWaiting.add(this.lc,this);this.i.renderer.media.displayObject.onStalled.add(this.lc,this);this.i.controllers.onControlStart.add(this.od,this);this.i.controllers.onControlEnd.add(this.nd,this)};e.Li=function(){!0===this.i.renderer.media.displayObject.loop&&this.fj()};e.od=function(){null!==this.c&&!0===this.O&&this.stop();this.o.stop(!0)};
e.nd=function(){this.M&&this.o.remove(this.M);null!==this.c&&!0===this.O&&(null===this.c&&"number"===typeof this.i.story.scene.config.director.animation.delay?(this.M=this.o.add(this.i.story.scene.config.director.animation.delay,this.Qf,this),this.o.start()):"number"===typeof this.L&&-1<this.L&&(this.M=this.o.add(this.L,this.Qf,this),this.o.start()))};
e.Vi=function(){if(1<this.j.length){var a=this.j.indexOf(this.c)+1;if(a<this.j.length){this.play(a);return}}!0===this.T&&(!0===this.$&&(this.j=g.K.Dd(this.j)),this.play(0))};e.Qf=function(){this.play(this.c);this.o.stop(!0)};
e.jj=function(a){this.stop();this.c=null;"number"===typeof a?a*=1E3:"number"===typeof a.data?a=1E3*a.data:a=this.i.renderer.media.displayObject.currentTimeMS;var b=0,d,h;h=g.S.get(this.j[0]);if(h.duration>a)this.c=h.uid;else for(var k=1,l=this.j.length-1;k<l;k++){d=h;h=g.S.get(this.j[k]);if(d.duration+b<a&&h.duration+d.duration+b>a){this.c=h.uid;break}b+=d.duration}null===this.c?(a=h.keyframes[h.keyframes.length-1].data,this.i.renderer.camera.uk(a.yaw,a.pitch,a.roll,a.fov)):this.i.renderer.camera.animation.play(this.c)};
e.play=function(a){this.stop();this.c=null;this.c="number"===typeof a?this.j[a]:"string"===typeof a?a:this.j[0];this.i.renderer.camera.animation.play(this.c)};e.stop=function(){this.i.renderer.camera.animation.stop()};
function Dc(a){a.i.renderer.camera.animation.onComplete.remove(a.Vi,a);"undefined"!==typeof a.i.story.scene.config.media&&a.i.story.scene.config.media.type===g.ub.VIDEO&&(a.i.renderer.media.displayObject.onPlay.remove(a.Sf,a),a.i.renderer.media.displayObject.onPause.remove(a.ge,a),a.i.renderer.media.displayObject.onWaiting.remove(a.lc,a),a.i.renderer.media.displayObject.onStalled.remove(a.lc,a),a.i.renderer.media.displayObject.onPlaying.remove(a.Tf,a),a.i.renderer.media.displayObject.onEnded.remove(a.Li,
a),a.i.renderer.media.displayObject.onCurrentTimeChange.remove(a.jj,a))}e.destroy=function(){Dc(this);this.i.onReady.remove(this.th,this);this.c=this.j=this.i=null;n.prototype.destroy.call(this)};function cc(a){this.G=this.o=!1;sb.call(this,"DirectorTrack");this.c(a)}cc.prototype=Object.create(sb.prototype);cc.prototype.constructor=cc;cc.prototype.c=function(a){this.o=a.smooth;this.G=a.cancelRoll;sb.prototype.c.call(this,a)};Object.defineProperty(cc.prototype,"smooth",{get:function(){return this.o}});
Object.defineProperty(cc.prototype,"cancelRoll",{get:function(){return this.G}});function Lb(a){this.i=a;this.f=[];n.call(this,"ActionEventDispatcher")}Lb.prototype=Object.create(n.prototype);Lb.prototype.constructor=Lb;Lb.prototype.c=function(a){if(!0===g.K.Pa(a,"string")||g.K.W(a,"string"))this.f=this.f.concat(a)};Lb.prototype.F=function(){for(var a=0,b=this.f.length;a<b;a++){var d=this.i.actions.get(this.f[a]);"undefined"!==typeof d&&null!==d&&d.Qb()}};
Lb.prototype.destroy=function(){this.i=null;n.prototype.destroy.call(this)};function Ec(a,b){this.i=a;this.j=b;this.ta="";this.c=this.f=null;n.call(this,"Action");a=this.j;this.R=a.uid;this.ta=a.target;this.f="undefined"!==typeof a.method?a.method:null;this.c="undefined"!==typeof a.property?a.property:null;aa(this)}Ec.prototype=Object.create(n.prototype);Ec.prototype.constructor=Ec;var Fc={Gf:"set",eh:"add",Ci:"substract",ri:"multiply",kh:"divide",Di:"toggle"};
function Gc(a,b){var d=null;if("undefined"===typeof b)d=window;else{var h=b,k=b;"object"===typeof b&&("string"===typeof b.identifier&&(h=b.identifier),"string"===typeof b.accessor&&(k=b.accessor));b=g.S.get(h);"undefined"!==typeof b&&null!==b&&(g.K.W(b,"Plugin")?d=b.instance:d=b);k=k.split(".");b=0;"viewer"===k[0].toLowerCase()&&(d=a.i,b=1);for(h=k.length;b<h;b++)"object"===typeof d[k[b]]&&(d=d[k[b]])}null===d&&a.warn("The target of the action "+a.R+" is invalid.");return d}
Ec.prototype.Qb=function(){var a=Gc(this,this.ta);if(null!==a){if(this.c){var b=this.c;if("undefined"!==typeof a[b.name])switch("undefined"===typeof b.operation&&(b.operation=Fc.Gf),b.operation){case Fc.Gf:a[b.name]=b.value;break;case Fc.eh:a[b.name]+=b.value;break;case Fc.Ci:a[b.name]-=b.value;break;case Fc.ri:a[b.name]*=b.value;break;case Fc.kh:a[b.name]/=b.value;break;case Fc.Di:a[b.name]=!a[b.name]}}if(this.f&&(b=this.f,"function"===typeof a[b.name])){var d="undefined"!==typeof b.args?b.args:
null;Array.isArray(d)||(d=[d]);a[b.name].apply(a,d)}}};Ec.prototype.destroy=function(){this.i=null;n.prototype.destroy.call(this)};Object.defineProperty(Ec.prototype,"target",{get:function(){return Gc(this,this.ta)}});Object.defineProperty(Ec.prototype,"count",{get:function(){return 0}});function na(a){this.i=a;this.c=[];n.call(this,"ActionManager")}na.prototype=Object.create(n.prototype);na.prototype.constructor=na;na.prototype.get=function(a){return g.S.get(a,"Action")};
na.prototype.ma=function(a){var b;if(!0===Array.isArray(a))for(var d=0,h=a.length;d<h;d++)b=new Ec(this.i,a[d]),this.c.push(b);else b=new Ec(this.i,a),this.c.push(b)};na.prototype.destroy=function(){if(g.K.Pa(this.c,"Action"))for(;0<this.c.length;)this.c.pop().destroy()};
function P(a,b,d,h){this.i=a;this.G=b;this.I=d;this.B=this.M=null;this.$=h;this.c=this.j=this.J=this.L=null;this.U=!1;this.C=this.H=this.D=this.f=this.m=null;this.P=this.Z=!0;this.u=this.o=null;n.call(this,"Plugin");this.R=this.I.uid;this.jb=this.I.tags;aa(this);this.C={}}P.prototype=Object.create(n.prototype);e=P.prototype;e.constructor=P;
function Hc(a){a.B=g.K.pb(a.G.defaultConfig,a.I,a.M);a.L=a.B.options;a.xb=a.B.data;a.J=a.B.actions;for(var b in a.j)a.j[b].destroy(),a.j[b]=null;b=a.B.events;a.j={};var d,h;for(h in b)d=new Lb(a.i),d.c(b[h]),a.j[h]=d}e.mk=function(){!0===this.G.loaded?Ic(this):this.G.onLoadComplete.ga(this.wm,this)};e.wm=function(){Ic(this)};
function Ic(a){a.log("Plugin._instantiatePlugin(); "+a.R);var b=a.I;"string"===typeof b.parent&&(a.m=b.parent);a.Z="boolean"===typeof b.keep?b.keep:!0;a.P="boolean"===typeof b.reset?b.reset:!0;a.H||!0!==g.K.Pa(b.scenes,"string")||(a.H=b.scenes);Hc(a);a.c=a.G.Uj(a);a.c.boot.call(a.c);a.o&&a.o.F()}e.lo=function(){this.U=!0;this.u&&this.u.F()};e.update=function(){this.c&&"function"===typeof this.c.update&&this.c.update.call(this.c)};
e.Ek=function(){Hc(this);this.c&&("function"===typeof this.c.reset?this.c.reset.call(this.c):this.warn("There is no reset function on plugin "+this.G.uid))};
e.destroy=function(){if(!1!==this.yb){this.c&&(this.c.viewer=null,this.c.plugin=null,this.c.destroy(),this.c=null);this.D&&(this.D.destroy(),this.D=null);this.f&&(this.f.destroy(),this.f=null);this.o&&(this.o.destroy(),this.o=null);this.u&&(this.u.destroy(),this.u=null);for(var a=this.j.length;a--;)this.j[a].destroy();this.C=this.i=this.j=null;n.prototype.destroy.call(this)}};Object.defineProperty(P.prototype,"fullUrl",{get:function(){return this.G.fullUrl}});
Object.defineProperty(P.prototype,"options",{get:function(){return this.L}});Object.defineProperty(P.prototype,"actions",{get:function(){return this.J}});Object.defineProperty(P.prototype,"events",{get:function(){return this.j}});Object.defineProperty(P.prototype,"scenes",{get:function(){return this.H}});Object.defineProperty(P.prototype,"persistentData",{get:function(){return this.C},set:function(a){this.C=a}});Object.defineProperty(P.prototype,"instance",{get:function(){return this.c}});
Object.defineProperty(P.prototype,"instanceReady",{get:function(){return this.U}});Object.defineProperty(P.prototype,"container",{get:function(){if(!this.f){if("string"===typeof this.m&&""!==this.m){this.m=document.getElementById(this.m);if("undefined"===typeof this.m||!this.m||!1===g.ka.sg(this.m))throw"FORGE.Plugin.boot : Plugin parent is invalid";this.f=new v(this.i,null,null,this.m)}else this.f=new v(this.i),this.i.pluginContainer.mc(this.f),this.f.Sb(!0);this.f.id=this.R;this.f.index=this.$}return this.f}});
Object.defineProperty(P.prototype,"create",{get:function(){this.D||(this.D=new Q(this.i,this));return this.D}});Object.defineProperty(P.prototype,"keep",{get:function(){return this.Z}});Object.defineProperty(P.prototype,"reset",{get:function(){return this.P}});Object.defineProperty(P.prototype,"contextualConfig",{get:function(){return this.M},set:function(a){this.M=a}});Object.defineProperty(P.prototype,"instanceConfig",{get:function(){return this.I}});Object.defineProperty(P.prototype,"config",{get:function(){return this.B}});
Object.defineProperty(P.prototype,"onInstanceCreate",{get:function(){this.o||(this.o=new q(this,!0));return this.o}});Object.defineProperty(P.prototype,"onInstanceReady",{get:function(){this.u||(this.u=new q(this,!0));return this.u}});function Jc(a){n.call(this,"PluginEngine");this.i=a;this.D=null;this.o=this.P=this.j=this.L="";this.M=null;this.u="";this.B=null;this.H="";this.m=this.G=this.C=this.I=this.f=null;this.U=0;this.J=!1;this.c=null}Jc.prototype=Object.create(n.prototype);
Jc.prototype.constructor=Jc;var Kc=["boot","destroy"],Lc=["viewer","plugin"];e=Jc.prototype;
e.load=function(a){if("undefined"!==typeof a){a=this.D=a;if("undefined"===typeof a.uid)throw"Can't load a plugin engine, missing id in config";this.R=a.uid;aa(this);this.L="string"===typeof a.prefix?a.prefix:this.i.plugins.prefix;if("undefined"===typeof a.url)throw"Can't load a plugin engine, missing url in config";this.j=a.url;this.o=this.L+this.j;this.P="string"===typeof a.manifest?a.manifest:"manifest.json";this.i.load.json(this.R,this.o+this.P,this.Hm,this);return!0}return!1};
e.Uj=function(a){for(var b=new this.f,d=0,h=Lc.length;d<h;d++)if("undefined"!==typeof b[Lc[d]])throw"FORGE.PluginEngine instance validation failed, "+Lc[d]+" is reserved";if(this.m)for(d=0,h=this.m.length;d<h;d++)if("function"!==typeof b[this.m[d]])throw"FORGE.PluginEngine instance validation failed, action "+this.m[d]+" is undefined on plugin "+this.H;b.i=this.i;b.kc=a;return b};
e.Hm=function(a){a=this.M=this.i.cache.get(C.JSON,a.key).data;if(this.R!==a.uid)throw"Plugin Engine UID doesn't match with manifest UID";var b=a.viewer,d="0.0.0",h="9.9.9";"undefined"!==typeof b&&("undefined"!==typeof b.min&&(d=b.min),"undefined"!==typeof b.max&&(h=b.max));for(var b=g.VERSION.split("."),d=d.split("."),h=h.split("."),k=0,l=0,p=0,r=Math.max(b.length,d.length,h.length)-1;0<=r;r--)"undefined"!==typeof b[r]&&(k=parseInt(b[r],10)),"undefined"!==typeof d[r]&&(l=parseInt(d[r],10)),"undefined"!==
typeof h[r]&&(p=parseInt(h[r],10));if(!1===(k<l||k>p?!1:!0))this.warn("Version compatibility check for plugin "+a.uid+" failed!"),this.warn(a.viewer);else{var u;a:{b=a.device;if("undefined"!==typeof b)for(u in b)if("undefined"===typeof g.A[u])this.warn("Unable to check plugin device compatibility for: "+u);else if(g.A[u]!==b[u]){u=!1;break a}u=!0}if(!1===u)this.warn("Device compatibility check for plugin "+a.uid+" failed!"),this.warn(a.device);else{"undefined"!==typeof a.options&&(this.C=a.options);
"undefined"!==typeof a.data&&(this.xb=a.data);"undefined"!==typeof a.actions&&(this.m=a.actions);"undefined"!==typeof a.events&&(this.G=a.events);this.u=a.name;this.B=a.sources;this.H=a.constructor;u=null;if("undefined"!==typeof a.i18n&&(u=a.i18n,"undefined"!==typeof u.locales))for(b=0,d=u.locales.length;b<d;b++)if(a=u.locales[b],"undefined"!==typeof a.files)for(k=0,l=a.files.length;k<l;k++)h=a.files[k],h.key=this.R+"-"+h.key,h.url=this.o+h.url;this.I=u;a=this.B;u=0;for(b=a.length;u<b;u++)d="http://"===
String(a[u]).substring(0,7)||"https://"===String(a[u]).substring(0,8)?a[u]:this.o+a[u],"css"===ya(d).extension?this.i.load.Bj(d,this.Pi,this):this.i.load.Lg(d,this.Pi,this)}}this.log("FORGE.Plugin._manifestLoadComplete();")};
e.Pi=function(){this.U++;if(this.U===this.B.length){var a;a:{a=this.H;if("string"===typeof a&&""!==a){a=a.split(".");for(var b=window,d=0,h=a.length;d<h;d++){if(d===a.length-1&&"function"===typeof b[a[d]]){a=b[a[d]];break a}if("object"===typeof b[a[d]])b=b[a[d]];else break}}a=null}this.f=a;!0===Mc(this)&&((a=this.I)&&this.i.i18n.ma(a),this.J=!0,this.c&&this.c.F())}};
function Mc(a){if(!a.f||"function"!==typeof a.f)throw"Plugin engine "+a.R+" can't find it's constructor";for(var b=0,d=Kc.length;b<d;b++)if("function"!==typeof a.f.prototype[Kc[b]])throw"FORGE.PluginEngine engine validation failed, missing required method "+Kc[b]+" on plugin engine "+a.u;Object.defineProperty(a.f.prototype,"viewer",{get:function(){return this.i}});Object.defineProperty(a.f.prototype,"plugin",{get:function(){return this.kc}});return!0}
e.destroy=function(){this.I=this.f=this.B=this.u=this.M=this.D=this.i=null;this.c&&(this.c.destroy(),this.c=null);n.prototype.destroy.call(this)};Object.defineProperty(Jc.prototype,"name",{get:function(){return this.u}});Object.defineProperty(Jc.prototype,"loaded",{get:function(){return this.J}});Object.defineProperty(Jc.prototype,"url",{get:function(){return this.j}});Object.defineProperty(Jc.prototype,"fullUrl",{get:function(){return this.o}});Object.defineProperty(Jc.prototype,"options",{get:function(){return this.C}});
Object.defineProperty(Jc.prototype,"actions",{get:function(){return this.m}});Object.defineProperty(Jc.prototype,"events",{get:function(){return this.G}});Object.defineProperty(Jc.prototype,"defaultConfig",{get:function(){return{data:this.xb,options:this.C,actions:this.m,events:this.G}}});Object.defineProperty(Jc.prototype,"onLoadComplete",{get:function(){this.c||(this.c=new q(this));return this.c}});
function B(a){n.call(this,"PluginManager");this.i=a;this.m=!0;this.u="";this.f=this.c=this.j=null}B.prototype=Object.create(n.prototype);e=B.prototype;e.constructor=B;
e.vl=function(a){a=a.data.uid;for(var b,d=this.c.size;d--;)b=this.c.get(d),(!1===b.keep||null!==b.scenes&&-1===b.scenes.indexOf(a))&&this.remove(b.uid);!0===this.m&&"undefined"!==typeof this.o&&(a=this.o,Nc(this,a.engines),Oc(this,a.instances),Pc(this,a.configurations));!0===this.m&&"undefined"!==typeof this.i.story.scene.config.plugins&&(a=this.i.story.scene.config.plugins,Nc(this,a.engines),Oc(this,a.instances),Pc(this,a.configurations));for(b=this.c.size;b--;)a=this.c.get(b),!0===a.reset&&a.Ek()};
function Nc(a,b){if("undefined"!==typeof b)for(var d=0,h=b.length;d<h;d++){var k=b[d];if("string"===typeof k.uid&&!1===g.S.hb(k.uid)){var l=new Jc(a.i);a.j.add(l);l.load(k)}}}
function Oc(a,b){if("undefined"!==typeof b)for(var d=0,h=b.length;d<h;d++){var k=!1!==b[d].enabled?!0:!1,l=a.ne(b[d].uid),p=a.i.story.sceneUid,r=g.K.Pa(b[d].scenes,"string")?b[d].scenes:[],p=0===r.length||""===p&&0===r.length||-1!==r.indexOf(p);if(!0===k&&!l&&!0===p){k=a;l=b[d];if("undefined"===typeof l.engine)throw"Can't create plugin instance, engineUid is undefined";a:{for(var p=k,r=l.engine,u,A=0,ob=p.j.size;A<ob;A++)if(u=p.j.get(A),u.uid===r){p=u;break a}p=null}if(!p)throw"Plugin Engine "+l.engine+
" doesn't exist";l=new P(k.i,p,l,"number"===typeof l.index?l.index:k.c.size);l.onInstanceCreate.ga(k.Qm,k);k.c.add(l);l.mk()}}}function Pc(a,b){if("undefined"!==typeof b)for(var d=0,h=b.length;d<h;d++){var k=!1!==b[d].enabled?!0:!1,l=a.ne(b[d].instance),p=null;!0===k&&(p=b[d]);l&&(l.contextualConfig=p)}}e.Qm=function(a){a=a.emitter;this.f&&this.f.F(a)};e.boot=function(){this.j=new Qc;this.c=new Qc;this.i.story.onSceneLoadStart.add(this.vl,this)};
e.ma=function(a){this.o=a;this.m="boolean"===typeof a.enabled?a.enabled:!0;this.u="string"===typeof a.prefix?a.prefix:"./plugins/"};e.ne=function(a){for(var b,d=0,h=this.c.size;d<h;d++)if(b=this.c.get(d),b.uid===a)return b;return null};e.Sj=function(a){a=this.c.get(a);return"undefined"!==typeof a?a:null};e.get=function(a){var b=null;"string"===typeof a?b=this.ne(a):"number"===typeof a&&(b=this.Sj(a));return b};e.remove=function(a){a=this.get(a);a.destroy();this.c.remove(a)};
e.update=function(){for(var a,b=0,d=this.c.size;b<d;b++)a=this.c.get(b),a.update()};e.render=function(){};e.destroy=function(){this.i=null;this.f&&(this.f.destroy(),this.f=null);for(var a=0,b=this.j.size;a<b;a++)this.j.get(a).destroy();this.j=null;a=0;for(b=this.c.size;a<b;a++)this.c.get(a).destroy();this.c=null;n.prototype.destroy.call(this)};Object.defineProperty(B.prototype,"all",{get:function(){return this.c}});Object.defineProperty(B.prototype,"enabled",{get:function(){return this.m}});
Object.defineProperty(B.prototype,"prefix",{get:function(){return this.u}});Object.defineProperty(B.prototype,"onInstanceCreate",{get:function(){this.f||(this.f=new q(this,!0));return this.f}});function Q(a,b){this.i=a;this.kc=b;this.ba=[];n.call(this,"PluginObjectFactory")}Q.prototype=Object.create(n.prototype);e=Q.prototype;e.constructor=Q;e.Ab=function(a){a:{for(var b=this.ba.length,d;b--;)if(d=this.ba[b],d===a.emitter){a=b;break a}a=-1}this.ba.splice(a,1)};
e.vo=function(a){a=new D(this.i,a);a.onDestroy.ga(this.Ab,this);this.ba.push(a);return a};e.wo=function(a){a=new S(this.i,a);a.onDestroy.ga(this.Ab,this);this.ba.push(a);return a};e.sound=function(a,b){a=new L(this.i,a,b);a.onDestroy.ga(this.Ab,this);this.ba.push(a);return a};e.Kn=function(a){a=new v(this.i,a);a.onDestroy.ga(this.Ab,this);this.ba.push(a);return a};e.xl=function(a){a=new T(this.i,a);a.onDestroy.ga(this.Ab,this);this.ba.push(a);return a};
e.image=function(a,b){var d=a;"string"===typeof a&&(d={key:null,url:a});d.key=this.kc.uid+"-"+d.key;!1!==b&&(d.url=this.kc.fullUrl+d.url);a=new H(this.i,d);a.onDestroy.ga(this.Ab,this);this.ba.push(a);return a};e.so=function(a,b){a.key=this.kc.uid+"-"+a.key;!1!==b&&(a.url=this.kc.fullUrl+a.url,a.frames=this.kc.fullUrl+a.frames);a=new Rc(this.i,a);a.onDestroy.ga(this.Ab,this);this.ba.push(a);return a};e.wl=function(a){a=new Sc(this.i,a);a.onDestroy.ga(this.Ab,this);this.ba.push(a);return a};
e.zl=function(a,b,d,h,k){var l;"undefined"!==typeof d&&d.toLowerCase()===g.nb.Pe?l=new I(this.i,a,b,h):l=new J(this.i,a,b,h,k);l.onDestroy.ga(this.Ab,this);this.ba.push(l);return l};e.canvas=function(){var a=new fa(this.i);a.onDestroy.ga(this.Ab,this);this.ba.push(a);return a};e.yl=function(a){a=new lb(this.i,a);a.onDestroy.ga(this.Ab,this);this.i.tween.add(a);this.ba.push(a);return a};e.Fj=function(){this.log("destroyAllObjects();");for(var a=this.ba.length;a--;)this.ba[a].destroy()};
e.destroy=function(){this.Fj();this.ba=this.kc=this.i=null;n.prototype.destroy.call(this)};
g.A=function(a){a=a();a.prototype=Object.create(null);a.prototype.constructor=a;a.prototype.om=function(){if(/Playstation Vita/.test(this.ea))this.rb="Playstation Vita",this.Tg=!0;else if(/Xbox/.test(this.ea))this.rb="Xbox",this.dh=!0;else if(/Kindle/.test(this.ea)||/\bKF[A-Z][A-Z]+/.test(this.ea)||/Silk.*Mobile Safari/.test(this.ea))this.rb="Kindle",this.vg=!0;else if(/Windows Phone/i.test(this.ea)||/IEMobile/i.test(this.ea))this.rb="Windows Phone",this.Me=!0,/Windows Phone (\d+)/.test(this.ea)&&
(this.oc=parseInt(RegExp.$1,10));else if(/Android/.test(this.ea))this.rb="Android",this.tj=!0,/Android ([\.\_\d]+)/.test(this.ea)&&(this.oc=parseInt(RegExp.$1,10));else if(/CrOS/.test(this.ea))this.rb="Chrome OS",this.ag=!0;else if(/iP[ao]d|iPhone/i.test(this.ea))this.rb="iOS",this.Xc=!0,/OS (\d+)/.test(navigator.appVersion)&&(this.oc=parseInt(RegExp.$1,10));else if(/(Linux|X11)/.test(this.ea))this.rb="Linux",this.wg=!0;else if(/Mac OS X/.test(this.ea))this.rb="Mac OS X",this.zg=!0,/Mac OS X (10[\.\_\d]+)/.test(this.ea)&&
(this.oc=parseInt(RegExp.$1,10));else if(/Windows/.test(this.ea)||/WPDesktop/i.test(this.ea))/WPDesktop/i.test(this.ea)?(this.rb="Windows Phone",this.Me=!0):(this.rb="Windows",this.bh=!0),/(Windows 10.0|Windows NT 10.0)/.test(this.ea)?this.oc=10:/(Windows 8.1|Windows NT 6.3)/.test(this.ea)||/(Windows 8|Windows NT 6.2)/.test(this.ea)?this.oc=8:/(Windows 7|Windows NT 6.1)/.test(this.ea)&&(this.oc=7)};a.prototype.fm=function(){this.yd="undefined"!==typeof document.documentMode;this.ke=!1===this.yd&&
!0===!!window.StyleMedia;this.ig="undefined"!==typeof window.InstallTrigger;this.opera=!0===!!window.opr||0<=this.ea.indexOf(" OPR/")||0<=this.ea.indexOf("Opera");this.Ig=0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor");this.chrome=!1===this.yd&&!1===this.ke&&!1===this.opera&&(!0===!!window.chrome||0<=this.ea.indexOf("CriOS"));if(this.ke)this.Bb="Edge",/Edge\/(\d+)/.test(this.ea)&&(this.ob=this.Hj=parseInt(RegExp.$1,10));else if(this.chrome)this.Bb="Chrome",/CriOS\/(\d+)/.test(this.ea)?
this.ob=this.bg=parseInt(RegExp.$1,10):/Chrome\/(\d+)/.test(this.ea)&&(this.ob=this.bg=parseInt(RegExp.$1,10));else if(this.ig)this.Bb="Firefox",/Firefox\D+(\d+)/.test(this.ea)&&(this.ob=this.Lj=parseInt(RegExp.$1,10));else if(this.vg)/Silk/.test(this.ea)&&(this.Bb="Silk",this.Ng=!0);else if(this.yd)this.Bb="Internet Explorer",/MSIE (\d+\.\d+);/.test(this.ea)?this.ob=this.rg=parseInt(RegExp.$1,10):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(this.ea)&&(this.ob=this.rg=parseInt(RegExp.$3,10));else if(this.opera)this.Bb=
"Opera",/OPR\/(\d+)/.test(this.ea)?this.ob=this.Ce=parseInt(RegExp.$1,10):0<=this.ea.indexOf("Opera/")?/Version\/(\d+)/.test(this.ea)&&(this.ob=this.Ce=parseInt(RegExp.$1,10)):/Opera (\d+)/.test(this.ea)&&(this.ob=this.Ce=parseInt(RegExp.$1,10));else if(this.Ig)this.Bb="Safari",/version\/(\d+(\.\d+)?)/i.test(this.ea)&&(this.ob=this.Gk=parseInt(RegExp.$1,10));else{var a=this.ea.match(/Android.*AppleWebKit\/([\d.]+)/);a&&537>a[1]&&(this.Bb="Android Stock",this.pk=!0,this.ob=this.uj=parseFloat(this.ea.slice(this.ea.indexOf("Android")+
8)))}navigator.o&&(this.Sk=!0);this.Dk="CSS1Compat"===document.compatMode?!1:!0};a.prototype.hm=function(){this.Fc=window.devicePixelRatio||1;this.kk=!0===this.Xc&&-1!==this.ea.toLowerCase().indexOf("iphone");this.lk=!0===this.Xc&&-1!==this.ea.toLowerCase().indexOf("ipod");this.qg=!0===this.Xc&&-1!==this.ea.toLowerCase().indexOf("ipad");this.Fk=2<=this.Fc&&!0===this.Xc;this.bh&&!this.Me||this.zg||this.wg&&!this.Ng||this.ag?this.Vc=!0:/Mobi/i.test(this.ea)&&!1===this.qg?this.ze=!0:this.Pg=!0;if(/TV/i.test(this.ea)||
!0===this.Tg||!0===this.dh||this.Vc&&/Windows NT/i.test(this.ea)&&/Touch/i.test(this.ea))this.zk=!0,this.Vc=this.Pg=this.ze=!1};a.prototype.qm=function(){var a=document.createElement("video");try{"function"===typeof a.canPlayType&&(a.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"")&&(this.Eg=!0),a.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,"")&&(this.Cg=this.mg=!0),a.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")&&(this.ah=!0),a.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,
"")&&(this.Ug=!0),a.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"")&&(this.pg=!0))}catch(d){}};a.prototype.dm=function(){this.Xf="undefined"!==typeof window.Audio;this.Wg="undefined"!==typeof window.AudioContext||"undefined"!==typeof window.webkitAudioContext;var a=document.createElement("audio");try{if("function"===typeof a.canPlayType){a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(this.Dg=!0);a.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(this.Ag=
!0);if(a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")||a.canPlayType("audio/opus;").replace(/^no$/,""))this.De=!0;a.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(this.Vg=!0);a.canPlayType("audio/aac;").replace(/^no$/,"")&&(this.Vf=!0);if(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/m4a;")||a.canPlayType("audio/aac;").replace(/^no$/,""))this.yg=!0;if(a.canPlayType("audio/x-mp4;")||a.canPlayType("audio/mp4;")||a.canPlayType("audio/aac;").replace(/^no$/,""))this.Bg=!0;
a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(this.Zg=this.$g=!0)}}catch(d){}};a.prototype.im=function(){this.Rg="undefined"!==typeof navigator.Rg||"undefined"!==typeof navigator.D||"undefined"!==typeof navigator.R||"undefined"!==typeof navigator.j;this.$f="function"===typeof navigator.getBattery};a.prototype.km=function(){this.canvas="undefined"!==typeof window.CanvasRenderingContext2D;if(!0===this.canvas){this.yj="function"===typeof document.createElement("canvas").getContext("2d").fillText;
var a=document.createElement("canvas").getContext("2d");a.rect(0,0,10,10);a.rect(2,2,6,6);this.zj=!1===a.isPointInPath(5,5,"evenodd")}try{this.localStorage="object"===typeof window.localStorage&&"function"===typeof window.localStorage.getItem}catch(h){this.localStorage=!1}this.wk="function"===typeof window.MediaSource;this.Ij="function"===typeof window.HTMLMediaElement&&"function"===typeof window.R&&"function"===typeof window.f&&"function"===typeof navigator.m;this.applicationCache="object"===typeof window.applicationCache;
this.addEventListener="function"===typeof window.addEventListener;this.raf="function"===typeof window.requestAnimationFrame||"function"===typeof window.webkitRequestAnimationFrame||"function"===typeof window.mozRequestAnimationFrame;try{var d=document.createElement("canvas");d.f=!1;this.Xg="function"===typeof d.getContext&&"undefined"!==typeof window.WebGLRenderingContext&&!(!d.getContext("webgl")&&!d.getContext("experimental-webgl"))}catch(h){this.Xg=!1}this.Yg="function"===typeof navigator.getVRDisplays?
!0:!1;this.JSON="object"===typeof window.JSON&&"function"===typeof window.JSON.parse&&"function"===typeof window.JSON.stringify;this.geolocation="object"===typeof navigator.geolocation;this.history="object"===typeof window.history&&"function"===typeof window.history.pushState;this.Kk="function"===typeof document.createElementNS&&"function"===typeof document.createElementNS("http://www.w3.org/2000/svg","svg").c;this.contextMenu="undefined"!==typeof document.documentElement.contextMenu&&"function"===
typeof window.HTMLMenuItemElement};a.prototype.jm=function(){this.rk=/^https/i.test(window.location.protocol);try{this.tg=window.self!==window.top}catch(b){this.tg=!0}};a.prototype.nm=function(){this.Mk="undefined"!==typeof window.ontouchstart||"undefined"!==typeof window.c&&document instanceof window.c||"number"===typeof navigator.c&&0<navigator.c||"number"===typeof navigator.msMaxTouchPoints&&0<navigator.msMaxTouchPoints;if("undefined"!==typeof window.j||"undefined"!==typeof window.m)this.Nk=!(!MouseEvent.f||
!MouseEvent.c);this.Rj="function"===typeof navigator.f||"function"===typeof navigator.B};a.prototype.lm=function(){for(var a="requestFullscreen requestFullScreen webkitRequestFullscreen webkitRequestFullScreen mozRequestFullScreen mozRequestFullscreen msRequestFullscreen msRequestFullScreen".split(" "),d="cancelFullscreen cancelFullScreen exitFullscreen exitFullScreen webkitCancelFullscreen webkitCancelFullScreen webkitExitFullscreen webkitExitFullScreen mozCancelFullscreen mozCancelFullScreen mozExitFullscreen mozExitFullScreen msCancelFullscreen msCancelFullScreen msExitFullscreen msExitFullScreen".split(" "),
h=document.createElement("div"),k=0,l=a.length;k<l;k++)if(h[a[k]]){this.requestFullscreen=a[k];break}a=0;for(h=d.length;a<h;a++)if(document[d[a]]){this.exitFullscreen=d[a];break}"function"===typeof window.Element&&Element.ALLOW_KEYBOARD_INPUT&&(this.Pj=!0);d=["fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement"];a=0;for(h=d.length;a<h;a++)if("undefined"!==typeof document[d[a]]){this.fullscreenElement=d[a];break}d=["fullscreenEnabled","mozFullScreenEnabled","webkitFullscreenEnabled",
"msFullscreenEnabled"];a=0;for(h=d.length;a<h;a++)if("undefined"!==typeof document[d[a]]){this.fullscreenEnabled=d[a];break}};a.prototype.em=function(){for(var a=["visibilitychange","mozvisibilitychange","webkitvisibilitychange","msvisibilitychange"],d=["hidden","mozHidden","webkitHidden","msHidden"],h=0,k=d.length;h<k;h++)if("undefined"!==typeof document[d[h]]){this.visibilityState=d[h];this.Sg=a[h];break}a=["orientation","mozOrientation","msOrientation"];d=0;for(h=a.length;d<h;d++)if("string"===
typeof screen[a[d]]){this.orientation=a[d];break}this.Hk="object"===typeof screen.orientation&&"string"===typeof screen.orientation.type&&"function"===typeof screen.orientation.lock;a=["lockOrientation","mozLockOrientation","msLockOrientation"];d=["unlockOrientation","mozUnlockOrientation","msUnlockOrientation"];h=0;for(k=a.length;h<k;h++)if("function"===typeof screen[a[h]]){this.tk=a[h];this.Ok=d[h];break}this.file="undefined"!==typeof window.File&&"undefined"!==typeof window.FileReader&&"undefined"!==
typeof window.FileList&&"undefined"!==typeof window.Blob;this.Kj="undefined"!==typeof window.requestFileSystem||"undefined"!==typeof window.webkitRequestFileSystem;this.Ck="undefined"!==typeof document.f||"undefined"!==typeof document.c||"undefined"!==typeof document.R};a.prototype.gm=function(){var a=document.createElement("a").style;a.cssText="pointer-events:auto";this.td="auto"===a.pointerEvents;a.cssText="background-color:rgba(150,255,150,.5)";this.Ej=-1<(""+a.backgroundColor).indexOf("rgba");
this.Dj="undefined"!==typeof a.animationName||"undefined"!==typeof a.webkitAnimationName||"undefined"!==typeof a.m||"undefined"!==typeof a.o;var a=document.createElement("p"),d,h={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(a,null);for(var k in h)"undefined"!==typeof a.style[k]&&(a.style[k]="translate3d(1px,1px,1px)",d=window.getComputedStyle(a).getPropertyValue(h[k]));document.body.removeChild(a);
this.Cj="undefined"!==typeof d&&0<d.length&&"none"!==d};a.prototype.um=function(a){null!==a.rotationRate&&"undefined"!==typeof a.rotationRate.alpha&&"undefined"!==typeof a.rotationRate.beta&&"undefined"!==typeof a.rotationRate.gamma&&(this.eg=!0);"undefined"!==typeof a.acceleration&&"undefined"!==typeof a.acceleration.x&&"undefined"!==typeof a.acceleration.y&&"undefined"!==typeof a.acceleration.z&&(this.dg=!0);this.Zi();"function"!==typeof this.Tc&&this.Mf()};a.prototype.vm=function(a){"undefined"!==
typeof a.alpha&&"undefined"!==typeof a.beta&&"undefined"!==typeof a.gamma&&(this.gg=!0);this.$i();"function"!==typeof this.Sc&&this.Mf()};a.prototype.Zi=function(){window.removeEventListener("devicemotion",this.Sc,!1);this.Sc=null};a.prototype.$i=function(){window.removeEventListener("deviceorientation",this.Tc,!1);this.Tc=null};a.prototype.mm=function(){this.cg="undefined"!==typeof window.DeviceMotionEvent;this.fg="undefined"!==typeof window.DeviceOrientationEvent;window.addEventListener("deviceorientation",
this.Tc,!1);window.addEventListener("devicemotion",this.Sc,!1)};a.prototype.pm=function(){var a=document.createElement("div");a.style.width="1in";a.style.height="1in";document.body.appendChild(a);this.Gj=a.offsetWidth;document.body.removeChild(a);this.ze?(this.Kg=Math.floor(Math.min(window.screen.width,window.screen.height)*this.Fc),this.Jg=Math.floor(Math.max(window.screen.width,window.screen.height)*this.Fc)):(this.Kg=Math.floor(Math.max(window.screen.width,window.screen.height)*this.Fc),this.Jg=
Math.floor(Math.min(window.screen.width,window.screen.height)*this.Fc))};a.prototype.cm=function(){this.ea=navigator.userAgent;this.language=navigator.languages&&navigator.languages[0]||navigator.language||navigator.u||"";this.om();this.fm();this.hm();this.dm();this.qm();this.im();this.km();this.jm();this.em();this.lm();this.nm();this.gm();this.Sc=this.um.bind(this);this.Tc=this.vm.bind(this);this.mm();this.pm();!1===this.cg&&!1===this.fg&&this.Mf()};a.prototype.Mf=function(){"function"===typeof this.Sc&&
this.Zi();"function"===typeof this.Tc&&this.$i();!0===this.eg&&!0===this.dg&&!0===this.gg&&(this.dk=!0);this.ready=!0;Object.freeze(g.A)};a.prototype.Hn=function(a){return"mp3"===a&&!0===this.Ag||"ogg"===a&&(!0===this.Dg||!0===this.De)||"m4a"===a&&!0===this.yg||"mp4"===a&&!0===this.Bg||"opus"===a&&!0===this.De||"wav"===a&&!0===this.Vg||"aac"===a&&!0===this.Vf||"webm"===a&&!0===this.$g||"weba"===a&&!0===this.Zg?!0:!1};a.prototype.In=function(a){if("webm"!==a||!0!==this.ah&&!0!==this.Ug)if("mp4"!==
a||!0!==this.Cg&&!0!==this.mg){if(("ogg"===a||"ogv"===a)&&!0===this.Eg||"mpeg"===a&&!0===this.pg)return!0}else return!0;else return!0;return!1};a.prototype.fo=function(){return navigator.getBattery().then(function(a){return this.$f&&!a.charging&&.2>=a.level}.bind(this),function(){return!1})};return new a}(function(){return function(){this.ready=!1;this.rb=this.language=this.ea="";this.oc=0;this.ig=this.Me=this.bh=this.zg=this.wg=this.Xc=this.ag=this.tj=this.vg=this.dh=this.Tg=!1;this.Lj=0;this.chrome=
!1;this.bg=0;this.yd=!1;this.rg=0;this.opera=!1;this.Ce=0;this.ke=!1;this.Hj=0;this.Ig=!1;this.Gk=0;this.Ng=!1;this.Bb="";this.ob=0;this.pk=this.Sk=!1;this.uj=0;this.Dk=!1;this.fullscreenElement=this.exitFullscreen=this.requestFullscreen=this.fullscreenEnabled="";this.qg=this.lk=this.Fk=this.kk=this.Pj=!1;this.Fc=1;this.tg=this.rk=this.Kk=this.history=this.JSON=this.Ij=this.wk=this.contextMenu=this.Ck=this.geolocation=this.applicationCache=this.localStorage=this.Kj=this.file=this.Yg=this.Xg=this.raf=
this.addEventListener=this.yj=this.zj=this.canvas=this.pg=this.Ug=this.ah=this.Cg=this.mg=this.Eg=this.Zg=this.$g=this.Vf=this.Bg=this.yg=this.Vg=this.De=this.Ag=this.Dg=this.Wg=this.Xf=this.Nk=this.Rj=this.Mk=this.zk=this.ze=this.Pg=this.Vc=this.$f=this.Rg=!1;this.Sg=this.visibilityState="";this.gg=this.eg=this.dg=this.fg=this.cg=this.dk=this.Dj=this.td=this.Ej=this.Cj=!1;this.Tc=this.Sc=null;this.Jg=this.Kg=this.Gj=0;this.Hk=!1;this.Ok=this.tk=this.orientation="";this.cm()}});
function ia(a){this.i=a;this.m=!1;this.c=null;this.j=!1;this.f=null}e=ia.prototype;e.constructor=ia;e.boot=function(){for(var a=["ms","moz","webkit","o"],b=0;b<a.length&&!window.requestAnimationFrame;b++)window.requestAnimationFrame=window[a[b]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[a[b]+"CancelAnimationFrame"];this.f=window};
e.start=function(a){this.f="undefined"!==typeof a&&(a===window||a instanceof VRDisplay)?a:window;this.j=!0;"undefined"===typeof this.f.requestAnimationFrame||"timeout"===this.i.config.update?(this.m=!0,this.c=function(){!0===this.j&&(this.i.update(0),this.R=window.setTimeout(this.c.bind(this),1E3/30))},this.R=window.setTimeout(this.c.bind(this),0)):(this.m=!1,this.c=function(a){!0===this.j&&(this.i.update(Math.floor(a)),this.R=window.requestAnimationFrame(this.c.bind(this)))},this.R=this.f.requestAnimationFrame(this.c.bind(this)))};
e.stop=function(){this.m?clearTimeout(this.R):(this.f.cancelAnimationFrame(this.R),this.R=null);this.j=!1};e.destroy=function(){this.stop();this.f=this.c=this.i=null};Object.defineProperty(ia.prototype,"running",{get:function(){return this.j}});function ka(a){this.i=a;this.c=!0;n.call(this,"History")}ka.prototype=Object.create(n.prototype);e=ka.prototype;e.constructor=ka;
e.Ch=function(){this.log("_addState");var a=this.i.story.scene,b={viewer:{uid:this.i.uid},scene:{uid:a.uid},locale:this.i.i18n.locale},d=window.history.state;null===d?window.history.replaceState(b,a.name,Tc(a)):d.scene.uid!==b.scene.uid&&window.history.pushState(b,a.name,Tc(a))};
e.Bh=function(){this.log("_updateState");var a=window.history.state,b;a?(b="undefined"!==typeof a.scene&&"string"===typeof a.scene.uid,b=!0===("undefined"!==typeof a.viewer&&"string"===typeof a.viewer.uid)&&!0===b):b=!1;b&&(b=g.S.get(a.scene.uid),a.locale=this.i.i18n.locale,window.history.replaceState(a,b.name,Tc(b)))};function Tc(a){return"#"+a.slug+"&uid="+a.uid}e.Si=function(a){if(null!==a.state){var b=g.S.get(a.state.viewer.uid);b.history.log("_onPopStateHandler");b.story.scene=a.state.scene.uid}};
e.ma=function(a){this.c="boolean"===typeof a.enabled?a.enabled:!0;!0===this.c&&(this.i.story.onSceneLoadStart.add(this.Ch,this),this.i.i18n.onLocaleChangeComplete.add(this.Bh,this),window.addEventListener("popstate",this.Si,!1))};e.destroy=function(){this.i.story.onSceneLoadStart.remove(this.Ch,this);this.i.i18n.onLocaleChangeComplete.remove(this.Bh,this);window.removeEventListener("popstate",this.Si,!1);this.i=null;n.prototype.destroy.call(this)};Object.defineProperty(ka.prototype,"enabled",{get:function(){return this.c}});
function q(a,b){this.o=a;this.j=b||!1;this.c=this.m=null;this.f=!0;n.call(this,"EventDispatcher")}q.prototype=Object.create(n.prototype);e=q.prototype;e.constructor=q;
function Uc(a,b,d,h,k){if("function"!==typeof b)a.warn("You're trying to add an undefined listener");else if(!0===a.has(b,h))a.warn("You're trying to add a duplicate listener for this context");else{b=new Vc(a,b,d,h,k);a.c||(a.c=[]);if(a.c.length){d=a.c.length;do d--;while(a.c[d]&&b.Uf<=a.c[d].Uf);a.c.splice(d+1,0,b)}else a.c.push(b);!0===a.j&&!0===a.f&&null!==a.m&&b.Qb(a.m)}}
function Wc(a,b,d){if(!a.c)return-1;"undefined"===typeof d&&(d=null);for(var h,k=0,l=a.c.length;k<l;k++)if(h=a.c[k],h.listener===b&&h.context===d)return k;return-1}e.add=function(a,b,d){Uc(this,a,!1,b,d)};e.ga=function(a,b,d){Uc(this,a,!0,b,d)};e.remove=function(a,b){a=Wc(this,a,b);-1!==a&&(this.c[a].destroy(),this.c.splice(a,1))};e.has=function(a,b){return-1!==Wc(this,a,b)};
e.F=function(a,b){!0===this.j&&(this.m=void 0===a?null:a);if(!1!==this.f&&this.c)for(var d=this.c.length;d--;)this.c[d].Qb(a,b)};e.destroy=function(){if(!1!==this.yb){if(this.c){for(var a=this.c.length;a--;)this.c[a].destroy();this.c=null}this.m=this.o=null;n.prototype.destroy.call(this)}};Object.defineProperty(q.prototype,"emitter",{get:function(){return this.o}});Object.defineProperty(q.prototype,"memorize",{get:function(){return this.j},set:function(a){this.j=!!a}});
Object.defineProperty(q.prototype,"active",{get:function(){return this.f},set:function(a){this.f=!!a}});function Xc(a,b){this.f=a;this.c=b||null}Xc.prototype.constructor=Xc;Object.defineProperty(Xc.prototype,"emitter",{get:function(){return this.f}});Object.defineProperty(Xc.prototype,"data",{get:function(){return this.c}});function Vc(a,b,d,h,k){this.j=a;this.c=b;this.f=h||null;this.o=d||!1;this.Uf=k||0;this.m=0;this.R=!1}e=Vc.prototype;e.constructor=Vc;
e.Ni=function(a){this.c.call(this.f,new Xc(this.j.emitter,a));this.m++;!0===this.o&&this.Fh();this.R=!1};e.Qb=function(a,b){this.c&&(!0===b&&!1===this.R?(this.R=!0,window.setTimeout(this.Ni.bind(this,a),0)):!0!==b&&this.Ni(a))};e.Fh=function(){return this.j.remove(this.c,this.f)};e.destroy=function(){this.f=this.c=this.j=null};Object.defineProperty(Vc.prototype,"listener",{get:function(){return this.c}});Object.defineProperty(Vc.prototype,"context",{get:function(){return this.f}});
Object.defineProperty(Vc.prototype,"priority",{get:function(){return this.Uf}});Object.defineProperty(Vc.prototype,"callCount",{get:function(){return this.m}});function ja(a){this.i=a;this.c=null;this.f=-1;this.o="";this.u=!0;this.j=this.m=null;n.call(this,"LocaleManager");this.log("FORGE.LocaleManager._boot();");this.c=new Qc}ja.prototype=Object.create(n.prototype);e=ja.prototype;e.constructor=ja;
e.ma=function(a){this.u="boolean"===typeof a.enabled?a.enabled:!0;"undefined"!==typeof a.auto&&!0===a.auto&&""!==g.A.language?this.o=g.A.language:"string"===typeof a["default"]&&(this.o=a["default"]);if(!1===this.u)this.warn("FORGE.LocaleManager: locale management is deactivated");else if("undefined"!==typeof a.locales){for(var b=!1,d=0,h=a.locales.length;d<h;d++){var k;k=a.locales[d];var l,p=Yc(this,k.uid);-1===p?(l=new Zc(this.i),l.f.add(this.Gm,this),p=this.c.add(l)-1):l=this.c.get(p);l.ma(k);
p===this.f||this.o.toLowerCase()===k.uid.toLowerCase()?(l.xg(),-1===this.f&&$c(this,p),k=!0):k=!1;!0===k&&(b=!0)}!1===b&&(-1===Yc(this,this.o)&&(this.o=a.locales[0].uid),$c(this,Yc(this,a.locales[0].uid)))}};function Yc(a,b){for(var d,h=0,k=a.c.size;h<k;h++)if(d=a.c.get(h),d.uid.toLowerCase()===b.toLowerCase())return h;return-1}
function $c(a,b){if(0>b||b>=a.c.size)throw"The locale you are trying to set doesn't exist";a.f===b?a.warn("FORGE.LocaleManager: You're trying to set a locale that is already the actual locale"):(a.f=b,a.m&&a.m.F(),a.c.get(a.f).xg())}e.Gm=function(){this.log("FORGE.LocaleManager._localeAllFilesLoaded();");this.j&&this.j.F()};
e.nc=function(a,b){if(-1===this.f)return this.warn("FORGE.LocaleManager: You trying to get a value with no locale selected!"),a;var d=this.c.get(this.f).nc(a,b),h=Yc(this,this.o);this.f!==h&&-1!==h&&d===a&&(d=this.c.get(h).nc(a,b));return d};e.Mb=function(a,b){if(-1===this.f)return!1;var d=this.c.get(this.f).Mb(a,b),h=Yc(this,this.o);this.f!==h&&-1!==h&&!1===d&&(d=this.c.get(h).Mb(a,b));return d};
e.destroy=function(){this.i=null;if(this.c){for(var a=0,b=this.c.size;a<b;a++)this.c.get(a).destroy();this.c=null}this.m&&(this.m.destroy(),this.m=null);this.j&&(this.j.destroy(),this.j=null);n.prototype.destroy.call(this)};Object.defineProperty(ja.prototype,"locale",{get:function(){return-1!==this.f?this.c.get(this.f).uid:""},set:function(a){var b;"number"===typeof a&&a<this.c.size?b=a:"string"===typeof a&&(b=Yc(this,a));$c(this,b)}});
Object.defineProperty(ja.prototype,"localeIndex",{get:function(){return this.f},set:function(a){"number"===typeof a&&a<this.c.size&&$c(this,a)}});Object.defineProperty(ja.prototype,"localeObject",{get:function(){return-1!==this.f?this.c.get(this.f):null}});Object.defineProperty(ja.prototype,"locales",{get:function(){for(var a=[],b=0,d=this.c.size;b<d;b++)a.push(this.c.get(b).uid);return a}});Object.defineProperty(ja.prototype,"onLocaleChangeRequest",{get:function(){this.m||(this.m=new q(this));return this.m}});
Object.defineProperty(ja.prototype,"onLocaleChangeComplete",{get:function(){this.j||(this.j=new q(this));return this.j}});function D(a,b,d,h){this.i=a;this.c=b;this.m=d;this.j=h;this.f=null;n.call(this,"LocaleString")}D.prototype=Object.create(n.prototype);D.prototype.constructor=D;D.prototype.destroy=function(){this.i=null;n.prototype.destroy.call(this)};Object.defineProperty(D.prototype,"key",{get:function(){return this.c},set:function(a){this.c=a}});
Object.defineProperty(D.prototype,"jsonKey",{get:function(){return this.m},set:function(a){this.m=a}});Object.defineProperty(D.prototype,"value",{get:function(){if(""===this.i.i18n.locale)return"undefined"!==typeof this.j?this.j:this.c;this.f=this.i.i18n.nc(this.c,this.m);this.f===this.c&&"undefined"!==typeof this.j&&(this.f=this.j);return this.f}});Object.defineProperty(D.prototype,"loaded",{get:function(){var a=this.i.i18n.nc(this.c,this.m);return"undefined"!==typeof a&&a!==this.c}});
function Zc(a){this.i=a;this.m="";this.f=this.j=this.c=null;n.call(this,"Locale");this.c=new Qc;this.j=new q(this);this.f=new q(this)}Zc.prototype=Object.create(n.prototype);e=Zc.prototype;e.constructor=Zc;
e.ma=function(a){"string"===typeof a.uid&&(this.R=a.uid);""===this.m&&"string"===typeof a.name&&(this.m=a.name);if("undefined"!==typeof a.files)for(var b,d=0,h=a.files.length;d<h;d++)b=a.files[d],null===ad(this,b.key)&&(b.Rb=!1,b.loaded=!1,this.c.add(b));this.log("Locale.addConfig(); number of files : "+this.c.size)};
e.xg=function(){if(!0===bd(this))return this.f.F(),!0;for(var a,b=0,d=this.c.size;b<d;b++)a=this.c.get(b),!1===a.Rb&&!1===a.loaded&&!1===a.Rb&&!1===a.loaded&&(a.Rb=!0,this.i.load.json(a.key,a.url,this.Em,this))};function ad(a,b){for(var d,h=0,k=a.c.size;h<k;h++)if(d=a.c.get(h),d.key===b)return d;return null}e.Em=function(a){a=ad(this,a.key);a.Rb=!1;a.loaded=!0;this.log("loadFileComplete(); "+a.key);this.j.F();!0===bd(this)&&this.f.F()};
function bd(a){for(var b,d=0,h=a.c.size;d<h;d++)if(b=a.c.get(d),!1===b.loaded)return!1;return!0}e.nc=function(a,b){for(var d,h=0,k=this.c.size;h<k;h++)if(d=this.c.get(h),!0===this.i.cache.has(C.JSON,d.key)&&("undefined"===typeof b||b===d.key)&&(d=this.i.cache.get(C.JSON,d.key),"undefined"!==typeof d.data[a]))return d.data[a];"undefined"!==typeof b&&(this.warn("FORGE.Locale: value not found into the specified JSON file, try to find it in all files."),this.nc(a));return a};
e.Mb=function(a,b){for(var d,h=0,k=this.c.size;h<k;h++)if(d=this.c.get(h),!0===this.i.cache.has(C.JSON,d.key)&&("undefined"===typeof b||b===d.key)&&(d=this.i.cache.get(C.JSON,d.key),"undefined"!==typeof d.data[a]))return!0;"undefined"!==typeof b&&(this.warn("FORGE.Locale: key not found into the specified JSON file, try to find it in all files."),this.Mb(a));return!1};
e.Gh=function(a,b){for(var d,h=0,k=this.c.size;h<k;h++)if(d=this.c.get(h),!0===this.i.cache.has(C.JSON,d.key)&&("undefined"===typeof b||b===d.key)){d=this.i.cache.get(C.JSON,d.key);for(var l in d.data)if(d.data[l]===a)return l}"undefined"!==typeof b&&(this.warn("FORGE.Locale: value not found into the specified JSON file, try to find it in all files."),this.Gh(a))};e.destroy=function(){this.c=this.i=null;this.j.destroy();this.j=null;this.f.destroy();this.f=null;n.prototype.destroy.call(this)};
Object.defineProperty(Zc.prototype,"name",{get:function(){return this.m}});function qa(a){this.i=a;this.j=!0;this.o=this.m=this.f=this.c=null;n.call(this,"Keyboard");this.c=[];this.f=[];this.m=this.Bm.bind(this);this.o=this.Cm.bind(this);window.addEventListener("keydown",this.m,!1);window.addEventListener("keyup",this.o,!1)}qa.prototype=Object.create(n.prototype);e=qa.prototype;e.constructor=qa;
e.Bm=function(a){if(!1!==this.j){var b=a.keyCode;this.log("keyDown "+b);-1===this.f.indexOf(b)?(this.f.push(b),b=!0):b=!1;!0===b&&cd(this,a)}};
e.Cm=function(a){if(!1!==this.j){var b=a.keyCode;this.log("keyUp "+b);b=this.f.indexOf(b);-1!==b?(this.f.splice(b,1),b=!0):b=!1;if(!0===b)a:if(b=a.keyCode,!0!==this.ug(b))for(var b=this.kg(b),d,h=0,k=b.length;h<k;h++){d=b[h];for(var l=0,p=this.f.length;l<p;l++)if(d.se(this.f[l]))break a;d.Pk(a);l=0;for(p=this.f.length;l<p;l++)if(d.ng(this.f[l])){var r=new KeyboardEvent("keydown",{Eo:this.f[l],ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey});cd(this,r)}}}};
function dd(a,b){if(!a.c||!a.c.length)return-1;if("object"===typeof b&&"KeyBinding"===b.type)return a.c.indexOf(b);if("number"===typeof b)for(var d=0,h=a.c.length;d<h;d++)if(!0===a.c[d].se(b))return d;return-1}function cd(a,b){var d=b.keyCode;if(!0!==a.ug(d)){a=a.kg(d);for(var h=0,k=a.length;h<k;h++)d=a[h],!1===d.pressed&&d.Eh(b)}}e.update=function(){for(var a,b=0,d=this.c.length;b<d;b++)if(a=this.c[b],!0===a.pressed){if(!0===a.hasToWaitToHold&&!1===a.downComplete)break;a.jk()}};
e.eo=function(a){return-1!==this.f.indexOf(a)};e.ug=function(a){for(var b,d=0,h=this.c.length;d<h;d++)if(b=this.c[d],!0===b.pressed&&!0===b.ng(a))return!0;return!1};e.Wf=function(a){if("object"!==typeof a&&"KeyBinding"!==a.type)return!1;if(-1===dd(this,a))return this.c.push(a),!0;this.warn("Trying to add a duplicate key binding on keyboard!");return!1};e.He=function(a){a=dd(this,a);return-1!==a?(this.c[a].destroy(),this.c.splice(a,1),!0):!1};e.Un=function(a){return-1!==dd(this,a)};
e.kg=function(a){for(var b=[],d=0,h=this.c.length;d<h;d++)!0===this.c[d].se(a)&&b.push(this.c[d]);return b};e.destroy=function(){this.i=null;window.removeEventListener("keydown",this.m,!1);window.removeEventListener("keyup",this.o,!1);for(var a=this.c.length;a--;)this.He(this.c[a]);this.o=this.m=this.c=null;n.prototype.destroy.call(this)};Object.defineProperty(qa.prototype,"enabled",{get:function(){return this.j},set:function(a){this.j=!!a}});
function M(a,b,d,h,k,l,p,r){this.i=a;this.G=b||[];this.o=d||null;this.D=h||null;this.u=k||null;this.B=l||null;this.f=p||this;this.J=r||"";this.Of=this.I=this.M=!1;this.H=this.C=this.pd=0;this.m=this.j=this.c=null;n.call(this,"KeyBinding");if(!0===g.K.W(this.o,"string")||g.K.Pa(this.o,"string"))this.c=new Lb(this.i),this.c.c(this.o);if(!0===g.K.W(this.u,"string")||g.K.Pa(this.u,"string"))this.j=new Lb(this.i),this.j.c(this.u);if(!0===g.K.W(this.D,"string")||g.K.Pa(this.D,"string"))this.m=new Lb(this.i),
this.m.c(this.D)}M.prototype=Object.create(n.prototype);e=M.prototype;e.constructor=M;e.se=function(a){return"number"===typeof this.G&&this.G===a?!0:"function"===typeof this.G.indexOf?-1!==this.G.indexOf(a):!1};e.ng=function(a){if(null!==this.B){if("number"===typeof this.B&&this.B===a)return!0;if("function"===typeof this.B.indexOf)return-1!==this.B.indexOf(a)}return!1};e.Eh=function(a){this.log("down");this.pd++;this.I=!0;"function"===typeof this.o?this.o.call(this.f,this,a):this.c&&this.c.F()};
e.zo=function(){this.M=!0;var a=this.pd;return function(){this.log("downCompleteCallback "+a+" "+this.pd);a===this.pd&&(this.Of=!0)}.bind(this)};e.Pk=function(a){this.log("up");this.H++;this.Of=this.I=!1;"function"===typeof this.D?this.D.call(this.f,this,a):this.m&&this.m.F()};e.jk=function(){this.log("hold");this.C++;"function"===typeof this.u?this.u.call(this.f,this):this.j&&this.j.F()};
e.destroy=function(){this.f=this.B=this.u=this.D=this.o=this.G=null;this.c&&(this.c.destroy(),this.c=null);this.j&&(this.j.destroy(),this.j=null);this.m&&(this.m.destroy(),this.m=null);n.prototype.destroy.call(this)};Object.defineProperty(M.prototype,"name",{get:function(){return this.J}});Object.defineProperty(M.prototype,"pressed",{get:function(){return this.I}});Object.defineProperty(M.prototype,"downCount",{get:function(){return this.pd}});Object.defineProperty(M.prototype,"upCount",{get:function(){return this.H}});
Object.defineProperty(M.prototype,"holdCount",{get:function(){return this.C}});Object.defineProperty(M.prototype,"hasToWaitToHold",{get:function(){return this.M}});Object.defineProperty(M.prototype,"downComplete",{get:function(){return this.Of}});function ed(a){this.f=this.N=a;this.L=!1;this.c=null;this.j="";this.G=this.J=null;this.M=this.C=this.I=!1;this.m=null;this.U=200;this.H=this.P=1;this.Z=g.X.LINEAR;this.D=this.u=this.B=this.o=null;n.call(this,"Drag");this.H=this.N.alpha}ed.prototype=Object.create(n.prototype);
e=ed.prototype;e.constructor=ed;function fd(a,b){a.f&&(a.f&&(a.f.pointer.onPanStart.remove(a.zh,a),a.f.pointer.onPanMove.remove(a.yh,a),a.f.pointer.onPanEnd.remove(a.xh,a)),a.f=null);a.f=b;a.f.pointer.enabled=!0;a.f.pointer.onPanStart.add(a.zh,a);a.f.pointer.onPanMove.add(a.yh,a);a.f.pointer.onPanEnd.add(a.xh,a)}
e.zh=function(a){this.log("_panStartHandler");var b=a.data;a=a.data.srcEvent;"undefined"!==typeof a.touches&&"object"===typeof a.touches[0]&&(a=a.touches[0]);if(b=!0!==this.M&&b.target===this.f.dom){if(this.c)var b=this.N.globalOffset,d=this.c.globalOffset,h=b.left+this.N.pixelWidth>d.left+this.c.innerWidth,k=b.top<d.top,l=b.top+this.N.pixelHeight>d.top+this.c.innerHeight,b=!0===b.left<d.left||!0===h||!0===k||!0===l?!1:!0;else b=!0;b=!1!==b}b&&(this.I=!0,this.J={x:this.N.x,y:this.N.y},this.N.top=
null,this.N.right=null,this.N.bottom=null,this.N.left=null,this.G={x:a.pageX,y:a.pageY},this.P=this.N.alpha,this.N.alpha=this.H,this.o&&this.o.F())};e.xh=function(){this.log("_panEndHandler");!0===this.I&&(this.I=!1,this.u&&this.u.F(),!0===this.C&&this.m?(this.M=!0,this.m.kf({x:this.J.x,y:this.J.y},this.U,this.Z).start()):this.N.alpha=this.P,this.G=this.J=null)};
e.yh=function(a){this.log("_panMoveHandler");if(!0===this.I){a=a.data.srcEvent;"undefined"!==typeof a.touches&&"object"===typeof a.touches[0]&&(a=a.touches[0]);var b={x:a.pageX,y:a.pageY};a=b.x-this.G.x;var d=b.y-this.G.y;this.G=b;if(this.c){var b=this.N.globalOffset,h=this.N.parent.globalOffset,k=this.c.globalOffset;if(""===this.j||"x"===this.j)b.left+a<k.left?(this.log("out left"),this.N.x=Math.abs(h.left-k.left)):b.left+a+this.N.pixelWidth>k.left+this.c.innerWidth?(this.log("out right"),this.N.x=
Math.abs(h.left-k.left)+this.c.innerWidth-this.N.pixelWidth):this.N.x+=a;if(""===this.j||"y"===this.j)b.top+d<k.top?(this.log("out top"),this.N.y=Math.abs(h.top-k.top)):b.top+d+this.N.pixelHeight>k.top+this.c.innerHeight?(this.log("out bottom"),this.N.y=Math.abs(h.top-k.top)+this.c.innerHeight-this.N.pixelHeight):this.N.y+=d}else{if(""===this.j||"x"===this.j)this.N.x+=a;if(""===this.j||"y"===this.j)this.N.y+=d}this.B&&this.B.F()}};
e.bj=function(){this.log("_revertCompleteHandler");this.M=!1;this.N.alpha=this.P;this.D&&this.D.F()};e.enable=function(){this.L=!0;fd(this,this.f)};e.Ah=function(){this.L=!1};e.destroy=function(){this.revert=!1;this.o&&(this.o.destroy(),this.o=null);this.B&&(this.B.destroy(),this.B=null);this.u&&(this.u.destroy(),this.u=null);this.D&&(this.D.destroy(),this.D=null);this.G=this.c=this.N=this.f=null;n.prototype.destroy.call(this)};
Object.defineProperty(ed.prototype,"enabled",{get:function(){return this.L},set:function(a){!0===!!a?this.enable():this.Ah()}});Object.defineProperty(ed.prototype,"dragging",{get:function(){return this.I}});Object.defineProperty(ed.prototype,"handle",{get:function(){return this.f},set:function(a){fd(this,a)}});Object.defineProperty(ed.prototype,"constrain",{get:function(){return this.c},set:function(a){this.c=a}});
Object.defineProperty(ed.prototype,"progress",{get:function(){if(this.c){var a=this.N.globalOffset,b=this.c.globalOffset;return{x:(a.left-b.left)/(this.c.innerWidth-this.N.pixelWidth),y:(a.top-b.top)/(this.c.innerHeight-this.N.pixelHeight)}}}});Object.defineProperty(ed.prototype,"axis",{get:function(){return this.j},set:function(a){"x"===a||"y"===a?this.j=a:this.j=""}});Object.defineProperty(ed.prototype,"alpha",{get:function(){return this.H},set:function(a){"number"===typeof a&&(this.H=a)}});
Object.defineProperty(ed.prototype,"reverting",{get:function(){return this.M}});Object.defineProperty(ed.prototype,"revert",{get:function(){return this.C},set:function(a){this.C=!!a;!0!==this.C||this.m?!1===this.C&&this.m&&(this.N.viewer.tween.remove(this.m),this.m.onComplete.remove(this.bj,this),this.m.destroy(),this.m=null):(this.m=new lb(this.N.viewer,this.N),this.m.onComplete.add(this.bj,this),this.N.viewer.tween.add(this.m))}});
Object.defineProperty(ed.prototype,"revertDuration",{get:function(){return this.U},set:function(a){"number"===typeof a&&(this.U=a)}});Object.defineProperty(ed.prototype,"revertEasing",{get:function(){return this.Z},set:function(a){"function"===typeof a&&(this.Z=a)}});Object.defineProperty(ed.prototype,"onStart",{get:function(){this.o||(this.o=new q(this.N));return this.o}});Object.defineProperty(ed.prototype,"onDrag",{get:function(){this.B||(this.B=new q(this.N));return this.B}});
Object.defineProperty(ed.prototype,"onStop",{get:function(){this.u||(this.u=new q(this.N));return this.u}});Object.defineProperty(ed.prototype,"onRevert",{get:function(){this.D||(this.D=new q(this.N));return this.D}});
function U(a){this.N=a;this.c=!1;this.da=gd.DEFAULT;this.gb=null;this.Od=[];this.T=this.f=this.j=this.m=this.B=this.u=this.$=this.P=this.U=this.Z=this.C=this.H=this.M=this.D=this.G=this.I=this.J=this.L=this.o=this.O=this.fa=this.V=this.Da=this.Ca=this.ra=this.sa=this.Ba=this.Aa=this.aa=null;n.call(this,"Pointer");this.gb=new Hammer.Manager(this.N.dom);this.gb.set({enable:!1})}U.prototype=Object.create(n.prototype);e=U.prototype;e.constructor=U;
function hd(a,b,d,h){for(var k,l=0,p=a.Od.length;l<p;l++)if(k=a.Od[l],k.event===b&&k.Gn===d&&k.type===h)return l;return-1}function id(a,b,d,h){if(-1===hd(a,b,d,h))if(a.Od.push({event:b,Gn:d,type:h}),h===V.bb)a.N.dom.addEventListener(b,Hammer.bindFn(d,a));else if(h===V.oa)a.gb.on(b,Hammer.bindFn(d,a))}function jd(a,b,d){return function(){var h=hd(this,a,b,d);-1!==h&&(this.Od.splice(h,1),d===V.bb?this.N.dom.removeEventListener(a,b):d===V.oa&&this.gb.off(a))}}e.kj=function(a){this.O&&!0===this.c&&this.O.F(a)};
e.Ji=function(a){this.o&&!0===this.c&&this.o.F(a)};e.Vh=function(a){this.L&&!0===this.c&&this.L.F(a)};e.Uh=function(a){this.J&&!0===this.c&&this.J.F(a)};e.Qh=function(a){this.I&&!0===this.c&&this.I.F(a)};e.Ph=function(a){this.G&&!0===this.c&&this.G.F(a)};e.Oh=function(a){this.D&&!0===this.c&&this.D.F(a)};e.Th=function(a){this.M&&!0===this.c&&this.M.F(a)};e.Sh=function(a){this.H&&!0===this.c&&this.H.F(a)};e.Rh=function(a){this.C&&!0===this.c&&this.C.F(a)};e.ej=function(a){this.Z&&!0===this.c&&this.Z.F(a)};
e.dj=function(a){this.U&&!0===this.c&&this.U.F(a)};e.cj=function(a){this.P&&!0===this.c&&this.P.F(a)};e.ij=function(a){this.$&&!0===this.c&&this.$.F(a)};e.Mi=function(a){this.u&&!0===this.c&&this.u.F(a)};e.Oi=function(a){this.B&&!0===this.c&&this.B.F(a)};e.Xi=function(a){this.m&&!0===this.c&&this.m.F(a)};e.Wi=function(a){this.j&&!0===this.c&&this.j.F(a)};e.Ri=function(a){this.f&&!0===this.c&&this.f.F(a)};e.Wh=function(a){this.T&&!0===this.c&&this.T.F(a)};
e.enable=function(){!0===g.A.td&&(this.N.dom.style.pointerEvents="auto");this.gb.set({enable:!0});this.aa||(this.aa=new Hammer.Tap,this.gb.add(this.aa));this.Aa||(this.Aa=(new Hammer.Tap({event:W.Md,Ho:2})).recognizeWith(this.aa),this.gb.add(this.Aa));this.Ba||(this.Ba=(new Hammer.Press).recognizeWith(this.aa),this.gb.add(this.Ba));this.sa||(this.sa=new Hammer.Pan,this.gb.add(this.sa));this.ra||(this.ra=new Hammer.Pinch,this.gb.add(this.ra));this.Ca||(this.Ca=(new Hammer.Rotate).recognizeWith(this.ra),
this.gb.add(this.Ca));this.Da||(this.Da=(new Hammer.Swipe).recognizeWith(this.sa),this.gb.add(this.Da));this.c=!0;this.V&&this.V.F()};e.ef=function(){!0===g.A.td&&(this.N.dom.style.pointerEvents="none");this.c=!1;this.gb.set({enable:!1});this.fa&&this.fa.F()};
e.destroy=function(){this.ef();this.Da=this.Ca=this.ra=this.sa=this.Ba=this.Aa=this.aa=null;this.V&&(this.V.destroy(),this.V=null);this.fa&&(this.fa.destroy(),this.fa=null);this.O&&(this.O.destroy(),this.O=null);this.o&&(this.o.destroy(),this.o=null);this.L&&(this.L.destroy(),this.L=null);this.J&&(this.J.destroy(),this.J=null);this.I&&(this.I.destroy(),this.I=null);this.G&&(this.G.destroy(),this.G=null);this.D&&(this.D.destroy(),this.D=null);this.M&&(this.M.destroy(),this.M=null);this.H&&(this.H.destroy(),
this.H=null);this.C&&(this.C.destroy(),this.C=null);this.Z&&(this.Z.destroy(),this.Z=null);this.U&&(this.U.destroy(),this.U=null);this.P&&(this.P.destroy(),this.P=null);this.$&&(this.$.destroy(),this.$=null);this.u&&(this.u.destroy(),this.u=null);this.B&&(this.B.destroy(),this.B=null);this.m&&(this.m.destroy(),this.m=null);this.j&&(this.j.destroy(),this.j=null);this.f&&(this.f.destroy(),this.f=null);this.T&&(this.T.destroy(),this.T=null);this.N=null;n.prototype.destroy.call(this)};
Object.defineProperty(U.prototype,"enabled",{get:function(){return this.c},set:function(a){!0===!!a?this.enable():this.ef()}});Object.defineProperty(U.prototype,"cursor",{get:function(){return this.da},set:function(a){this.N.dom.style.cursor=a;if(a!==this.N.dom.style.cursor||""===this.N.dom.style.cursor)this.N.dom.style.cursor="-webkit-"+a;this.da=a}});Object.defineProperty(U.prototype,"onEnable",{get:function(){this.V||(this.V=new q(this));return this.V}});
Object.defineProperty(U.prototype,"onDisable",{get:function(){this.fa||(this.fa=new q(this));return this.fa}});Object.defineProperty(U.prototype,"onTap",{get:function(){this.O||(this.O=new q(this.N),this.O.onDestroy.ga(jd(W.If,this.kj,V.oa),this),id(this,W.If,this.kj,V.oa));return this.O}});Object.defineProperty(U.prototype,"onClick",{get:function(){return this.onTap}});
Object.defineProperty(U.prototype,"onDoubleTap",{get:function(){this.o||(this.o=new q(this.N),this.o.onDestroy.ga(jd(W.Md,this.Ji,V.oa),this),id(this,W.Md,this.Ji,V.oa));return this.o}});Object.defineProperty(U.prototype,"onDoubleClick",{get:function(){return this.onDoubleTap}});Object.defineProperty(U.prototype,"onPressStart",{get:function(){this.L||(this.L=new q(this.N),this.L.onDestroy.ga(jd(W.Cf,this.Vh,V.oa),this),id(this,W.Cf,this.Vh,V.oa));return this.L}});
Object.defineProperty(U.prototype,"onDown",{get:function(){return this.onPressStart}});Object.defineProperty(U.prototype,"onPressEnd",{get:function(){this.J||(this.J=new q(this.N),this.J.onDestroy.ga(jd(W.Bf,this.Uh,V.oa),this),id(this,W.Bf,this.Uh,V.oa));return this.J}});Object.defineProperty(U.prototype,"onUp",{get:function(){return this.onPressEnd}});
Object.defineProperty(U.prototype,"onPanStart",{get:function(){this.I||(this.I=new q(this.N),this.I.onDestroy.ga(jd(W.wf,this.Qh,V.oa),this),id(this,W.wf,this.Qh,V.oa));return this.I}});Object.defineProperty(U.prototype,"onPanMove",{get:function(){this.G||(this.G=new q(this.N),this.G.onDestroy.ga(jd(W.vf,this.Ph,V.oa),this),id(this,W.vf,this.Ph,V.oa));return this.G}});
Object.defineProperty(U.prototype,"onPanEnd",{get:function(){this.D||(this.D=new q(this.N),this.D.onDestroy.ga(jd(W.uf,this.Oh,V.oa),this),id(this,W.uf,this.Oh,V.oa));return this.D}});Object.defineProperty(U.prototype,"onPinchStart",{get:function(){this.M||(this.M=new q(this.N),this.M.onDestroy.ga(jd(W.Af,this.Th,V.oa),this),id(this,W.Af,this.Th,V.oa));return this.M}});
Object.defineProperty(U.prototype,"onPinchMove",{get:function(){this.H||(this.H=new q(this.N),this.H.onDestroy.ga(jd(W.zf,this.Sh,V.oa),this),id(this,W.zf,this.Sh,V.oa));return this.H}});Object.defineProperty(U.prototype,"onPinchEnd",{get:function(){this.C||(this.C=new q(this.N),this.C.onDestroy.ga(jd(W.yf,this.Rh,V.oa),this),id(this,W.yf,this.Rh,V.oa));return this.C}});
Object.defineProperty(U.prototype,"onRotateStart",{get:function(){this.Z||(this.Z=new q(this.N),this.Z.onDestroy.ga(jd(W.Ff,this.ej,V.oa),this),id(this,W.Ff,this.ej,V.oa));return this.Z}});Object.defineProperty(U.prototype,"onRotateMove",{get:function(){this.U||(this.U=new q(this.N),this.U.onDestroy.ga(jd(W.Ef,this.dj,V.oa),this),id(this,W.Ef,this.dj,V.oa));return this.U}});
Object.defineProperty(U.prototype,"onRotateEnd",{get:function(){this.P||(this.P=new q(this.N),this.P.onDestroy.ga(jd(W.Df,this.cj,V.oa),this),id(this,W.Df,this.cj,V.oa));return this.P}});Object.defineProperty(U.prototype,"onSwipe",{get:function(){this.$||(this.$=new q(this.N),this.$.onDestroy.ga(jd(W.Hf,this.ij,V.oa),this),id(this,W.Hf,this.ij,V.oa));return this.$}});
Object.defineProperty(U.prototype,"onEnter",{get:function(){this.u||(this.u=new q(this.N),this.u.onDestroy.ga(jd(W.Re,this.Mi,V.bb),this),id(this,W.Re,this.Mi,V.bb));return this.u}});Object.defineProperty(U.prototype,"onLeave",{get:function(){this.B||(this.B=new q(this.N),this.B.onDestroy.ga(jd(W.sf,this.Oi,V.bb),this),id(this,W.sf,this.Oi,V.bb));return this.B}});
Object.defineProperty(U.prototype,"onOver",{get:function(){this.m||(this.m=new q(this.N),this.m.onDestroy.ga(jd(W.yc,this.Xi,V.bb),this),id(this,W.yc,this.Xi,V.bb));return this.m}});Object.defineProperty(U.prototype,"onOut",{get:function(){this.j||(this.j=new q(this.N),this.j.onDestroy.ga(jd(W.Nb,this.Wi,V.bb),this),id(this,W.Nb,this.Wi,V.bb));return this.j}});
Object.defineProperty(U.prototype,"onMove",{get:function(){this.f||(this.f=new q(this.N),this.f.onDestroy.ga(jd(W.tf,this.Ri,V.bb),this),id(this,W.tf,this.Ri,V.bb));return this.f}});Object.defineProperty(U.prototype,"onWheel",{get:function(){this.T||(this.T=new q(this.N),this.T.onDestroy.ga(jd(W.Lf,this.Wh,V.bb),this),id(this,W.Lf,this.Wh,V.bb));return this.T}});
var V={bb:0,oa:1},W={If:"tap",Md:"doubletap",Cf:"press",Bf:"pressup",wf:"panstart",vf:"panmove",uf:"panend",Af:"pinchstart",zf:"pinchmove",yf:"pinchend",Ff:"rotatestart",Ef:"rotatemove",Df:"rotateend",Hf:"swipe",Re:"mouseenter",sf:"mouseleave",yc:"mouseover",Nb:"mouseout",tf:"mousemove",Lf:"wheel"},gd={DEFAULT:"default",kb:"pointer",Rl:"grab",Sl:"grabbing"};
function ea(a){this.i=a;this.ba=[];this.f=[];this.j=this.c=null;n.call(this,"DisplayList");this.c=this.xm.bind(this);document.addEventListener("fullscreenchange",this.c,!1);document.addEventListener("mozfullscreenchange",this.c,!1);document.addEventListener("webkitfullscreenchange",this.c,!1);document.addEventListener("MSFullscreenChange",this.c,!1)}ea.prototype=Object.create(n.prototype);e=ea.prototype;e.constructor=ea;
e.xm=function(){this.log("_fullScreenChangeHandler");if(null!==document[g.A.fullscreenElement])for(var a,b=this.ba.length;b--;){if(a=this.ba[b],a.dom===document[g.A.fullscreenElement]){a=this.j=a;a.log("_notifyFullscreenEnter");b=a;b.log("_fullscreenSaveData");b.Z={x:b.G,y:b.I,width:b.u,unitWidth:b.D,height:b.o,unitHeight:b.B,top:b.hc,right:b.Da,bottom:b.Yb,left:b.Aa};b.G=0;b.I=0;b.u=screen.width;b.D="px";b.c.style.width=b.u+"px";b.o=screen.height;b.B="px";b.c.style.height=b.o+"px";b.hc=null;b.Da=
null;b.Yb=null;b.Aa=null;b.c.style.top="0";b.c.style.left="0";b.za({property:"both"});a.ec&&a.ec.F();break}}else a=this.j,a.log("_notifyFullscreenChange"),a.log("_fullscreenRestoreData"),a.G=a.Z.x,a.c.style.left=a.G+"px",a.I=a.Z.y,a.c.style.top=a.I+"px",a.u=a.Z.width,a.D=a.Z.unitWidth,a.c.style.width=a.pixelWidth+"px",a.o=a.Z.height,a.B=a.Z.unitHeight,a.c.style.height=a.pixelHeight+"px",a.hc=a.Z.top,a.Da=a.Z.right,a.Yb=a.Z.bottom,a.Aa=a.Z.left,a.za({property:"both"}),a.Z=null,a.fc&&a.fc.F(),this.j=
null};e.register=function(a,b){this.ba.push(a);!0===b&&this.f.push(a)};e.unregister=function(a){this.ba.splice(this.ba.indexOf(a),1);a=this.f.indexOf(a);-1!==a&&this.f.splice(a,1)};e.update=function(){for(var a=0,b=this.f.length;a<b;a++)this.f[a].update()};
e.destroy=function(){for(var a=this.ba.length;a--;)this.ba[a].destroy();this.ba=[];this.f=[];document.removeEventListener("fullscreenchange",this.c,!1);document.removeEventListener("mozfullscreenchange",this.c,!1);document.removeEventListener("webkitfullscreenchange",this.c,!1);document.removeEventListener("MSFullscreenChange",this.c,!1);this.j=this.c=null};var kd="DisplayObject DisplayObjectContainer Image TextField Button Video Canvas Sprite Iframe".split(" ");
function T(a,b,d){this.i=a;this.c=b||null;this.m=null;this.ve=0;this.Qe="";this.I=this.G=0;this.$b=!1;this.u=0;this.D="px";this.ra=1;this.o=0;this.B="px";this.sa=1;this.Rc=this.Pc=!1;this.Aa=this.Yb=this.Da=this.hc=null;this.ue=1;this.xe=0;this.Oc=this.Qc=null;this.jd="";this.ld="solid";this.P=0;this.kd="rgb(0, 0, 0)";this.Fe=0;this.U=!1;this.Hd="";this.xb=null;this.we=!1;this.$=!0;this.Ca=null;this.fa=!1;this.fc=this.ec=this.ad=this.xd=this.ac=this.bc=this.M=this.dc=this.gc=this.Ba=this.Z=null;n.call(this,
d||"DisplayObject");this.La()}T.prototype=Object.create(n.prototype);e=T.prototype;e.constructor=T;
e.La=function(){!0!==this.we&&("undefined"!==typeof this.c&&this.c?(this.u=g.ka.ck(this.c),this.D=g.ka.ak(this.c),this.o=g.ka.bk(this.c),this.B=g.ka.$j(this.c)):this.c=document.createElement("div"),this.c.style.width=this.u+""+this.D,this.c.style.height=this.o+""+this.B,this.c.style.display="block",this.c.style.position="relative",this.c.style.margin="0px",this.c.style.padding="0px",this.c.style.top=this.I+"px",this.c.style.left=this.G+"px",this.c.style.overflow="hidden",this.c.style.boxSizing="border-box",
!0===g.A.td&&(this.c.style.pointerEvents="none"),this.c.style.R="none",this.c.style.webkitUserSelect="none",this.c.style.c="none",this.c.style.f="none",this.c.style.j="none",this.c.style.borderStyle=this.ld,this.c.style.borderWidth=this.P+"px",this.c.style.borderColor=this.kd,this.c.style.background=this.jd,this.Ca=[],"DisplayObject"===this.fb&&(this.i.display.register(this),ld(this),md(this)))};function ld(a){!0!==a.we&&(a.log("_notifyReady"),a.we=!0,a.Ba&&a.Ba.F())}
e.ae=function(){this.log("_notifyAddedToDom");this.ac&&this.ac.F()};e.zc=function(){this.log("_notifyShow");!1!==this.Ad()&&this.xd&&!0===this.visible&&this.xd.F()};e.be=function(){this.log("_notifyHide");this.ad&&!1===this.visible&&this.ad.F()};e.Rf=function(){this.dc&&this.dc.F()};e.za=function(a){nd(this);this.gc&&this.gc.F(a)};
function nd(a){a.m&&a.u&&a.o&&(a.log("_updateAnchors"),!0===a.Pc?a.horizontalCenter=!0:(a.left=a.Aa,a.right=a.Da),!0===a.Rc?a.verticalCenter=!0:(a.top=a.hc,a.bottom=a.Yb))}
function od(a,b){var d=-1!==b.toLowerCase().indexOf("height")||"both"===b;!0===(-1!==b.toLowerCase().indexOf("width")||"both"===b)&&"%"===a.D&&(a.c.style.width=a.pixelWidth+"px",a.c.width=a.pixelWidth,a.za({property:"width"}));!0===d&&"%"===a.B&&(a.c.style.height=a.pixelHeight+"px",a.c.height=a.pixelHeight,a.za({property:"height"}))}function pd(a,b,d){a.Ca.push({prop:b,value:d})}
function md(a){a.log("_applyPending");a.$=!1;if(a.Ca&&0!==a.Ca.length){a.fa=!0;for(var b=0,d=a.Ca.length;b<d;b++)a[a.Ca[b].prop]=a.Ca[b].value;a.fa=!1;a.Ca=[]}}e.wh=function(){this.c.style.display="block";this.zc()};e.ik=function(){this.c.style.display="none";this.be()};e.xo=function(){this.visible=!this.visible};
e.Sb=function(a){!0===a&&(this.U=!0,!0===this.$&&pd(this,"maximized",!0));this.m&&(this.$b=!1,a=this.pixelWidth,this.u=this.m.innerWidth,this.D="px",this.c.style.width=this.m.innerWidth+"px",this.c.width=this.m.innerWidth,a!==this.pixelWidth&&this.za({property:"width"}),a=this.pixelHeight,this.o=this.m.innerHeight,this.B="px",this.c.style.height=this.m.innerHeight+"px",this.c.height=this.m.innerHeight,a!==this.pixelHeight&&this.za({property:"height"}))};e.Ad=function(){return g.ka.has(this.c)};
e.vh=function(a,b){null!==a&&"undefined"!==typeof a&&(this.width=a);null!==b&&"undefined"!==typeof b&&(this.height=b)};e.Nj=function(){if(!0===document[g.A.fullscreenEnabled]&&!1===this.zd())this.c[g.A.requestFullscreen]()};e.Oj=function(){if(!0===document[g.A.fullscreenEnabled]&&!0===this.zd())document[g.A.exitFullscreen]()};e.zd=function(){return document[g.A.fullscreenElement]===this.c};
e.destroy=function(){!1!==this.yb&&(this.i.display.unregister(this),this.m&&(this.m.removeChild(this,!1),this.m=null),this.Qc&&(this.Qc.destroy(),this.Qc=null),this.Oc&&(this.Oc.destroy(),this.Oc=null),this.gc&&(this.gc.destroy(),this.gc=null),this.dc&&(this.dc.destroy(),this.dc=null),this.Ba&&(this.Ba.destroy(),this.Ba=null),this.bc&&(this.bc.destroy(),this.bc=null),this.ac&&(this.ac.destroy(),this.ac=null),this.ec&&(this.ec.destroy(),this.ec=null),this.fc&&(this.fc.destroy(),this.fc=null),this.i=
this.xb=this.c=null,n.prototype.destroy.call(this))};Object.defineProperty(T.prototype,"viewer",{get:function(){return this.i}});Object.defineProperty(T.prototype,"dom",{get:function(){return this.c}});Object.defineProperty(T.prototype,"id",{get:function(){return this.Qe},set:function(a){this.Qe=a;this.c.id=this.Qe}});Object.defineProperty(T.prototype,"ready",{get:function(){return this.we}});
Object.defineProperty(T.prototype,"parent",{get:function(){return this.m},set:function(a){"object"===typeof a&&!1!==Array.isArray(a.children)&&a!==this.m&&(this.m=a,this.c.style.position="absolute",!0===this.U&&this.Sb(this.U),od(this,"both"),nd(this),this.bc&&this.bc.F(),!0===this.m.Ad()&&(this.ae(),this.zc()))}});Object.defineProperty(T.prototype,"visible",{get:function(){return"block"===this.c.style.display},set:function(a){"boolean"===typeof a&&(!0===a?this.wh():this.ik())}});
Object.defineProperty(T.prototype,"x",{get:function(){return this.G},set:function(a){if("number"===typeof a){var b=this.G;this.G=a;this.c.style.left=this.G+"px";this.M&&b!==this.G&&this.M.F({property:"x"})}}});Object.defineProperty(T.prototype,"y",{get:function(){return this.I},set:function(a){if("number"===typeof a){var b=this.I;this.I=a;this.c.style.top=this.I+"px";this.M&&b!==this.I&&this.M.F({property:"y"})}}});
Object.defineProperty(T.prototype,"keepRatio",{get:function(){return this.$b},set:function(a){"boolean"===typeof a&&a!==this.$b&&(this.$b=a)}});
Object.defineProperty(T.prototype,"width",{get:function(){return this.u},set:function(a){var b=this.u,d=this.D;if("string"===typeof a){var h=g.K.Fg(a);if(null===h.value||null===h.Zc)throw"FORGE.DisplayObject.width value "+a+" is incorrect";this.D=h.Zc;this.u=h.value}else if("number"===typeof a)this.u=a;else return;!0===this.$?pd(this,"width",this.u):(this.U=!1,this.c.style.width=this.pixelWidth+"px",this.c.width=this.pixelWidth,b===this.u&&d===this.D&&!0!==this.fa||this.za({property:"width"}))}});
Object.defineProperty(T.prototype,"pixelWidth",{get:function(){if("px"===this.D)return this.u;if("%"===this.D)return this.m?this.m.innerWidth*this.u/100:0},set:function(a){if("number"===typeof a){var b=this.u,d=this.D;this.u=a;this.D="px";!0===this.$?pd(this,"pixelWidth",a):(this.U=!1,this.c.style.width=this.pixelWidth+"px",this.c.width=this.pixelWidth,b===this.u&&"px"===d&&!0!==this.fa||this.za({property:"pixelWidth"}))}}});
Object.defineProperty(T.prototype,"percentWidth",{get:function(){if("%"===this.D)return this.u;if("px"===this.D)return this.m?this.u/this.m.innerWidth*100:0},set:function(a){if("number"===typeof a){var b=this.u,d=this.D;this.u=a;this.D="%";!0===this.$?pd(this,"percentWidth",a):(this.U=!1,this.c.style.width=this.pixelWidth+"px",this.c.width=this.pixelWidth,b===this.u&&"%"===d&&!0!==this.fa||this.za({property:"percentWidth"}))}}});
Object.defineProperty(T.prototype,"unitWidth",{get:function(){return this.D},set:function(a){if("string"===typeof a&&("px"===a||"%"===a)){var b=this.D;this.D=a;!0===this.$?pd(this,"unitWidth",a):(this.U=!1,this.c.style.width=this.pixelWidth+"px",this.c.width=this.pixelWidth,b===this.D&&!0!==this.fa||this.za({property:"unitWidth"}))}}});Object.defineProperty(T.prototype,"innerWidth",{get:function(){return this.pixelWidth-2*this.P}});
Object.defineProperty(T.prototype,"height",{get:function(){return this.o},set:function(a){var b=this.o,d=this.B;if("string"===typeof a){var h=g.K.Fg(a);if(null===h.value||null===h.Zc)throw"FORGE.DisplayObject.height value "+a+" is incorrect";this.B=h.Zc;this.o=h.value}else if("number"===typeof a)this.o=a;else return;!0===this.$?pd(this,"height",this.o):(this.U=!1,this.c.style.height=this.pixelHeight+"px",this.c.height=this.pixelHeight,b===this.o&&d===this.B&&!0!==this.fa||this.za({property:"height"}))}});
Object.defineProperty(T.prototype,"pixelHeight",{get:function(){if("px"===this.B)return this.o;if("%"===this.B)return this.m?this.m.innerHeight*this.o/100:0},set:function(a){if("number"===typeof a){var b=this.o,d=this.B;this.o=a;this.B="px";!0===this.$?pd(this,"pixelHeight",a):(this.U=!1,this.c.style.height=this.pixelHeight+"px",this.c.height=this.pixelHeight,b===this.o&&"px"===d&&!0!==this.fa||this.za({property:"pixelHeight"}))}}});
Object.defineProperty(T.prototype,"percentHeight",{get:function(){if("%"===this.B)return this.o;if("px"===this.B)return this.m?this.o/this.m.innerHeight*100:0},set:function(a){if("number"===typeof a){var b=this.o,d=this.B;this.o=a;this.B="%";!0===this.$?pd(this,"percentHeight",a):(this.U=!1,this.c.style.height=this.pixelHeight+"px",this.c.height=this.pixelHeight,b===this.o&&"%"===d&&!0!==this.fa||this.za({property:"percentHeight"}))}}});
Object.defineProperty(T.prototype,"unitHeight",{get:function(){return this.B},set:function(a){if("string"===typeof a){var b=this.B;this.B=a;!0===this.$?pd(this,"unitHeight",a):(this.U=!1,this.c.style.height=this.pixelHeight+"px",this.c.height=this.pixelHeight,b===this.B&&!0!==this.fa||this.za({property:"unitHeight"}))}}});Object.defineProperty(T.prototype,"innerHeight",{get:function(){return this.pixelHeight-2*this.P}});
Object.defineProperty(T.prototype,"maximized",{get:function(){return this.U},set:function(a){"boolean"===typeof a&&(this.U=a,!0===this.U&&this.Sb(!0))}});Object.defineProperty(T.prototype,"horizontalCenter",{get:function(){return this.Pc},set:function(a){"boolean"===typeof a&&(this.Pc=a,!0===this.Pc&&(this.Da=this.Aa=null),this.m&&(a=this.G,this.G=(this.m.innerWidth-this.pixelWidth)/2,this.c.style.left=this.G+"px",this.M&&a!==this.G&&this.M.F({property:"x"})))}});
Object.defineProperty(T.prototype,"verticalCenter",{get:function(){return this.Rc},set:function(a){"boolean"===typeof a&&(this.Rc=a,!0===this.Rc&&(this.Yb=this.hc=null),this.m&&(a=this.I,this.I=(this.m.innerHeight-this.pixelHeight)/2,this.c.style.top=this.I+"px",this.M&&a!==this.I&&this.M.F({property:"y"})))}});
Object.defineProperty(T.prototype,"top",{get:function(){return this.hc},set:function(a){if("number"===typeof a||null===a)if(this.hc=a,this.Rc=!1,this.m&&null!==this.hc){var b=this.I;this.I=a;this.c.style.top=this.I+"px";this.M&&b!==this.I&&this.M.F({property:"y"})}}});
Object.defineProperty(T.prototype,"right",{get:function(){return this.Da},set:function(a){if("number"===typeof a||null===a)if(this.Da=a,this.Pc=!1,this.m&&null!==this.Da){var b=this.G;this.G=this.m.innerWidth-this.pixelWidth-a;this.c.style.left=this.G+"px";this.M&&b!==this.G&&this.M.F({property:"x"})}}});
Object.defineProperty(T.prototype,"bottom",{get:function(){return this.Yb},set:function(a){if("number"===typeof a||null===a)if(this.Yb=a,this.Rc=!1,this.m&&null!==this.Yb){var b=this.I;this.I=this.m.innerHeight-this.pixelHeight-a;this.c.style.top=this.I+"px";this.M&&b!==this.I&&this.M.F({property:"y"})}}});
Object.defineProperty(T.prototype,"left",{get:function(){return this.Aa},set:function(a){if("number"===typeof a||null===a)if(this.Aa=a,this.Pc=!1,this.m&&null!==this.Aa){var b=this.G;this.G=a;this.c.style.left=this.G+"px";this.M&&b!==this.G&&this.M.F({property:"x"})}}});Object.defineProperty(T.prototype,"alpha",{get:function(){return this.ue},set:function(a){"number"===typeof a&&a!==this.ue&&(this.ue=a,this.c.style.opacity=this.ue)}});
Object.defineProperty(T.prototype,"rotation",{get:function(){return this.xe},set:function(a){"number"===typeof a&&a!==this.xe&&(this.xe=a,this.c.style.transform="rotate("+this.xe+"deg)")}});Object.defineProperty(T.prototype,"background",{get:function(){return this.jd},set:function(a){"string"===typeof a&&a!==this.jd&&(this.jd=a,this.c.style.background=this.jd)}});
Object.defineProperty(T.prototype,"borderStyle",{get:function(){return this.ld},set:function(a){-1!=="none dotted dashed solid double groove ridge inset outset".split(" ").indexOf(a)&&a!==this.ld&&(this.ld=a,!0===this.$?pd(this,"borderStyle",a):this.c.style.borderStyle=this.ld)}});
Object.defineProperty(T.prototype,"borderWidth",{get:function(){return this.P},set:function(a){if("number"===typeof a){var b=this.P;this.P=a;!0===this.$?pd(this,"borderWidth",a):(this.c.style.borderWidth=this.P+"px",b===this.P&&!0!==this.fa||this.Rf())}}});Object.defineProperty(T.prototype,"borderColor",{get:function(){return this.kd},set:function(a){"string"===typeof a&&a!==this.kd&&(this.kd=a,this.c.style.borderColor=this.kd)}});
Object.defineProperty(T.prototype,"borderRadius",{get:function(){return this.Fe},set:function(a){"number"!==typeof a&&"string"!==typeof a||a===this.Fe||("string"===typeof a&&(a=parseInt(a,10)),isNaN(a)||(this.Fe=a,this.c.style.borderRadius=this.Fe+"px"))}});Object.defineProperty(T.prototype,"globalOffset",{get:function(){var a=this.c,b=0,d=0;do b+=a.offsetTop||0,d+=a.offsetLeft||0,a=a.offsetParent;while(a);return{top:b,left:d}}});
Object.defineProperty(T.prototype,"tooltip",{get:function(){return this.Hd},set:function(a){"string"===typeof a&&a!==this.Hd&&(this.Hd=a,this.c.title=this.Hd)}});Object.defineProperty(T.prototype,"index",{get:function(){return this.ve},set:function(a){"number"===typeof a&&a!==this.ve&&(this.ve=a,this.c.style.zIndex=this.ve)}});Object.defineProperty(T.prototype,"fullscreen",{set:function(a){"boolean"===typeof a&&(!0===a?this.Nj():this.Oj())}});
Object.defineProperty(T.prototype,"pointer",{get:function(){this.Qc||(this.Qc=new U(this));return this.Qc}});Object.defineProperty(T.prototype,"drag",{get:function(){this.Oc||(this.Oc=new ed(this));return this.Oc}});Object.defineProperty(T.prototype,"onResize",{get:function(){this.gc||(this.gc=new q(this));return this.gc}});Object.defineProperty(T.prototype,"onBorderResize",{get:function(){this.dc||(this.dc=new q(this));return this.dc}});
Object.defineProperty(T.prototype,"onMove",{get:function(){this.M||(this.M=new q(this));return this.M}});Object.defineProperty(T.prototype,"onReady",{get:function(){this.Ba||(this.Ba=new q(this,!0));return this.Ba}});Object.defineProperty(T.prototype,"onAddedToParent",{get:function(){this.bc||(this.bc=new q(this));return this.bc}});Object.defineProperty(T.prototype,"onAddedToDom",{get:function(){this.ac||(this.ac=new q(this));return this.ac}});
Object.defineProperty(T.prototype,"onShow",{get:function(){this.xd||(this.xd=new q(this));return this.xd}});Object.defineProperty(T.prototype,"onHide",{get:function(){this.ad||(this.ad=new q(this));return this.ad}});Object.defineProperty(T.prototype,"onFullscreenEnter",{get:function(){this.ec||(this.ec=new q(this));return this.ec}});Object.defineProperty(T.prototype,"onFullscreenExit",{get:function(){this.fc||(this.fc=new q(this));return this.fc}});
function v(a,b,d,h){this.f=[];this.O="undefined"!==typeof h?h:null;this.C=null;this.Pf=!1;this.ja="hidden";T.call(this,a,b,d||"DisplayObjectContainer")}v.prototype=Object.create(T.prototype);e=v.prototype;e.constructor=v;
e.La=function(){T.prototype.La.call(this);if("DisplayObjectContainer"===this.fb){var a=!!this.O;!0===a&&(this.C={originalWidth:this.O.clientWidth,originalHeight:this.O.clientHeight,currentWidth:this.O.clientWidth,currentHeight:this.O.clientHeight,scaleWidth:1,scaleHeight:1,frameCount:0,frameInterval:10},this.u=this.C.currentWidth,this.c.style.width=this.pixelWidth+"px",this.o=this.C.currentHeight,this.c.style.height=this.pixelHeight+"px",this.c.style.position="absolute",this.O.appendChild(this.c));
this.i.display.register(this,a);ld(this);md(this)}};e.za=function(a){for(var b=0,d=this.f.length;b<d;b++){var h=this.f[b],k=a;!0===h.U&&h.Sb(h.U);od(h,k.property);nd(h)}T.prototype.za.call(this,a)};e.ae=function(){T.prototype.ae.call(this);for(var a=0,b=this.f.length;a<b;a++)this.f[a].ae()};e.zc=function(){T.prototype.zc.call(this);for(var a=0,b=this.f.length;a<b;a++)this.f[a].zc()};e.be=function(){T.prototype.be.call(this);for(var a=0,b=this.f.length;a<b;a++)this.f[a].be()};
function qd(a,b){if(!a.f)return-1;for(var d=0,h=a.f.length;d<h;d++)if(a.f[d]===b)return d;return-1}
e.update=function(){this.C.frameCount++;if(!(this.C.frameCount<this.C.frameInterval)){this.C.frameCount=0;var a=this.O.clientWidth,b=this.O.clientHeight,d=!1;a!==this.C.currentWidth&&(this.C.currentWidth=a,this.C.scaleWidth=this.C.currentWidth/this.C.originalWidth,d=!0);b!==this.C.currentHeight&&(this.C.currentHeight=b,this.C.scaleHeight=this.C.currentHeight/this.C.scaleHeight,d=!0);!0===d&&this.vh(this.C.currentWidth,this.C.currentHeight)}};
e.mc=function(a){if(a===this)throw"You can't add a FORGE.DisplayObjectContainer to itself!";var b=a;a instanceof Element&&(b=new T(a));this.c.appendChild(b.dom);b.parent=this;a=this.f.push(b)-1;null===b.index&&(b.index=a)};e.Dn=function(a,b){var d=a;a instanceof Element&&(d=new T(a));this.c.appendChild(d.dom);d.parent=this;this.f.splice(b,0,d);d.index=b;b=0;for(d=this.f.length;b<d;b++)a=this.f[b],a.index=b};
e.Mj=function(){var a=this.f;if(0<a.length){this.Pf=!0;for(var b=0,d=a.length;b<d;b++)if(!0===a[b].Ad()&&!0===a[b].visible){var h=Math.max(a[b].width+a[b].x,a[b].width+a[b].left,a[b].width+a[b].right),k=Math.max(a[b].height+a[b].y,a[b].height+a[b].top,a[b].height+a[b].bottom);h>this.pixelWidth&&(this.width=h);k>this.pixelHeight&&(this.height=k)}}null!==this.parent&&!0===g.K.W(this.parent,"DisplayObjectContainer")&&!0===this.parent.Pf&&this.parent.Mj()};
e.removeChild=function(a,b){a=qd(this,a);-1!==a&&this.Gg(a,b)};e.Gg=function(a,b){if(0<=a&&a<this.f.length){var d=this.f[a];this.f.splice(a,1);this.c.removeChild(d.dom);"undefined"!==typeof b&&!0!==b||d.destroy();!0!==this.Pf||this.f.length||(this.height=this.width=0)}};e.uh=function(a){for(var b=this.f.length;b--;)this.Gg(b,a)};e.Xk=function(a){return-1!==qd(this,a)};e.destroy=function(){this.uh(!1);this.C=this.O=this.f=null;T.prototype.destroy.call(this)};
Object.defineProperty(v.prototype,"children",{get:function(){return this.f}});Object.defineProperty(v.prototype,"overflow",{get:function(){return this.ja},set:function(a){-1!==["hidden","visible","scroll"].indexOf(a)&&(this.ja=a,this.c.style.overflow=a)}});
function H(a,b,d){this.xa=b||null;this.na=this.O="";this.ja=!1;this.la=this.ya="";this.C=this.aa=null;this.da=!1;this.ia=this.f=null;this.qa="";this.T=this.pa=!1;this.va=this.wa=!0;this.H=rd;this.L=this.V=this.j=null;T.call(this,a,null,d||"Image")}H.prototype=Object.create(T.prototype);H.prototype.constructor=H;var sd={CSS:"css",Zb:"canvas"},rd=sd.CSS;e=H.prototype;
e.La=function(){T.prototype.La.call(this);this.$b=!0;this.H===sd.CSS?this.c.style.backgroundRepeat="no-repeat":this.H===sd.Zb&&(this.j=document.createElement("canvas"),this.j.style.position="absolute",this.j.style.top="0px",this.j.style.left="0px",this.c.appendChild(this.j));null!==this.xa&&this.load(this.xa);this.i.display.register(this);ld(this)};
e.za=function(a){var b=a.property;-1!==b.toLowerCase().indexOf("width")&&"autoWidth"!==b&&(this.wa=!1);-1!==b.toLowerCase().indexOf("height")&&"autoHeight"!==b&&(this.va=!1);this.C&&(this.H===sd.CSS?(td(this),ud(this)):this.H===sd.Zb&&this.f&&this.qd(this.f),!0===this.$b&&(-1!==b.toLowerCase().indexOf("width")?(b=this.pixelWidth/this.f.w,b!==this.ra&&(this.ra=b,!0===this.$b&&(this.sa=b,this.height=this.f.h*this.sa))):-1!==b.toLowerCase().indexOf("height")&&(b=this.pixelHeight/this.f.h,b!==this.sa&&
(this.sa=b,!0===this.$b&&(this.ra=b,this.width=this.f.w*this.ra)))),T.prototype.za.call(this,a))};e.Rf=function(){this.H===sd.CSS?this.c.style.backgroundPosition=-this.P+"px "+-this.P+"px":this.H===sd.Zb&&(this.j.style.top=-this.P+"px",this.j.style.left=-this.P+"px");T.prototype.Rf.call(this)};e.$e=function(){var a=this.O+"_"+this.i.i18n.locale;if(a!==this.ya&&(this.ya=a,!0===this.i.i18n.Mb(this.la))){var b=this.aa.value;this.T=!1;this.i.load.image(a,b,this.$d,this)}};
function vd(a,b){a.f=b;!0===a.wa&&(a.u=a.f.w,a.D="px",a.c.style.width=a.pixelWidth+"px");!0===a.va&&(a.o=a.f.h,a.B="px",a.c.style.height=a.pixelHeight+"px");a.H===sd.CSS?(td(a),ud(a)):a.H===sd.Zb&&a.qd(a.f)}e.qd=function(a){if(this.C&&!1!==this.da){this.j.width=this.innerWidth;this.j.height=this.innerHeight;var b=this.j.getContext("2d");b.clearRect(0,0,this.innerWidth,this.innerHeight);b.drawImage(this.C,a.x,a.y,a.w,a.h,0,0,this.innerWidth,this.innerHeight)}};
function td(a){a.c.style.backgroundSize=a.pixelWidth/a.f.w*a.C.naturalWidth+"px "+a.pixelHeight/a.f.h*a.C.naturalHeight+"px"}function ud(a){a.c.style.backgroundPosition=a.pixelWidth/a.f.w*(-a.f.x-a.P)+"px "+a.pixelHeight/a.f.h*(-a.f.y-a.P)+"px"}e.$d=function(a){!1!==this.yb&&(this.C=a.data,this.H===sd.CSS&&(this.c.style.backgroundImage="url('"+a.url+"')"),this.da=!0,wd(this))};
e.Fm=function(a){"undefined"!==typeof a.data.frames?this.ia=a.data.frames:this.warn("No frames found in file!");this.pa=!0;wd(this)};function wd(a){if(!0!==a.T&&!0===a.da&&!0===a.pa){a.T=!0;var b;a.f?b=a.f:a.ia?b=a.ia[0].frame:b={x:0,y:0,w:a.C.naturalWidth,h:a.C.naturalHeight};vd(a,b);nd(a);md(a);a.L&&a.L.F()}}
e.load=function(a){this.pa=this.da=this.T=!1;"object"===typeof a&&a?(this.O=a.key||"",this.ja=a.i18n||!1,!0===this.ja?(this.na="",this.la=a.url):this.na=a.url,this.f=a.frame||null,"string"===typeof a.frames?this.qa=a.frames:"object"===typeof a.frames&&null!==a.frames&&(this.ia=a.frames),this.alpha=a.alpha,this.keepRatio=a.keepRatio,this.maximized=a.maximized,this.width=a.width,this.height=a.height):(this.na=this.O="",this.ja=!1,"string"===typeof a&&(this.na=a));a=this.O;var b=this.na;if(!0===this.ja&&
"string"===typeof this.la){this.aa=new D(this.i,this.la);!1===this.i.i18n.onLocaleChangeComplete.has(this.$e,this)&&this.i.i18n.onLocaleChangeComplete.add(this.$e,this);var d=this.i.i18n.locale;""!==d&&(a=this.O+"_"+d);!0===this.i.i18n.Mb(this.la)&&(b=this.aa.value)}""!==b?(this.T=!1,this.i.load.image(a,b,this.$d,this)):this.da=!0;"string"===typeof this.qa&&""!==this.qa?(a=this.qa,this.T=!1,this.i.load.json(this.O+"-frames",a,this.Fm,this)):this.pa=!0};
e.Le=function(){this.c.style.backgroundImage="";this.C=null};e.destroy=function(a){if(!1!==this.yb){this.aa&&(this.aa.destroy(),this.aa=null,this.i.i18n.onLocaleChangeComplete.remove(this.$e,this));this.V&&(this.V.destroy(),this.V=null);this.L&&(this.L.destroy(),this.L=null);this.C=null;if("undefined"===typeof a||!0===a)if(!0===this.ja){a=this.i.i18n.locales;for(var b,d=0,h=a.length;d<h;d++)b=this.O+"_"+a[d],this.i.cache.remove(C.IMAGE,b)}else this.i.cache.remove(C.IMAGE,this.O);T.prototype.destroy.call(this)}};
Object.defineProperty(H.prototype,"loaded",{get:function(){return this.T}});Object.defineProperty(H.prototype,"element",{get:function(){return this.C}});Object.defineProperty(H.prototype,"frame",{get:function(){return this.f},set:function(a){vd(this,a)}});Object.defineProperty(H.prototype,"frames",{get:function(){return this.ia}});Object.defineProperty(H.prototype,"originalWidth",{get:function(){if(this.C)return this.C.naturalWidth}});Object.defineProperty(H.prototype,"originalHeight",{get:function(){if(this.C)return this.C.naturalHeight}});
Object.defineProperty(H.prototype,"onLoadStart",{get:function(){this.V||(this.V=new q(this));return this.V}});Object.defineProperty(H.prototype,"onLoadComplete",{get:function(){this.L||(this.L=new q(this));return this.L}});function Rb(a,b){this.sa=this.ra=1;this.J=null;H.call(this,a,b,"ImageScalable");this.La()}Rb.prototype=Object.create(H.prototype);e=Rb.prototype;e.constructor=Rb;e.La=function(){this.warn(this.fb+" test both render modes");this.H=sd.Zb;H.prototype.La.call(this)};
e.$d=function(a){var b=a.data;this.J=new Ca(b.naturalWidth,b.naturalHeight);H.prototype.$d.call(this,a)};
e.qd=function(a){this.log(a);this.H!==sd.Zb?this.warn("Invalid render mode for "+this.fb):this.C&&!1!==this.da&&(this.u=this.j.width=this.J.width*this.ra,this.c.style.width=this.j.width+"px",this.o=this.j.height=this.J.height*this.sa,this.c.style.height=this.j.height+"px",a=this.j.getContext("2d"),a.clearRect(0,0,this.j.width,this.j.height),a.drawImage(this.C,0,0,this.J.width,this.J.height,0,0,this.j.width,this.j.height))};e.destroy=function(){this.J=null;H.prototype.destroy.call(this)};
Object.defineProperty(Rb.prototype,"scaleWidth",{get:function(){return this.ra},set:function(a){a=Math.max(Number.EPSILON,a);this.ra!==a&&(this.ra=a,this.qd(this.frame))}});Object.defineProperty(Rb.prototype,"scaleHeight",{get:function(){return this.sa},set:function(a){a=Math.max(Number.EPSILON,a);this.sa!==a&&(this.sa=a,this.qd(this.frame))}});function Rc(a,b){this.J=null;H.call(this,a,b,"Sprite")}Rc.prototype=Object.create(H.prototype);e=Rc.prototype;e.constructor=Rc;
e.La=function(){this.H=sd.Zb;H.prototype.La.call(this);this.J=new xd(this);this.i.display.register(this,!0)};e.play=function(a,b,d){this.J.play(a,b,d)};e.pause=function(a){this.J.pause(a)};e.resume=function(a){this.J.resume(a)};e.stop=function(){this.J.stop()};e.update=function(){this.J.update()};e.destroy=function(){!1!==this.yb&&(this.J.destroy(),this.J=null,H.prototype.destroy.call(this))};Object.defineProperty(Rc.prototype,"animations",{get:function(){return this.J}});
Object.defineProperty(Rc.prototype,"animation",{get:function(){return this.J.currentAnimation}});function yd(a,b){this.f=null;this.aa=b||null;this.j="";this.O=!1;this.C="";this.V=this.L=null;this.T=!1;this.H=this.J=null;T.call(this,a,null,"Iframe")}yd.prototype=Object.create(T.prototype);e=yd.prototype;e.constructor=yd;
e.La=function(){T.prototype.La.call(this);this.V=this.Dm.bind(this);this.f=document.createElement("iframe");this.f.style.width="100%";this.f.style.height="100%";this.f.style.border=0;this.f.style.overflow="hidden";this.f.addEventListener("load",this.V,!!this&&!!this);this.f.setAttribute("allowFullScreen","");this.c.appendChild(this.f);null!==this.aa&&this.load(this.aa);this.i.display.register(this);ld(this);md(this)};
e.Ze=function(){this.log("_localeChangeComplete");!0===this.i.i18n.Mb(this.C)&&zd(this,this.L.value)};function zd(a,b){a.log("_loadIframe url: "+b);a.T=!1;a.J&&a.J.F();a.j=b;a.f.src=a.j}e.Dm=function(){""!==this.j&&(this.log("_loadCompleteHandler url: "+this.j),this.T=!0,this.H&&this.H.F())};function Ad(a){!1===a.i.i18n.onLocaleChangeComplete.has(a.Ze,a)&&a.i.i18n.onLocaleChangeComplete.add(a.Ze,a)}
e.load=function(a){"object"===typeof a&&a?(this.O=a.i18n||!1,!0===this.O?(this.j="",this.C=a.url):this.j=a.url):(this.O=!1,this.j="","string"===typeof a&&(this.j=a));var b;!0===this.O&&"string"===typeof this.C&&""!==this.C?(this.L=new D(this.i,this.C),Ad(this),b=this.L.value):"string"===typeof this.j&&""!==this.j&&(b=this.j);"undefined"!==typeof b&&zd(this,b)};
e.destroy=function(){!1!==this.yb&&(this.L&&(this.L.destroy(),this.L=null,this.i.i18n.onLocaleChangeComplete.remove(this.Ze,this)),this.J&&(this.J.destroy(),this.J=null),this.H&&(this.H.destroy(),this.H=null),this.V=this.f=null,T.prototype.destroy.call(this))};
Object.defineProperty(yd.prototype,"i18nUrl",{get:function(){return this.C},set:function(a){if("string"===typeof a){this.O=!0;this.C=a;var b;""!==this.C&&(this.L=new D(this.i,this.C),Ad(this),b=this.L.value);"undefined"!==typeof b&&zd(this,b)}}});Object.defineProperty(yd.prototype,"url",{get:function(){return this.j},set:function(a){"string"===typeof a&&(this.O=!1,zd(this,a))}});Object.defineProperty(yd.prototype,"loaded",{get:function(){return this.T}});
Object.defineProperty(yd.prototype,"onLoadStart",{get:function(){this.J||(this.J=new q(this));return this.J}});Object.defineProperty(yd.prototype,"onLoadComplete",{get:function(){this.H||(this.H=new q(this));return this.H}});
function S(a,b){this.ja=b;this.H="";this.j=!1;this.J=null;this.aa="";this.ia="rgb(0, 0, 0)";this.T=this.V=!0;this.Ja=0;this.O=this.Ka=!1;this.da=null;this.Ya=!1;this.Ga=this.Ea=this.Fa=this.ya=this.xa=this.wa=this.va=this.Xa=this.Ta=this.Va=this.Ua=this.Sa=this.Qa="";this.na=this.pa=this.qa=this.f=this.Na=null;this.la=!1;this.C=this.L=null;T.call(this,a,null,"TextField")}S.prototype=Object.create(T.prototype);e=S.prototype;e.constructor=S;
e.La=function(){T.prototype.La.call(this);this.qa=this.rm.bind(this);this.pa=this.bm.bind(this);this.na=this.am.bind(this);this.Na=document.createElement("span");this.c.appendChild(this.Na);"undefined"!==typeof this.ja&&null!==this.ja&&this.load(this.ja);this.i.display.register(this);ld(this);md(this)};
e.za=function(a){var b=a.property;-1!==b.toLowerCase().indexOf("width")&&"autoWidth"!==b&&(this.V=!1);-1!==b.toLowerCase().indexOf("height")&&"autoHeight"!==b&&(this.T=!1);T.prototype.za.call(this,a)};e.zc=function(){Bd(this);T.prototype.zc.call(this)};function Cd(a,b){b!==a.aa&&(a.aa=String(b),a.Na.innerHTML=b,Bd(a),nd(a),a.L&&a.L.F());if(!1===a.j||!0===a.j&&!0===a.J.loaded)a.la=!0,a.C&&a.C.F()}
function Bd(a){if(!1!==a.Ad()){if(!0===a.V){var b=a.pixelWidth;a.c.style.width="";var d=a.c.offsetWidth;0<d&&(d+=1);a.u=d;a.D="px";a.c.style.width=a.u+"px";b!==a.u&&a.za({property:"autoWidth"})}!0===a.T&&(b=a.pixelHeight,a.c.style.height="",d=a.c.offsetHeight,0<d&&(d+=1),a.o=d,a.B="px",a.c.style.height=a.o+"px",b!==a.o&&a.za({property:"autoHeight"}))}}function Dd(a){a.J||(a.J=new D(a.i,a.H));Cd(a,a.J.value)}
function Ed(a){!1===a.i.i18n.onLocaleChangeComplete.has(a.hf,a)&&a.i.i18n.onLocaleChangeComplete.add(a.hf,a)}e.hf=function(){this.log("_localeChangeComplete");!0===this.i.i18n.Mb(this.H)&&(this.value=this.J.value)};
e.rm=function(){!0!==this.O||this.f||(this.f=document.createElement("textarea"),this.f.style.position="absolute",this.f.style.top="0px",this.f.style.left="0px",this.f.style.width="100%",this.f.style.height="100%",this.f.style.resize="none",this.f.style.margin="0px",this.f.style.padding="0px",this.f.style.overflowX="hidden",this.f.style.overflowY="auto",this.f.style.boxSizing="border-box",this.f.value=this.aa,this.f.addEventListener("input",this.pa,!1),this.f.addEventListener("blur",this.na,!1),this.c.appendChild(this.f),
this.f.focus())};e.bm=function(){Cd(this,this.f.value)};e.am=function(){this.Nf()};e.Nf=function(){this.f&&(this.f.removeEventListener("input",this.pa,!1),this.f.removeEventListener("blur",this.na,!1),this.c.removeChild(this.f),this.f=null)};
e.load=function(a){this.la=!1;"object"===typeof a&&a?(a.color&&(this.color=a.color),a.font&&(this.font=a.font),a.fontFamily&&(this.fontFamily=a.fontFamily),a.fontWeight&&(this.fontWeight=a.fontWeight),a.fontSize&&(this.fontSize=a.fontSize),a.fontStyle&&(this.fontStyle=a.fontStyle),a.fontVariant&&(this.fontVariant=a.fontVariant),a.textAlign&&(this.textAlign=a.textAlign),a.textShadow&&(this.textShadow=a.textShadow),a.textDecoration&&(this.textDecoration=a.textDecoration),a.textOverflow&&(this.textOverflow=
a.textOverflow),a.textTransform&&(this.textTransform=a.textTransform),a.whiteSpace&&(this.whiteSpace=a.whiteSpace),a.wordWrap&&(this.wordWrap=a.wordWrap),a.lineHeight&&(this.lineHeight=a.lineHeight),a.autoWidth&&(this.autoWidth=a.autoWidth),a.autoHeight&&(this.autoHeight=a.autoHeight),a.padding&&(this.padding=a.padding),a.selectable&&(this.selectable=a.selectable),a.editable&&(this.editable=a.editable),this.j=a.i18n||!1,!0===this.j?this.H=a.value:this.value=a.value):"string"===typeof a&&(this.j=!1,
this.value=a);!0===this.j&&"string"===typeof this.H&&""!==this.H&&(Dd(this),Ed(this))};e.destroy=function(){!1!==this.yb&&(this.J&&(this.J.destroy(),this.J=null,this.i.i18n.onLocaleChangeComplete.remove(this.hf,this)),this.Nf(),this.C&&(this.C.destroy(),this.C=null),this.L&&(this.L.destroy(),this.L=null),T.prototype.destroy.call(this))};Object.defineProperty(S.prototype,"i18nValue",{get:function(){return this.H},set:function(a){"string"===typeof a&&(""===this.H&&Ed(this),this.j=!0,this.H=a,Dd(this))}});
Object.defineProperty(S.prototype,"i18n",{get:function(){return this.j}});Object.defineProperty(S.prototype,"value",{get:function(){return this.aa},set:function(a){if("string"===typeof a||"number"===typeof a)this.j=!1,Cd(this,a)}});Object.defineProperty(S.prototype,"color",{get:function(){return this.ia},set:function(a){"string"===typeof a&&(this.ia=a,this.c.style.color=this.ia)}});
Object.defineProperty(S.prototype,"font",{get:function(){return this.va},set:function(a){"string"!==typeof a||2>a.split(" ").toString().length||(this.va=a.replace(/"/g,'"'),this.c.style.font=this.va)}});Object.defineProperty(S.prototype,"fontFamily",{get:function(){return this.wa},set:function(a){"string"===typeof a&&(this.wa=a.replace(/"/g,'"'),this.c.style.fontFamily=this.wa,Bd(this))}});
Object.defineProperty(S.prototype,"fontSize",{get:function(){return this.xa},set:function(a){if("number"===typeof a||"string"===typeof a)"number"===typeof a&&(a+="px"),this.xa=a,this.c.style.fontSize=this.xa}});Object.defineProperty(S.prototype,"fontStyle",{get:function(){return this.ya},set:function(a){"string"===typeof a&&(this.ya=a,this.c.style.fontStyle=this.ya)}});
Object.defineProperty(S.prototype,"fontWeight",{get:function(){return this.Fa},set:function(a){"string"===typeof a&&"number"===typeof a&&(this.Fa=a,this.c.style.fontWeight=this.Fa)}});Object.defineProperty(S.prototype,"fontVariant",{get:function(){return this.Ea},set:function(a){"string"===typeof a&&(this.Ea=a,this.c.style.fontVariant=this.Ea)}});
Object.defineProperty(S.prototype,"lineHeight",{get:function(){return this.Ga},set:function(a){if("number"===typeof a||"string"===typeof a)"number"===typeof a&&(a+="px"),this.Ga=a,this.c.style.lineHeight=this.Ga}});Object.defineProperty(S.prototype,"textAlign",{get:function(){return this.Qa},set:function(a){"string"===typeof a&&(this.Qa=a,this.c.style.textAlign=this.Qa)}});
Object.defineProperty(S.prototype,"textShadow",{get:function(){return this.Ua},set:function(a){"string"===typeof a&&(this.Ua=a,this.c.style.textShadow=this.Ua)}});Object.defineProperty(S.prototype,"textDecoration",{get:function(){return this.Sa},set:function(a){"string"===typeof a&&(this.Sa=a,this.c.style.textDecoration=this.Sa)}});Object.defineProperty(S.prototype,"textTransform",{get:function(){return this.Va},set:function(a){"string"===typeof a&&(this.Va=a,this.c.style.textTransform=this.Va)}});
Object.defineProperty(S.prototype,"autoWidth",{get:function(){return this.V},set:function(a){"boolean"===typeof a&&(this.V=a,Bd(this))}});Object.defineProperty(S.prototype,"autoHeight",{get:function(){return this.T},set:function(a){"boolean"===typeof a&&(this.T=a,Bd(this))}});
Object.defineProperty(S.prototype,"padding",{get:function(){return this.Ja},set:function(a){if("number"===typeof a||"string"===typeof a)this.Ja=a="string"===typeof a?a.split(" ",4).toString().replace(/,/g," "):a+"px",this.c.style.padding=this.Ja}});
Object.defineProperty(S.prototype,"selectable",{get:function(){return this.Ka},set:function(a){"boolean"===typeof a&&(this.Ka=a,!1===this.Ka?(!1===this.O&&!0===this.cb&&(this.cb=this.pointer.enabled=!1),this.c.style.R="none",this.c.style.webkitUserSelect="none",this.c.style.c="none",this.c.style.f="none",this.c.style.j="none"):(!1===this.pointer.enabled&&(this.cb=this.pointer.enabled=!0),this.c.style.R="text",this.c.style.webkitUserSelect="text",this.c.style.c="text",this.c.style.f="text",this.c.style.j=
"inherit"))}});Object.defineProperty(S.prototype,"wordWrap",{get:function(){return this.Ya},set:function(a){"boolean"===typeof a&&(this.Ya=a,this.c.style.wordWrap=!1===this.Ya?"normal":"break-word")}});Object.defineProperty(S.prototype,"whiteSpace",{get:function(){return this.Xa},set:function(a){"string"===typeof a&&(this.Xa=a,this.c.style.whiteSpace=this.Xa)}});
Object.defineProperty(S.prototype,"textOverflow",{get:function(){return this.Ta},set:function(a){"string"===typeof a&&(this.Ta=a,this.c.style.textOverflow=this.Ta)}});
Object.defineProperty(S.prototype,"editable",{get:function(){return this.O},set:function(a){a=!!a;this.O!==a&&(this.O=a,!1===this.O?(this.c.removeEventListener("click",this.qa,!!this&&!!this),this.i.keyboard.He(this.da),this.da=null,this.pointer.enabled=!0,this.c.style.cursor="text"):(this.c.addEventListener("click",this.qa,!!this&&!!this),this.da=new M(this.i,[13,27],this.Nf,null,null,null,this),this.i.keyboard.Wf(this.da),this.c.style.cursor="default"))}});
Object.defineProperty(S.prototype,"loaded",{get:function(){return this.la}});Object.defineProperty(S.prototype,"onLoadComplete",{get:function(){this.C||(this.C=new q(this));return this.C}});Object.defineProperty(S.prototype,"onValueChange",{get:function(){this.L||(this.L=new q(this));return this.L}});function Sc(a,b){this.la=b||null;this.H={};this.da=this.J=this.T="";this.j=this.L=null;this.V=this.aa=!1;this.ia=0;v.call(this,a,null,"Button")}Sc.prototype=Object.create(v.prototype);
Sc.prototype.constructor=Sc;var Fd={Nb:"out",yc:"over",lh:"down"};e=Sc.prototype;
e.La=function(){v.prototype.La.call(this);this.J=Fd.Nb;this.L=new H(this.i);this.L.onLoadComplete.add(this.Yd,this);this.L.onResize.add(this.Zd,this);this.mc(this.L);this.j=new S(this.i);this.j.onLoadComplete.add(this.Yd,this);this.j.onResize.add(this.Zd,this);this.j.autoWidth=!0;this.j.autoHeight=!0;this.mc(this.j);this.pointer.enabled=!0;this.pointer.cursor=gd.kb;this.pointer.onEnter.add(this.Jm,this);this.pointer.onLeave.add(this.Km,this);this.pointer.onPressStart.add(this.Wk,this);this.pointer.onPressEnd.add(this.Vk,
this);this.i.display.register(this);ld(this);md(this);this.i.i18n.onLocaleChangeComplete.add(this.nh,this);this.load(this.la)};e.Jm=function(){Gd(this,Fd.yc)};e.Km=function(){Gd(this,Fd.Nb)};e.Wk=function(){Gd(this,Fd.lh)};e.Vk=function(){Gd(this,Fd.yc)};e.nh=function(){Gd(this,this.J)};e.Yd=function(a){this.log("_itemLoadComplete "+a.emitter.className);this.ia++;2===this.ia&&(this.log("_allItemsLoaded"),Hd(this),Id(this))};e.Zd=function(){Hd(this);Id(this)};function Jd(a,b){a.T=b;Gd(a,a.J)}
function Gd(a,b){a.J=b;b=a.H[a.T];a.ia=0;var d=b.ek(a.J);a.background=b.$a("background",a.J);a.borderStyle=b.$a("borderStyle",a.J);a.borderColor=b.$a("borderColor",a.J);a.borderRadius=b.$a("borderRadius",a.J);a.borderWidth=b.$a("borderWidth",a.J);a.aa=b.$a("autoWidth",a.J);a.V=b.$a("autoHeight",a.J);var h=b.$a("label",a.J);"undefined"!==typeof h&&a.j.load(h);!0===d&&a.L.load(b.$a("image",a.J))}
function Hd(a){a.log("_updateLayout");var b=a.H[a.T],d=b.$a("align",a.J),h=b.$a("padding",a.J),k=b.$a("spacing",a.J);"label"===b.$a("first",a.J)?(b=a.j,a=a.L):(b=a.L,a=a.j);switch(d){case "left":b.left=h;b.verticalCenter=!0;a.left=b.left+k+b.pixelWidth;a.verticalCenter=!0;break;case "right":b.right=h;b.verticalCenter=!0;a.right=b.right+k+b.pixelWidth;a.verticalCenter=!0;break;case "top":b.top=h;b.horizontalCenter=!0;a.top=b.top+b.pixelHeight+k;a.horizontalCenter=!0;break;case "bottom":b.bottom=h;
b.horizontalCenter=!0;a.bottom=b.bottom+k+b.pixelHeight;a.horizontalCenter=!0;break;default:b.horizontalCenter=!0,b.verticalCenter=!0,a.horizontalCenter=!0,a.verticalCenter=!0}}
function Id(a){a.log("_updateAutoSize");if(!1!==a.aa||!1!==a.V){var b=a.H[a.T].$a("padding",a.J);if(!0===a.aa){var d=a.pixelWidth;a.u=Math.max(a.j.x+a.j.pixelWidth,a.L.x+a.L.pixelWidth)-Math.min(a.j.x,a.L.x)+2*b+2*a.P;a.D="px";a.c.style.width=a.u+"px";d!==a.pixelWidth&&a.za({property:"autoWidth"})}!0===a.V&&(d=a.pixelHeight,a.o=Math.max(a.j.y+a.j.pixelHeight,a.L.y+a.L.pixelHeight)-Math.min(a.j.y,a.L.y)+2*b+2*a.P,a.B="px",a.c.style.height=a.o+"px",d!==a.pixelHeight&&a.za({property:"autoHeight"}))}}
e.load=function(a){if("undefined"!==typeof a&&a){if(!0===g.K.Pa(a.skins,"ButtonSkin"))for(var b=0,d=a.skins.length;b<d;b++)this.Bc(a.skins[b]);else if("object"===typeof a.skins&&0<a.skins.length)for(var d=0,h=a.skins.length;d<h;d++)b=new X(a.skins[d].name,a.skins[d].states),this.Bc(b);g.K.W(a.skin,"ButtonSkin")?this.Bc(a.skin):"object"===typeof a.skin&&(b=new X(a.skin.name,a.skin.states),this.Bc(b));!0===g.K.W(a["default"],"string")&&!0===this.fk(a["default"])&&(this.da=a["default"])}a=this.H||{};
Object.keys(a).length||(b=new X("default"),this.Bc(b));""===this.da&&(this.da=this.H[Object.keys(a)[0]].name);Jd(this,this.da)};e.Bc=function(a,b){if(!1===g.K.W(a,"ButtonSkin"))throw"FORGE.Button: Invalid button skin!";a.Mg(Fd.Nb);this.H[a.name]=a;!0===b&&Jd(this,a.name)};e.Ik=function(a){"string"===typeof a&&!0===g.K.W(this.H[a],"ButtonSkin")?Jd(this,a):!0===g.K.W(a,"ButtonSkin")&&(this.H[a.name]===a?Jd(this,a.name):"undefined"!==typeof this.H[a.name]&&null!==this.H[a.name]||this.Bc(a,!0))};
e.fk=function(a){return"undefined"!==typeof this.H[a]};e.yo=function(){this.H[this.T].Mg(Fd.Nb);Jd(this,this.T)};
e.destroy=function(){this.i.i18n.onLocaleChangeComplete.remove(this.nh,this);if("undefined"!==typeof this.H&&0<this.H.length)for(var a in this.H)this.H.hasOwnProperty(a)&&this.H[a].destroy();this.H={};this.L&&(this.L.onLoadComplete.remove(this.Yd,this),this.L.onResize.remove(this.Zd,this),this.removeChild(this.L,!0),this.L=null);this.j&&(this.j.onLoadComplete.remove(this.Yd,this),this.j.onResize.remove(this.Zd,this),this.removeChild(this.j,!0),this.j=null);v.prototype.destroy.call(this)};
Object.defineProperty(Sc.prototype,"skins",{get:function(){return this.H}});Object.defineProperty(Sc.prototype,"skin",{get:function(){return this.H[this.T]},set:function(a){this.Ik(a)}});Object.defineProperty(Sc.prototype,"autoWidth",{get:function(){return this.aa},set:function(a){"boolean"===typeof a&&(this.aa=a,Id(this))}});Object.defineProperty(Sc.prototype,"autoHeight",{get:function(){return this.V},set:function(a){"boolean"===typeof a&&(this.V=a,Id(this))}});
function X(a,b){this.j=a||"";this.f=g.K.Cc(Kd,{});this.c=g.K.Cc(b||{},{out:{},over:{},down:{}});n.call(this,"ButtonSkin")}X.prototype=Object.create(n.prototype);X.prototype.constructor=X;
var Ld={key:"",url:"",i18n:!1,keepRatio:!0,maximized:!1,alpha:1},Md={value:"",i18n:!1,color:"",fontFamily:"",fontWeight:""},Nd={name:"",background:"",borderStyle:"solid",borderColor:"",borderRadius:0,borderWidth:0,autoWidth:!0,autoHeight:!0,align:"center",padding:0,spacing:0,first:"image",image:Ld,label:Md},Od={key:"",url:"",i18n:!1,keepRatio:!0,maximized:!1,alpha:1},Pd={value:"Button",i18n:!1,color:"",fontFamily:"",fontWeight:""},Kd={name:"default",background:"#eee",borderStyle:"solid",borderColor:"#555",
borderRadius:5,borderWidth:2,autoWidth:!0,autoHeight:!0,align:"left",padding:5,spacing:0,first:"image",image:Od,label:Pd};X.prototype.Mg=function(a){"undefined"!==typeof this.c[a]&&(this.f=this.c[a])};X.prototype.$a=function(a,b){b=g.K.re(this.c,b+"."+a,g.K.re(this.f,a,g.K.re(Nd,a)));"object"===typeof b&&(b=g.K.Cc(this.f[a],b));return b};X.prototype.ek=function(a){a=this.$a("image",a);return"undefined"!==typeof a&&"string"===typeof a.url&&""!==a.url};
X.prototype.m=function(a){a=this.$a("label",a);return"undefined"!==typeof a&&"string"===typeof a.value&&""!==a.value};Object.defineProperty(X.prototype,"name",{get:function(){return this.j}});Object.defineProperty(X.prototype,"default",{get:function(){return this.f},set:function(a){this.f=a}});Object.defineProperty(X.prototype,"out",{get:function(){return this.c.out},set:function(a){this.c.out=a}});
Object.defineProperty(X.prototype,"over",{get:function(){return this.c.over},set:function(a){this.c.over=a}});Object.defineProperty(X.prototype,"down",{get:function(){return this.c.down},set:function(a){this.c.down=a}});function fa(a){T.call(this,a,document.createElement("canvas"),"Canvas")}fa.prototype=Object.create(T.prototype);fa.prototype.constructor=fa;fa.prototype.La=function(){T.prototype.La.call(this);this.i.display.register(this);ld(this);md(this)};
Object.defineProperty(fa.prototype,"context2D",{get:function(){return this.c.getContext("2d")}});Object.defineProperty(fa.prototype,"context3D",{get:function(){return this.c.getContext("webgl")}});Object.defineProperty(fa.prototype,"element",{get:function(){return this.c}});
function J(a,b,d,h,k){this.i=a;this.hd=b;this.qc=d||null;this.H=null;this.dd=h||g.Ha.Xb;this.ib="";this.L=null;this.J=this.C=-1;this.Ya=null;this.Fb=!1;this.wb=null;this.rc=!1;this.vb=1;this.cb=!1;this.Jc=0;this.Vb=null;this.Tb=k||!1;this.$c=[0,1,2,3];this.Ic=!1;this.Ka=this.aa=this.Ga=this.Ja=this.Na=this.Ua=this.wa=this.Ea=this.Sa=this.Xa=this.na=this.la=this.Qa=this.Va=this.O=this.Ta=this.xa=this.ya=this.ia=this.da=this.ja=this.Fa=this.qa=this.va=this.pa=null;this.Ub=this.T=!1;this.Hc=this.Kc=
0;this.tc=this.uc=this.j=this.Wb=this.Gb=this.Lb=this.Hb=this.Jb=this.Kb=this.Ib=this.V=null;T.call(this,a,null,"VideoHTML5")}J.prototype=Object.create(T.prototype);e=J.prototype;e.constructor=J;
e.La=function(){T.prototype.La.call(this);!0===this.Tb&&!1===Qd(this)&&(this.log("FORGE.VideoHTML5: can't manage ambisonic sound without Google Chrome Omnitone library and WebAudio API."),this.Tb=!1);this.R=this.hd;aa(this);this.V=this.$m.bind(this);this.Ib=this.an.bind(this);this.Kb=this.cn.bind(this);this.Jb=this.bn.bind(this);this.Hb=this.Zm.bind(this);this.Lb=this.dn.bind(this);this.Gb=this.Ym.bind(this);this.Wb=this.en.bind(this);this.j=this.Pm.bind(this);this.Ya=this.i.clock.create(!1);this.wb=
this.i.clock.create(!1);this.wb.jf(500,this.$l,this);this.i.audio.onVolumeChange.add(this.li,this);this.i.audio.onDisable.add(this.ki,this);this.aa=new q(this,!0);null!==this.qc&&this.load(this.qc);this.i.display.register(this,Qd(this));ld(this);md(this)};e.za=function(a){var b=Rd(this);b&&null!==b.element&&(b.element.setAttribute("width",this.pixelWidth),b.element.setAttribute("height",this.pixelHeight));T.prototype.za.call(this,a)};
function Sd(a,b){for(var d,h=0,k=a.L.length;h<k;h++)if(d=a.L[h],d===b)return h;return-1}function Td(a,b){return a.L?(a=a.L[b])&&"undefined"!==typeof a?a:null:null}function Ud(a){return Td(a,a.C)}function Rd(a){return Td(a,a.J)}function Vd(a,b){return(a=Rd(a))&&null!==a.element?a.element[b]:0}
function Wd(a,b){if(-1!==b){a.log("_destroyVideoAt "+b);b=a.L[b];var d=b.element;if("undefined"!==typeof d&&null!==d){d.removeEventListener("loadstart",a.j,!1);d.removeEventListener("durationchange",a.j,!1);d.removeEventListener("loadedmetadata",a.j,!1);d.removeEventListener("loadeddata",a.j,!1);d.removeEventListener("progress",a.j,!1);d.removeEventListener("canplay",a.j,!1);d.removeEventListener("canplaythrough",a.j,!1);d.removeEventListener("play",a.j,!1);d.removeEventListener("pause",a.j,!1);d.removeEventListener("timeupdate",
a.j,!1);d.removeEventListener("volumechange",a.j,!1);d.removeEventListener("seeked",a.j,!1);d.removeEventListener("ended",a.j,!1);d.removeEventListener("error",a.j,!1);d.removeEventListener("waiting",a.j,!1);d.removeEventListener("stalled",a.j,!1);d.removeEventListener("playing",a.j,!1);d.removeEventListener("error",a.V,!1);d.pause();d.src="";for(var h,k=0,l=d.children.length;k<l;k++)h=d.children[k],h.removeEventListener("error",a.V,!1),h.src="",d.removeChild(h);d.load();d.parentNode===a.c&&a.c.removeChild(d)}b.element=
null;null!==b.buffer&&(b.buffer.destroy(),b.buffer=null);null!==b.played&&(b.played.destroy(),b.played=null)}}
function Xd(a,b,d){a.Fb=d||!1;a.log("Requesting index: "+b+", force: "+a.Fb);-1!==a.C&&a.C!==b&&Yd(a);d=b===a.C?!0:!1;a.C=b;a.Na&&a.Na.F(b);if(b!==a.J&&!0!==d){d=a.C;var h=document.createElement("video");h.setAttribute("webkit-playsinline","webkit-playsinline");h.setAttribute("width",a.pixelWidth);h.setAttribute("height",a.pixelHeight);h.volume=0;h.crossOrigin="anonymous";h.id="FORGE-VideoHTML5-"+a.R+"-"+d;var k=new Zd(h,"buffered"),l=new Zd(h,"played");d=a.L[d];d.element=h;d.buffer=k;d.played=l;
d.lastTimeStamp=0;d.requestCount++;h=a.H[a.C];-1<a.J&&(d.element.addEventListener("loadstart",a.Ib,!1),d.element.addEventListener("error",a.V,!1));k=document.createElement("source");k.addEventListener("error",a.V,!1);k.src=h.url;k.type=h.mimeType;d.element.appendChild(k);a.uc=a.Ii.bind(a);!0===Qd(a)?(a.f=a.i.audio.context,a.Vb=Omnitone.createFOADecoder(a.f,d.element,{channelMap:a.$c}),a.tc=a.tm.bind(a),a.Vb.initialize().then(a.uc,a.tc)):a.Ii();-1===a.J?(a.log("No current video, set directly the current index"),
$d(a,b)):(a.Ya.add(2E4,a.sn,a),a.Ya.start())}}e.Ii=function(){-1===this.C?Rd(this).element.load():Ud(this).element.load()};e.tm=function(){this.log("FOA decoder could not be initialized")};e.an=function(){var a=Ud(this).element;this.log("_onRequestLoadStart [readyState: "+a.readyState+"]");a.removeEventListener("loadstart",this.Ib,!1);a.addEventListener("loadedmetadata",this.Kb,!1)};
e.cn=function(){var a=Ud(this).element;this.log("_onRequestLoadedMetaData [readyState: "+a.readyState+"]");a.removeEventListener("loadedmetadata",this.Kb,!1);a.addEventListener("loadeddata",this.Jb,!1)};e.bn=function(){var a=Ud(this).element;this.log("_onRequestLoadedData [readyState: "+a.readyState+"]");a.removeEventListener("loadeddata",this.Jb,!1);!0===g.A.Vc?(a.addEventListener("play",this.Hb,!1),a.play()):$d(this,this.C,!0)};
e.Zm=function(){var a=Ud(this).element;this.log("_onRequestCanPlayBeforeSeek [readyState: "+a.readyState+"]");a.pause();a.removeEventListener("play",this.Hb,!1);a.addEventListener("seeked",this.Lb,!1);var b=this.currentTime;a.currentTime=!0===this.T&&!1===this.Fb?b+6:b};
e.dn=function(){var a=Ud(this).element;this.log("_onRequestSeeked [readyState: "+a.readyState+"]");a.removeEventListener("seeked",this.Lb,!1);4===a.readyState?(a.removeEventListener("error",this.V,!1),ae(this)):a.addEventListener("canplay",this.Gb,!1)};e.Ym=function(){var a=Ud(this).element;this.log("_onRequestCanPlayAfterSeek [readyState: "+a.readyState+"]");a.removeEventListener("canplay",this.Gb,!1);a.removeEventListener("error",this.V,!1);ae(this)};
function ae(a){var b=Rd(a);b&&null!==b.element&&!1===a.Fb&&(a.log("Current video listen to seek, wait both video to sync"),b.element.addEventListener("seeked",a.Wb,!1),a.Ya.jf(10,a.An,a));for(var b=Ud(a).element,d,h=0,k=b.children.length;h<k;h++)d=b.children[h],d.removeEventListener("error",a.V,!1);!0===a.Fb&&$d(a,a.C)}e.en=function(){this.log("_onRequestSeekedWhileSync "+this.currentTime);var a=this.C;be(this,!1);Xd(this,a)};
e.An=function(){this.log("_videoSyncTimerLoop "+this.C);var a=Ud(this);a&&this.currentTime>=a.element.currentTime&&this.currentTime<a.element.currentTime+.05&&$d(this,this.C)};e.sn=function(){this.log("_requestTimeOutHandler");be(this,!0)};e.$m=function(a){this.log("_onRequestError");this.log(a);be(this,!0)};
function $d(a,b,d){if(b!==a.J){a.c.innerHTML="";var h=Ud(a);!0===a.T&&h.element.play();ce(a,h);h=Rd(a);a.C=-1;a.J=b;b=Rd(a);b.currentCount++;!0===d&&h&&(b.element.currentTime=h.element.currentTime);d=b.element;d.addEventListener("loadstart",a.j,!1);d.addEventListener("durationchange",a.j,!1);d.addEventListener("loadedmetadata",a.j,!1);d.addEventListener("loadeddata",a.j,!1);d.addEventListener("progress",a.j,!1);d.addEventListener("canplay",a.j,!1);d.addEventListener("canplaythrough",a.j,!1);d.addEventListener("play",
a.j,!1);d.addEventListener("pause",a.j,!1);d.addEventListener("timeupdate",a.j,!1);d.addEventListener("volumechange",a.j,!1);d.addEventListener("seeked",a.j,!1);d.addEventListener("ended",a.j,!1);d.addEventListener("error",a.j,!1);d.addEventListener("waiting",a.j,!1);d.addEventListener("stalled",a.j,!1);d.addEventListener("playing",a.j,!1);a.c.appendChild(b.element);h&&null!==h.element&&(h.element.removeEventListener("seeked",a.Wb,!1),d=Sd(a,h),-1!==d&&Wd(a,d));a.Ya.stop(!0);a.Ja&&a.Ja.F(a.J);""===
a.ib&&de(a,a.dd)}}
e.$l=function(){this.log("Auto quality timer loop");if(!1!==this.T&&-1===this.C){var a;a=Rd(this);var b=a.element.currentTime;!1===a.element.playing?a=!1:b===a.lastTimeStamp?(a.lastTimeStamp=0,a=!0):(a.lastTimeStamp=b,a=!1);!0===a?(this.log("AutoQuality downgrade quality"),Rd(this).leaveCount++,0<=this.J-1?Xd(this,this.J-1,!0):this.log("Can't downgrade video quality anymore!")):(a=Rd(this),!0===(a&&null!==a.buffer&&a.buffer.qk(a.element.currentTime,6)?!0:!1)&&this.J!==this.H.length-1&&(a=this.J+1,
this.L[a].abortCount||this.L[a].leaveCount?this.log("AutoQuality do not attempt to load an already aborted video"):(this.log("AutoQuality upgrade quality"),Xd(this,a))))}};function de(a,b){!1===g.A.Vc&&(b=g.Ha.MANUAL,a.warn("Quality mode force to manual, you are not on desktop"));a.ib===b||b!==g.Ha.Xb&&b!==g.Ha.MANUAL||(a.ib=b,a.wb.stop(!1),a.ib===g.Ha.Xb&&a.wb.start(),a.Ka&&a.Ka.F(a.ib))}function be(a,b){var d=Ud(a);d&&(!0===b&&d.abortCount++,Yd(a),a.Ya.stop(!0),a.Ga&&a.Ga.F())}
function Yd(a){var b=Ud(a),d;b&&(d=b.element,d.removeEventListener("loadstart",a.Ib,!1),d.removeEventListener("loadedmetadata",a.Kb,!1),d.removeEventListener("loadeddata",a.Jb,!1),d.removeEventListener("play",a.Hb,!1),d.removeEventListener("seeked",a.Lb,!1),d.removeEventListener("canplay",a.Gb,!1),d.removeEventListener("error",a.V,!1),b=Sd(a,b),-1!==b&&Wd(a,b),a.C=-1)}e.li=function(){ce(this)};
function ce(a,b){(b=b||Rd(a))&&null!==b.element&&!0===a.i.audio.enabled&&(b.element.volume=a.vb*a.i.audio.volume)}e.ki=function(){var a=Rd(this);a&&null!==a.element&&!1===this.i.audio.enabled&&(a.element.volume=0)};
e.Pm=function(a){var b=Rd(this).element;this.log(a.type+" [readyState: "+b.readyState+"]");switch(a.type){case "loadstart":this.pa&&this.pa.F(a);break;case "durationchange":this.ja&&1===b.readyState&&this.ja.F(a);break;case "loadedmetadata":this.Ic=!0;this.va&&this.va.F(a);break;case "loadeddata":this.qa&&this.qa.F(a);break;case "progress":this.Fa&&this.Fa.F(a);break;case "canplay":this.Ub=!0;this.da&&this.da.F(a);break;case "canplaythrough":this.Ub=!0;this.ia&&this.ia.F(a);break;case "play":this.ya&&
this.ya.F(a);break;case "pause":this.T=!1;this.xa&&this.xa.F(a);break;case "timeupdate":this.Ta&&this.Ta.F(a);break;case "volumechange":this.Va&&0!==b.readyState&&this.Va.F(a);break;case "seeked":this.Ub=!1;this.Qa&&this.Qa.F(a);break;case "ended":this.T=!1;this.c.currentTime=0;this.Hc++;!0===this.rc&&this.play(0);this.la&&this.la.F(a);break;case "error":this.na&&this.na.F(a);break;case "waiting":this.Xa&&this.Xa.F(a);break;case "stalled":this.Sa&&this.Sa.F(a);break;case "playing":this.Ea&&this.Ea.F(a);
break;default:this.warn('The event "'+a.type+'" is not handled.')}};function Qd(a){return!0===a.Tb&&!0===a.i.audio.useWebAudio&&"undefined"!==typeof Omnitone}e.update=function(){this.Vb&&!0===this.T&&this.Vb.setRotationMatrixFromCamera(this.i.renderer.camera.modelViewInverse)};
e.load=function(a){if(null!==a)if(!0===g.K.W(a,"string")?a=[a]:!0===g.K.W(a,"VideoQuality")&&(a=[a]),!0===g.K.Pa(a,"string")){for(var b=[],d,h=0,k=a.length;h<k;h++)d=new ee(a[h]),b.push(d);this.H=b}else!0===g.K.Pa(a,"VideoQuality")&&(this.H=a);this.aa&&this.aa.F(this.H);if(!this.H||!this.H.length)throw"FORGE.VideoHTML5.load: Can't create video with no qualities set!";a=this.H.length;b=[];for(h=0;h<a;h++)d={index:h,element:null,buffer:null,played:null,requestCount:0,currentCount:0,abortCount:0,leaveCount:0,
lastTimeStamp:0},b[h]=d;this.L=b;Xd(this,0)};e.play=function(a,b){this.currentTime=a;this.loop=b;(a=Rd(this))&&null!==a.element&&(a.element.play(),this.T=!0,this.Kc++)};e.pause=function(){var a=Rd(this);a&&null!==a.element&&(a.element.pause(),this.T=!1)};e.stop=function(){var a=Rd(this);a&&null!==a.element&&(a.element.pause(),a.element.currentTime=0,this.T=!1)};e.Ol=function(){!0===this.T||!1===this.i.audio.enabled?this.pause():this.play()};
e.qb=function(){!0!==this.cb&&!1!==this.i.audio.enabled&&(this.cb=!0,this.Jc=this.vb,this.vb=0,ce(this),this.wa&&this.wa.F())};e.mi=function(a){!1!==this.cb&&(a="number"===typeof a?a:this.Jc,this.cb=!1,this.vb=g.Math.ca(a,0,1),ce(this),this.Ua&&this.Ua.F())};
e.destroy=function(){Yd(this);this.Ya.destroy();this.Ya=null;this.wb.destroy();this.wb=null;this.pa&&(this.pa.destroy(),this.pa=null);this.va&&(this.va.destroy(),this.va=null);this.qa&&(this.qa.destroy(),this.qa=null);this.Fa&&(this.Fa.destroy(),this.Fa=null);this.ja&&(this.ja.destroy(),this.ja=null);this.da&&(this.da.destroy(),this.da=null);this.ia&&(this.ia.destroy(),this.ia=null);this.ya&&(this.ya.destroy(),this.ya=null);this.xa&&(this.xa.destroy(),this.xa=null);this.Ta&&(this.Ta.destroy(),this.Ta=
null);this.O&&(this.O.destroy(),this.O=null);this.Va&&(this.Va.destroy(),this.Va=null);this.Qa&&(this.Qa.destroy(),this.Qa=null);this.la&&(this.la.destroy(),this.la=null);this.na&&(this.na.destroy(),this.na=null);this.Xa&&(this.Xa.destroy(),this.Xa=null);this.Sa&&(this.Sa.destroy(),this.Sa=null);this.Ea&&(this.Ea.destroy(),this.Ea=null);this.wa&&(this.wa.destroy(),this.wa=null);this.Ua&&(this.Ua.destroy(),this.Ua=null);this.Na&&(this.Na.destroy(),this.Na=null);this.Ja&&(this.Ja.destroy(),this.Ja=
null);this.Ga&&(this.Ga.destroy(),this.Ga=null);this.Ka&&(this.Ka.destroy(),this.Ka=null);this.aa&&(this.aa.destroy(),this.aa=null);for(var a=0,b=this.L.length;a<b;a++)Wd(this,a);this.j=this.Wb=this.Gb=this.Lb=this.Hb=this.Jb=this.Kb=this.Ib=this.V=this.tc=this.uc=null;this.i.audio.onVolumeChange.remove(this.li,this);this.i.audio.onDisable.remove(this.ki,this);this.L=this.H=this.qc=null;T.prototype.destroy.call(this)};
Object.defineProperty(J.prototype,"quality",{get:function(){return this.H[this.J]},set:function(a){if("number"===typeof a&&0<=a&&a<this.H.length)de(this,g.Ha.MANUAL),Xd(this,a);else if(!0===g.K.W(a,"VideoQuality")){a:{for(var b,d=0,h=this.H.length;d<h;d++)if(b=this.H[d],b===a){a=d;break a}a=-1}if(-1!==a)de(this,g.Ha.MANUAL),Xd(this,a);else throw"Unknown quality";}else throw"Video quality "+a+" out of bounds";}});
Object.defineProperty(J.prototype,"qualityMode",{get:function(){return this.ib},set:function(a){a!==g.Ha.Xb&&a!==g.Ha.MANUAL||de(this,a)}});Object.defineProperty(J.prototype,"qualities",{get:function(){return this.H}});Object.defineProperty(J.prototype,"requestIndex",{get:function(){return this.C}});Object.defineProperty(J.prototype,"currentIndex",{get:function(){return this.J}});Object.defineProperty(J.prototype,"videos",{get:function(){return this.L}});
Object.defineProperty(J.prototype,"element",{get:function(){var a=Rd(this);return a&&null!==a.element?a.element:null}});Object.defineProperty(J.prototype,"buffer",{get:function(){var a=Rd(this);return a&&null!==a.buffer?a.buffer:null}});Object.defineProperty(J.prototype,"played",{get:function(){var a=Rd(this);return a&&null!==a.played?a.played:null}});Object.defineProperty(J.prototype,"originalWidth",{get:function(){return Vd(this,"videoWidth")}});
Object.defineProperty(J.prototype,"originalHeight",{get:function(){return Vd(this,"videoHeight")}});Object.defineProperty(J.prototype,"currentTime",{get:function(){return Vd(this,"currentTime")},set:function(a){if("number"===typeof a){var b=Rd(this);b&&null!==b.element&&(b.element.currentTime=a,this.O&&this.O.F(a))}}});Object.defineProperty(J.prototype,"currentTimeMS",{get:function(){return 1E3*this.currentTime},set:function(a){this.currentTime=a/1E3}});
Object.defineProperty(J.prototype,"remainingTime",{get:function(){return this.duration-this.currentTime}});Object.defineProperty(J.prototype,"duration",{get:function(){return Vd(this,"duration")}});Object.defineProperty(J.prototype,"durationMS",{get:function(){return Math.round(1E3*this.duration)}});Object.defineProperty(J.prototype,"playing",{get:function(){return this.T}});Object.defineProperty(J.prototype,"playCount",{get:function(){return this.Kc}});
Object.defineProperty(J.prototype,"canPlay",{get:function(){return this.Ub}});Object.defineProperty(J.prototype,"endCount",{get:function(){return this.Hc}});Object.defineProperty(J.prototype,"metaDataLoaded",{get:function(){return this.Ic}});Object.defineProperty(J.prototype,"loop",{get:function(){return this.rc},set:function(a){"boolean"===typeof a&&(this.rc=a)}});
Object.defineProperty(J.prototype,"volume",{get:function(){return this.vb},set:function(a){"number"===typeof a&&(this.vb=g.Math.ca(a,0,1),this.cb=!1,ce(this))}});Object.defineProperty(J.prototype,"muted",{get:function(){return this.cb},set:function(a){!0===!!a?this.qb():this.mi()}});Object.defineProperty(J.prototype,"ambisonic",{get:function(){return this.Tb}});Object.defineProperty(J.prototype,"onLoadStart",{get:function(){this.pa||(this.pa=new q(this));return this.pa}});
Object.defineProperty(J.prototype,"onLoadedMetaData",{get:function(){this.va||(this.va=new q(this));return this.va}});Object.defineProperty(J.prototype,"onLoadedData",{get:function(){this.qa||(this.qa=new q(this));return this.qa}});Object.defineProperty(J.prototype,"onProgress",{get:function(){this.Fa||(this.Fa=new q(this));return this.Fa}});Object.defineProperty(J.prototype,"onDurationChange",{get:function(){this.ja||(this.ja=new q(this));return this.ja}});
Object.defineProperty(J.prototype,"onCanPlay",{get:function(){this.da||(this.da=new q(this));return this.da}});Object.defineProperty(J.prototype,"onCanPlayThrough",{get:function(){this.ia||(this.ia=new q(this));return this.ia}});Object.defineProperty(J.prototype,"onPlay",{get:function(){this.ya||(this.ya=new q(this));return this.ya}});Object.defineProperty(J.prototype,"onPause",{get:function(){this.xa||(this.xa=new q(this));return this.xa}});
Object.defineProperty(J.prototype,"onTimeUpdate",{get:function(){this.Ta||(this.Ta=new q(this));return this.Ta}});Object.defineProperty(J.prototype,"onCurrentTimeChange",{get:function(){this.O||(this.O=new q(this));return this.O}});Object.defineProperty(J.prototype,"onVolumeChange",{get:function(){this.Va||(this.Va=new q(this));return this.Va}});Object.defineProperty(J.prototype,"onSeeked",{get:function(){this.Qa||(this.Qa=new q(this));return this.Qa}});
Object.defineProperty(J.prototype,"onEnded",{get:function(){this.la||(this.la=new q(this));return this.la}});Object.defineProperty(J.prototype,"onError",{get:function(){this.na||(this.na=new q(this));return this.na}});Object.defineProperty(J.prototype,"onWaiting",{get:function(){this.Xa||(this.Xa=new q(this));return this.Xa}});Object.defineProperty(J.prototype,"onStalled",{get:function(){this.Sa||(this.Sa=new q(this));return this.Sa}});
Object.defineProperty(J.prototype,"onPlaying",{get:function(){this.Ea||(this.Ea=new q(this));return this.Ea}});Object.defineProperty(J.prototype,"onMute",{get:function(){this.wa||(this.wa=new q(this));return this.wa}});Object.defineProperty(J.prototype,"onUnmute",{get:function(){this.Ua||(this.Ua=new q(this));return this.Ua}});Object.defineProperty(J.prototype,"onQualityRequest",{get:function(){this.Na||(this.Na=new q(this));return this.Na}});
Object.defineProperty(J.prototype,"onQualityChange",{get:function(){this.Ja||(this.Ja=new q(this));return this.Ja}});Object.defineProperty(J.prototype,"onQualityAbort",{get:function(){this.Ga||(this.Ga=new q(this));return this.Ga}});Object.defineProperty(J.prototype,"onQualityModeChange",{get:function(){this.Ka||(this.Ka=new q(this));return this.Ka}});Object.defineProperty(J.prototype,"onQualitiesLoaded",{get:function(){this.aa||(this.aa=new q(this,!0));return this.aa}});
function I(a,b,d,h){this.i=a;this.Wl=b;this.dd=d||null;this.cb="";this.Na=null;this.Vl=h||g.Ha.Xb;this.Xa="";this.j=null;this.hd=!1;this.Ta=1;this.Ja=!1;this.si=0;this.oi=!1;this.ib=this.f=null;this.nf=this.mf=this.Qa=this.Ya=0;this.wb=this.Fa=this.Kc=this.$c=null;this.vb=this.Ka=!1;this.ni=this.ti=0;this.Tb=this.qf=this.rc=this.tc=this.Wb=this.Hc=this.Ua=this.Ib=this.uc=this.Jc=this.Ic=this.Ub=this.Vb=this.Gb=this.Fb=this.Hb=this.qc=this.Kb=this.Lb=this.Jb=this.Ga=this.qa=this.C=this.Sa=this.pa=
this.va=this.la=this.xa=this.T=this.O=this.wa=this.Ea=this.Va=this.ya=this.ia=this.ja=this.J=this.H=this.L=this.na=this.aa=this.da=this.V=null;T.call(this,a,null,"VideoDash")}I.prototype=Object.create(T.prototype);I.prototype.constructor=I;var fe={VIDEO:"video",AUDIO:"audio"};e=I.prototype;
e.La=function(){T.prototype.La.call(this);if("undefined"===typeof dashjs)throw"FORGE.VideoDash._boot: Can't create MPEG-DASH video stream without dash.js Media Player.";this.R=this.Wl;aa(this);this.Jb=this.Rm.bind(this);this.Hb=this.Nm.bind(this);this.Lb=this.Jl.bind(this);this.Kb=this.Sm.bind(this);this.qc=this.Vm.bind(this);this.Fb=this.Mm.bind(this);this.Gb=this.Hl.bind(this);this.Vb=this.Ll.bind(this);this.Ub=this.Kl.bind(this);this.Ic=this.kn.bind(this);this.Jc=this.qn.bind(this);this.uc=this.gn.bind(this);
this.Ib=this.Il.bind(this);this.Ua=this.Om.bind(this);this.Hc=this.hn.bind(this);this.Wb=this.Um.bind(this);this.tc=this.Xm.bind(this);this.rc=this.Wm.bind(this);this.qf=this.jn.bind(this);this.Tb=this.Tm.bind(this);this.i.audio.onVolumeChange.add(this.ii,this);this.i.audio.onDisable.add(this.hi,this);this.C=new q(this,!0);null!==this.dd&&this.load(this.dd);this.i.display.register(this);ld(this);md(this)};
e.za=function(a){var b=this.j;b&&null!==b.element&&(b.element.setAttribute("width",this.pixelWidth),b.element.setAttribute("height",this.pixelHeight));T.prototype.za.call(this,a)};function ge(a,b){return(a=a.j)&&null!==a.element?a.element[b]:0}
e.Rm=function(a){this.log("onLoadStart [readyState: "+this.j.element.readyState+"]");var b=this.cb,d=this.f.getBitrateInfoListFor(fe.VIDEO),h=[],k;if(d){for(var l=0,p=d.length;l<p;l++)k=new ee(b),k.id=d[l].qualityIndex,k.bitrate=d[l].bitrate,k.width=d[l].width,k.height=d[l].height,h.push(k);this.Na=h;this.C&&this.C.F(h)}else this.destroy();this.V&&this.V.F(a)};e.jn=function(a){this.log("_onSwitchCompleted [readyState: "+this.j.element.readyState+"]");this.ib=a.toStreamInfo};
e.Tm=function(a){this.log("_onMetricsChangedHandler [readyState: "+this.j.element.readyState+"]");this.$c||(this.$c=this.f.getMetricsFor(fe.VIDEO));this.Kc||(this.Kc=this.f.getMetricsFor(fe.AUDIO));this.Fa||(this.Fa=this.f.getDashMetrics());if(this.Ga){var b;a.mediaType===fe.VIDEO&&(b=he(this,fe.VIDEO,this.$c,this.Fa))&&(this.wb={videoBitrate:b.bitrate,videoIndex:b.index,videoPendingIndex:b.Bk,videoMaxIndex:b.vk,videoBufferLength:b.xj,videoDroppedFrames:b.droppedFrames});a.mediaType===fe.AUDIO&&(b=
he(this,fe.AUDIO,this.Kc,this.Fa))&&(this.wb={audioBitrate:b.bitrate,audioIndex:b.index,audioPendingIndex:b.Bk,audioMaxIndex:b.vk,audioBufferLength:b.xj,audioDroppedFrames:b.droppedFrames});this.Ga.F(a)}};
function he(a,b,d,h){if(d&&h){var k=a.ib.index,l,p,r,u,A,ob;(l=h.getCurrentRepresentationSwitch(d))&&(p=Math.round(h.getBandwidthForRepresentation(l.to,k)/1E3));if(isNaN(p)||void 0===p)p=0;b===fe.VIDEO?(r=a.Ya+1,u=a.Qa+1):b===fe.AUDIO&&(r=a.mf+1,u=a.nf+1);if(isNaN(r)||void 0===r)r=0;if(isNaN(u)||void 0===u)u=0;a=h.getMaxIndexForBufferType(b,k);if(isNaN(a)||void 0===a)a=0;b=h.getCurrentBufferLevel(d);null!==b&&(A=b.toPrecision(5));if(isNaN(A)||void 0===A)A=0;if(d=h.getCurrentDroppedFrames(d))ob=d.droppedFrames;
return{bitrate:p,index:r,Bk:u,vk:a,xj:A,droppedFrames:ob}}return null}e.Wm=function(a){this.log("onQualityChange [readyState: "+this.j.element.readyState+"]");a.mediaType===fe.AUDIO?this.nf=this.mf=a.newQuality:a.mediaType===fe.VIDEO&&(this.Qa=this.Ya=a.newQuality,this.pa&&this.pa.F(this.Qa))};
e.Xm=function(a){this.log("onQualityRequest [readyState: "+this.j.element.readyState+"]");a.mediaType===fe.AUDIO?(this.mf=a.oldQuality,this.nf=a.newQuality):a.mediaType===fe.VIDEO&&(this.Ya=a.oldQuality,this.Qa=a.newQuality,this.va&&this.va.F(this.Qa))};e.Nm=function(a){var b=this.j.element;this.log("onDurationChange [readyState: "+b.readyState+"]");this.L&&1===b.readyState&&this.L.F(a)};
e.Jl=function(a){this.log("onLoadedMetaData [readyState: "+this.j.element.readyState+"]");this.oi=!0;this.da&&this.da.F(a)};e.Sm=function(a){this.log("onLoadedData [readyState: "+this.j.element.readyState+"]");this.aa&&this.aa.F(a)};e.Vm=function(a){this.na&&this.na.F(a)};e.Mm=function(a){this.log("onCanPlay [readyState: "+this.j.element.readyState+"]");this.vb=!0;this.H&&this.H.F(a)};e.Hl=function(a){this.log("onCanPlayThrough [readyState: "+this.j.element.readyState+"]");this.vb=!0;this.J&&this.J.F(a)};
e.Ll=function(a){this.log("onPlay [readyState: "+this.j.element.readyState+"]");this.ja&&this.ja.F(a)};e.Kl=function(a){this.log("onPause [readyState: "+this.j.element.readyState+"]");this.Ka=!1;this.ia&&this.ia.F(a)};e.kn=function(a){this.ya&&this.ya.F(a)};e.qn=function(a){var b=this.j.element;this.log("onVolumeChange [readyState: "+b.readyState+"]");this.Ea&&0!==b.readyState&&this.Ea.F(a)};e.gn=function(a){this.log("onSeeked [readyState: "+this.j.element.readyState+"]");this.vb=!1;this.wa&&this.wa.F(a)};
e.Il=function(a){this.log("onEnded [readyState: "+this.j.element.readyState+"]");this.Ka=!1;this.ni++;!0===this.hd&&this.play();this.O&&this.O.F(a)};e.Om=function(a){this.log("onError [readyState: "+this.j.element.readyState+"]");this.T&&this.T.F(a)};e.hn=function(a){this.log("onStalled [readyState: "+this.j.element.readyState+"]");this.xa&&this.xa.F(a)};e.Um=function(a){this.log("onPlaying [readyState: "+this.j.element.readyState+"]");this.la&&this.la.F(a)};
e.hi=function(){var a=this.j;a&&null!==a.element&&!1===this.i.audio.enabled&&this.f.setVolume(0)};e.ii=function(){ie(this)};function ie(a){var b=a.j;b&&null!==b.element&&!0===a.i.audio.enabled&&(a.f.setVolume(a.Ta*a.i.audio.volume),!0===a.Ja?a.f.setMute(!0):a.f.setMute(!1))}
function je(a,b){a.Qa=b;if(a.ib&&a.f&&!0===a.f.isReady()&&a.Fa){var d=a.ib.index,h=a.Fa.getMaxIndexForBufferType(fe.VIDEO,d),d=a.Fa.getMaxIndexForBufferType(fe.AUDIO,d),k=b;k>=h&&(k=h-1);0>k&&(k=0);b>=d&&(b=d-1);0>b&&(b=0);a.f.setQualityFor(fe.VIDEO,k);a.f.setQualityFor(fe.AUDIO,b)}ie(a)}
function ke(a,b){a.Xa===b||b!==g.Ha.Xb&&b!==g.Ha.MANUAL||(a.Xa=b,a.f&&!0===a.f.isReady()&&(b===g.Ha.MANUAL?(a.f.setAutoSwitchQualityFor(fe.VIDEO,!1),a.f.setAutoSwitchQualityFor(fe.AUDIO,!1)):(a.f.setAutoSwitchQualityFor(fe.VIDEO,!0),a.f.setAutoSwitchQualityFor(fe.AUDIO,!0))),a.qa&&a.qa.F(a.Xa))}
e.load=function(a){null!==a&&(!0===g.K.W(a,"string")?a=[a]:!0===g.K.W(a,"VideoQuality")&&(a=[a]),!0===g.K.Pa(a,"string")?this.cb=a[0]:!0===g.K.Pa(a,"VideoQuality")&&(this.cb=a[0].url));if(""===this.cb)throw"FORGE.VideoDash : Can't create video with no manifest!";this.j={index:0,element:null,buffer:null,played:null};a=document.createElement("video");a.setAttribute("webkit-playsinline","webkit-playsinline");a.setAttribute("width",this.pixelWidth);a.setAttribute("height",this.pixelHeight);a.volume=0;
a.crossOrigin="anonymous";a.id="FORGE-VideoDash-"+this.R;var b=new Zd(a,"buffered"),d=new Zd(a,"played"),h=this.j;h.element=a;h.buffer=b;h.played=d;h.lastTimeStamp=0;this.f=dashjs.MediaPlayer().create();this.f.getDebug().setLogToBrowserConsole(!1);this.f.initialize();this.f.setAutoPlay(!1);this.f.attachView(this.j.element);this.f.attachSource(this.cb);!0===this.f.isReady()&&(this.f.on(dashjs.MediaPlayer.events.CAN_PLAY,this.Fb),this.f.on(dashjs.MediaPlayer.events.ERROR,this.Ua),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_ENDED,
this.Ib),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_ERROR,this.Ua),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_METADATA_LOADED,this.Lb),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_PAUSED,this.Ub),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_PROGRESS,this.qc),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_SEEKED,this.uc),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_STARTED,this.Vb),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_TIME_UPDATED,this.Ic),this.f.on(dashjs.MediaPlayer.events.QUALITY_CHANGE_RENDERED,
this.rc),this.f.on(dashjs.MediaPlayer.events.QUALITY_CHANGE_REQUESTED,this.tc),this.f.on(dashjs.MediaPlayer.events.STREAM_INITIALIZED,this.Jb),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_PLAYING,this.Wb),this.f.on(dashjs.MediaPlayer.events.BUFFER_EMPTY,this.Hc),this.f.on(dashjs.MediaPlayer.events.PERIOD_SWITCH_COMPLETED,this.qf),this.f.on(dashjs.MediaPlayer.events.METRIC_CHANGED,this.Tb),this.j.element.addEventListener("loadeddata",this.Kb,!1),this.j.element.addEventListener("durationchange",this.Hb,
!1),this.j.element.addEventListener("canplaythrough",this.Gb,!1),this.j.element.addEventListener("volumechange",this.Jc,!1),this.c.innerHTML="",this.c.appendChild(this.j.element));""===this.Xa&&ke(this,this.Vl)};e.play=function(a,b){this.currentTime=a;this.loop=b;this.f&&!0===this.f.isReady()&&(this.f.play(),this.Ka=!0,this.ti++)};e.pause=function(){this.f&&!0===this.f.isReady()&&(this.f.pause(),this.Ka=!1)};
e.stop=function(){this.f&&!0===this.f.isReady()&&(this.f.pause(),this.f.seek(0),this.j.element.currentTime=0,this.Ka=!1)};e.Nl=function(){!0===this.Ka||!1===this.i.audio.enabled?this.pause():this.play()};e.qb=function(){!0!==this.Ja&&!1!==this.i.audio.enabled&&(this.Ja=!0,this.si=this.Ta,this.Ta=0,ie(this))};e.ji=function(a){!1!==this.Ja&&(a="number"===typeof a?a:this.si,this.Ja=!1,this.Ta=g.Math.ca(a,0,1),ie(this))};e.Ml=function(a){this.f&&!0===this.f.isReady()&&this.f.enableBufferOccupancyABR(a)};
e.destroy=function(){this.log("_destroyVideo");this.f&&!0===this.f.isReady()&&(this.f.off(dashjs.MediaPlayer.events.CAN_PLAY,this.Fb),this.f.off(dashjs.MediaPlayer.events.ERROR,this.Ua),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_ENDED,this.Ib),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_ERROR,this.Ua),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_METADATA_LOADED,this.Lb),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_PAUSED,this.Ub),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_PROGRESS,this.qc),
this.f.off(dashjs.MediaPlayer.events.PLAYBACK_SEEKED,this.uc),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_STARTED,this.Vb),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_TIME_UPDATED,this.Ic),this.f.off(dashjs.MediaPlayer.events.QUALITY_CHANGE_RENDERED,this.rc),this.f.off(dashjs.MediaPlayer.events.QUALITY_CHANGE_REQUESTED,this.tc),this.f.off(dashjs.MediaPlayer.events.STREAM_INITIALIZED,this.Jb),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_PLAYING,this.Wb),this.f.off(dashjs.MediaPlayer.events.BUFFER_EMPTY,
this.Hc),this.f.off(dashjs.MediaPlayer.events.PERIOD_SWITCH_COMPLETED,this.qf),this.f.off(dashjs.MediaPlayer.events.METRIC_CHANGED,this.Tb),this.j.element.removeEventListener("loadeddata",this.Kb,!1),this.j.element.removeEventListener("durationchange",this.Hb,!1),this.j.element.removeEventListener("canplaythrough",this.Gb,!1),this.j.element.removeEventListener("volumechange",this.Jc,!1),this.f.pause(),this.f.reset());var a=this.j,b=a.element;"undefined"!==typeof b&&null!==b&&b.parentNode===this.c&&
this.c.removeChild(b);a.element=null;null!==a.buffer&&(a.buffer.destroy(),a.buffer=null);null!==a.played&&(a.played.destroy(),a.played=null);this.V&&(this.V.destroy(),this.V=null);this.da&&(this.da.destroy(),this.da=null);this.aa&&(this.aa.destroy(),this.aa=null);this.na&&(this.na.destroy(),this.na=null);this.L&&(this.L.destroy(),this.L=null);this.H&&(this.H.destroy(),this.H=null);this.J&&(this.J.destroy(),this.J=null);this.ja&&(this.ja.destroy(),this.ja=null);this.ia&&(this.ia.destroy(),this.ia=
null);this.ya&&(this.ya.destroy(),this.ya=null);this.Va&&(this.Va.destroy(),this.Va=null);this.Ea&&(this.Ea.destroy(),this.Ea=null);this.wa&&(this.wa.destroy(),this.wa=null);this.O&&(this.O.destroy(),this.O=null);this.T&&(this.T.destroy(),this.T=null);this.xa&&(this.xa.destroy(),this.xa=null);this.la&&(this.la.destroy(),this.la=null);this.va&&(this.va.destroy(),this.va=null);this.pa&&(this.pa.destroy(),this.pa=null);this.Sa&&(this.Sa.destroy(),this.Sa=null);this.C&&(this.C.destroy(),this.C=null);
this.qa&&(this.qa.destroy(),this.qa=null);this.Ga&&(this.Ga.destroy(),this.Ga=null);this.Tb=this.rc=this.tc=this.Hc=this.Wb=this.Ua=this.Ib=this.uc=this.Jc=this.Ic=this.Ub=this.Vb=this.Gb=this.Fb=this.Hb=this.qc=this.Kb=this.Lb=this.Jb=null;this.i.audio.onVolumeChange.remove(this.ii,this);this.i.audio.onDisable.remove(this.hi,this);this.j=this.Na=this.dd=this.ib=this.wb=this.Fa=this.Kc=this.$c=this.f=null;T.prototype.destroy.call(this)};Object.defineProperty(I.prototype,"monitoring",{get:function(){return this.wb}});
Object.defineProperty(I.prototype,"quality",{get:function(){return this.Na[this.Ya]},set:function(a){if("number"===typeof a&&0<=a&&a<this.Na.length)ke(this,g.Ha.MANUAL),je(this,a);else if(!0===g.K.W(a,"VideoQuality")){a:{for(var b,d=0,h=this.Na.length;d<h;d++)if(b=this.Na[d],b===a){a=d;break a}a=-1}if(-1!==a)ke(this,g.Ha.MANUAL),je(this,a);else throw"Unknown quality";}else throw"Video quality "+a+" out of bounds";}});
Object.defineProperty(I.prototype,"qualityMode",{get:function(){return this.Xa},set:function(a){a!==g.Ha.Xb&&a!==g.Ha.MANUAL||ke(this,a)}});Object.defineProperty(I.prototype,"qualities",{get:function(){return this.Na}});Object.defineProperty(I.prototype,"requestIndex",{get:function(){return this.Qa}});Object.defineProperty(I.prototype,"currentIndex",{get:function(){return this.Ya}});Object.defineProperty(I.prototype,"video",{get:function(){return this.j}});
Object.defineProperty(I.prototype,"element",{get:function(){var a=this.j;return a&&null!==a.element?a.element:null}});Object.defineProperty(I.prototype,"buffer",{get:function(){var a=this.j;return a&&null!==a.buffer?a.buffer:null}});Object.defineProperty(I.prototype,"played",{get:function(){var a=this.j;return a&&null!==a.played?a.played:null}});Object.defineProperty(I.prototype,"originalWidth",{get:function(){return ge(this,"videoWidth")}});
Object.defineProperty(I.prototype,"originalHeight",{get:function(){return ge(this,"videoHeight")}});Object.defineProperty(I.prototype,"currentTime",{get:function(){return this.f.time()},set:function(a){"number"===typeof a&&(this.f.seek(a),this.Va&&this.Va.F(a))}});Object.defineProperty(I.prototype,"currentTimeMS",{get:function(){return 1E3*this.currentTime},set:function(a){this.currentTime=a/1E3}});Object.defineProperty(I.prototype,"remainingTime",{get:function(){return this.duration-this.currentTime}});
Object.defineProperty(I.prototype,"duration",{get:function(){return this.f.duration()}});Object.defineProperty(I.prototype,"durationMS",{get:function(){return Math.round(1E3*this.duration)}});Object.defineProperty(I.prototype,"playing",{get:function(){return this.Ka}});Object.defineProperty(I.prototype,"playCount",{get:function(){return this.ti}});Object.defineProperty(I.prototype,"canPlay",{get:function(){return this.vb}});Object.defineProperty(I.prototype,"endCount",{get:function(){return this.ni}});
Object.defineProperty(I.prototype,"metaDataLoaded",{get:function(){return this.oi}});Object.defineProperty(I.prototype,"loop",{get:function(){return this.hd},set:function(a){"boolean"===typeof a&&(this.hd=a)}});Object.defineProperty(I.prototype,"volume",{get:function(){return this.Ta},set:function(a){"number"===typeof a&&(this.Ta=g.Math.ca(a,0,1),this.Ja=!1,ie(this))}});Object.defineProperty(I.prototype,"muted",{get:function(){return this.Ja},set:function(a){!0===!!a?this.qb():this.ji()}});
Object.defineProperty(I.prototype,"onLoadStart",{get:function(){this.V||(this.V=new q(this));return this.V}});Object.defineProperty(I.prototype,"onLoadedMetaData",{get:function(){this.da||(this.da=new q(this));return this.da}});Object.defineProperty(I.prototype,"onLoadedData",{get:function(){this.aa||(this.aa=new q(this));return this.aa}});Object.defineProperty(I.prototype,"onProgress",{get:function(){this.na||(this.na=new q(this));return this.na}});
Object.defineProperty(I.prototype,"onDurationChange",{get:function(){this.L||(this.L=new q(this));return this.L}});Object.defineProperty(I.prototype,"onCanPlay",{get:function(){this.H||(this.H=new q(this));return this.H}});Object.defineProperty(I.prototype,"onCanPlayThrough",{get:function(){this.J||(this.J=new q(this));return this.J}});Object.defineProperty(I.prototype,"onPlay",{get:function(){this.ja||(this.ja=new q(this));return this.ja}});
Object.defineProperty(I.prototype,"onPause",{get:function(){this.ia||(this.ia=new q(this));return this.ia}});Object.defineProperty(I.prototype,"onTimeUpdate",{get:function(){this.ya||(this.ya=new q(this));return this.ya}});Object.defineProperty(I.prototype,"onCurrentTimeChange",{get:function(){this.O||(this.O=new q(this));return this.O}});Object.defineProperty(I.prototype,"onVolumeChange",{get:function(){this.Ea||(this.Ea=new q(this));return this.Ea}});
Object.defineProperty(I.prototype,"onSeeked",{get:function(){this.wa||(this.wa=new q(this));return this.wa}});Object.defineProperty(I.prototype,"onEnded",{get:function(){this.O||(this.O=new q(this));return this.O}});Object.defineProperty(I.prototype,"onError",{get:function(){this.T||(this.T=new q(this));return this.T}});Object.defineProperty(I.prototype,"onStalled",{get:function(){this.xa||(this.xa=new q(this));return this.xa}});Object.defineProperty(I.prototype,"onWaiting",{get:function(){return this.onStalled}});
Object.defineProperty(I.prototype,"onPlaying",{get:function(){this.la||(this.la=new q(this));return this.la}});Object.defineProperty(I.prototype,"onQualityRequest",{get:function(){this.va||(this.va=new q(this));return this.va}});Object.defineProperty(I.prototype,"onQualityChange",{get:function(){this.pa||(this.pa=new q(this));return this.pa}});Object.defineProperty(I.prototype,"onQualityAbort",{get:function(){this.Sa||(this.Sa=new q(this));return this.Sa}});
Object.defineProperty(I.prototype,"onMetricsChanged",{get:function(){this.Ga||(this.Ga=new q(this));return this.Ga}});Object.defineProperty(I.prototype,"onQualitiesLoaded",{get:function(){this.C||(this.C=new q(this,!0));return this.C}});Object.defineProperty(I.prototype,"onQualityModeChange",{get:function(){this.qa||(this.qa=new q(this));return this.qa}});function Zd(a,b){this.c=a;this.f=b;n.call(this,"VideoTimeRanges")}Zd.prototype=Object.create(n.prototype);Zd.prototype.constructor=Zd;
Zd.prototype.j=function(a){var b=this.c[this.f];if(!this.length)return this.warn("No available range for now"),null;if(a>this.length-1)return this.warn("Time range out of bounds, returning the last available range"),this.j(this.length-1);if(0>a)return this.warn("Time range out of bounds, returning the first available range"),this.j(0);var d=b.start(a);a=b.end(a);return{start:d,end:a}};
Zd.prototype.qk=function(a,b){"number"!==typeof b&&(b=0);for(var d=this.c[this.f],h,k,l=this.length;l--;)if(h=d.start(l),k=d.end(l),a>=h&&a+b<=k)return!0;return!1};Object.defineProperty(Zd.prototype,"length",{get:function(){return this.c[this.f].length}});function ee(a){this.m="";this.j=a||"";this.o=this.c="";this.f=this.u=this.B=0;n.call(this,"VideoQuality")}ee.prototype=Object.create(n.prototype);ee.prototype.constructor=ee;
function le(a){var b=["mp4","webm","ogg"];a=ya(a);if(""!==a.extension&&-1!==b.indexOf(a.extension))return"video/"+a.extension;b=["mpd"];return""!==a.extension&&-1!==b.indexOf(a.extension)?"application/dash+xml":""}Object.defineProperty(ee.prototype,"id",{get:function(){return this.m},set:function(a){if("number"===typeof a||"string"===typeof a)this.m=a}});Object.defineProperty(ee.prototype,"url",{get:function(){return this.j},set:function(a){"string"===typeof a&&(this.j=a)}});
Object.defineProperty(ee.prototype,"mimeType",{get:function(){""===this.c&&""!==this.j&&(this.c=le(this.j));return this.c}});Object.defineProperty(ee.prototype,"name",{get:function(){return this.o},set:function(a){"string"===typeof a&&(this.o=a)}});Object.defineProperty(ee.prototype,"framerate",{get:function(){return 0}});Object.defineProperty(ee.prototype,"bitrate",{get:function(){return this.B},set:function(a){"number"===typeof a&&(this.B=a)}});
Object.defineProperty(ee.prototype,"width",{get:function(){return this.u},set:function(a){"number"===typeof a&&(this.u=a)}});Object.defineProperty(ee.prototype,"height",{get:function(){return this.f},set:function(a){"number"===typeof a&&(this.f=a)}});Object.defineProperty(ee.prototype,"speed",{get:function(){return 1}});g.Ha={};g.Ha.Xb="auto";g.Ha.MANUAL="manual";g.nb={};g.nb.Pe="dash";g.nb.Ul="html5";g.nb.Td="unknown";
function xd(a){this.m=a;this.f={};this.c=null;this.j=[];n.call(this,"SpriteAnimationManager");!1===this.m.loaded&&this.m.onLoadComplete.ga(this.xn,this)}xd.prototype=Object.create(n.prototype);e=xd.prototype;e.constructor=xd;e.xn=function(){this.log("_spriteLoadComplete");for(var a,b,d=0,h=this.j.length;d<h;d++)a=this.j[d].method,b=this.j[d].args,xd.prototype[a].apply(this,b);this.j=[]};
e.add=function(a,b,d,h,k){if(!1===this.m.loaded)this.j.push({method:"add",args:arguments});else{this.log("add");"string"!==typeof a&&(a="default");b=parseInt(b,10);d=parseInt(d,10);var l=this.m.frames;if("number"!==typeof b||!0===isNaN(b)||0>b||b>=l.length)b=0;if("number"!==typeof d||!0===isNaN(d)||0>d||d>=l.length)d=l.length;k="undefined"===typeof k?!1:!!k;this.f[a]=new Y(this.m,a,l.slice(b,d),h||60);this.c=this.f[a]}};
e.play=function(a,b,d){if(!1===this.m.loaded)this.j.push({method:"play",args:arguments});else{var h=this.c;"string"===typeof a&&null!==a&&(h=this.get(a));h&&h.play(b,d)}};e.pause=function(a){var b=this.c;b&&b.pause(a)};e.resume=function(a){var b=this.c;b&&b.resume(a)};e.stop=function(){var a=this.c;a&&a.stop()};e.get=function(a){return!0===g.K.W(this.f[a],"SpriteAnimation")?this.f[a]:null};e.update=function(){this.c&&this.c.update()};
e.destroy=function(){for(var a in this.f)this.f[a].destroy(),this.f[a]=null;this.j=this.c=this.f=this.m=null;n.prototype.destroy.call(this)};Object.defineProperty(xd.prototype,"currentAnimation",{get:function(){return this.c},set:function(a){!0===g.K.W(a,"SpriteAnimation")&&(this.c=a)}});
function Y(a,b,d,h){this.C=a;this.O=b;this.D=d||[];this.P=0;this.Z=h||60;this.L=!1;this.$=0;this.G=1E3/h;this.H=this.M=0;this.U=1;this.J=this.c=this.I=!1;this.f=this.B=this.j=this.u=this.m=this.o=null;n.call(this,"SpriteAnimation")}Y.prototype=Object.create(n.prototype);e=Y.prototype;e.constructor=Y;function me(a,b){a.P="number"===typeof b&&0<=b&&b<a.D.length?b:0;a.C.frame=a.D[a.P].frame}
e.play=function(a,b){"boolean"===typeof a&&(this.L=a);this.I=!0;this.c=this.J=!1;this.$=0;this.M=this.C.viewer.clock.time+this.G;me(this,b);this.C.animations.Do=this;this.o&&this.o.F()};e.pause=function(a){!0!==this.c&&(this.c=!0,"number"===typeof a&&me(this,a),this.m&&this.m.F())};e.resume=function(a){!1!==this.c&&(this.c=!1,"number"===typeof a&&me(this,a),this.I&&(this.M=this.C.viewer.clock.time+this.G),this.u&&this.u.F())};e.stop=function(){this.I=!1;this.J=!0;this.c=!1;me(this,0);this.B&&this.B.F()};
e.update=function(){if(!0!==this.c){var a=this.C.viewer.clock.time;!0===this.I&&a>=this.M&&(this.U=1,this.H=a-this.M,this.H>this.G&&(this.U=Math.floor(this.H/this.G),this.H-=this.U*this.G),this.M=a+(this.G-this.H),a=this.P+this.U,a>=this.D.length?!0===this.L?(a%=this.D.length,this.$++,this.j&&this.j.F(),me(this,a)):(me(this,this.D.length-1),this.I=!1,this.J=!0,this.c=!1,this.f&&this.f.F()):me(this,a))}};
e.destroy=function(){this.D=this.C=null;this.o&&(this.o.destroy(),this.o=null);this.m&&(this.m.destroy(),this.m=null);this.u&&(this.u.destroy(),this.u=null);this.f&&(this.f.destroy(),this.f=null);this.j&&(this.j.destroy(),this.j=null);this.B&&(this.B.destroy(),this.B=null);n.prototype.destroy.call(this)};Object.defineProperty(Y.prototype,"name",{get:function(){return this.O}});Object.defineProperty(Y.prototype,"frames",{get:function(){return this.D}});
Object.defineProperty(Y.prototype,"frameIndex",{get:function(){return this.P}});Object.defineProperty(Y.prototype,"frameRate",{get:function(){return this.Z},set:function(a){"number"===typeof a&&(this.Z=a,this.G=1E3/this.Z)}});Object.defineProperty(Y.prototype,"loop",{get:function(){return this.L},set:function(a){this.L=!!a}});Object.defineProperty(Y.prototype,"loopCount",{get:function(){return this.$}});Object.defineProperty(Y.prototype,"playing",{get:function(){return this.I}});
Object.defineProperty(Y.prototype,"paused",{get:function(){return this.c},set:function(a){!0===!!a?this.pause():this.resume()}});Object.defineProperty(Y.prototype,"complete",{get:function(){return this.J}});Object.defineProperty(Y.prototype,"onPlay",{get:function(){this.o||(this.o=new q(this));return this.o}});Object.defineProperty(Y.prototype,"onPause",{get:function(){this.m||(this.m=new q(this));return this.m}});
Object.defineProperty(Y.prototype,"onResume",{get:function(){this.u||(this.u=new q(this));return this.u}});Object.defineProperty(Y.prototype,"onLoop",{get:function(){this.j||(this.j=new q(this));return this.j}});Object.defineProperty(Y.prototype,"onComplete",{get:function(){this.f||(this.f=new q(this));return this.f}});Object.defineProperty(Y.prototype,"onStop",{get:function(){this.B||(this.B=new q(this));return this.B}});
function ra(a){this.i=a;this.R=new ne;this.m=new ne;this.f=new ne;this.c=new ne;this.j=0}var C={JSON:"json",jc:"xml",IMAGE:"image",Eb:"sound"},oe={bd:["forge","forgejs","FORGE"]};oe.JSON=["forge.story.config"].concat(oe.bd);oe.jc=[].concat(oe.bd);oe.IMAGE=[].concat(oe.bd);oe.Eb=[].concat(oe.bd);function pe(a,b){var d=null;switch(b){case C.JSON:d=a.R;break;case C.jc:d=a.m;break;case C.IMAGE:d=a.f;break;case C.Eb:d=a.c}return d}
function qe(a,b,d){var h=pe(a,b),k=(d||"FORGE-cache")+"-"+a.j;a.j++;return!1===h.has(k)&&!1===re(b,k)?k:qe(a,b,d)}function re(a,b){var d=null;switch(a){case C.JSON:d=oe.JSON;break;case C.jc:d=oe.jc;break;case C.IMAGE:d=oe.IMAGE;break;case C.Eb:d=oe.Eb}return(a=d)?-1!==a.indexOf(b.toLowerCase()):!1}e=ra.prototype;e.has=function(a,b){return(a=pe(this,a))?a.has(b):!1};e.get=function(a,b){return!0===this.has(a,b)&&(a=pe(this,a))?a.get(b):null};
e.add=function(a,b,d){var h;(h="string"!==typeof b||""===b)||(h=pe(this,a),h=!0===(!0===re(a,b)&&!0===h.has(b)));h&&(b=qe(this,a,a+"-cache"));return!1===this.has(b,a)&&(a=pe(this,a))?(a.set(b,d),!0):!1};e.remove=function(a,b){return!0===this.has(a,b)&&(a=pe(this,a))?(a.af(b),!0):!1};e.destroy=function(){this.c=this.f=this.R=this.i=null};function se(){}e=se.prototype;e.key="";e.url="";e.type="";e.data=null;e.Ao=null;e.Rb=!1;e.Zk=!1;e.Yk="";e.constructor=se;
function sa(a){this.i=a;n.call(this,"Loader")}sa.prototype=Object.create(n.prototype);e=sa.prototype;e.constructor=sa;e.json=function(a,b,d,h,k,l){var p=new se;p.type="json";p.key=a;p.url=b;p.c=d;p.f=h;p.R=k;p.j=l;te(this,p,"text",this.zm,this.Am)};
e.zm=function(a,b){if(b.responseText){if(a.data=Object(JSON.parse(b.responseText)),!1===this.i.cache.has(C.JSON,a.key)?this.i.cache.add(C.JSON,a.key,a):this.log("FORGE.Loader.json : JSON file already exists"),"function"===typeof a.c&&null!==a.f){b=a.c;var d=a.f;a.c=null;a.f=null;a.R=null;a.j=null;b.call(d,a)}}else throw"FORGE.Loader.json : JSON file empty ?";};
e.Am=function(a,b){if(b.responseText){if("function"===typeof a.R&&null!==a.j){b=a.R;var d=a.j;a.c=null;a.f=null;a.R=null;a.j=null;b.call(d,a)}}else throw"FORGE.Loader.json : JSON file empty ?";};e.el=function(a,b,d,h,k,l){k=new se;k.type="xml";k.key=a;k.url=b;k.c=d;k.f=h;k.R=d;k.j=l;te(this,k,"document",this.Bn,this.Cn)};
e.Bn=function(a,b){if(b.responseXML){if(a.data=b.responseXML,!1===this.i.cache.has(C.jc,a.key)?this.i.cache.add(C.jc,a.key,a):this.log("FORGE.Loader.xml : XML file already exists"),"function"===typeof a.c&&null!==a.f){b=a.c;var d=a.f;a.c=null;a.f=null;a.R=null;a.j=null;b.call(d,a)}}else throw"FORGE.Loader.xml : XML file empty ?";};
e.Cn=function(a,b){if(b.responseXML){if("function"===typeof a.R&&null!==a.j){b=a.R;var d=a.j;a.c=null;a.f=null;a.R=null;a.j=null;b.call(d,a)}}else throw"FORGE.Loader.xml : JSON file empty ?";};e.sound=function(a,b,d,h,k){var l=new se;l.type="sound";l.key=a;l.url=b;l.c=d;l.f=h;!0===this.i.audio.useWebAudio&&!0!==k?te(this,l,"arraybuffer",this.hj):!0!==this.i.audio.useAudioTag&&!0!==k||ue(l,this.hj,this)};
e.hj=function(a,b){!0===this.i.audio.useWebAudio&&"undefined"!==typeof b&&(a.data=b.response);this.i.cache.add(C.Eb,a.key,a);"function"===typeof a.c&&null!==a.f&&a.c.call(a.f,a)};
function ue(a,b,d){function h(){a.data.removeEventListener(k,h,!1);a.data.onerror=null;"function"===typeof b&&b.call(d,a)}a.data=new Audio;a.data.preload="auto";a.data.crossOrigin="anonymous";a.data.src=a.url;var k="canplaythrough";a.data.onerror=function(){a.data.removeEventListener(k,h,!1);a.data.onerror=null;throw"FORGE.Loader._loadAudioTag : Could not load "+a.url;};"undefined"===typeof a.data.oncanplaythrough&&(k="canplay");a.data.addEventListener(k,h,!1);a.data.load()}
function te(a,b,d,h,k){b.Rb=!0;var l=new XMLHttpRequest;l.open("GET",b.url,!0);l.responseType=d;l.onreadystatechange=function(){if(l.readyState===XMLHttpRequest.DONE){if(200!==l.status&&l.status)throw"FORGE.Loader._xhr : Could not load "+b.url;this.onreadystatechange=null;"function"===typeof h&&(b.loaded=!0,h.call(this,b,l))}}.bind(a);l.onerror=function(){"function"===typeof k&&k.call(this,b,l)}.bind(a);l.send()}
e.image=function(a,b,d,h){var k=new se;k.type="image";k.key=a;k.url=b;k.data=new Image;k.data.crossOrigin="anonymous";k.data.onload=function(){k.data.onload=null;k.data.onerror=null;k.Rb=!1;k.loaded=!0;this.i.cache.add(C.IMAGE,k.key,k);d.call(h,k)}.bind(this);k.data.onerror=function(){k.data.onload=null;k.data.onerror=null;throw"ERROR : FORGE.Loader.image, failed to load image key : "+a+" at url "+b;};k.data.src=k.url;k.Rb=!0};
e.Lg=function(a,b,d){for(var h=document.getElementsByTagName("head")[0],k=h.getElementsByTagName("script"),l=0,p=k.length;l<p;l++)if(k[l].src===a){this.warn("Attempt to load an already loaded script!");b.call(d);return}var r=document.createElement("script");r.type="text/javascript";r.onload=function(){r.onload=null;b.call(d)};r.src=a;h.appendChild(r)};
e.Bj=function(a,b,d){var h=document.createElement("link");h.type="text/css";h.rel="stylesheet";"undefined"!==typeof b&&"undefined"!==typeof d&&(h.onload=function(){h.onload=null;b.call(d)});h.href=a;document.getElementsByTagName("head")[0].appendChild(h)};e.destroy=function(){this.i=null;n.prototype.destroy.call(this)};function ga(a){this.i=a;this.j=this.f=0;this.c=null;n.call(this,"DependencyManager")}ga.prototype=Object.create(n.prototype);ga.prototype.constructor=ga;
ga.prototype.add=function(a){"undefined"!==typeof a&&"string"===typeof a.url&&(this.f++,this.i.load.Lg(a.url,this.m,this))};ga.prototype.m=function(){this.j++;this.f-this.j||(console.log("DependencyManager : all scripts loaded"),this.c&&this.c.F())};ga.prototype.destroy=function(){this.i=null;n.prototype.destroy.call(this)};Object.defineProperty(ga.prototype,"dependencies",{get:function(){return this.f}});
Object.defineProperty(ga.prototype,"onAllScriptsLoaded",{get:function(){this.c||(this.c=new q(this));return this.c}});function ha(a){this.i=a;this.f=0;this.c=null;n.call(this,"Clock");this.f=Date.now();this.c=[]}ha.prototype=Object.create(n.prototype);e=ha.prototype;e.constructor=ha;e.ln=function(a){a:{if(this.c)for(var b,d=0,h=this.c.length;d<h;d++)if(b=this.c[d],b===a.emitter){a=d;break a}a=-1}-1!==a&&this.c.splice(a,1)};e.create=function(a){return this.add(new Z(this.i,a))};
e.add=function(a){this.c.push(a);a.onDestroy.add(this.ln,this);return a};e.update=function(){this.f=Date.now();for(var a=0,b=this.c.length;a<b;a++)this.c[a].update(this.f)};e.destroy=function(){this.i=null;for(var a=this.c.length;a--;)this.c[a].destroy();this.c=null};Object.defineProperty(ha.prototype,"time",{get:function(){return this.f}});
function Z(a,b){this.i=a;this.L="undefined"!==typeof b?b:!0;this.C=0;this.j=!1;this.M=this.J=0;this.m=!1;this.f=0;this.H=!1;this.u=this.I=this.D=this.B=this.G=this.c=null;n.call(this,"Timer");this.c=[];this.f=Date.now()}Z.prototype=Object.create(n.prototype);e=Z.prototype;e.constructor=Z;function ve(a,b){for(var d=0;d<a.c.length;d++){var h=a.c[d];if(!1===h.f){var k=h.c-b;0>k&&(k=0);h.c=a.f+k}}b=a.o-b;a.o=0>b?a.f:a.f+b}function we(a){0<a.c.length&&(a.c.sort(a.wn),a.o=a.c[0].c)}
e.wn=function(a,b){return a.c<b.c?-1:a.c>b.c?1:0};e.create=function(a,b,d,h,k,l){var p=a=Math.round(a);this.f?p+=this.f:p+=this.i.clock.time;a=new xe(0,a,p,d,b,h,k,l);this.c.push(a);we(this);this.H=!1;return a};e.add=function(a,b,d,h){return this.create(a,!1,0,b,d,Array.prototype.splice.call(arguments,3))};e.Gl=function(a,b,d,h){return this.create(a,!1,b,d,h,Array.prototype.splice.call(arguments,4))};e.jf=function(a,b,d){return this.create(a,!0,0,b,d,Array.prototype.splice.call(arguments,3))};
e.remove=function(a){for(var b=0;b<this.c.length;b++)if(this.c[b]===a)return this.c[b].f=!0;return!1};e.start=function(){if(!0!==this.j){this.C=this.i.clock.time;this.j=!0;for(var a,b=0;b<this.c.length;b++)a=this.c[b],a.c=a.delay+this.C;this.G&&this.G.F()}};e.stop=function(a){this.j=!1;!1!==a&&(this.c.length=0);this.I&&this.I.F()};e.pause=function(){!1!==this.j&&!0!==this.m&&(this.J=this.i.clock.time,this.m=!0,this.B&&this.B.F())};
e.resume=function(){if(!1!==this.m){var a=this.i.clock.time;this.M+=a-this.f;this.f=a;ve(this,this.J);this.m=!1;this.D&&this.D.F()}};
e.update=function(a){if(!0!==this.m){var b=a-this.f;this.f=a;1E3<b&&ve(this,a-b);for(a=this.c.length;a--;)!0===this.c[a].f&&this.c.splice(a,1);a=this.c.length;var d=b=0;if(!0===this.j&&this.f>=this.o&&0<a){for(var h;b<a&&!0===this.j;)if(h=this.c[b],this.f>=h.c&&!1===h.f){var k=this.f+h.delay-(this.f-h.c);0>k&&(k=this.f+h.delay);!0===h.loop?h.c=k:0<h.R?(h.R--,h.c=k):(d++,h.f=!0);h.Qb();b++}else break;this.c.length>d?we(this):(this.H=!0,this.j=!1,this.u&&this.u.F())}this.H&&this.L&&this.destroy()}};
e.destroy=function(){this.j=!1;this.c=[];n.prototype.destroy.call(this)};Object.defineProperty(Z.prototype,"autoDestroy",{get:function(){return this.L}});Object.defineProperty(Z.prototype,"running",{get:function(){return this.j}});Object.defineProperty(Z.prototype,"paused",{get:function(){return this.m}});Object.defineProperty(Z.prototype,"next",{get:function(){return this.o}});Object.defineProperty(Z.prototype,"duration",{get:function(){return this.j&&this.o>this.f?this.o-this.f:0}});
Object.defineProperty(Z.prototype,"length",{get:function(){return this.c.length}});Object.defineProperty(Z.prototype,"ms",{get:function(){return this.j?this.f-this.C-this.M:0}});Object.defineProperty(Z.prototype,"seconds",{get:function(){return this.j?.001*this.ms:0}});Object.defineProperty(Z.prototype,"onStart",{get:function(){this.G||(this.G=new q(this));return this.G}});Object.defineProperty(Z.prototype,"onPause",{get:function(){this.B||(this.B=new q(this));return this.B}});
Object.defineProperty(Z.prototype,"onResume",{get:function(){this.D||(this.D=new q(this));return this.D}});Object.defineProperty(Z.prototype,"onStop",{get:function(){this.I||(this.I=new q(this));return this.I}});Object.defineProperty(Z.prototype,"onComplete",{get:function(){this.u||(this.u=new q(this));return this.u}});function xe(a,b,d,h,k,l,p,r){this.delay=b;this.c=d;this.R=h-1;this.loop=k;this.m=l;this.o=p;this.j=r;this.f=!1}xe.prototype.constructor=xe;
xe.prototype.Qb=function(){this.m.apply(this.o,this.j)};function ta(a){this.i=a;this.c=[];n.call(this,"TweenManager")}ta.prototype=Object.create(n.prototype);e=ta.prototype;e.constructor=ta;e.zn=function(a){this.remove(a.emitter)};e.add=function(a){this.c.push(a);a.onDestroy.ga(this.zn,this)};e.remove=function(a){a:{for(var b=0,d=this.c.length;b<d;b++)if(a===this.c[b]){a=b;break a}a=-1}-1!==a&&this.c.splice(a,1)};e.update=function(){for(var a=0,b=this.c.length;a<b;a++)this.c[a].update()};
e.destroy=function(){for(var a=this.c.length;a--;)this.c[a].destroy();this.i=this.c=null;n.prototype.destroy.call(this)};function lb(a,b){this.i=a;this.D=b;this.c=null;this.B=g.X.LINEAR;this.I=null;this.u=this.G=this.C=!1;this.o=this.f=this.j=this.m=null;n.call(this,"Tween")}lb.prototype=Object.create(n.prototype);e=lb.prototype;e.constructor=lb;
e.kf=function(a,b,d){this.c||(this.c={});for(var h in a)this.c[h]={name:h,min:null,max:a[h],duration:"number"===typeof b?b:0,easing:"function"===typeof d?d:null,started:!1,complete:!1,startTime:null};return this};e.start=function(){this.I=Date.now();this.C=!0;this.u=this.G=!1;var a,b;for(b in this.c)a=this.c[b],a.min=this.D[b],a.max="string"===typeof this.c[b].max?a.min+parseInt(this.c[b].max,10):a.max,a.started=!0,a.startTime=this.I;this.m&&this.m.F();return this};
e.stop=function(){this.G=!0;this.o&&this.o.F();return this};e.update=function(){if(!1!==this.C&&!0!==this.u&&!0!==this.G){var a,b=0,d;for(d in this.c){a=this.c[d];if(!1===a.complete){var h=a,k=Date.now()-h.startTime;h.complete=k>=h.duration;!1===h.complete?(k=(null!==h.easing?h.easing:this.B)(k/h.duration),this.D[h.name]=k*(h.max-h.min)+h.min):this.D[h.name]=h.max}!1===a.complete&&b++}this.j&&this.j.F();b||(this.u=!0,this.f&&this.f.F())}};
e.destroy=function(){this.stop();this.B=this.c=this.D=this.i=null;this.m&&(this.m.destroy(),this.m=null);this.j&&(this.j.destroy(),this.j=null);this.f&&(this.f.destroy(),this.f=null);this.o&&(this.o.destroy(),this.o=null);n.prototype.destroy.call(this)};Object.defineProperty(lb.prototype,"easing",{get:function(){return this.B},set:function(a){"function"===typeof a&&(this.B=a)}});Object.defineProperty(lb.prototype,"complete",{get:function(){return this.u}});
Object.defineProperty(lb.prototype,"onStart",{get:function(){this.m||(this.m=new q(this));return this.m}});Object.defineProperty(lb.prototype,"onProgress",{get:function(){this.j||(this.j=new q(this));return this.j}});Object.defineProperty(lb.prototype,"onComplete",{get:function(){this.f||(this.f=new q(this));return this.f}});Object.defineProperty(lb.prototype,"onStop",{get:function(){this.o||(this.o=new q(this));return this.o}});g.X={};g.X.LINEAR=function(a){return g.Math.ca(a,0,1)};
g.X.zi=function(a){return g.Math.ca(1+Math.sin(Math.PI/2*(a-1)),0,1)};g.X.Ai=function(a){return g.Math.ca(.5*(1+Math.sin(Math.PI/2*(2*a-1))),0,1)};g.X.Bi=function(a){return g.Math.ca(Math.sin(Math.PI/2*a),0,1)};g.X.vi=function(a){return g.Math.ca(a*a,0,1)};g.X.wi=function(a){return g.Math.ca(.5>a?2*a*a:1-2*(a-1)*(a-1),0,1)};g.X.xi=function(a){a=1-a;return g.Math.ca(1-a*a,0,1)};g.X.gh=function(a){return g.Math.ca(a*a*a,0,1)};
g.X.hh=function(a){return g.Math.ca(.5>a?4*a*a*a:1+4*(a-1)*(a-1)*(a-1),0,1)};g.X.ih=function(a){a=1-a;return g.Math.ca(1-a*a*a,0,1)};g.X.Oe=function(a){a<1/2.75?a*=7.5625*a:a<2/2.75?(a-=1.5/2.75,a=7.5625*a*a+.75):a<2.5/2.75?(a-=2.25/2.75,a=7.5625*a*a+.9375):(a-=2.625/2.75,a=7.5625*a*a+.984375);return g.Math.ca(a,0,1)};g.X.fh=function(a){return 1-g.X.Oe(1-a)};g.K={};
g.K.Fg=function(a){var b={value:null,Zc:null};if("string"===typeof a){var d=parseInt(a,10);!1===isNaN(d)&&(b.value=d);-1<a.indexOf("%")?b.Zc="%":-1<a.indexOf("px")&&(b.Zc="px")}return b};g.K.Cc=function(a,b,d){var h={};a="undefined"!==typeof a?a:{};b="undefined"!==typeof b?b:{};for(var k in a)a.hasOwnProperty(k)&&(h[k]=a[k]);for(var l in b)b.hasOwnProperty(l)&&(h[l]=!1!==d&&a&&null!==b[l]&&"undefined"!==typeof b[l]&&b[l].constructor===Object?g.K.Cc(a[l],b[l],!0):b[l]);return h};
g.K.pb=function(a){for(var b=arguments,d={},h=0,k=b.length;h<k;h++)d=g.K.Cc(d,b[h],!0);return d};g.K.clone=function(a){if(!(a instanceof Object))return a;var b=new a.constructor,d;for(d in a)b[d]=g.K.clone(a[d]);return b};g.K.co=function(a){return a&&"object"===typeof a&&"string"===typeof a.className&&-1!==kd.indexOf(a.className)?!0:!1};
g.K.W=function(a,b){if("string"===typeof b&&(null!==a&&"object"===typeof a&&"string"===typeof a.className&&a.className.toLowerCase()===b.toLowerCase()||typeof a===b.toLowerCase()))return!0;if(!0===Array.isArray(b)&&!0===g.K.Pa(b,"string"))for(var d=0,h=b.length;d<h;d++)if(!0===g.K.W(a,b[d]))return!0;return!1};g.K.ho=function(a,b,d){b=b.split(".");for(var h=0,k=b.length;h<k;h++){a=a[b[h]];if(h===k-1)return g.K.W(a,d);if("undefined"===typeof a)break}return!1};
g.K.Pa=function(a,b){if("object"===typeof a&&!0===Array.isArray(a)){for(var d=0,h=a.length;d<h;d++)if(!1===g.K.W(a[d],b))return!1;return!0}return!1};g.K.re=function(a,b,d){b=b.split(".");for(var h=0,k=b.length;h<k;h++){a=a[b[h]];if("undefined"===typeof a)break;if(h===k-1)return a}return d};g.K.Gd=function(a,b){var d=b.split("."),h=d.length;a.sort(function(a,b){for(var k=0;k<h;)a=a[d[k]],b=b[d[k]],k++;return a<b?-1:a>b?1:0});return a};
g.K.Dd=function(a){a=a.slice();for(var b,d,h=a.length-1;0<h;h--)d=~~(Math.random()*(h+1)),b=a[h],a[h]=a[d],a[d]=b;return a};g.K.ye=function(a,b,d){for(a=String(a);a.length<d;)a=b+a;return a};g.K.Ak=function(a){a={input:a,hours:0,minutes:0,seconds:0};if("number"!==typeof a.input||isNaN(a.input))return a;a.$n=parseInt(a.input/3600,10)%24;a.jo=parseInt(a.input/60,10)%60;a.seconds=parseInt(a.input%60,10);return a};
g.K.Mn=function(a,b){a=g.K.Ak(a);var d="string"===typeof b?b:"H:M:S";b=0;-1!==d.indexOf("H")?b=2:-1!==d.indexOf("h")&&(b=1);var h=0;-1!==d.indexOf("M")?h=2:-1!==d.indexOf("m")&&(h=1);var k=0;-1!==d.indexOf("S")?k=2:-1!==d.indexOf("s")&&(k=1);d=d.toLowerCase();0<b&&(d=d.replace("h",g.K.ye(a.$n,0,b)));0<h&&(d=d.replace("m",g.K.ye(a.jo,0,h)));0<k&&(d=d.replace("s",g.K.ye(a.seconds,0,k)));return d};g.K.Qg=function(a,b,d){return new THREE.Spherical(a,Math.PI/2-d,b)};
g.K.Pn=function(a){return{radius:a.radius,theta:a.theta,phi:Math.PI/2-a.phi}};g.K.wj=function(a,b){return a.filter(function(a){return 0>b.indexOf(a)})};g.K.mo=function(a,b){return b>=a.length?null:a.splice(b,1)};g.K.endsWith=function(a,b){return"function"!==typeof String.prototype.endsWith?-1!==a.indexOf(b,a.length-b.length):a.endsWith(b)};g.ka={};
g.ka.vd=function(a,b){var d=window.getComputedStyle(a,null).getPropertyValue("display");a.style.display="none";b=window.getComputedStyle(a,null).getPropertyValue(b);a.style.display=d;return b};g.ka.ak=function(a){a=g.ka.vd(a,"width");var b="px";-1<a.indexOf("%")&&(b="%");-1<a.indexOf("px")&&(b="px");return b};g.ka.ck=function(a){a=parseInt(g.ka.vd(a,"width"),10);return isNaN(a)?0:a};g.ka.$j=function(a){a=g.ka.vd(a,"height");var b="px";-1<a.indexOf("%")&&(b="%");-1<a.indexOf("px")&&(b="px");return b};
g.ka.bk=function(a){a=parseInt(g.ka.vd(a,"height"),10);return isNaN(a)?0:a};g.ka.has=function(a){return document.body.contains(a)};g.ka.sg=function(a){return a instanceof HTMLElement};
g.ka.Sn=function(a){var b,d;d=["MouseEvent","PointerEvent","TouchEvent"];"object"===typeof a.srcEvent&&d.indexOf(a.srcEvent.constructor.toString())?(b=a.target.getBoundingClientRect(),d=a.srcEvent.clientX-b.left,a=a.srcEvent.clientY-b.top):(b=(a.currentTarget||a.target||a.srcElement).getBoundingClientRect(),d=a.clientX-b.left,a=a.clientY-b.top);return{x:d,y:a}};function ne(){this.f=0;this.c={}}e=ne.prototype;e.constructor=ne;
e.set=function(a,b){if("undefined"!==typeof a)return void 0===this.c[a]&&this.f++,this.c[a]=b,this.f};e.af=function(a){if("undefined"!==typeof a&&void 0!==this.c[a])return delete this.c[a],--this.f};e.get=function(a){return this.c[a]};e.hl=function(){var a=new Qc,b;for(b in this.c)a.add(b);return a.Je()};e.il=function(){var a=new Qc,b;for(b in this.c)a.add(this.c[b]);return a.Je()};e.gl=function(){var a=new Qc,b;for(b in this.c){var d=[];d.push(b);d.push(this.c[b]);a.add(d)}return a.Je()};e.fl=function(){for(var a in this.c)this.af(a)};
e.has=function(a){return 0<this.f&&void 0!==this.c[a]};Object.defineProperty(ne.prototype,"size",{get:function(){return this.f}});function Qc(){this.c=[]}e=Qc.prototype;e.constructor=Qc;e.add=function(a){this.c.push(a);return this.c.length};e.remove=function(a){for(var b=0,d=this.c.length;b<d;b++)this.c[b]===a&&this.c.splice(b,1)};e.get=function(a){return this.c[a]};e.Je=function(){return this.c};Object.defineProperty(Qc.prototype,"size",{get:function(){return this.c.length}});
function ye(a){this.j=a;this.c=this.G=this.f=this.B=this.u=this.D="";this.o=null;this.m="";n.call(this,"URL")}ye.prototype=Object.create(n.prototype);ye.prototype.constructor=ye;
function ya(a){var b=new ye;"string"!==typeof a&&(a=window.location.toString());b.j=a;a=document.createElement("a");a.href=b.j;b.D=a.protocol;b.u=a.hostname;b.B=a.port;b.f=a.pathname;b.G=a.search;b.c=a.hash;b.m=b.f.substr(b.f.lastIndexOf(".")+1);if(""!==b.c){a=b.c.replace("#","").split("&");var d={};d.slug=a[0];for(var h=1,k=a.length;h<k;h++){var l=a[h].split("=");d[l[0]]=decodeURIComponent(l[1])}b.o=d}return b}Object.defineProperty(ye.prototype,"url",{get:function(){return this.j}});
Object.defineProperty(ye.prototype,"protocol",{get:function(){return this.D}});Object.defineProperty(ye.prototype,"host",{get:function(){return this.u}});Object.defineProperty(ye.prototype,"port",{get:function(){return this.B}});Object.defineProperty(ye.prototype,"path",{get:function(){return this.f}});Object.defineProperty(ye.prototype,"query",{get:function(){return this.G}});Object.defineProperty(ye.prototype,"hash",{get:function(){return this.c}});
Object.defineProperty(ye.prototype,"hashParameters",{get:function(){return this.o}});Object.defineProperty(ye.prototype,"extension",{get:function(){return this.m}});g.Color={};g.Color.oo=function(a,b,d){a/=255;b/=255;d/=255;var h=Math.max(a,b,d),k=Math.min(a,b,d),l,p=(h+k)/2;if(h===k)l=k=0;else{var r=h-k,k=.5<p?r/(2-h-k):r/(h+k);switch(h){case a:l=(b-d)/r+(b<d?6:0);break;case b:l=(d-a)/r+2;break;case d:l=(a-b)/r+4}l/=6}return{h:l,s:k,l:p}};
g.Color.ao=function(a,b,d){if(b){var h=.5>d?d*(1+b):d+b-d*b,k=2*d-h;d=g.Color.te(k,h,a+1/3);b=g.Color.te(k,h,a);a=g.Color.te(k,h,a-1/3)}else d=b=a=d;return{r:255*d,g:255*b,b:255*a}};g.Color.te=function(a,b,d){if(!(0>d||1<d)){if(d<1/6)return a+6*(b-a)*d;if(.5>d)return b;if(d<2/3)return a+(b-a)*(2/3-d)*6}return a};
g.Color.po=function(a,b,d){a/=255;b/=255;d/=255;var h=Math.max(a,b,d),k=Math.min(a,b,d),l,p=h-k;if(h===k)l=0;else{switch(h){case a:l=(b-d)/p+(b<d?6:0);break;case b:l=(d-a)/p+2;break;case d:l=(a-b)/p+4}l/=6}return{h:l,s:h?p/h:0,v:h}};
g.Color.bo=function(a,b,d){var h,k,l,p=Math.floor(6*a),r=6*a-p;a=d*(1-b);var u=d*(1-r*b);b=d*(1-(1-r)*b);switch(p%6){case 0:h=d;k=b;l=a;break;case 1:h=u;k=d;l=a;break;case 2:h=a;k=d;l=b;break;case 3:h=a;k=u;l=d;break;case 4:h=b;k=a;l=d;break;case 5:h=d,k=a,l=u}return{r:255*h,g:255*k,b:255*l}};g.Color.je=function(a){a=a.toString(16);return 1===a.length?"0"+a:a};g.Color.no=function(a,b,d){return"#"+g.Color.je(a)+g.Color.je(b)+g.Color.je(d)};
g.Color.Nn=function(a){a=a.split("(")[1].split(")")[0].split(",");var b={r:parseInt(a[0],10),g:parseInt(a[1],10),b:parseInt(a[2],10)};3<a.length&&(b.a=parseInt(a[3],10));return b};g.Color.Zn=function(a){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,d,h,k){return d+d+h+h+k+k});return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null};
g.Color.qo=function(a){a=new THREE.Vector3(a.r,a.g,a.b);var b=(new THREE.Matrix3).set(.299,.587,.114,-.169,-.331,.5,.5,-.419,-.081),d=new THREE.Vector3(0,128,128);a.applyMatrix3(b).add(d);return{Y:a.x,Cr:a.y,Cb:a.z}};g.Color.Co=function(a){a=new THREE.Vector3(a.Y,a.Cr,a.Cb);var b=new THREE.Vector3(0,-128,-128),d=(new THREE.Matrix3).set(1,0,1.4,1,-.343,-.711,1,1.765,0);a.add(b).applyMatrix3(d);return{r:a.x,g:a.y,b:a.z}};
g.Color.Bo=function(a,b){var d=g.Math.ha(b);b=Math.cos(d);d=Math.sin(d);return{Y:a.Y,Cb:a.Cb*b-a.Cr*d,Cr:a.Cb*d+a.Cr*b}};g.Color.distance=function(a,b){return Math.sqrt((a.Cb-b.Cb)*(a.Cb-b.Cb)+(a.Cr-b.Cr)*(a.Cr-b.Cr))};function Ab(a,b,d,h){this.alpha=h}window.FORGE=g;window.FORGE.BaseObject=n;window.FORGE.Viewer=t;window.FORGE.Tags=g.mb;window.FORGE.UID=g.S;window.FORGE.Story=x;window.FORGE.Group=F;window.FORGE.Scene=E;window.FORGE.SceneParser=G;window.FORGE.Rectangle=Ba;window.FORGE.Size=Ca;
window.FORGE.Media=Da;window.FORGE.RenderManager=y;window.FORGE.RenderScene=Qa;window.FORGE.RenderPipeline=Ha;window.FORGE.RenderDisplay=Fa;window.FORGE.RenderParams=db;window.FORGE.BackgroundRenderer=eb;window.FORGE.BackgroundMeshRenderer=Na;window.FORGE.BackgroundShaderRenderer=Ma;window.FORGE.PostProcessing=pa;window.FORGE.EffectComposer=Ra;window.FORGE.TexturePass=Ta;window.FORGE.ShaderPass=Va;window.FORGE.AdditionPass=Ya;window.FORGE.RenderPass=Sa;window.FORGE.ViewBase=hb;
window.FORGE.ViewGoPro=Pa;window.FORGE.ViewRectilinear=Oa;window.FORGE.Timeline=ib;window.FORGE.Keyframe=jb;window.FORGE.Animation=kb;window.FORGE.MetaAnimation=pb;window.FORGE.Track=sb;window.FORGE.Object3D=tb;window.FORGE.ObjectRenderer=Ga;window.FORGE.Raycaster=xb;window.FORGE.PickingDrawPass=Bb;window.FORGE.PickingManager=Ea;window.FORGE.HotspotManager=ma;window.FORGE.Hotspot3D=Eb;window.FORGE.HotspotSound=Kb;window.FORGE.HotspotMaterial=Ib;window.FORGE.HotspotTransform=Gb;
window.FORGE.HotspotAnimation=Hb;window.FORGE.HotspotAnimationTrack=Fb;window.FORGE.Camera=K;window.FORGE.CameraAnimation=dc;window.FORGE.CameraGaze=Sb;window.FORGE.ControllerManager=la;window.FORGE.ControllerBase=nc;window.FORGE.ControllerPointer=lc;window.FORGE.ControllerKeyboard=mc;window.FORGE.SoundManager=w;window.FORGE.Sound=L;window.FORGE.Playlist=N;window.FORGE.PlaylistManager=z;window.FORGE.PlaylistTrack=O;window.FORGE.Director=oa;window.FORGE.DirectorTrack=cc;
window.FORGE.ActionEventDispatcher=Lb;window.FORGE.Action=Ec;window.FORGE.ActionManager=na;window.FORGE.Plugin=P;window.FORGE.PluginEngine=Jc;window.FORGE.PluginManager=B;window.FORGE.PluginObjectFactory=Q;window.FORGE.Device=g.A;window.FORGE.RequestAnimationFrame=ia;window.FORGE.History=ka;window.FORGE.EventDispatcher=q;window.FORGE.Event=Xc;window.FORGE.Listener=Vc;window.FORGE.LocaleManager=ja;window.FORGE.LocaleString=D;window.FORGE.Locale=Zc;window.FORGE.Keyboard=qa;window.FORGE.KeyBinding=M;
window.FORGE.Drag=ed;window.FORGE.Pointer=U;window.FORGE.DisplayList=ea;window.FORGE.DisplayObject=T;window.FORGE.DisplayObjectContainer=v;window.FORGE.Image=H;window.FORGE.ImageScalable=Rb;window.FORGE.Sprite=Rc;window.FORGE.Iframe=yd;window.FORGE.TextField=S;window.FORGE.Button=Sc;window.FORGE.ButtonSkin=X;window.FORGE.Canvas=fa;window.FORGE.VideoHTML5=J;window.FORGE.VideoDash=I;window.FORGE.VideoTimeRanges=Zd;window.FORGE.VideoQuality=ee;window.FORGE.SpriteAnimationManager=xd;
window.FORGE.SpriteAnimation=Y;window.FORGE.Cache=ra;window.FORGE.File=se;window.FORGE.Loader=sa;window.FORGE.DependencyManager=ga;window.FORGE.Clock=ha;window.FORGE.Timer=Z;window.FORGE.TimerEvent=xe;window.FORGE.TweenManager=ta;window.FORGE.Tween=lb;window.FORGE.Map=ne;window.FORGE.Collection=Qc;window.FORGE.URL=ye;window.FORGE.ColorRGBA=Ab;n.prototype.log=n.prototype.log;n.prototype.warn=n.prototype.warn;n.prototype.destroy=n.prototype.destroy;t.prototype.update=t.prototype.update;
t.prototype.pause=t.prototype.pause;t.prototype.resume=t.prototype.resume;t.prototype.destroy=t.prototype.destroy;x.prototype.boot=x.prototype.boot;x.prototype.load=x.prototype.load;x.prototype.hasScenes=x.prototype.Dl;x.prototype.hasGroups=x.prototype.Ec;x.prototype.nextScene=x.prototype.El;x.prototype.previousScene=x.prototype.Fl;x.prototype.notifySceneConfigLoadComplete=x.prototype.yk;x.prototype.loadScene=x.prototype.Bd;x.prototype.loadGroup=x.prototype.sk;x.prototype.destroy=x.prototype.destroy;
F.prototype.load=F.prototype.load;F.prototype.hasChild=F.prototype.Ve;F.prototype.hasScene=F.prototype.Wc;F.prototype.hasGroup=F.prototype.wd;F.prototype.hasChildren=F.prototype.Vn;F.prototype.hasTypeOfChild=F.prototype.og;F.prototype.hasScenes=F.prototype.We;F.prototype.hasGroups=F.prototype.Ec;F.prototype.getChildrenUids=F.prototype.ud;F.prototype.getChildren=F.prototype.oe;F.prototype.nextScene=F.prototype.$k;F.prototype.previousScene=F.prototype.al;F.prototype.destroy=F.prototype.destroy;
E.prototype.addConfig=E.prototype.ma;E.prototype.load=E.prototype.load;E.prototype.unload=E.prototype.Le;E.prototype.hasGroup=E.prototype.wd;E.prototype.hasGroups=E.prototype.Ec;E.prototype.destroy=E.prototype.destroy;G.prototype.extendConfiguration=G.prototype.Jj;G.prototype.hasSoundSource=G.prototype.gk;G.prototype.hasSoundTarget=G.prototype.hk;G.prototype.isAmbisonic=G.prototype.nk;G.prototype.destroy=G.prototype.destroy;Da.prototype.destroy=Da.prototype.destroy;y.prototype.render=y.prototype.render;
y.prototype.screenToWorld=y.prototype.screenToWorld;y.prototype.worldToScreen=y.prototype.worldToScreen;y.prototype.enableVR=y.prototype.Al;y.prototype.setView=y.prototype.Fd;y.prototype.destroy=y.prototype.destroy;Qa.prototype.setSize=Qa.prototype.setSize;Qa.prototype.destroy=Qa.prototype.destroy;Ha.prototype.enablePicking=Ha.prototype.hg;Ha.prototype.addBackground=Ha.prototype.pj;Ha.prototype.addRenderScenes=Ha.prototype.rj;Ha.prototype.addGlobalFx=Ha.prototype.qj;
Ha.prototype.getShaderPassByUID=Ha.prototype.Tn;Ha.prototype.setSize=Ha.prototype.setSize;Ha.prototype.render=Ha.prototype.render;Ha.prototype.clear=Ha.prototype.gf;Ha.prototype.destroy=Ha.prototype.destroy;Fa.prototype.enableVR=Fa.prototype.Yh;Fa.prototype.getQuaternionFromPose=Fa.prototype.Vj;Fa.prototype.getRenderParams=Fa.prototype.Xj;Fa.prototype.setSize=Fa.prototype.setSize;Fa.prototype.submitFrame=Fa.prototype.Zh;Fa.prototype.destroy=Fa.prototype.destroy;
eb.prototype.updateAfterViewChange=eb.prototype.vc;eb.prototype.setSize=eb.prototype.setSize;eb.prototype.render=eb.prototype.render;eb.prototype.destroy=eb.prototype.destroy;Na.prototype.render=Na.prototype.render;Na.prototype.updateAfterViewChange=Na.prototype.vc;Na.prototype.destroy=Na.prototype.destroy;Ma.prototype.render=Ma.prototype.render;Ma.prototype.updateAfterViewChange=Ma.prototype.vc;Ma.prototype.destroy=Ma.prototype.destroy;pa.prototype.parseShaderPasses=pa.prototype.Ee;
pa.prototype.getFxSetByUID=pa.prototype.pe;pa.prototype.addConfig=pa.prototype.ma;pa.prototype.destroy=pa.prototype.destroy;Ra.prototype.destroy=Ra.prototype.destroy;Va.prototype.render=Va.prototype.render;Ya.prototype.destroy=Ya.prototype.destroy;hb.prototype.shaderSTW=hb.prototype.Yc;hb.prototype.shaderWTS=hb.prototype.sc;hb.prototype.updateScreenToWorld=hb.prototype.Gc;hb.prototype.worldToScreen=hb.prototype.worldToScreen;hb.prototype.screenToWorld=hb.prototype.screenToWorld;
hb.prototype.destroy=hb.prototype.destroy;Pa.prototype.shaderSTW=Pa.prototype.Yc;Pa.prototype.shaderWTS=Pa.prototype.sc;Pa.prototype.updateScreenToWorld=Pa.prototype.Gc;Pa.prototype.destroy=Pa.prototype.destroy;Oa.prototype.shaderSTW=Oa.prototype.Yc;Oa.prototype.shaderWTS=Oa.prototype.sc;Oa.prototype.updateScreenToWorld=Oa.prototype.Gc;Oa.prototype.worldToScreen=Oa.prototype.worldToScreen;Oa.prototype.screenToWorld=Oa.prototype.screenToWorld;Oa.prototype.destroy=Oa.prototype.destroy;
ib.prototype.hasKeyframes=ib.prototype.Wn;ib.prototype.addKeyframe=ib.prototype.Pb;ib.prototype.getKeyframes=ib.prototype.Rn;ib.prototype.getKeyframesIndexes=ib.prototype.qe;ib.prototype.getSideKeyframes=ib.prototype.Yj;ib.prototype.getSideKeyframesIndexes=ib.prototype.Zj;ib.prototype.emptyKeyframes=ib.prototype.Ln;ib.prototype.destroy=ib.prototype.destroy;kb.prototype.play=kb.prototype.play;kb.prototype.stop=kb.prototype.stop;kb.prototype.resume=kb.prototype.resume;kb.prototype.destroy=kb.prototype.destroy;
pb.prototype.stop=pb.prototype.stop;pb.prototype.resume=pb.prototype.resume;pb.prototype.destroy=pb.prototype.destroy;sb.prototype.destroy=sb.prototype.destroy;tb.prototype.click=tb.prototype.click;tb.prototype.over=tb.prototype.cf;tb.prototype.out=tb.prototype.Nd;tb.prototype.destroy=tb.prototype.destroy;Ga.prototype.register=Ga.prototype.register;Ga.prototype.unregister=Ga.prototype.unregister;Ga.prototype.createRenderScenes=Ga.prototype.Aj;Ga.prototype.getRaycastable=Ga.prototype.Wj;
Ga.prototype.getByMesh=Ga.prototype.Tj;Ga.prototype.clear=Ga.prototype.df;Ga.prototype.destroy=Ga.prototype.destroy;xb.prototype.start=xb.prototype.start;xb.prototype.stop=xb.prototype.stop;xb.prototype.click=xb.prototype.click;xb.prototype.clear=xb.prototype.Xh;Bb.prototype.start=Bb.prototype.start;Bb.prototype.stop=Bb.prototype.stop;Bb.prototype.click=Bb.prototype.click;Bb.prototype.setSize=Bb.prototype.setSize;Bb.prototype.clear=Bb.prototype.Hh;Bb.prototype.destroy=Bb.prototype.destroy;
Ea.prototype.updateForViewType=Ea.prototype.Qk;Ea.prototype.clear=Ea.prototype.Ih;Ea.prototype.setSize=Ea.prototype.setSize;Ea.prototype.click=Ea.prototype.click;Ea.prototype.start=Ea.prototype.start;Ea.prototype.stop=Ea.prototype.stop;Ea.prototype.destroy=Ea.prototype.destroy;ma.prototype.boot=ma.prototype.boot;ma.prototype.getByType=ma.prototype.Qn;ma.prototype.addConfig=ma.prototype.ma;ma.prototype.addTracks=ma.prototype.sj;ma.prototype.update=ma.prototype.update;ma.prototype.clear=ma.prototype.Xe;
ma.prototype.destroy=ma.prototype.destroy;Eb.prototype.update=Eb.prototype.update;Eb.prototype.destroy=Eb.prototype.destroy;Kb.prototype.load=Kb.prototype.load;Kb.prototype.update=Kb.prototype.update;Kb.prototype.destroy=Kb.prototype.destroy;Ib.prototype.load=Ib.prototype.load;Ib.prototype.update=Ib.prototype.update;Ib.prototype.destroy=Ib.prototype.destroy;Gb.prototype.computeSizeFromAnglesAndMaterial=Gb.prototype.m;Gb.prototype.load=Gb.prototype.load;Gb.prototype.destroy=Gb.prototype.destroy;
Hb.prototype.load=Hb.prototype.load;Hb.prototype.play=Hb.prototype.play;K.prototype.load=K.prototype.load;K.prototype.lookAt=K.prototype.uk;K.prototype.update=K.prototype.update;K.prototype.destroy=K.prototype.destroy;dc.prototype.play=dc.prototype.play;dc.prototype.destroy=dc.prototype.destroy;Sb.prototype.load=Sb.prototype.load;Sb.prototype.start=Sb.prototype.start;Sb.prototype.stop=Sb.prototype.stop;Sb.prototype.update=Sb.prototype.update;Sb.prototype.destroy=Sb.prototype.destroy;
la.prototype.notifyControlStart=la.prototype.Be;la.prototype.notifyControlEnd=la.prototype.Ae;la.prototype.update=la.prototype.update;la.prototype.addConfig=la.prototype.ma;la.prototype.destroy=la.prototype.destroy;nc.prototype.enable=nc.prototype.enable;nc.prototype.disable=nc.prototype.cc;nc.prototype.destroy=nc.prototype.destroy;lc.prototype.enable=lc.prototype.enable;lc.prototype.disable=lc.prototype.cc;lc.prototype.update=lc.prototype.update;lc.prototype.destroy=lc.prototype.destroy;
mc.prototype.enable=mc.prototype.enable;mc.prototype.disable=mc.prototype.cc;mc.prototype.update=mc.prototype.update;mc.prototype.destroy=mc.prototype.destroy;w.prototype.boot=w.prototype.boot;w.prototype.addConfig=w.prototype.ma;w.prototype.update=w.prototype.update;w.prototype.add=w.prototype.add;w.prototype.remove=w.prototype.remove;w.prototype.autoSuspend=w.prototype.Zf;w.prototype.autoResume=w.prototype.Yf;w.prototype.mute=w.prototype.qb;w.prototype.unmute=w.prototype.ci;
w.prototype.destroy=w.prototype.destroy;L.prototype.update=L.prototype.update;L.prototype.play=L.prototype.play;L.prototype.stop=L.prototype.stop;L.prototype.pause=L.prototype.pause;L.prototype.resume=L.prototype.resume;L.prototype.mute=L.prototype.qb;L.prototype.unmute=L.prototype.gi;L.prototype.destroy=L.prototype.destroy;N.prototype.hasTracks=N.prototype.ul;N.prototype.play=N.prototype.play;N.prototype.stop=N.prototype.stop;N.prototype.pause=N.prototype.pause;N.prototype.resume=N.prototype.resume;
N.prototype.nextTrack=N.prototype.Cd;N.prototype.previousTrack=N.prototype.Ge;N.prototype.destroy=N.prototype.destroy;z.prototype.boot=z.prototype.boot;z.prototype.addConfig=z.prototype.ma;z.prototype.add=z.prototype.add;z.prototype.addTrack=z.prototype.Kh;z.prototype.hasPlaylists=z.prototype.Xn;z.prototype.hasTracks=z.prototype.ol;z.prototype.play=z.prototype.play;z.prototype.stop=z.prototype.stop;z.prototype.pause=z.prototype.pause;z.prototype.resume=z.prototype.resume;z.prototype.nextTrack=z.prototype.Cd;
z.prototype.previousTrack=z.prototype.Ge;z.prototype.destroy=z.prototype.destroy;O.prototype.play=O.prototype.play;O.prototype.stop=O.prototype.stop;O.prototype.pause=O.prototype.pause;O.prototype.resume=O.prototype.resume;O.prototype.destroy=O.prototype.destroy;oa.prototype.load=oa.prototype.load;oa.prototype.play=oa.prototype.play;oa.prototype.stop=oa.prototype.stop;oa.prototype.destroy=oa.prototype.destroy;Lb.prototype.addActions=Lb.prototype.c;Lb.prototype.dispatch=Lb.prototype.F;
Lb.prototype.destroy=Lb.prototype.destroy;Ec.prototype.execute=Ec.prototype.Qb;Ec.prototype.destroy=Ec.prototype.destroy;na.prototype.get=na.prototype.get;na.prototype.addConfig=na.prototype.ma;na.prototype.destroy=na.prototype.destroy;P.prototype.instantiate=P.prototype.mk;P.prototype.notifyInstanceReady=P.prototype.lo;P.prototype.update=P.prototype.update;P.prototype.resetInstance=P.prototype.Ek;P.prototype.destroy=P.prototype.destroy;Jc.prototype.load=Jc.prototype.load;
Jc.prototype.getNewInstance=Jc.prototype.Uj;Jc.prototype.destroy=Jc.prototype.destroy;B.prototype.boot=B.prototype.boot;B.prototype.addConfig=B.prototype.ma;B.prototype.getById=B.prototype.ne;B.prototype.getByIndex=B.prototype.Sj;B.prototype.get=B.prototype.get;B.prototype.remove=B.prototype.remove;B.prototype.update=B.prototype.update;B.prototype.render=B.prototype.render;B.prototype.destroy=B.prototype.destroy;Q.prototype.string=Q.prototype.vo;Q.prototype.textField=Q.prototype.wo;
Q.prototype.sound=Q.prototype.sound;Q.prototype.displayObjectContainer=Q.prototype.Kn;Q.prototype.displayObject=Q.prototype.xl;Q.prototype.image=Q.prototype.image;Q.prototype.sprite=Q.prototype.so;Q.prototype.button=Q.prototype.wl;Q.prototype.video=Q.prototype.zl;Q.prototype.canvas=Q.prototype.canvas;Q.prototype.tween=Q.prototype.yl;Q.prototype.destroyAllObjects=Q.prototype.Fj;Q.prototype.destroy=Q.prototype.destroy;ia.prototype.boot=ia.prototype.boot;ia.prototype.start=ia.prototype.start;
ia.prototype.stop=ia.prototype.stop;ia.prototype.destroy=ia.prototype.destroy;ka.prototype.addConfig=ka.prototype.ma;ka.prototype.destroy=ka.prototype.destroy;q.prototype.add=q.prototype.add;q.prototype.addOnce=q.prototype.ga;q.prototype.remove=q.prototype.remove;q.prototype.has=q.prototype.has;q.prototype.dispatch=q.prototype.F;q.prototype.destroy=q.prototype.destroy;Vc.prototype.execute=Vc.prototype.Qb;Vc.prototype.detach=Vc.prototype.Fh;Vc.prototype.destroy=Vc.prototype.destroy;
ja.prototype.addConfig=ja.prototype.ma;ja.prototype.getValue=ja.prototype.nc;ja.prototype.hasValue=ja.prototype.Mb;ja.prototype.destroy=ja.prototype.destroy;D.prototype.destroy=D.prototype.destroy;Zc.prototype.addConfig=Zc.prototype.ma;Zc.prototype.loadFiles=Zc.prototype.xg;Zc.prototype.getValue=Zc.prototype.nc;Zc.prototype.hasValue=Zc.prototype.Mb;Zc.prototype.getKey=Zc.prototype.Gh;Zc.prototype.destroy=Zc.prototype.destroy;qa.prototype.update=qa.prototype.update;qa.prototype.isKeyPressed=qa.prototype.eo;
qa.prototype.isKeyOut=qa.prototype.ug;qa.prototype.addBinding=qa.prototype.Wf;qa.prototype.removeBinding=qa.prototype.He;qa.prototype.hasBinding=qa.prototype.Un;qa.prototype.getBindings=qa.prototype.kg;qa.prototype.destroy=qa.prototype.destroy;M.prototype.hasKeyIn=M.prototype.se;M.prototype.hasKeyOut=M.prototype.ng;M.prototype.down=M.prototype.Eh;M.prototype.waitToHold=M.prototype.zo;M.prototype.up=M.prototype.Pk;M.prototype.hold=M.prototype.jk;M.prototype.destroy=M.prototype.destroy;
ed.prototype.enable=ed.prototype.enable;ed.prototype.disable=ed.prototype.Ah;ed.prototype.destroy=ed.prototype.destroy;U.prototype.enable=U.prototype.enable;U.prototype.disable=U.prototype.ef;U.prototype.destroy=U.prototype.destroy;ea.prototype.register=ea.prototype.register;ea.prototype.unregister=ea.prototype.unregister;ea.prototype.update=ea.prototype.update;ea.prototype.destroy=ea.prototype.destroy;T.prototype.show=T.prototype.wh;T.prototype.hide=T.prototype.ik;T.prototype.toggleVisibility=T.prototype.xo;
T.prototype.maximize=T.prototype.Sb;T.prototype.isInDom=T.prototype.Ad;T.prototype.resize=T.prototype.vh;T.prototype.fullscreenEnter=T.prototype.Nj;T.prototype.fullscreenExit=T.prototype.Oj;T.prototype.isFullscreen=T.prototype.zd;T.prototype.destroy=T.prototype.destroy;v.prototype.update=v.prototype.update;v.prototype.addChild=v.prototype.mc;v.prototype.addChildAt=v.prototype.Dn;v.prototype.fitToContent=v.prototype.Mj;v.prototype.removeChild=v.prototype.removeChild;v.prototype.removeChildAt=v.prototype.Gg;
v.prototype.empty=v.prototype.uh;v.prototype.hasChild=v.prototype.Xk;v.prototype.destroy=v.prototype.destroy;H.prototype.load=H.prototype.load;H.prototype.unload=H.prototype.Le;H.prototype.destroy=H.prototype.destroy;Rb.prototype.destroy=Rb.prototype.destroy;Rc.prototype.play=Rc.prototype.play;Rc.prototype.pause=Rc.prototype.pause;Rc.prototype.resume=Rc.prototype.resume;Rc.prototype.stop=Rc.prototype.stop;Rc.prototype.update=Rc.prototype.update;Rc.prototype.destroy=Rc.prototype.destroy;
yd.prototype.load=yd.prototype.load;yd.prototype.destroy=yd.prototype.destroy;S.prototype.load=S.prototype.load;S.prototype.destroy=S.prototype.destroy;Sc.prototype.load=Sc.prototype.load;Sc.prototype.addSkin=Sc.prototype.Bc;Sc.prototype.setSkin=Sc.prototype.Ik;Sc.prototype.hasSkin=Sc.prototype.fk;Sc.prototype.updateSkin=Sc.prototype.yo;Sc.prototype.destroy=Sc.prototype.destroy;X.prototype.setDefaultFromState=X.prototype.Mg;X.prototype.getProperty=X.prototype.$a;X.prototype.hasImage=X.prototype.ek;
X.prototype.hasLabel=X.prototype.m;J.prototype.update=J.prototype.update;J.prototype.load=J.prototype.load;J.prototype.play=J.prototype.play;J.prototype.pause=J.prototype.pause;J.prototype.stop=J.prototype.stop;J.prototype.togglePlayback=J.prototype.Ol;J.prototype.mute=J.prototype.qb;J.prototype.unmute=J.prototype.mi;J.prototype.destroy=J.prototype.destroy;I.prototype.load=I.prototype.load;I.prototype.play=I.prototype.play;I.prototype.pause=I.prototype.pause;I.prototype.stop=I.prototype.stop;
I.prototype.togglePlayback=I.prototype.Nl;I.prototype.mute=I.prototype.qb;I.prototype.unmute=I.prototype.ji;I.prototype.enableBufferOccupancyABR=I.prototype.Ml;I.prototype.destroy=I.prototype.destroy;Zd.prototype.getTimeRange=Zd.prototype.j;Zd.prototype.isInRanges=Zd.prototype.qk;xd.prototype.add=xd.prototype.add;xd.prototype.play=xd.prototype.play;xd.prototype.pause=xd.prototype.pause;xd.prototype.resume=xd.prototype.resume;xd.prototype.stop=xd.prototype.stop;xd.prototype.get=xd.prototype.get;
xd.prototype.update=xd.prototype.update;xd.prototype.destroy=xd.prototype.destroy;Y.prototype.play=Y.prototype.play;Y.prototype.pause=Y.prototype.pause;Y.prototype.resume=Y.prototype.resume;Y.prototype.stop=Y.prototype.stop;Y.prototype.update=Y.prototype.update;Y.prototype.destroy=Y.prototype.destroy;ra.prototype.has=ra.prototype.has;ra.prototype.get=ra.prototype.get;ra.prototype.add=ra.prototype.add;ra.prototype.remove=ra.prototype.remove;ra.prototype.destroy=ra.prototype.destroy;
se.prototype.key=se.prototype.key;se.prototype.url=se.prototype.url;se.prototype.type=se.prototype.type;se.prototype.data=se.prototype.data;se.prototype.xhr=se.prototype.Ao;se.prototype.loading=se.prototype.Rb;se.prototype.loaded=se.prototype.Zk;se.prototype.error=se.prototype.Yk;sa.prototype.json=sa.prototype.json;sa.prototype.xml=sa.prototype.el;sa.prototype.sound=sa.prototype.sound;sa.prototype.image=sa.prototype.image;sa.prototype.script=sa.prototype.Lg;sa.prototype.css=sa.prototype.Bj;
sa.prototype.destroy=sa.prototype.destroy;ga.prototype.add=ga.prototype.add;ga.prototype.destroy=ga.prototype.destroy;ha.prototype.create=ha.prototype.create;ha.prototype.add=ha.prototype.add;ha.prototype.update=ha.prototype.update;ha.prototype.destroy=ha.prototype.destroy;Z.prototype.create=Z.prototype.create;Z.prototype.add=Z.prototype.add;Z.prototype.repeat=Z.prototype.Gl;Z.prototype.loop=Z.prototype.jf;Z.prototype.remove=Z.prototype.remove;Z.prototype.start=Z.prototype.start;
Z.prototype.stop=Z.prototype.stop;Z.prototype.pause=Z.prototype.pause;Z.prototype.resume=Z.prototype.resume;Z.prototype.update=Z.prototype.update;Z.prototype.destroy=Z.prototype.destroy;xe.prototype.execute=xe.prototype.Qb;ta.prototype.add=ta.prototype.add;ta.prototype.remove=ta.prototype.remove;ta.prototype.update=ta.prototype.update;ta.prototype.destroy=ta.prototype.destroy;lb.prototype.to=lb.prototype.kf;lb.prototype.start=lb.prototype.start;lb.prototype.stop=lb.prototype.stop;
lb.prototype.update=lb.prototype.update;lb.prototype.destroy=lb.prototype.destroy;ne.prototype.set=ne.prototype.set;ne.prototype["delete"]=ne.prototype.af;ne.prototype.get=ne.prototype.get;ne.prototype.keys=ne.prototype.hl;ne.prototype.values=ne.prototype.il;ne.prototype.entries=ne.prototype.gl;ne.prototype.clear=ne.prototype.fl;ne.prototype.has=ne.prototype.has;Qc.prototype.add=Qc.prototype.add;Qc.prototype.remove=Qc.prototype.remove;Qc.prototype.get=Qc.prototype.get;Qc.prototype.toArray=Qc.prototype.Je;
window.FORGE.Math=g.Math;g.Math.degToRad=g.Math.ha;g.Math.radToDeg=g.Math.pc;g.Math.round10=g.Math.Ed;g.Math.clamp=g.Math.ca;g.Math.wrap=g.Math.eb;g.Math.mix=g.Math.ko;g.Math.smoothStep=g.Math.ro;g.Math.rotationMatrixToEuler=g.Math.Hg;g.Math.eulerToRotationMatrix=g.Math.le;window.FORGE.Quaternion=g.Quaternion;g.Quaternion.toEuler=g.Quaternion.Ke;g.Quaternion.fromEuler=g.Quaternion.Dc;g.Quaternion.toRotationMatrix=g.Quaternion.Lk;g.Quaternion.fromRotationMatrix=g.Quaternion.On;
g.Quaternion.cancelRoll=g.Quaternion.cancelRoll;g.Quaternion.diffBetweenQuaternions=g.Quaternion.Jn;g.Quaternion.angularDistance=g.Quaternion.vj;g.Quaternion.multiplyScalar=g.Quaternion.multiplyScalar;g.Quaternion.add=g.Quaternion.add;g.Quaternion.log=g.Quaternion.log;g.Quaternion.exp=g.Quaternion.exp;g.Quaternion.slerp=g.Quaternion.slerp;g.Quaternion.squad=g.Quaternion.uo;g.Quaternion.nlerpNoInvert=g.Quaternion.xk;g.Quaternion.slerpNoInvert=g.Quaternion.Ie;g.Quaternion.squadNoInvert=g.Quaternion.Jk;
g.Quaternion.spline=g.Quaternion.Og;Ra.getUniqueName=gb;g.ShaderLib.parseIncludes=g.ShaderLib.sb;Bb.colorFrom3DObject=Cb;X.isValid=function(a){return a?!0:!1};ee.mimeTypeFromURL=le;window.FORGE.Easing=g.X;g.X.LINEAR=g.X.LINEAR;g.X.SINE_IN=g.X.zi;g.X.SINE_IN_OUT=g.X.Ai;g.X.SINE_OUT=g.X.Bi;g.X.QUAD_IN=g.X.vi;g.X.QUAD_IN_OUT=g.X.wi;g.X.QUAD_OUT=g.X.xi;g.X.CUBIC_IN=g.X.gh;g.X.CUBIC_IN_OUT=g.X.hh;g.X.CUBIC_OUT=g.X.ih;g.X.BOUNCE_OUT=g.X.Oe;g.X.BOUNCE_IN=g.X.fh;window.FORGE.Utils=g.K;
g.K.parseSizeString=g.K.Fg;g.K.extendSimpleObject=g.K.Cc;g.K.extendMultipleObjects=g.K.pb;g.K.clone=g.K.clone;g.K.isDisplayObject=g.K.co;g.K.isTypeOf=g.K.W;g.K.isTypeOfRecursive=g.K.ho;g.K.isArrayOf=g.K.Pa;g.K.getObjectProperty=g.K.re;g.K.sortArrayByProperty=g.K.Gd;g.K.randomize=g.K.Dd;g.K.leftFill=g.K.ye;g.K.parseTime=g.K.Ak;g.K.formatTime=g.K.Mn;g.K.toTHREESpherical=g.K.Qg;g.K.fromTHREESpherical=g.K.Pn;g.K.arrayByDifference=g.K.wj;g.K.removeItemFromArrayAtIndex=g.K.mo;g.K.endsWith=g.K.endsWith;
window.FORGE.Dom=g.ka;g.ka.getCssProperty=g.ka.vd;g.ka.getUnitWidth=g.ka.ak;g.ka.getValueWidth=g.ka.ck;g.ka.getUnitHeight=g.ka.$j;g.ka.getValueHeight=g.ka.bk;g.ka.has=g.ka.has;g.ka.isHtmlElement=g.ka.sg;g.ka.getMouseEventOffset=g.ka.Sn;ye.parse=ya;
ye.exists=function(a,b,d,h){var k=new XMLHttpRequest,l=null;k.onreadystatechange=function(){4===this.readyState&&200===this.status&&(clearTimeout(l),"function"===typeof b&&b.call(h))};k.onerror=function(a){console.log(a)};k.open("HEAD",a);k.send();l=window.setTimeout(function(){"function"===typeof d&&d.call(h)},500)};
ye.isValid=function(a){return/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-]*)?\??(?:[\-\+=&;%@\.\w]*)#?(?:[\.\!\/\\\w]*))?)/.test(a)?!0:!1};window.FORGE.Color=g.Color;g.Color.rgbToHsl=g.Color.oo;g.Color.hslToRgb=g.Color.ao;g.Color.hueToRgb=g.Color.te;g.Color.rgbToHsv=g.Color.po;g.Color.hsvToRgb=g.Color.bo;g.Color.componentToHex=g.Color.je;g.Color.rgbToHex=g.Color.no;g.Color.fromRgbaString=g.Color.Nn;
g.Color.hexToRgb=g.Color.Zn;g.Color.rgbToYcbcr=g.Color.qo;g.Color.ycbcrToRgb=g.Color.Co;g.Color.ycbcrRotate=g.Color.Bo;g.Color.distance=g.Color.distance;g.A.canPlayAudio=g.A.Hn;g.A.canPlayVideo=g.A.In;g.A.isLowBattery=g.A.fo;g.A.os=g.A.rb;g.A.vita=g.A.Tg;g.A.xbox=g.A.dh;g.A.kindle=g.A.vg;g.A.windowsPhone=g.A.Me;g.A.osVersion=g.A.oc;g.A.android=g.A.tj;g.A.chromeOS=g.A.ag;g.A.iOS=g.A.Xc;g.A.linux=g.A.wg;g.A.macOS=g.A.zg;g.A.windows=g.A.bh;g.A.ie=g.A.yd;g.A.edge=g.A.ke;g.A.firefox=g.A.ig;g.A.opera=g.A.opera;
g.A.safari=g.A.Ig;g.A.chrome=g.A.chrome;g.A.browser=g.A.Bb;g.A.browserVersion=g.A.ob;g.A.edgeVersion=g.A.Hj;g.A.chromeVersion=g.A.bg;g.A.firefoxVersion=g.A.Lj;g.A.silk=g.A.Ng;g.A.ieVersion=g.A.rg;g.A.operaVersion=g.A.Ce;g.A.safariVersion=g.A.Gk;g.A.isAndroidStockBrowser=g.A.pk;g.A.androidStockBrowserVersion=g.A.uj;g.A.webApp=g.A.Sk;g.A.quirksMode=g.A.Dk;g.A.pixelRatio=g.A.Fc;g.A.iPhone=g.A.kk;g.A.iPod=g.A.lk;g.A.iPad=g.A.qg;g.A.retina=g.A.Fk;g.A.desktop=g.A.Vc;g.A.mobile=g.A.ze;g.A.tablet=g.A.Pg;
g.A.other=g.A.zk;g.A.oggVideo=g.A.Eg;g.A.h264Video=g.A.mg;g.A.mp4Video=g.A.Cg;g.A.webmVideo=g.A.ah;g.A.vp9Video=g.A.Ug;g.A.hlsVideo=g.A.pg;g.A.audioTag=g.A.Xf;g.A.webAudio=g.A.Wg;g.A.ogg=g.A.Dg;g.A.mp3=g.A.Ag;g.A.opus=g.A.De;g.A.wav=g.A.Vg;g.A.aac=g.A.Vf;g.A.m4a=g.A.yg;g.A.mp4=g.A.Bg;g.A.webm=g.A.$g;g.A.weba=g.A.Zg;g.A.vibrate=g.A.Rg;g.A.battery=g.A.$f;g.A.canvas=g.A.canvas;g.A.canvasText=g.A.yj;g.A.canvasWinding=g.A.zj;g.A.localStorage=g.A.localStorage;g.A.mediaSource=g.A.wk;g.A.encryptedMedia=g.A.Ij;
g.A.applicationCache=g.A.applicationCache;g.A.addEventListener=g.A.addEventListener;g.A.raf=g.A.Fo;g.A.webGL=g.A.Xg;g.A.webVR=g.A.Yg;g.A.geolocation=g.A.geolocation;g.A.history=g.A.history;g.A.svg=g.A.Kk;g.A.contextMenu=g.A.contextMenu;g.A.isSecure=g.A.rk;g.A.isIframe=g.A.tg;g.A.touch=g.A.Mk;g.A.touchForce=g.A.Nk;g.A.gamepad=g.A.Rj;g.A.requestFullscreen=g.A.requestFullscreen;g.A.exitFullscreen=g.A.exitFullscreen;g.A.fullscreenKeyboard=g.A.Pj;g.A.fullscreenElement=g.A.fullscreenElement;
g.A.fullscreenEnabled=g.A.fullscreenEnabled;g.A.visibilityState=g.A.visibilityState;g.A.visibilityChange=g.A.Sg;g.A.orientation=g.A.orientation;g.A.screenOrientation=g.A.Hk;g.A.lockOrientation=g.A.tk;g.A.unlockOrientation=g.A.Ok;g.A.file=g.A.file;g.A.fileSystem=g.A.Kj;g.A.pointerLock=g.A.Ck;g.A.cssPointerEvents=g.A.td;g.A.cssRgba=g.A.Ej;g.A.cssAnimation=g.A.Dj;g.A.css3D=g.A.Cj;g.A.deviceMotionRotationRate=g.A.eg;g.A.deviceMotionAcceleration=g.A.dg;g.A.deviceOrientationMagnetometer=g.A.gg;
g.A.deviceMotion=g.A.cg;g.A.deviceOrientation=g.A.fg;g.A.dpi=g.A.Gj;g.A.screenWidth=g.A.Kg;g.A.screenHeight=g.A.Jg;g.A.ua=g.A.ea;g.A.language=g.A.language;g.A.gyroscope=g.A.dk;g.A.ready=g.A.ready;g.S.generate=g.S.jg;g.S.validate=g.S.Rk;g.S.register=g.S.register;g.S.unregister=g.S.unregister;g.S.getUids=g.S.lg;g.S.filterType=g.S.me;g.S.get=g.S.get;g.S.isTypeOf=g.S.W;g.S.exists=g.S.hb;g.mb.register=g.mb.register;g.mb.getUids=g.mb.lg;g.mb.get=g.mb.get;g.mb.hasTypeOf=g.mb.Yn;g.mb.exists=g.mb.hb;
t.DEFAULT_CONFIG=da;window.FORGE.Cache.types=C;C.JSON=C.JSON;window.FORGE.SoundType=g.lb;g.lb.AMBISONIC=g.lb.Ne;window.FORGE.Math=g.Math;g.Math.DEGREES=g.Math.Wa;g.Math.RADIANS=g.Math.Db;g.Math.DEG2RAD=g.Math.jh;g.Math.RAD2DEG=g.Math.yi;g.Math.TWOPI=g.Math.Fi;window.FORGE.MediaType=g.ub;g.ub.IMAGE=g.ub.IMAGE;g.ub.VIDEO=g.ub.VIDEO;window.FORGE.MediaFormat=g.Oa;g.Oa.EQUIRECTANGULAR=g.Oa.cd;g.Oa.CUBE=g.Oa.Kd;g.Oa.FLAT=g.Oa.mh;g.Oa.HOTSPOT=g.Oa.Tl;window.FORGE.VideoFormat=g.nb;g.nb.DASH=g.nb.Pe;
window.FORGE.BackgroundType=g.Za;g.Za.UNDEFINED=g.Za.Sd;window.FORGE.ViewType=g.Ia;g.Ia.RECTILINEAR=g.Ia.Ob;g.Ia.GOPRO=g.Ia.wc;g.Za.MESH=g.Za.Qd;g.Za.SHADER=g.Za.Rd;window.FORGE.PickingManager.modes=La;La.GAZE=La.Mc;La.POINTER=La.kb;window.FORGE.EffectComposerType=g.ab;g.ab.RENDER=g.ab.ic;window.FORGE.PassPosition=g.Ma;g.Ma.RENDER=g.Ma.ic;g.ab.PICKING=g.ab.xf;g.ab.MAIN=g.ab.pi;g.Ma.BACKGROUND=g.Ma.Id;g.Ma.GLOBAL=g.Ma.lf;g.Ma.UNKNOWN=g.Ma.Td;g.Ia.UNDEFINED=g.Ia.Sd;window.FORGE.HotspotType=g.Nc;
g.Nc.THREE_DIMENSIONAL=g.Nc.Jf;window.FORGE.HotspotMaterial.presets=Jb;Jb.TRANSPARENT=Jb.Ei;Jb.DEBUG=Jb.Ld;Mb.GRAPHICS=Mb.Pd;K.RADIUS=50;Mb.IMAGE=Mb.IMAGE;Mb.PLUGIN=Mb.ui;K.DEFAULT_CONFIG=Tb;window.FORGE.Easing=g.X;g.X.LINEAR=g.X.LINEAR;window.FORGE.ControllerType=g.tb;g.tb.POINTER=g.tb.kb;g.tb.KEYBOARD=g.tb.rf;la.DEFAULT_CONFIG=kc;lc.DEFAULT_OPTIONS=oc;mc.DEFAULT_OPTIONS=pc;g.lb.STEREO=g.lb.Yl;g.lb.SPATIAL=g.lb.Xl;C.SOUND=C.Eb;window.FORGE.Action.operation=Fc;Fc.SET=Fc.Gf;Fc.ADD=Fc.eh;
Fc.SUBSTRACT=Fc.Ci;Fc.MULTIPLY=Fc.ri;Fc.DIVIDE=Fc.kh;Fc.TOGGLE=Fc.Di;window.FORGE.Pointer.cursors=gd;gd.DEFAULT=gd.DEFAULT;window.FORGE.Pointer.listenerTypes=V;V.NATIVE=V.bb;V.HAMMER=V.oa;window.FORGE.Pointer.events=W;W.DOUBLE_TAP=W.Md;W.TAP=W.If;W.PRESS_START=W.Cf;W.PRESS_END=W.Bf;W.PAN_START=W.wf;W.PAN_MOVE=W.vf;W.PAN_END=W.uf;W.PINCH_START=W.Af;W.PINCH_MOVE=W.zf;W.PINCH_END=W.yf;W.ROTATE_START=W.Ff;W.ROTATE_MOVE=W.Ef;W.ROTATE_END=W.Df;W.SWIPE=W.Hf;W.ENTER=W.Re;W.LEAVE=W.sf;W.OVER=W.yc;W.OUT=W.Nb;
W.MOVE=W.tf;W.WHEEL=W.Lf;gd.POINTER=gd.kb;gd.GRAB=gd.Rl;gd.GRABBING=gd.Sl;window.FORGE.Image.renderModes=sd;sd.CSS=sd.CSS;sd.CANVAS=sd.Zb;C.IMAGE=C.IMAGE;window.FORGE.Button.states=Fd;Fd.OUT=Fd.Nb;Fd.OVER=Fd.yc;Fd.DOWN=Fd.lh;X.DEFAULT_STATE=Kd;X.EMPTY_STATE_IMAGE=Ld;X.EMPTY_STATE_LABEL=Md;X.EMPTY_STATE=Nd;X.DEFAULT_STATE_IMAGE=Od;X.DEFAULT_STATE_LABEL=Pd;window.FORGE.VideoQualityMode=g.Ha;g.Ha.AUTO=g.Ha.Xb;g.Ha.MANUAL=g.Ha.MANUAL;window.FORGE.VideoDash.mediaType=fe;fe.VIDEO=fe.VIDEO;fe.AUDIO=fe.AUDIO;
g.nb.HTML5=g.nb.Ul;g.nb.UNKNOWN=g.nb.Td;C.XML=C.jc;window.FORGE.Cache.reserved=oe;oe.COMMON=oe.bd;oe.JSON=oe.JSON;oe.XML=oe.jc;oe.IMAGE=oe.IMAGE;oe.SOUND=oe.Eb;g.X.SINE_IN=g.X.zi;g.X.SINE_IN_OUT=g.X.Ai;g.X.SINE_OUT=g.X.Bi;g.X.QUAD_IN=g.X.vi;g.X.QUAD_IN_OUT=g.X.wi;g.X.QUAD_OUT=g.X.xi;g.X.CUBIC_IN=g.X.gh;g.X.CUBIC_IN_OUT=g.X.hh;g.X.CUBIC_OUT=g.X.ih;g.X.BOUNCE_OUT=g.X.Oe;g.X.BOUNCE_IN=g.X.fh;
  root.FORGE = window.FORGE;
}).call(this);

