(function() {
  var root = this;
  var e,aa=[];function l(a){this.O="";this.gc=this.hb=this.Ya=null;this.ib=!0;this.sd=this.Tc=!1;this.Te=null;this.Ua=a||"BaseObject"}l.prototype.constructor=l;function ba(a){if("string"!==typeof a.O||""===a.O)a.O=n.Qf();n.register(a);a.Ya&&("string"===typeof a.Ya&&(a.Ya=[a.Ya]),!0===Array.isArray(a.Ya)&&ca.register(a))}function da(a){""!==a.O&&!0===n.Wa(a.O)&&n.unregister(a)}
function ea(a,b,d){d=d||"log";console[d].apply(console,["%c[ForgeJS]%c FORGE."+a.Ua+" : "+b+" %c(@"+window.performance.now().toFixed(2)+"ms)","background: #e2edff; color: #4286f4; font-weight: 700","font-weight: 400","color: #AAA"]);if("object"===typeof b&&null!==b)console[d](b)}l.prototype.log=function(a){if(!0===window.FORGE[this.Ua].DEBUG||!0===this.Tc)ea(this,a,"log"),this.Te||(this.Te=[]),this.Te.push(a)};
l.prototype.warn=function(a){!0!==window.FORGE[this.Ua].WARNING&&!0!==this.sd||ea(this,a,"warn")};l.prototype.destroy=function(){!1!==this.ib&&(da(this),this.gc&&(this.gc.D(),this.gc.destroy(),this.gc=null),this.hb=null,this.ib=!1)};Object.defineProperty(l.prototype,"className",{get:function(){return this.Ua}});Object.defineProperty(l.prototype,"uid",{get:function(){return this.O}});Object.defineProperty(l.prototype,"tags",{get:function(){return this.Ya}});
Object.defineProperty(l.prototype,"alive",{get:function(){return this.ib}});Object.defineProperty(l.prototype,"data",{get:function(){return this.hb},set:function(a){this.hb=a}});Object.defineProperty(l.prototype,"debug",{get:function(){return this.Tc},set:function(a){this.Tc=!!a;!0===this.Tc&&(console.log("Enabling debug for a FORGE."+this.Ua+" instance :"),console.log(this))}});
Object.defineProperty(l.prototype,"warning",{get:function(){return this.sd},set:function(a){this.sd=!!a;!0===this.sd&&(console.log("Enabling warning for a FORGE."+this.Ua+" instance :"),console.log(this))}});Object.defineProperty(l.prototype,"onDestroy",{get:function(){this.gc||(this.gc=new p(this));return this.gc}});
function r(a,b,d){l.call(this,"Viewer");this.j=a;this.ya=b||{viewer:fa};this.F=this.P=this.ba=this.C=this.J=this.B=this.va=this.S=this.wa=this.ma=this.V=this.xa=this.R=this.W=this.fa=this.M=this.H=this.U=this.G=this.N=this.I=this.K=this.A=this.c=this.na=null;this.ea=this.$=!1;this.u=this.m=this.o=null;this.f=d||null;window.setTimeout(this.ll.bind(this),0)}r.prototype=Object.create(l.prototype);r.prototype.constructor=r;var fa={background:"#000"};e=r.prototype;
e.ll=function(a){this.O="FORGE-instance-"+String(aa.length);aa.push(this.O);ba(this);this.log("$_Viewer.boot();");this.na=new ga(this);"string"===typeof this.j&&""!==this.j&&(this.j=document.getElementById(this.j));if("undefined"===typeof this.j||null===this.j||!1===ha.Zf(this.j))throw"$_Viewer.boot : Viewer parent is invalid";this.c=new t(this,null,null,this.j);this.c.id="FORGE-main-container-"+this.O;this.A=new t(this);this.A.id="FORGE-canvas-container-"+this.O;this.c.index=0;this.A.Ab(!0);this.c.Wb(this.A);
this.K=new t(this);this.K.id="FORGE-dom-hotspot-container-"+this.O;this.c.index=0;this.K.Ab(!0);this.c.Wb(this.K);this.I=new t(this);this.I.id="FORGE-plugin-container-"+this.O;this.c.index=0;this.I.Ab(!0);this.c.Wb(this.I);this.N=new ia(this);this.N.Ab(!0);this.A.Wb(this.N);this.fa=new ja(this);this.C=new ka(this);this.G=new u(this);this.J=new la(this);this.P=new ma(this);this.V=new w(this);this.ma=new na(this);this.F=new y(this);this.R=new oa(this);this.U=new z(this);this.B=new pa(this);this.H=new qa(this);
this.M=new ra(this);this.W=new sa(this);this.xa=new ta(this);this.va=new ua(this);this.S=new va(this);this.wa=new wa(this);this.ba=new xa(this);this.G.boot();this.J.boot();this.V.boot();this.U.boot();this.B.boot();this.H.boot();this.log("ForgeJS 0.3.0");"function"===typeof a&&a.call();this.f&&"function"===typeof this.f.boot&&this.f.boot.call();this.J.start();this.ea=!0;this.o&&this.o.D();a=this.ya;"string"===typeof a?this.wa.json(this.O+"-configuration",a,this.ml,this):a&&"object"===typeof a&&ya(this,
a)};e.ml=function(a){this.log("$_Viewer._configLoadComplete();");a=this.S.get(A.JSON,a.key).data;ya(this,a)};
function ya(a,b){a.ya=b;if("undefined"!==typeof b.viewer){var d=b.viewer;a.c.background="string"===typeof d.background?d.background:fa.background}"undefined"!==typeof b.i18n&&a.P.ha(b.i18n);"undefined"!==typeof b.history&&a.ma.ha(b.history);"undefined"!==typeof b.audio&&a.G.ha(b.audio);"undefined"!==typeof b.playlists&&a.U.ha(b.playlists);"undefined"!==typeof b.actions&&a.M.ha(b.actions);"undefined"!==typeof b.director&&a.W.load(b.director);"undefined"!==typeof b.hotspots&&a.H.Pi(b.hotspots);"undefined"!==
typeof b.postProcessing&&a.xa.ha(b.postProcessing);"undefined"!==typeof b.plugins&&a.B.ha(b.plugins);a.R.ha(b.controllers);"undefined"!==typeof b.story&&a.V.load(b.story)}
e.update=function(a){!0!==this.$&&(this.C.update(a),this.na.update(),this.va.update(),this.G.update(),this.B.update(),this.ba.update(),this.H.update(),this.R.update(),this.f&&"function"===typeof this.f.update&&this.f.update.call(),this.f&&"function"===typeof this.f.$m&&this.f.$m.call(),this.F&&this.F.render(),this.f&&"function"===typeof this.f.Zm&&this.f.Zm.call())};e.pause=function(){this.$=!0;this.m&&this.m.D()};e.resume=function(){this.$=!1;this.u&&this.u.D()};
e.destroy=function(){this.J.stop();this.j=this.ya=null;this.B.destroy();this.B=null;this.J.destroy();this.J=null;this.wa.destroy();this.wa=null;this.ma.destroy();this.ma=null;this.C.destroy();this.C=null;this.va.destroy();this.va=null;this.H.destroy();this.H=null;this.W.destroy();this.W=null;this.F.destroy();this.F=null;this.N.destroy();this.N=null;this.A.destroy();this.A=null;this.K.destroy();this.K=null;this.xa.destroy();this.xa=null;this.I.destroy();this.I=null;this.M.destroy();this.M=null;this.c.destroy();
this.c=null;this.na.destroy();this.na=null;this.U.destroy();this.U=null;this.G.destroy();this.G=null;this.V.destroy();this.V=null;this.S.destroy();this.S=null;this.ba.destroy();this.ba=null;this.P.destroy();this.P=null;this.R.destroy();this.f=this.R=null;this.o&&(this.o.destroy(),this.o=null);this.m&&(this.m.destroy(),this.m=null);this.u&&(this.u.destroy(),this.u=null);aa.splice(this.O,1);l.prototype.destroy.call(this)};Object.defineProperty(r.prototype,"ready",{get:function(){return this.ea}});
Object.defineProperty(r.prototype,"config",{get:function(){return this.ya}});Object.defineProperty(r.prototype,"parent",{get:function(){return this.j}});Object.defineProperty(r.prototype,"display",{get:function(){return this.na}});Object.defineProperty(r.prototype,"fullscreen",{get:function(){return this.c.fd()},set:function(a){"boolean"===typeof a&&this.c.fd()!==a&&(this.c.fullscreen=a)}});Object.defineProperty(r.prototype,"container",{get:function(){return this.c}});
Object.defineProperty(r.prototype,"canvasContainer",{get:function(){return this.A}});Object.defineProperty(r.prototype,"canvas",{get:function(){return this.N}});Object.defineProperty(r.prototype,"domHotspotContainer",{get:function(){return this.K}});Object.defineProperty(r.prototype,"pluginContainer",{get:function(){return this.I}});Object.defineProperty(r.prototype,"raf",{get:function(){return this.J}});Object.defineProperty(r.prototype,"audio",{get:function(){return this.G}});
Object.defineProperty(r.prototype,"playlists",{get:function(){return this.U}});Object.defineProperty(r.prototype,"hotspots",{get:function(){return this.H}});Object.defineProperty(r.prototype,"actions",{get:function(){return this.M}});Object.defineProperty(r.prototype,"dependencies",{get:function(){return this.fa}});Object.defineProperty(r.prototype,"director",{get:function(){return this.W}});Object.defineProperty(r.prototype,"story",{get:function(){return this.V}});
Object.defineProperty(r.prototype,"history",{get:function(){return this.ma}});Object.defineProperty(r.prototype,"load",{get:function(){return this.wa}});Object.defineProperty(r.prototype,"cache",{get:function(){return this.S}});Object.defineProperty(r.prototype,"plugins",{get:function(){return this.B}});Object.defineProperty(r.prototype,"clock",{get:function(){return this.C}});Object.defineProperty(r.prototype,"tween",{get:function(){return this.ba}});Object.defineProperty(r.prototype,"i18n",{get:function(){return this.P}});
Object.defineProperty(r.prototype,"renderer",{get:function(){return this.F}});Object.defineProperty(r.prototype,"view",{get:function(){return this.F.view}});Object.defineProperty(r.prototype,"camera",{get:function(){return this.F.camera}});Object.defineProperty(r.prototype,"controllers",{get:function(){return this.R}});Object.defineProperty(r.prototype,"postProcessing",{get:function(){return this.xa}});Object.defineProperty(r.prototype,"keyboard",{get:function(){return this.va}});
Object.defineProperty(r.prototype,"width",{get:function(){return this.c.width},set:function(a){this.c.width=a}});Object.defineProperty(r.prototype,"height",{get:function(){return this.c.height},set:function(a){this.c.height=a}});Object.defineProperty(r.prototype,"onReady",{get:function(){this.o||(this.o=new p(this));return this.o}});Object.defineProperty(r.prototype,"onPause",{get:function(){this.m||(this.m=new p(this));return this.m}});
Object.defineProperty(r.prototype,"onResume",{get:function(){this.u||(this.u=new p(this));return this.u}});
var ca=function(a){a=a();a.prototype=Object.create(l.prototype);a.prototype.constructor=a;a.prototype.register=function(a){if("object"===typeof a&&"string"===typeof a.uid&&Array.isArray(a.tags)){var b=a.uid,g=a.tags;if(!0===n.Wa(b))for(var h=0,k=g.length;h<k;h++)a=g[h],"string"!==typeof a?this.warn("Tags: An object has a tag that isn't a string!"):("undefined"===typeof this.jb[a]&&(this.jb[a]=[],null!==this.Zc&&this.Zc.D({tag:a})),-1===this.jb[a].indexOf(b)&&this.jb[a].push(b));else this.warn("Tags: The object you want to register in tags is not known by UID!"),
this.warn(a)}else this.warn("Tags: No uid or no tags on the object you try to register!"),this.warn(a)};a.prototype.Sf=function(a,d){var b=[];if("string"===typeof a)b=this.jb[a];else if(Array.isArray(a)){var h=0;for(a=a.length;h<a;h++);}"string"===typeof d&&(b=n.Sd(b,d));return b};a.prototype.get=function(a,d){if("string"===typeof a)return n.get(this.jb[a],d);if(Array.isArray(a)){var b=0;for(a=a.length;b<a;b++);return n.get([],d)}};a.prototype.un=function(a,d){if(!0===this.Wa(a)){a=this.jb[a];for(var b=
0,h=this.jb.length;b<h;b++)if(!0===n.T(a[b],d))return!0}return!1};a.prototype.Wa=function(a){return"undefined"!==typeof this.jb[a]&&null!==this.jb[a]};Object.defineProperty(a.prototype,"list",{get:function(){return Object.keys(this.jb)}});Object.defineProperty(a.prototype,"onRegister",{get:function(){null===this.Zc&&(this.Zc=new p(this));return this.Zc}});return new a}(function(){return function(){this.jb={};this.Zc=null;l.call(this,"Tags")}}),n=function(a){a=a();a.prototype=Object.create(l.prototype);
a.prototype.constructor=a;a.prototype.Qf=function(){var a="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(a){var b=16*Math.random()|0;return("x"==a?b:b&3|8).toString(16)});return!1===n.Wa(a)?a:n.Qf()};a.prototype.mk=function(a){function b(a){var d,h;for(h in a)if("uid"===h)if(d=a[h],"string"===typeof d){if(n.Wa(d))throw"UID configuration not valid, uid "+d+" already have an object binded to!";if(-1!==g.indexOf(d))throw"UID configuration not valid, uid "+d+" is in double in config file!";
g.push(a[h])}else throw"Found a uid in configuration that is not a string!";else"object"===typeof a[h]&&b(a[h]);return!0}var g=[];return b(a)};a.prototype.register=function(a){if("object"===typeof a&&"string"===typeof a.uid){var b=a.uid;if(!1===n.Wa(b))return this.X[b]=a,!0;this.warn("The uid you want to register already exists!");this.warn(a)}else this.warn("No uid on the object you try to register!"),this.warn(a);return!1};a.prototype.unregister=function(a){"object"===typeof a&&"string"===typeof a.uid?
(a=a.uid,this.X[a]=null,delete this.X[a]):this.warn("No uid on the object you try to unregister!")};a.prototype.Sf=function(a){return"undefined"===typeof a||null===a?Object.keys(this.X):n.Sd(Object.keys(this.X),a)};a.prototype.Sd=function(a,d){return a.filter(function(a){return n.T(a,d)?!0:!1})};a.prototype.get=function(a,d){if("undefined"===typeof a||null===a){if("string"!==typeof d)return this.X;a=Object.keys(this.X)}if("string"===typeof a)return this.X[a];if(Array.isArray(a)){"string"===typeof d&&
(a=n.Sd(a,d));d=[];for(var b,h=0,k=a.length;h<k;h++)b=a[h],!0===n.Wa(b)&&d.push(this.X[b]);return d}};a.prototype.T=function(a,d){a=n.get(a);return B.T(a,d)};a.prototype.Wa=function(a){return"undefined"!==typeof this.X[a]&&null!==this.X[a]};return new a}(function(){return function(){this.X={};l.call(this,"UID")}});
function w(a){this.i=a;this.I=this.N=this.J=this.f=null;this.K="";this.c=null;this.m="";this.o=null;this.u="";this.j=this.G=this.H=this.F=this.B=this.C=this.A=null;l.call(this,"Story")}w.prototype=Object.create(l.prototype);e=w.prototype;e.constructor=w;e.boot=function(){this.log("$_Story.boot();");this.c=[];this.o=[];this.J=new za(this.i);this.N=new za(this.i);this.I=new za(this.i)};
e.load=function(a){this.log("$_Story.load();");"string"===typeof a?this.i.load.json("forge.story.config",a,this.Zk,this):"object"===typeof a&&Aa(this,a)};e.$k=function(){return!!this.c.length};e.mc=function(){return!!this.o.length};e.al=function(){var a=this.c.indexOf(this.m);this.hd(a+1<this.c.length?this.c[a+1]:this.c[0])};e.bl=function(){var a=this.c.indexOf(this.m);this.hd(0<=a-1?this.c[a-1]:this.c[this.c.length-1])};
e.Zk=function(a){this.log("$_Story.loadComplete();");a=this.i.cache.get(A.JSON,a.key).data;Aa(this,a)};
function Aa(a,b){if(!0!==n.mk(b))throw"Story configuration is not valid!";a.f=b;a.O=a.f.uid;ba(a);a.K=a.f["default"];a.J.key=a.f.name;a.N.key=a.f.slug;a.I.key=a.f.description;if("undefined"!==typeof a.f.scenes&&0<a.f.scenes.length){b=a.f.scenes;for(var d,g=0,h=b.length;g<h;g++)d=new C(a.i),d.ha(b[g]),!0===d.booted&&Ba(a,d)}if("undefined"!==typeof a.f.groups&&0<a.f.groups.length)for(b=a.f.groups,g=0,h=b.length;g<h;g++)d=new D(a.i,b[g]),a.o.push(d.uid);Ca(a)}
function Ca(a){if("undefined"===typeof a.f.scenes||a.c.length===a.f.scenes.length){a.A&&a.A.D();var b=Da().hashParameters;null!==b&&"string"===typeof b.uid?Ea(b.uid):""!==a.K&&null!==a.K&&n.Wa(a.K)?Ea(a.K):a.hd(0)}}function Ea(a){!0!==n.T(a,"Scene")&&!0!==n.T(a,"Group")||n.get(a).load()}e.Uj=function(a){Ba(this,a);Ca(this)};function Ba(a,b){b.onLoadStart.add(a.Pm,a);b.onLoadComplete.add(a.Om,a);a.c.push(b.uid)}
e.hd=function(a){var b;"number"===typeof a?0<=a&&a<this.c.length?b=this.c[a]:this.warn("Load scene, index "+a+" is out of bounds"):"string"===typeof a&&n.T(a,"Scene")?b=a:"object"===typeof a&&B.T(a,"Scene")&&(b=a.uid);"undefined"!==typeof b&&b!==this.m&&Ea(b)};e.Pm=function(a){""!==this.m&&null!==this.m&&this.scene.re();a=a.emitter;this.m=a.uid;!1===a.mc()?(this.u=null,this.j&&this.j.D()):!0===a.mc()&&!1===a.cd(this.u)&&Fa(this,a.groups[0].uid);this.C&&this.C.D({uid:a.uid})};
e.Om=function(){this.F&&this.F.D()};function Fa(a,b){!0===n.T(b,"Group")&&b!==a.u&&(a.u=b,a.j&&a.j.D())}e.Oj=function(a){var b;"number"===typeof a?0<=a&&a<this.o.length?b=this.o[a]:this.warn("Load group, index "+a+" is out of bounds"):"string"===typeof a&&n.T(a,"Group")?b=a:"object"===typeof a&&B.T(a,"Group")&&(b=a.uid);"undefined"!==typeof b&&b!==this.u&&(Fa(this,b),Ea(b))};
e.destroy=function(){this.f=this.i=null;this.J.destroy();this.J=null;this.N.destroy();this.N=null;this.I.destroy();this.I=null;for(var a=0,b=this.c.length;a<b;a++)n.get(this.c[a]).destroy();this.c=null;a=0;for(b=this.o.length;a<b;a++)n.get(this.o[a]).destroy();this.o=null;this.A&&(this.A.destroy(),this.A=null);this.C&&(this.C.destroy(),this.C=null);this.B&&(this.B.destroy(),this.B=null);this.F&&(this.F.destroy(),this.F=null);this.H&&(this.H.destroy(),this.H=null);this.G&&(this.G.destroy(),this.G=
null);this.j&&(this.j.destroy(),this.j=null);l.prototype.destroy.call(this)};Object.defineProperty(w.prototype,"config",{get:function(){return this.f}});Object.defineProperty(w.prototype,"name",{get:function(){return this.J.value}});Object.defineProperty(w.prototype,"slug",{get:function(){return this.N.value}});Object.defineProperty(w.prototype,"description",{get:function(){return this.I.value}});Object.defineProperty(w.prototype,"scenes",{get:function(){return n.get(this.c)}});
Object.defineProperty(w.prototype,"scene",{get:function(){return null===this.m||""===this.m?null:n.get(this.m)},set:function(a){this.hd(a)}});Object.defineProperty(w.prototype,"sceneUid",{get:function(){return this.m}});Object.defineProperty(w.prototype,"groups",{get:function(){return n.get(this.o)}});Object.defineProperty(w.prototype,"group",{get:function(){return null===this.u||""===this.u?null:n.get(this.u)},set:function(a){this.Oj(a)}});Object.defineProperty(w.prototype,"groupUid",{get:function(){return this.u}});
Object.defineProperty(w.prototype,"onReady",{get:function(){this.A||(this.A=new p(this));return this.A}});Object.defineProperty(w.prototype,"onSceneLoadStart",{get:function(){this.C||(this.C=new p(this));return this.C}});Object.defineProperty(w.prototype,"onSceneLoadProgress",{get:function(){this.B||(this.B=new p(this));return this.B}});Object.defineProperty(w.prototype,"onSceneLoadComplete",{get:function(){this.F||(this.F=new p(this));return this.F}});
Object.defineProperty(w.prototype,"onSceneLoadError",{get:function(){this.H||(this.H=new p(this));return this.H}});Object.defineProperty(w.prototype,"onScenePreview",{get:function(){this.G||(this.G=new p(this));return this.G}});Object.defineProperty(w.prototype,"onGroupChange",{get:function(){this.j||(this.j=new p(this));return this.j}});
function D(a,b){this.i=a;this.f=b;this.o=null;this.C="#ffffff";this.A=1;this.c=this.m=this.u=null;this.j="";l.call(this,"Group");this.log("$_Group._boot();");this.O=this.f.uid;this.Ya=this.f.tags;ba(this);this.c=[];this.o=new za(this.i,this.f.name);this.u=new za(this.i,this.f.slug);this.m=new za(this.i,this.f.description);"string"===typeof this.f.color&&(this.C=this.f.color);"number"===typeof this.f.alpha&&(this.A=this.f.alpha);a=this.f;"undefined"!==typeof a.children&&!0===B.Ga(a.children,"string")?
this.c=a.children:this.warn("A group has no children in its configuration, or configuration is not valid!");"string"===typeof a["default"]&&(-1!==this.c.indexOf(a["default"])?this.j=a["default"]:this.warn("A group has a default child that is not in its children array!"))}D.prototype=Object.create(l.prototype);e=D.prototype;e.constructor=D;
e.load=function(a){this.log("$_Group.load();");if(!this.c||!this.c.length)throw"Group.load() : can't load a group that have no children";var b;"undefined"===typeof a||null===a?b="string"===typeof this.j&&""!==this.j?this.j:this.c[0]:"number"===typeof a&&0<=a&&a<this.c.length?b=this.c[a]:"string"===typeof a?b=a:"object"===typeof a&&!0===this.we(a)&&(b=a.uid);if(-1===this.c.indexOf(b))throw'Group.load() : uid "'+b+'" is not in children of the group!';if(!0===n.T(b,"Scene")||!0===n.T(b,"Group"))n.get(b).load();
else throw"Impossible to load group child with uid "+b+", it seems to be neither a scene or a group!";};e.we=function(a){return"string"===typeof a?-1!==this.c.indexOf(a):!0===B.T(a,"Scene")||!0===B.T(a,"Group")?this.we(a.uid):!1};e.Dc=function(a){return"string"===typeof a&&n.T(a,"Scene")?-1!==this.c.indexOf(a):!0===B.T(a,"Scene")?this.Dc(a.uid):!1};e.cd=function(a){return"string"===typeof a&&n.T(a,"Group")?-1!==this.c.indexOf(a):!0===B.T(a,"Group")?this.cd(a.uid):!1};e.rn=function(){return!!this.c.length};
e.Vf=function(a){for(var b,d=0,g=this.c.length;d<g;d++)if(b=this.c[d],n.T(b,a))return!0;return!1};e.xe=function(){return this.Vf("Scene")};e.mc=function(){return this.Vf("Group")};e.ad=function(a){if("string"!==typeof a)return this.c;for(var b=[],d=0,g=this.c.length;d<g;d++)n.T(this.c[d],a)&&b.push(this.c[d]);return b};e.Ud=function(a){a=this.ad(a);return n.get(a)};
e.wk=function(){if(!1===this.xe())this.warn("Can't do Group.nextScene() on this group that have no scenes!");else{var a=this.scenesUids,b=a.indexOf(this.i.story.sceneUid),d;-1===b&&(n.T(this.j,"Scene")?d=this.j:d=a[0]);b+1<a.length?d=a[b+1]:-1!==b&&(d=a[0]);this.load(d)}};
e.xk=function(){if(!1===this.xe())this.warn("Can't do Group.previousScene() on this group that have no scenes!");else{var a=this.scenesUids,b=a.indexOf(this.i.story.sceneUid),d;-1===b&&(n.T(this.j,"Scene")?d=this.j:d=a[0]);0<=b-1?d=a[b-1]:-1!==b&&(d=a[a.length-1]);this.load(d)}};e.destroy=function(){this.c=this.i=null;this.o.destroy();this.o=null;this.u.destroy();this.u=null;this.m.destroy();this.m=null;l.prototype.destroy.call(this)};Object.defineProperty(D.prototype,"config",{get:function(){return this.f}});
Object.defineProperty(D.prototype,"name",{get:function(){return this.o.value}});Object.defineProperty(D.prototype,"color",{get:function(){return this.C}});Object.defineProperty(D.prototype,"alpha",{get:function(){return this.A}});Object.defineProperty(D.prototype,"slug",{get:function(){return this.u.value}});Object.defineProperty(D.prototype,"description",{get:function(){return this.m.value}});Object.defineProperty(D.prototype,"childrenUids",{get:function(){return this.ad()}});
Object.defineProperty(D.prototype,"children",{get:function(){return this.Ud()}});Object.defineProperty(D.prototype,"scenesUids",{get:function(){return this.ad("Scene")}});Object.defineProperty(D.prototype,"scenes",{get:function(){return this.Ud("Scene")}});Object.defineProperty(D.prototype,"groupsUids",{get:function(){return this.ad("Group")}});Object.defineProperty(D.prototype,"groups",{get:function(){return this.Ud("Group")}});
function C(a){this.i=a;this.c=null;this.C=0;this.A=!1;this.u=this.m=this.o=this.f=this.j=null;l.call(this,"Scene")}C.prototype=Object.create(l.prototype);e=C.prototype;e.constructor=C;e.Yk=function(a){this.A=!0;"string"===typeof a.data&&(a.data=JSON.parse(a.data));this.c.fj(a.data);this.i.story.Uj(this);this.u&&this.u.D()};
e.ha=function(a){this.c=new F(this.i,a);this.O=this.c.uid;this.Ya=this.c.tags;ba(this);!1===this.A&&"string"===typeof a.url&&""!==a.url?this.i.load.json(this.O,a.url,this.Yk,this):this.A=!0};e.load=function(){this.log("$_Scene.load();");this.i.story.scene!==this&&(this.j&&this.j.D(),this.C++,this.f&&this.f.D())};e.re=function(){this.o&&this.o.D();this.m&&this.m.D()};e.cd=function(a){return"string"===typeof a&&!0===n.T(a,"Group")?n.get(a).Dc(this):!0===B.T(a,"Group")?a.Dc(this):!1};
e.mc=function(){for(var a=this.i.story.groups,b,d=0,g=a.length;d<g;d++)if(b=a[d],!0===b.Dc(this))return!0;return!1};e.destroy=function(){this.i=null;this.c&&(this.c.destroy(),this.c=null);this.j&&(this.j.destroy(),this.j=null);this.f&&(this.f.destroy(),this.f=null);this.o&&(this.o.destroy(),this.o=null);this.m&&(this.m.destroy(),this.m=null);l.prototype.destroy.call(this)};Object.defineProperty(C.prototype,"booted",{get:function(){return this.A}});Object.defineProperty(C.prototype,"config",{get:function(){return this.c}});
Object.defineProperty(C.prototype,"viewCount",{get:function(){return this.C}});Object.defineProperty(C.prototype,"viewed",{get:function(){return!!this.C}});Object.defineProperty(C.prototype,"name",{get:function(){return this.c.name}});Object.defineProperty(C.prototype,"slug",{get:function(){return this.c.slug}});Object.defineProperty(C.prototype,"description",{get:function(){return this.c.description}});
Object.defineProperty(C.prototype,"groupsUid",{get:function(){for(var a=this.i.story.groups,b,d=[],g=0,h=a.length;g<h;g++)b=a[g],!0===b.Dc(this)&&d.push(b.uid);return d}});Object.defineProperty(C.prototype,"groups",{get:function(){return n.get(this.groupsUid)}});Object.defineProperty(C.prototype,"thumbnails",{get:function(){return this.c.thumbnails}});Object.defineProperty(C.prototype,"onLoadStart",{get:function(){this.j||(this.j=new p(this));return this.j}});
Object.defineProperty(C.prototype,"onLoadComplete",{get:function(){this.f||(this.f=new p(this));return this.f}});Object.defineProperty(C.prototype,"onUnloadStart",{get:function(){this.o||(this.o=new p(this));return this.o}});Object.defineProperty(C.prototype,"onUnloadComplete",{get:function(){this.m||(this.m=new p(this));return this.m}});Object.defineProperty(C.prototype,"onConfigLoadComplete",{get:function(){this.u||(this.u=new p(this));return this.u}});
function F(a,b){this.i=a;this.c=b;this.f=this.m=this.j=null;l.call(this,"SceneParser");this.O=this.c.uid;this.Ya=this.c.tags;this.j=new za(this.i,this.c.name);this.m=new za(this.i,this.c.slug);this.f=new za(this.i,this.c.description)}F.prototype=Object.create(l.prototype);e=F.prototype;e.constructor=F;e.fj=function(a){this.c=B.kc(this.c,a)};
e.Dj=function(){return"undefined"!==typeof this.c.sound&&"undefined"!==typeof this.c.sound.source&&("undefined"!==typeof this.c.sound.source.url&&""!==this.c.sound.source.url||"undefined"!==typeof this.c.sound.source.target&&""!==this.c.sound.source.target)?!0:!1};e.Ej=function(a){return"undefined"!==typeof this.c.sound&&"undefined"!==typeof this.c.sound.source&&"undefined"!==typeof this.c.sound.source.target&&""!==this.c.sound.source.target&&this.c.sound.source.target===a?!0:!1};
e.Kj=function(){return!0===this.Dj()&&this.c.sound.type===Ga.Me?!0:!1};e.destroy=function(){this.i=null;this.j.destroy();this.j=null;this.m.destroy();this.m=null;this.f.destroy();this.f=null;l.prototype.destroy.call(this)};Object.defineProperty(F.prototype,"uid",{get:function(){return this.O}});Object.defineProperty(F.prototype,"name",{get:function(){return this.j.value}});Object.defineProperty(F.prototype,"slug",{get:function(){return this.m.value}});
Object.defineProperty(F.prototype,"description",{get:function(){return this.f.value}});Object.defineProperty(F.prototype,"tags",{get:function(){return this.Ya}});Object.defineProperty(F.prototype,"thumbnails",{get:function(){return this.c.thumbnails}});Object.defineProperty(F.prototype,"media",{get:function(){return this.c.media}});Object.defineProperty(F.prototype,"sound",{get:function(){return this.c.sound}});Object.defineProperty(F.prototype,"fx",{get:function(){return this.c.fx}});
Object.defineProperty(F.prototype,"playlists",{get:function(){return this.c.playlists}});Object.defineProperty(F.prototype,"view",{get:function(){return this.c.view}});Object.defineProperty(F.prototype,"camera",{get:function(){return this.c.camera}});Object.defineProperty(F.prototype,"hotspots",{get:function(){return this.c.hotspots}});Object.defineProperty(F.prototype,"director",{get:function(){return this.c.director}});Object.defineProperty(F.prototype,"plugins",{get:function(){return this.c.plugins}});
Object.defineProperty(F.prototype,"audio",{get:function(){return this.c.audio}});var G={Na:"degrees",mb:"radians"};G.Nh=Math.PI/180;G.Xh=180/Math.PI;G.ai=2*Math.PI;G.da=function(a){return a*G.Nh};G.Zb=function(a){return a*G.Xh};G.ld=function(a){return Math.round(10*a)/10};G.Z=function(a,b,d){b="number"===typeof b&&!1===isNaN(b)?b:-Infinity;d="number"===typeof d&&!1===isNaN(d)?d:Infinity;return Math.min(Math.max(a,b),d)};G.Ta=function(a,b,d){d-=b;return((a-b)%d+d)%d+b};
G.Fn=function(a,b,d){return a*d+b*(1-d)};G.Mn=function(a,b,d){a=G.Z((a-b)/(d-b),0,1);return a*a*(3-2*a)};G.ng=function(a){return{yaw:Math.atan2(-a.elements[2],a.elements[10]),pitch:Math.asin(-a.elements[6]),roll:Math.atan2(-a.elements[4],a.elements[5])}};
G.Rd=function(a,b,d,g){var h=Math.cos(a);a=Math.sin(a);var k=Math.cos(-b);b=Math.sin(-b);var q=Math.cos(d);d=Math.sin(d);"undefined"===typeof g&&(g=!1);return g?(new THREE.Matrix4).set(h*q+a*b*d,-h*d+a*b*q,a*k,0,k*d,k*q,-b,0,-a*q+h*b*d,a*d+h*b*q,h*k,0,0,0,0,1):(new THREE.Matrix4).set(q*h-d*b*a,-d*k,q*a+d*b*h,0,d*h+q*b*a,q*k,d*a-q*b*h,0,-a*k,b,k*h,0,0,0,0,1)};
var H={qe:function(a){a=(new THREE.Euler).setFromQuaternion(a,"XYZ");return{yaw:a.x,pitch:-a.y,roll:a.z}},lc:function(a,b,d){"object"===typeof a&&(b=a.pitch,d=a.roll,a=a.yaw);return(new THREE.Quaternion).setFromEuler(new THREE.Euler(a,-b,d,"ZXY"))},gk:function(a){a=H.qe(a);return G.Rd(a.yaw,a.pitch,a.roll)},jn:function(a){return H.lc(G.ng(a))},cancelRoll:function(a){a=H.qe(a);return H.lc(a.yaw,a.pitch,0)},dn:function(a,b){return(new THREE.Quaternion).copy(a).inverse().multiply(b)},Si:function(a,b){a=
Math.abs(a.dot(b));return 1<=a?0:2*Math.acos(a)},multiplyScalar:function(a,b){return new THREE.Quaternion(a*b.x,a*b.y,a*b.z,a*b.w)},add:function(a,b){return new THREE.Quaternion(a.x+b.x,a.y+b.y,a.z+b.z,a.w+b.w)},log:function(a){var b=new THREE.Quaternion(0,0,0,0);if(1>Math.abs(a.w)){var d=Math.acos(a.w),g=Math.sin(d);0<g&&(b.x=d*a.x/g,b.y=d*a.y/g,b.z=d*a.z/g);return b}b.x=a.x;b.y=a.y;b.z=a.z;return b},exp:function(a){var b=Math.sqrt(a.x*a.x+a.y*a.y+a.z*a.z),d=Math.sin(b),g=(new THREE.Quaternion).copy(a);
g.w=Math.cos(b);Math.abs(d)>Number.EPSILON&&(g.x=d*a.x/b,g.y=d*a.y/b,g.z=d*a.z/b);return g},slerp:function(a,b,d){var g=new THREE.Quaternion;THREE.Quaternion.slerp(a,b,g,d);return g},On:function(a,b,d,g,h,k){a=H.slerp(a,g,k);b=H.slerp(b,d,k);return H.slerp(a,b,2*k*(1-k))},Tj:function(a,b,d){return H.add(H.multiplyScalar(1-d,a),H.multiplyScalar(d,b)).normalize()},oe:function(a,b,d){var g=a.dot(b);if(.95<=Math.abs(g))return H.Tj(a,b,d);g=Math.acos(g);return H.multiplyScalar(1/Math.sin(g),H.add(H.multiplyScalar(Math.sin(g*
(1-d)),a),H.multiplyScalar(Math.sin(g*d),b)))},ek:function(a,b,d,g,h){a=H.oe(a,g,h);b=H.oe(b,d,h);return H.oe(a,b,2*h*(1-h))},ug:function(a,b,d){var g=(new THREE.Quaternion).copy(b).conjugate();a=(new THREE.Quaternion).copy(g).multiply(a);d=(new THREE.Quaternion).copy(g).multiply(d);g=H.log(a);d=H.log(d);d=H.add(g,d);d=H.multiplyScalar(-.25,d);d=H.exp(d);return(new THREE.Quaternion).copy(b).multiply(d).normalize()}};
function Ha(a,b,d,g){this.O="number"===typeof a?a:0;this.j="number"===typeof b?b:0;this.f="number"===typeof d?d:0;this.c="number"===typeof g?g:0}Ha.prototype.constructor=Ha;Object.defineProperty(Ha.prototype,"x",{get:function(){return this.O},set:function(a){"number"===typeof a&&(this.O=a)}});Object.defineProperty(Ha.prototype,"y",{get:function(){return this.j},set:function(a){"number"===typeof a&&(this.j=a)}});
Object.defineProperty(Ha.prototype,"width",{get:function(){return this.f},set:function(a){"number"===typeof a&&(this.f=a)}});Object.defineProperty(Ha.prototype,"height",{get:function(){return this.c},set:function(a){"number"===typeof a&&(this.c=a)}});Object.defineProperty(Ha.prototype,"center",{get:function(){return new THREE.Vector2(this.O+.5*this.f,this.j+.5*this.c)}});Object.defineProperty(Ha.prototype,"origin",{get:function(){return new THREE.Vector2(this.O,this.j)}});
Object.defineProperty(Ha.prototype,"size",{get:function(){return new Ia(this.f,this.c)}});function Ia(a,b){this.f=a||0;this.c=b||0}Ia.prototype.constructor=Ia;Object.defineProperty(Ia.prototype,"width",{get:function(){return this.f}});Object.defineProperty(Ia.prototype,"height",{get:function(){return this.c}});Object.defineProperty(Ia.prototype,"ratio",{get:function(){return this.f/this.c}});var Ja={IMAGE:"image",VIDEO:"video"},Ka={Nc:"equi",td:"cube",Ph:"flat",ql:"hotspot"};
function La(a,b){this.i=a;this.j=b;this.c=this.L=this.f=null;l.call(this,"Media");a=this.j;this.warn("$_Media config validator not implemented");a=a.media;this.O=a.uid;b=a.source;if(!b)throw"No source specified !";if(a.type===Ja.IMAGE){if(!b.url)throw"Multi resolution not implemented yet !";if(b.format===Ka.Nc)b={key:this.O,url:b.url},this.L=new I(this.i,b);else if(b.format===Ka.td)b={key:this.O,url:b.url},this.L=new I(this.i,b);else if(b.format===Ka.Ph)throw"Flat media not supported yet !";this.L.onLoadComplete.ca(this.o,
this)}else if(a.type===Ja.VIDEO){if(Array.isArray(b.levels)){b.url=[];for(var d=0,g=b.levels.length;d<g;d++)b.url.push(b.levels[d].url)}"undefined"!==typeof b.streaming&&b.streaming.toLowerCase()===Ma.Ne?this.L=new J(this.i,this.O):this.L=new K(this.i,this.O,null,null,!0===this.j.Ej(this.O)&&!0===this.j.Kj()?!0:!1);this.L.load(b.url);this.L.onLoadedMetaData.ca(this.m,this)}this.f="undefined"!==typeof a.options?a.options:null}La.prototype=Object.create(l.prototype);La.prototype.constructor=La;
La.prototype.o=function(){this.c&&this.c.D()};La.prototype.m=function(){this.f&&(this.L.volume="number"===typeof this.f.volume?this.f.volume:1,this.L.loop="boolean"===typeof this.f.loop?this.f.loop:!0,!0===this.f.autoPlay&&this.L.play());this.c&&this.c.D()};La.prototype.destroy=function(){this.L&&(this.L.destroy(),this.L=null);this.c&&(this.c.destroy(),this.c=null);this.j=this.i=null};Object.defineProperty(La.prototype,"displayObject",{get:function(){return this.L}});
Object.defineProperty(La.prototype,"onLoadComplete",{get:function(){this.c||(this.c=new p(this));return this.c}});function y(a){this.i=a;this.c=this.A=this.u=this.m=this.F=this.f=this.o=this.H=null;this.P=Na.yd;this.j=this.G=this.I=this.ba=this.B=null;this.S=this.M=this.N=!1;this.V=this.U=this.J=this.K=null;l.call(this,"RenderManager");this.C=new THREE.Clock;this.i.onReady.add(this.yh,this,1E3)}y.prototype=Object.create(l.prototype);e=y.prototype;e.constructor=y;
e.yh=function(){var a={antialias:!0,alpha:!0,premultipliedAlpha:!1,stencil:!0,canvas:this.i.canvas.dom};try{this.H=new THREE.WebGLRenderer(a)}catch(b){this.destroy();return}this.H.autoClear=!1;this.H.autoClearDepth=!0;this.H.autoClearColor=!0;this.A=new Oa(this.i);this.f=new Pa(this.i);this.G=new Qa(this.i);this.o=new Ra(this.i);this.f.onDisplayChange.add(this.xi,this);Sa(this,this.f.rendererSize);this.B=new L(this.i);this.i.canvas.onResize.add(this.bi,this);this.i.story.onSceneLoadStart.add(this.xh,
this)};
e.xh=function(){this.i.story.scene.onUnloadStart.ca(this.Cm,this);this.j=this.i.story.scene.config;"undefined"!==typeof this.j.background&&(this.i.container.background=this.j.background);this.G.Xi();this.o.Oi(this.G.renderScenes);var a=B.ab(this.i.config.view,this.j.view);switch("string"===typeof a.type?a.type.toLowerCase():Ta.wb){case Ta.fc:this.md(Ta.fc);break;default:this.md(Ta.wb)}a=B.ab(this.i.config.camera,this.j.camera);this.B.load(a);a=this.j;"undefined"!==typeof a.media&&"undefined"!==typeof a.media.source?
(this.P=a.media.source.format===Ka.td?Na.wd:Na.xd,this.m=new La(this.i,a),this.m.onLoadComplete.ca(this.em,this),B.T(this.m.displayObject,["VideoHTML5","VideoDash"])&&this.m.displayObject.onQualityChange.add(this.He,this),this.U&&this.U.D()):Ua(this);a=this.j;if("undefined"!==typeof a.sound&&"undefined"!==typeof a.sound.source){var b,d,g,h;"undefined"!==typeof a.sound.options&&(b="number"===typeof a.sound.options.volume?G.Z(a.sound.options.volume,0,1):1,d="boolean"===typeof a.sound.options.loop?a.sound.options.loop:
!1,g="number"===typeof a.sound.options.startTime?a.sound.options.startTime:0,h="boolean"===typeof a.sound.options.autoPlay?a.sound.options.autoPlay:!1);"undefined"!==typeof a.sound.source.url&&""!==a.sound.source.url&&(this.u=new M(this.i,a.sound.uid,a.sound.source.url,a.sound.type===Ga.Me?!0:!1),"undefined"!==typeof a.sound.options&&(this.u.volume=b,this.u.loop=d,this.u.startTime=g,!0===h&&this.u.play(this.u.startTime,this.u.loop,!0)))}};
e.Cm=function(){this.S=this.N=this.M=!1;this.G&&this.G.Fe();this.A&&this.A.fh();this.o&&this.o.Ie();this.u&&(this.u.destroy(),this.u=null);this.m&&(!0===B.T(this.m.displayObject,["VideoHTML5","VideoDash"])&&void 0!==this.m.displayObject.onQualityChange&&this.m.displayObject.onQualityChange.has(this.He,this)&&this.m.displayObject.onQualityChange.remove(this.He,this),this.V&&this.V.D(),this.m.destroy(),this.m=null)};
e.em=function(a){this.log("Media load is complete");Va(this,this.P);this.c.displayObject=a.emitter.displayObject;a=null;"undefined"!==typeof this.j.media.fx&&null!==this.j.media.fx&&(a=this.i.postProcessing.Vd(this.j.media.fx));this.o.Mi(this.c.renderTarget.texture,a);"undefined"!==typeof this.j.fx&&this.o.Ni(this.i.postProcessing.Vd(this.j.fx))};e.He=function(a){this.log("Media quality has changed");this.c.displayObject=a.emitter};
function Sa(a,b){a.log("Renderer size: "+b.width+"x"+b.height);var d=a.f.presentingVR,g=!0;!0===d&&(g=!1);!1===d&&a.f.setSize(b);a.H.setSize(b.width,b.height,g);a.ba=b;a.I=new Ia(b.width*(d?.5:1),b.height);a.c&&a.c.setSize(a.I);a.A.setSize(a.I);a.o.setSize(a.I);a.log("Render size change in "+(d?"VR":"screen")+" mode, resolution: "+a.I.width+"x"+a.I.height)}e.bi=function(){this.log("_canvasResizeHandler");var a=this.i.canvas.dom;Sa(this,new Ia(a.width,a.height))};
e.xi=function(){Sa(this,this.f.rendererSize);this.A.mode=!0===this.f.presentingVR?Wa.uc:Wa.Za};function Va(a,b){var d=null,g=null;a.c&&(null!==a.c.displayObject&&(d=a.c.displayObject),null!==a.c.renderTarget&&(g=a.c.renderTarget));Ua(a);b===Na.xd?(a.c=new Xa(a.i,g),g=a.H.getSize(),Sa(a,new Ia(g.width,g.height))):b===Na.wd&&(b={order:a.j.media.source.order||"RLUDFB",tile:a.j.media.source.tile},b.Dn=a.j.media.source.format,a.c=new Ya(a.i,g,b));null!==d&&(a.c.displayObject=d);a.N=!0;a.K&&a.K.D()}
function Ua(a){a.c&&(a.c.destroy(),a.c=null);a.N=!1}e.render=function(){if(!1!==this.N&&!1!==this.M&&this.o&&!0===this.N){var a=this.f.presentingVR,b=this.f.tj();this.B.update();for(var d=0,g=b.length;d<g;d++){var h=b[d],k=h.rectangle,h=h.camera;this.H.setViewport(k.origin.x,k.origin.y,k.size.width,k.size.height);this.c&&this.c.render((a?h:null)||null);this.o.render(h);this.H.clearDepth();!0===a&&(k=new THREE.Scene,k.add(h),this.H.render(k,h))}!0===this.f.presentingVR&&this.f.wh()}};
e.screenToWorld=function(a){return this.F.screenToWorld(a)};e.worldToScreen=function(a,b){return this.F.worldToScreen(a,b||0)};e.Xk=function(a){this.f.presentingVR!==a&&(this.f.vh(a),this.j.media.source.format===Ka.Nc&&(this.P=!0===a?Na.wd:Na.xd,Va(this,this.P)))};
e.md=function(a){this.log("setView");this.M=!1;this.F&&(this.log("Destroy previous view"),this.F.destroy(),this.F=null);if(a===Ta.wb)this.F=new Za(this.i,this.B);else if(a===Ta.fc)this.F=new $a(this.i,this.B);else throw"View type not supported "+a;this.c&&this.c.ec();this.M=!0;this.A.lk(a);a===Ta.wb?this.o.Of(!1):this.o.Of(!0,this.A.material,this.A.renderTarget);this.onViewReady.D()};
e.destroy=function(){this.i.canvas.onResize.remove(this.bi,this);this.i.story.onSceneLoadStart.remove(this.xh,this);this.i.onReady.remove(this.yh,this);this.A&&(this.A.destroy(),this.A=null);this.K&&(this.K.destroy(),this.K=null);this.J&&(this.J.destroy(),this.J=null);null!==this.R&&(this.R.destroy(),this.R=null);this.u&&(this.u.destroy(),this.u=null);this.m&&(this.m.destroy(),this.m=null);this.G&&(this.G.destroy(),this.G=null);this.F&&(this.F.destroy(),this.F=null);this.c&&(this.c.destroy(),this.c=
null);this.B&&(this.B.destroy(),this.B=null);this.f&&(this.f.onDisplayChange.remove(this.xi,this),this.f.destroy(),this.f=null);this.o&&(this.o.destroy(),this.o=null);this.H=this.j=this.C=null;l.prototype.destroy.call(this)};Object.defineProperty(y.prototype,"viewer",{get:function(){return this.i}});Object.defineProperty(y.prototype,"media",{get:function(){return this.m}});Object.defineProperty(y.prototype,"mediaSound",{get:function(){return this.u}});
Object.defineProperty(y.prototype,"webGLRenderer",{get:function(){return this.H}});Object.defineProperty(y.prototype,"renderPipeline",{get:function(){return this.o}});Object.defineProperty(y.prototype,"backgroundRenderer",{get:function(){return this.c}});Object.defineProperty(y.prototype,"pickingManager",{get:function(){return this.A}});
Object.defineProperty(y.prototype,"view",{get:function(){return this.F},set:function(a){if("string"===typeof a&&""!==a)switch(a){case Ta.fc:this.md(Ta.fc);break;case Ta.wb:this.md(Ta.wb);break;default:throw"View type not supported: "+a;}}});Object.defineProperty(y.prototype,"camera",{get:function(){return this.B}});Object.defineProperty(y.prototype,"canvasResolution",{get:function(){return this.ba}});Object.defineProperty(y.prototype,"displayResolution",{get:function(){return this.I}});
Object.defineProperty(y.prototype,"presentingVR",{get:function(){return this.f.presentingVR}});Object.defineProperty(y.prototype,"display",{get:function(){return this.f}});Object.defineProperty(y.prototype,"backgroundReady",{get:function(){return this.N}});Object.defineProperty(y.prototype,"onBackgroundReady",{get:function(){this.K||(this.K=new p(this,!0));return this.K}});Object.defineProperty(y.prototype,"viewReady",{get:function(){return this.M}});
Object.defineProperty(y.prototype,"onViewReady",{get:function(){this.J||(this.J=new p(this,!0));return this.J}});Object.defineProperty(y.prototype,"objects",{get:function(){return this.G}});Object.defineProperty(y.prototype,"hotspotsReady",{get:function(){return this.S}});Object.defineProperty(y.prototype,"onHotspotsReady",{get:function(){null===this.R&&(this.R=new p(this,!0));return this.R}});Object.defineProperty(y.prototype,"onMediaReady",{get:function(){this.U||(this.U=new p(this));return this.U}});
Object.defineProperty(y.prototype,"onMediaRelease",{get:function(){this.V||(this.V=new p(this));return this.V}});
function ab(a,b,d,g){this.i=a;this.j=b;this.m=d;this.o=g;this.f=this.c=null;l.call(this,"RenderScene");this.c=new bb(cb.Sb,this.i.renderer.webGLRenderer);a=new db(this.j,this.m);a.position=eb.Sb;this.c.addPass(a);a=this.i.postProcessing.ke(this.o);b=0;for(d=a.length;b<d;b++)g=a[b],g.renderToScreen=!1,g.position=eb.Sb,this.c.addPass(g);this.f=new bb(cb.cf,this.i.renderer.webGLRenderer);a=new db(this.j,this.m);a.position=eb.Sb;this.f.addPass(a)}ab.prototype=Object.create(l.prototype);
ab.prototype.constructor=ab;ab.prototype.setSize=function(a,b){this.c.setSize(a,b);this.f.setSize(a,b)};ab.prototype.destroy=function(){this.c.readBuffer.dispose();for(this.c.writeBuffer.dispose();0<this.c.passes.length;){var a=this.c.passes.pop();a instanceof fb&&a.hasOwnProperty("tDiffuse")&&(a.uniforms.tDiffuse.value.texture.dispose(),a.uniforms.tDiffuse.value=null)}this.c=null;this.f.passes.length=0;this.o=this.m=this.j=this.i=this.f=null;l.prototype.destroy.call(this)};
Object.defineProperty(ab.prototype,"scene",{get:function(){return this.j}});Object.defineProperty(ab.prototype,"camera",{get:function(){return this.m}});Object.defineProperty(ab.prototype,"sceneComposer",{get:function(){return this.c}});Object.defineProperty(ab.prototype,"pickingComposer",{get:function(){return this.f}});function Ra(a){this.i=a;this.C=this.f=this.c=null;this.j=!0;l.call(this,"RenderPipeline");this.C=new THREE.Clock;this.f=[];this.c=new bb(cb.Sh,this.i.renderer.webGLRenderer)}
Ra.prototype=Object.create(l.prototype);e=Ra.prototype;e.constructor=Ra;
function gb(a,b){a.log("COMPOSER: "+b.name);if(b.passes.length){for(var d=[],g=0,h=b.passes.length;g<h;g++){var k;k=b.passes[g];k=k instanceof fb?k.hasOwnProperty("map")?"Texture("+k.map.uuid.split("-")[0].slice(0,4)+")":"Texture":k instanceof db?"Render":k instanceof THREE.ClearMaskPass?"ClearMask":k instanceof THREE.MaskPass?"Mask":k instanceof hb?"Shader("+k.type.replace("Shader","")+")":"Pass";d.push(k)}g="";h=0;for(k=d.length;h<k;h++){for(var q=d[h],g=g+"| ",v=0;v<q.length;v++)g+="-";g+=" |";
if(h<k-1)for(q=0;5>q;q++)g+=" "}a.log(g);h="";k=0;for(q=d.length;k<q;k++)h+="| "+d[k]+" |",k<q-1&&(h+=" --- ");!1===b.passes[b.passes.length-1].renderToScreen&&(h+=" --- tex",b.readBuffer&&"undefined"!==typeof b.readBuffer.name&&(h+="("+b.readBuffer.name+")"));a.log(h);a.log(g)}}function ib(a){for(var b=0,d=a.f.length;b<d;b++)gb(a,a.f[b]);gb(a,a.c)}function jb(a,b,d){a.f.push(b);!1===d&&(b=new kb(b),a.c.addPass(b));lb(a)}
function mb(a,b,d){d="undefined"!==typeof d?d:a.passes.length;if(Array.isArray(b))for(var g=b.length-1;0<=g;g--)a.insertPass(b[g],d);else b instanceof THREE.Pass&&a.insertPass(b,d)}
function lb(a){var b=a.c.passes,d=[];b.filter(function(a,b){a.position===eb.rd&&d.push(b)});if(0<d.length&&0<d[0]){for(var g=[],h=d.length-1;0<=h;h--){var k=b.splice(d[h],1)[0];g.push(k)}h=0;for(k=g.length;h<k;h++)a.c.insertPass(g[h],0)}var q=[];b.filter(function(a,b){a.position===eb.Qe&&q.push(b)});if(0<q.length&&q[q.length-1]<b.length-1){g=[];h=0;for(k=q.length;h<k;h++){var v=b.splice(q[h],1)[0];g.push(v)}h=0;for(k=g.length;h<k;h++)a.c.addPass(g[h])}g=0;for(h=a.f.length;g<h;g++){var k=a.f[g],v=
!1,x,E=a.f.length;for(x=0;x<E;x++)if(x!==g&&k.readBuffer===a.f[x].readBuffer){v=!0;break}v=v&&g>x;x=0;for(E=k.passes.length;x<E;x++)k.passes[x].clear=!0===v?!1:!x}g=!1;for(h=b.length-1;0<=h;h--)k=b[h],!0===g?k.renderToScreen=!1:!0===k.enabled&&(g=k.renderToScreen=!0);ib(a)}e.Of=function(a,b,d){for(var g=0,h=this.f.length;g<h;g++){var k=this.f[g];k.type===cb.cf&&(k.enabled=a,"undefined"!==typeof b&&(k.passes[0].overrideMaterial=b),"undefined"!==typeof d&&(k.renderTarget=d))}};
e.Mi=function(a,b){if("undefined"!==typeof b&&b&&0<b.length){b=this.i.postProcessing.ke(b);for(var d=0,g=b.length;d<g;d++)b[d].position=eb.rd;mb(this.c,b,0)}a=new fb(a);a.position=eb.rd;this.c.insertPass(a,0);lb(this)};e.Oi=function(a){for(var b=0,d=a.length;b<d;b++)jb(this,a[b].sceneComposer,!1),jb(this,a[b].pickingComposer,!0);lb(this)};e.Ni=function(a){a=this.i.postProcessing.ke(a);for(var b=0,d=a.length;b<d;b++)a[b].position=eb.Qe;mb(this.c,a);lb(this)};
e.pn=function(a){if(this.c)for(var b=0,d=this.c.passes.length;b<d;b++){var g=this.c.passes[b];if(g.uid===a)return g}if(this.f)for(b=0,d=this.f.length;b<d;b++)for(var g=this.f[b],h=0,k=g.passes.length;h<k;h++){var q=g.passes[h];if(q.uid===a)return q}return null};
e.setSize=function(a){for(var b=0,d=this.f.length;b<d;b++){var g=this.f[b];g.setSize(a.width,a.height);for(var h=0,k=g.passes.length;h<k;h++){var q=g.passes[h];q instanceof THREE.ShaderPass&&"undefined"!==typeof q.uniforms.resolution&&(q.uniforms.resolution.value=new THREE.Vector2(1/a.width,1/a.height))}}this.c.setSize(a.width,a.height);h=0;for(k=this.c.passes.length;h<k;h++)q=this.c.passes[h],q instanceof THREE.ShaderPass&&"undefined"!==typeof q.uniforms.resolution&&(q.uniforms.resolution.value=
new THREE.Vector2(1/a.width,1/a.height))};
e.render=function(a){if(this.c){for(var b=0,d=this.c.passes.length;b<d;b++){var g=this.c.passes[b];if(g instanceof kb){var h=g.composer,k=h.readBuffer.texture;!0===h.passes[h.passes.length-1].needsSwap&&(k=h.writeBuffer.texture);g.uniforms.tAdd.value=k}}b=this.C.getDelta();d=this.f.concat(this.c);g=0;for(h=d.length;g<h;g++)for(var k=d[g],q=0,v=k.passes.length;q<v;q++){var x=k.passes[q];x instanceof db&&(x.camera=a)}a=0;for(d=this.f.length;a<d;a++)this.f[a].enabled&&this.f[a].render(b);this.c.render(b)}};
e.Ie=function(){if(this.c){this.c.readBuffer.dispose();this.c.writeBuffer.dispose();for(var a=0,b=this.c.passes.length;a<b;a++){var d=this.c.passes[a];d instanceof hb&&d.uniforms.hasOwnProperty("tAdd")&&(d.uniforms.tAdd.value=null)}this.c.passes=[]}this.f=[]};
e.destroy=function(){this.Ie();this.C=null;for(var a=this.f.length-1;0<a;a--){for(var b=this.f[a],d=0,g=b.passes.length;d<g;d++){var h=b.passes[d];"function"===typeof h.destroy&&h.destroy()}b.passes.length=0}this.f=null;d=0;for(g=this.c.passes.length;d<g;d++)h=this.c.passes[d],"function"===typeof h.destroy&&h.destroy();this.c.passes.length=0;this.i=this.c=null};
Object.defineProperty(Ra.prototype,"enabled",{get:function(){return this.j},set:function(a){for(var b=this.f.concat(this.c),d=0,g=b.length;d<g;d++){var h=b[d],k=a;!1===k&&(this.j=!1);for(var q=h.passes.length-1;0<=q;q--){var v=h.passes[q];v instanceof THREE.ShaderPass&&!(v instanceof kb)&&(v.enabled=k)}h.hasOwnProperty("enabled")&&(h.enabled=k);lb(this)}this.j=a}});
function Pa(a){this.i=a;this.o=this.F=!1;this.u=this.f=this.m=this.j=this.c=null;this.H=1;this.C=this.A=null;l.call(this,"RenderDisplay");nb(this)}Pa.prototype=Object.create(l.prototype);e=Pa.prototype;e.constructor=Pa;
function nb(a){var b=a.i.renderer.webGLRenderer;a.H=b.getPixelRatio();a.u=b.getSize();a.f=a.u;a.j=[0,0,.5,1];a.m=[.5,0,.5,1];"VRFrameData"in window&&(a.A=new VRFrameData);!0===N.Eg?(navigator.getVRDisplays().then(function(b){a.F=0<b.length;for(var d=0,h=b.length;d<h;d++)if("VRDisplay"in window&&b[d]instanceof VRDisplay){a.c=b[d];break}}),ob(a)):a.warn("missing api navigator.getVRDisplays")}
function ob(a){a.i.container.onFullscreenEnter.add(a.Bc,a);a.i.container.onFullscreenExit.add(a.Bc,a);window.addEventListener("vrdisplaypresentchange",a.Bc.bind(a),!1)}
e.Bc=function(){var a=this.o,b=this.i.renderer.webGLRenderer;this.o="undefined"!==typeof this.c&&(!0===this.c.isPresenting||!1===this.F&&document[N.fullscreenElement]instanceof window.HTMLElement);if(!0===this.o){var d=this.c.getEyeParameters("left");!0===this.F&&(this.G=d.renderWidth,this.B=d.renderHeight,this.log("Window size: "+window.innerWidth+"x"+window.innerHeight),this.log("Render size: "+this.G+"x"+this.B),this.j=[0,0,.5,1],this.m=[.5,0,.5,1],this.c.getLayers&&(d=this.c.getLayers(),0<d.length&&
d[0].leftBounds&&4===d[0].leftBounds.length&&(this.j=d[0].leftBounds,this.m=d[0].rightBounds)),this.log("Bounds L:["+this.j[0]+", "+this.j[1]+", "+this.j[2]+", "+this.j[3]+"], R:["+this.m[0]+", "+this.m[1]+", "+this.m[2]+", "+this.m[3]+"]"));!1===a&&(this.H=b.getPixelRatio(),this.u=b.getSize(),this.f=new Ia(2*this.G,this.B),b.setPixelRatio(1))}else!0===a&&(this.f=this.u,b.setPixelRatio(this.H));this.o!==a&&this.C&&this.C.D()};
function pb(a,b){var d=a.i.renderer.webGLRenderer.domElement;new Promise(function(a,h){"undefined"===typeof this.c?h(Error("No VR hardware found.")):this.o===b?a():!0===this.F&&(b?a(this.c.requestPresent([{source:d}])):a(this.c.exitPresent()))}.bind(a))}e.vh=function(a){!0===a?(this.i.raf.stop(),this.i.raf.start(this.c),pb(this,!0)):(this.i.raf.stop(),this.i.raf.start(window),pb(this,!1))};
e.rj=function(){if(!this.c)return null;var a=new THREE.Quaternion;if("function"===typeof this.c.getPose){var b=this.c.getPose();b.orientation&&(a=b.orientation,a=new THREE.Quaternion(-a[1],-a[0],-a[2],a[3]))}return a};
e.tj=function(){var a=this.i.renderer.camera,b=[];if("undefined"!==typeof this.c&&this.c&&!0===this.o){var d=this.f.width*this.j[0],g=this.f.height*this.j[1],h=this.f.width*this.j[2],k=this.f.height*this.j[3],q=new Ha(d,g,h,k),d=this.f.width*this.m[0],g=this.f.height*this.m[1],h=this.f.width*this.m[2],k=this.f.height*this.m[3],d=new Ha(d,g,h,k);b.push(new qb(q,a.left));b.push(new qb(d,a.right))}else b.push(new qb(new Ha(0,0,this.u.width,this.u.height),a.main));return b};
e.setSize=function(a){this.u=a;this.i.renderer.webGLRenderer.setPixelRatio(1)};e.wh=function(){!0===this.F&&"undefined"!==typeof this.c&&!0===this.o&&!0===this.c.capabilities.hasExternalDisplay&&this.c.submitFrame()};e.destroy=function(){this.i.container.onFullscreenEnter.remove(this.Bc,this);this.i.container.onFullscreenExit.remove(this.Bc,this);window.removeEventListener("vrdisplaypresentchange",this.Bc.bind(this));this.i=this.f=this.m=this.j=this.A=this.c=null};
Object.defineProperty(Pa.prototype,"presentingVR",{get:function(){return this.o}});Object.defineProperty(Pa.prototype,"vrDisplay",{get:function(){return this.c}});Object.defineProperty(Pa.prototype,"vrFrameData",{get:function(){return this.c&&"function"===typeof this.c.getFrameData&&this.A?(this.c.getFrameData(this.A),this.A):null}});Object.defineProperty(Pa.prototype,"rendererSize",{get:function(){return this.f}});
Object.defineProperty(Pa.prototype,"onDisplayChange",{get:function(){this.C||(this.C=new p(this));return this.C}});function qb(a,b){this.f=a||null;this.c=b||null}qb.prototype.constructor=qb;Object.defineProperty(qb.prototype,"rectangle",{get:function(){return this.f}});Object.defineProperty(qb.prototype,"camera",{get:function(){return this.c}});function rb(a,b,d){this.i=a;this.H=this.j=this.f=null;this.A=b||null;l.call(this,d||"BackgroundRenderer");this.Ic()}rb.prototype=Object.create(l.prototype);
e=rb.prototype;e.constructor=rb;e.Ic=function(){this.j=new THREE.Scene;this.A||(this.A=new THREE.WebGLRenderTarget(this.i.renderer.canvasResolution.width,this.i.renderer.canvasResolution.height,{minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBAFormat,lo:!1}))};e.ec=function(){throw Error(this.Ua+"::updateAfterViewChange not implemented");};e.setSize=function(a){null!==this.renderTarget&&this.renderTarget.setSize(a.width,a.height)};
e.render=function(a){if(null!==this.i.renderer&&this.A){if(this.f.material instanceof THREE.ShaderMaterial){var b=this.i.renderer.displayResolution;this.f.material.uniforms.hasOwnProperty("tViewportResolution")&&(this.f.material.uniforms.tViewportResolution.value=new THREE.Vector2(b.width,b.height));this.f.material.uniforms.hasOwnProperty("tViewportResolutionRatio")&&(this.f.material.uniforms.tViewportResolutionRatio.value=b.ratio);this.f.material.uniforms.hasOwnProperty("tModelViewMatrixInverse")&&
(this.f.material.uniforms.tModelViewMatrixInverse.value=this.i.renderer.camera.modelViewInverse);this.i.renderer.view.oc(this.f.material.uniforms)}a?this.i.renderer.webGLRenderer.render(this.j,a,this.A,!0):this.i.renderer.webGLRenderer.render(this.j,this.H,this.A,!0)}};e.destroy=function(){this.H=null;this.A&&(this.A.dispose(),this.A=null);for(;0<this.j.children.length;){var a=this.j.children.pop();null!==a.geometry&&(a.geometry.dispose(),a.geometry=null);this.j.remove(a)}this.i=this.j=null;l.prototype.destroy.call(this)};
Object.defineProperty(rb.prototype,"renderTarget",{get:function(){return this.A}});Object.defineProperty(rb.prototype,"displayObject",{get:function(){return this.L},set:function(a){null===a?this.Dd():this.Di(a)}});var Na={yd:"undefined",xd:"shader",wd:"mesh"};function Ya(a,b,d){this.C=this.u=this.c=this.L=null;this.I=d.order||"RLUDFB";this.m=new THREE.Vector2(0,0);this.K=d.tile;this.G=d.Dn||Ka.td;this.o=this.F=0;this.B=1;rb.call(this,a,b,"BackgroundMeshRenderer")}Ya.prototype=Object.create(rb.prototype);
e=Ya.prototype;e.constructor=Ya;e.Ic=function(){rb.prototype.Ic.call(this);this.H=this.i.renderer.camera.main;this.i.renderer.camera.fovMin=this.i.renderer.view.fovMin;this.i.renderer.camera.fovMax=this.i.renderer.view.fovMax;this.F=1E3;this.o=32;this.ec()};
e.Di=function(a){this.L=a;if(B.T(a,"Image"))this.c=new THREE.Texture,this.c.image=a.element;else if(B.T(a,"Canvas"))this.c=new THREE.Texture,this.c.image=a.element;else if(B.T(a,["VideoHTML5","VideoDash"]))"safari"===N.lb.toLowerCase()&&1440<a.originalHeight&&(this.B=2),this.u=document.createElement("canvas"),this.u.width=a.originalWidth/this.B,this.u.height=a.originalHeight/this.B,this.C=this.u.getContext("2d"),this.c=new THREE.Texture(this.u);else throw"Wrong type of display object "+a.type;this.c.format=
THREE.RGBAFormat;this.c.mapping=THREE.Texture.DEFAULT_MAPPING;this.c.magFilter=THREE.LinearFilter;this.c.minFilter=THREE.LinearFilter;this.c.wrapS=THREE.ClampToEdgeWrapping;this.c.wrapT=THREE.ClampToEdgeWrapping;this.c.generateMipmaps=!1;this.c.needsUpdate=!0;this.m.x=this.c.image.width/this.K;this.m.y=this.c.image.height/this.K;this.f.onBeforeRender=this.qk.bind(this);this.G!==Ka.Nc&&this.f.geometry.attributes.uv.set(sb(this))};e.qk=function(){this.f.material.uniforms.tTexture.value=this.c};
function sb(a){function b(a,b,h,Cc,fc){if(-1===a)throw"Unknown face for cube mapping.";var E,zb=a%b/b;a=1-(1+parseInt(a/b,10))/h;if(fc)for(fc=0,h=Cc;fc<=h;fc++)for(b=0,E=Cc;b<=E;b++)d[g.next().value]=v+k*b+zb,d[g.next().value]=x+q*fc+a;else for(fc=0,h=Cc;fc<=h;h--)for(b=0,E=Cc;b<=E;E--)d[g.next().value]=v+k*E+zb,d[g.next().value]=x+q*h+a}var d=new Float32Array((a.o+1)*(a.o+1)*12),g=d.keys(),h=a.I.split(""),k=1/1.01*(1/a.m.x/a.o),q=1/1.01*(1/a.m.y/a.o),v=1/a.m.x*.005,x=1/a.m.y*.005;b(h.indexOf("R"),
a.m.x,a.m.y,a.o);b(h.indexOf("L"),a.m.x,a.m.y,a.o);b(h.indexOf("U"),a.m.x,a.m.y,a.o,!0);b(h.indexOf("D"),a.m.x,a.m.y,a.o,!0);b(h.indexOf("B"),a.m.x,a.m.y,a.o);b(h.indexOf("F"),a.m.x,a.m.y,a.o);return d}
e.render=function(a){if(null!==this.i.renderer){if(this.c&&this.u&&this.C&&this.L&&null!==this.L.element){var b=this.L.element;b&&b instanceof HTMLVideoElement&&b.readyState===HTMLMediaElement.HAVE_ENOUGH_DATA&&this.C&&(this.C.drawImage(b,0,0,b.videoWidth,b.videoHeight,0,0,this.u.width,this.u.height),this.c.needsUpdate=!0,this.log("texture update done"))}rb.prototype.render.call(this,a)}};e.Dd=function(){this.i.renderer.webGLRenderer.clearColor()};
e.ec=function(){var a=B.clone(this.i.renderer.view.bc),a=this.G===Ka.Nc?a.equirectangular:a.mapping,b=tb.eb(a.vertexShader),d=tb.eb(a.fragmentShader),a=new THREE.RawShaderMaterial({fragmentShader:d,vertexShader:b,uniforms:a.uniforms,name:"BackgroundMeshMaterial",side:THREE.BackSide});this.c&&(a.uniforms.tTexture.value=this.c);0===this.j.children.length?(b=new THREE.BoxBufferGeometry(this.F,this.F,this.F,this.o,this.o,this.o),this.f=new THREE.Mesh(b,a),this.j.add(this.f)):(this.f=this.j.children[0],
this.f.material.dispose());this.f.material=a;a.needsUpdate=!0};e.destroy=function(){this.Dd();this.C=this.u=this.L=null;this.c&&(this.c.dispose(),this.c=null);rb.prototype.destroy.call(this)};Object.defineProperty(Ya.prototype,"texture",{get:function(){return this.c}});function Xa(a,b){this.o=this.m=this.c=this.L=null;this.u=1;rb.call(this,a,b,"BackgroundShaderRenderer")}Xa.prototype=Object.create(rb.prototype);e=Xa.prototype;e.constructor=Xa;
e.Ic=function(){rb.prototype.Ic.call(this);this.ec();this.H=new THREE.OrthographicCamera(-1,1,1,-1,-1,1)};
e.Di=function(a){this.L=a;if(B.T(a,"Image")||B.T(a,"Canvas"))this.c=new THREE.Texture,this.c.image=a.element;else if(B.T(a,["VideoHTML5","VideoDash"]))"safari"===N.lb.toLowerCase()&&1440<a.originalHeight&&(this.u=2),this.L.onQualityChange.has(this.Jc,this)&&this.L.onQualityChange.remove(this.Jc,this),this.L.onQualityChange.add(this.Jc,this),this.m=document.createElement("canvas"),this.m.width=a.originalWidth/this.u,this.m.height=a.originalHeight/this.u,this.o=this.m.getContext("2d"),this.c=new THREE.Texture(this.m);
else throw"Wrong type of display object "+a.className;this.c.format=THREE.RGBFormat;this.c.mapping=THREE.Texture.DEFAULT_MAPPING;this.c.magFilter=THREE.LinearFilter;this.c.minFilter=THREE.LinearFilter;this.c.wrapS=THREE.ClampToEdgeWrapping;this.c.wrapT=THREE.ClampToEdgeWrapping;this.c.generateMipmaps=!1;this.c.needsUpdate=!0;this.f.material.uniforms.tTexture.value=this.c};
e.Jc=function(a){this.log("Media quality has changed");a=a.emitter;this.m.width=a.originalWidth/this.u;this.m.height=a.originalHeight/this.u};e.Dd=function(){this.i.renderer.webGLRenderer.clearColor()};
e.render=function(a){if(null!==this.i.renderer){a=null;if(this.c&&this.m&&this.o&&this.L&&null!==this.L.element){var b=this.L.element;b instanceof HTMLVideoElement&&b.readyState===HTMLMediaElement.HAVE_ENOUGH_DATA&&this.o&&(this.o.drawImage(b,0,0,b.videoWidth,b.videoHeight,0,0,this.m.width,this.m.height),this.c.needsUpdate=!0,this.log("texture update done"))}rb.prototype.render.call(this,a)}};
e.ec=function(){var a=this.i.renderer.view.Fc,b=tb.eb(a.vertexShader),d=tb.eb(a.fragmentShader),a=new THREE.ShaderMaterial({uniforms:a.uniforms,vertexShader:b,fragmentShader:d,side:THREE.FrontSide});this.c&&(a.uniforms.tTexture.value=this.c);0===this.j.children.length?(b=new THREE.PlaneBufferGeometry(2,2),this.f=new THREE.Mesh(b,a),this.j.add(this.f)):(this.f=this.j.children[0],this.f.material=null);this.f.material=a;a.needsUpdate=!0};
e.destroy=function(){this.Dd();"undefined"!==typeof this.L.onQualityChange&&this.L.onQualityChange.has(this.Jc,this)&&this.L.onQualityChange.remove(this.Jc,this);this.o=this.m=this.L=null;this.c&&(this.c.dispose(),this.c=null);rb.prototype.destroy.call(this)};Object.defineProperty(Xa.prototype,"texture",{get:function(){return this.c}});function ta(a){this.i=a;this.c=this.f=null;l.call(this,"PostProcessing");this.c={}}ta.prototype=Object.create(l.prototype);e=ta.prototype;e.constructor=ta;
e.ke=function(a){if("undefined"===typeof a||null===a||0===a.length)return[];for(var b=[],d=0,g=a.length;d<g;d++){var h=a[d],k;if(THREE.hasOwnProperty(h.type)){k=new hb(h.uid,h.type,THREE[h.type]);if("undefined"!==typeof k.uniforms)for(var q in h.params){var v=h.params[q],x=v;if("object"===typeof v&&v.hasOwnProperty("type")&&v.hasOwnProperty("args")){var E=v.args;switch(v.type){case "THREE.Color":if(3===E.length)x=new THREE.Color(E[0],E[1],E[2]);else if("string"===typeof E||"number"===typeof E)x=new THREE.Color(E);
else throw Error("Cannot create THREE.Color with "+typeof E+" (length "+E.length+")");break;case "THREE.Vector2":x=new THREE.Vector2(E[0],E[1]);break;case "THREE.Vector3":x=new THREE.Vector3(E[0],E[1],E[2])}}k.uniforms[q].value=x}b.push(k)}else this.warn("Unknown image effect ("+h.type+")")}return b};e.Vd=function(a){return this.c[a]};
e.ha=function(a){a=this.f=a;this.O=a.uid;if("undefined"!==typeof a.fxSets&&0<a.fxSets.length)for(var b=0,d=a.fxSets.length;b<d;b++){var g=a.fxSets[b];this.c[g.uid]=g.set}};e.destroy=function(){this.c=this.i=null};var cb={Sh:"main",Sb:"render",cf:"picking"};function bb(a,b,d){this.m=a||cb.Sb;this.f="";this.c=!0;THREE.EffectComposer.call(this,b,d);this.f=ub(this.m)}bb.prototype=Object.create(THREE.EffectComposer.prototype);bb.prototype.constructor=bb;
bb.prototype.destroy=function(){this.writeBuffer.dispose();this.writeBuffer=null;this.readBuffer.dispose();this.readBuffer=null};bb.uid=0;function ub(a){return"$_EffectComposer."+a+"."+bb.uid++}Object.defineProperty(bb.prototype,"type",{get:function(){return this.m}});Object.defineProperty(bb.prototype,"renderTarget",{get:function(){return this.readBuffer},set:function(a){this.readBuffer&&this.readBuffer.dispose();this.readBuffer=a}});
Object.defineProperty(bb.prototype,"enabled",{get:function(){return this.c},set:function(a){this.c=a}});Object.defineProperty(bb.prototype,"name",{get:function(){return this.f}});var eb={zd:"",rd:"background",Sb:"render",Qe:"global"};function fb(a,b){this.c="";THREE.TexturePass.call(this,a,b)}fb.prototype=Object.create(THREE.TexturePass.prototype);fb.prototype.constructor=fb;Object.defineProperty(fb.prototype,"position",{get:function(){return this.c},set:function(a){this.c=a}});
function hb(a,b,d,g){this.o=a;this.m=b||"shader";this.O=eb.zd;this.f=0;THREE.ShaderPass.call(this,d,g||"tDiffuse")}hb.prototype=Object.create(THREE.ShaderPass.prototype);hb.prototype.constructor=hb;hb.prototype.render=function(a,b,d,g,h){this.f+=g;this.uniforms.hasOwnProperty("time")&&(this.uniforms.time.value=this.f);THREE.ShaderPass.prototype.render.call(this,a,b,d,g,h)};Object.defineProperty(hb.prototype,"uid",{get:function(){return this.o}});Object.defineProperty(hb.prototype,"type",{get:function(){return this.m}});
Object.defineProperty(hb.prototype,"position",{get:function(){return this.O},set:function(a){this.O=a}});function kb(a){this.j=a;this.c=null;a=tb.eb(vb.wts_vert_rectilinear);var b=tb.eb(vb.wts_frag_addition);this.c=new THREE.RawShaderMaterial({fragmentShader:b,vertexShader:a,uniforms:{tTexture:{type:"t",value:null},tAdd:{type:"t",value:null}},side:THREE.FrontSide,name:"$_AdditionPassMaterial"});hb.call(this,"","Addition",this.c,"tTexture")}kb.prototype=Object.create(hb.prototype);
kb.prototype.constructor=kb;kb.prototype.destroy=function(){this.c||(this.c.dispose(),this.c=null);this.j=null};Object.defineProperty(kb.prototype,"composer",{get:function(){return this.j}});function db(a,b,d,g,h){this.c="";THREE.RenderPass.call(this,a,b,d,g,h)}db.prototype=Object.create(THREE.RenderPass.prototype);db.prototype.constructor=db;Object.defineProperty(db.prototype,"position",{get:function(){return this.c},set:function(a){this.c=a}});
var vb={coordinates:"\nvec3 toCartesian(in vec3 rtp) {\n    float r = rtp.x;\n    float theta = rtp.y;\n    float phi = rtp.z;\n    float x = r * cos(phi) * sin(theta);\n    float y = r * sin(phi);\n    float z = r * cos(phi) * cos(theta);\n    return vec3(x,y,z);\n}\nvec3 toSpherical(in vec3 pt) {\n    float r = length(pt);\n    float theta = -atan(pt.x, pt.z);\n    float phi = asin(pt.y / r);\n    return vec3(r,theta,phi);\n}\n",defines:"precision highp float;\nprecision highp int;\n#define PI  3.141592653589793\n#define PI2 6.28318530717959\n#define RECIPROCAL_PI2 0.1591549430919\n",
helpers:"\nfloat wrap(in float x, in float min, in float max) {\n    return x - ((max - min) * (1.0 - step(x, min) - step(x, max)));\n}\nvec2 getFragment() {\n    return (2.0 * gl_FragCoord.xy / tViewportResolution - 1.0) * vec2(tViewportResolutionRatio, 1.0);\n}\n",texcoords:"\nvec2 toEquirectangularTexCoords(in vec2 thetaphi) {\n    thetaphi.x = wrap(thetaphi.x + PI, -PI, PI);\n    vec2 coords = 0.5 + thetaphi / vec2(PI2, PI);\n    return coords;\n}\n",uniforms:"uniform mat4 modelMatrix;\nuniform mat4 modelViewMatrix;\nuniform mat4 projectionMatrix;\nuniform mat4 viewMatrix;\nuniform mat3 normalMatrix;\nuniform vec3 cameraPosition;\n",
vert_attributes:"attribute vec3 position;\nattribute vec3 normal;\nattribute vec2 uv;\n",stw_frag_proj_gopro:"\n#include <defines>\nuniform sampler2D tTexture;\nuniform vec2 tViewportResolution;\nuniform float tViewportResolutionRatio;\nuniform mat4 tModelViewMatrixInverse;\nuniform float tProjectionDistance;\nuniform float tProjectionScale;\n#include <helpers>\n#include <coordinates>\n#include <texcoords>\nvec2 projection() {\n    vec2 frag = getFragment();\n    vec2 c = tProjectionScale * frag;\n    float zs = tProjectionDistance;\n    float xy2 = dot(c,c);\n    float zs12 = (zs+1.0)*(zs+1.0);\n    float delta = 4.0*(zs*zs*xy2*xy2 - (xy2+zs12)*(xy2*zs*zs-zs12));\n    if (delta < 0.0) {return vec2(-1.);}\n    float z = (2.0*zs*xy2 - sqrt(delta)) / (2.0 * (zs12 + xy2));\n    float x = c.x * ((zs-z) / (zs+1.0));\n    float y = c.y * ((zs-z) / (zs+1.0));\n    vec3 vx = vec3(tModelViewMatrixInverse * vec4(x, y, z, 1.0));\n    return toSpherical(vx).yz;\n}\nvoid main() {\n    vec2 texCoords = toEquirectangularTexCoords(projection());\n    gl_FragColor = vec4(texture2D(tTexture, texCoords).rgb, 1.0);\n}\n",
stw_frag_proj_rectilinear:"\n#include <defines>\nuniform sampler2D tTexture;\nuniform vec2 tViewportResolution;\nuniform float tViewportResolutionRatio;\nuniform mat4 tModelViewMatrixInverse;\nuniform float tProjectionScale;\n#include <helpers>\n#include <coordinates>\n#include <texcoords>\nvec2 projection() {\n    vec2 frag = tProjectionScale * getFragment();\n    vec4 screenPT = vec4(frag, -1.0, 1.0);\n    vec4 worldPT = tModelViewMatrixInverse * screenPT;\n    return toSpherical(worldPT.xyz).yz;\n}\nvoid main() {\n    vec2 texCoords = toEquirectangularTexCoords(projection());\n    gl_FragColor = vec4(texture2D(tTexture, texCoords).rgb, 1.0);\n}\n",
stw_vert_proj:"\n#include <defines>\nvoid main() {\n   gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n}\n",wts_frag:"\n#include <defines>\nuniform sampler2D tTexture;\nvarying vec2 vUv;\nvoid main() {\n    gl_FragColor = texture2D( tTexture, vUv );\n}\n",wts_frag_addition:"\n#include <defines>\nuniform sampler2D tTexture;\nuniform sampler2D tAdd;\nvarying vec2 vUv;\nvoid main() {\n    vec4 texel = texture2D( tTexture, vUv );\n    vec4 texelAdd = texture2D( tAdd, vUv );\n    gl_FragColor = vec4(vec3(texelAdd.a * texelAdd.rgb + (1.0 - texelAdd.a) * texel.rgb), 1.0);\n}\n",
wts_frag_color:"\n#include <defines>\nuniform vec3 tColor;\nvarying vec2 vUv;\nvoid main() {\n    vec2 texCoords = vUv;\n    gl_FragColor = vec4(tColor, 1.0);\n}\n",wts_frag_depth_drawing:"\n#include <defines>\nvarying float vDepth;\nvoid main() {\n    gl_FragColor = vec4(vDepth, vDepth, vDepth, 1.0);\n}\n",wts_frag_equirectangular:"\n#include <defines>\nuniform sampler2D tTexture;\nvarying vec3 vWorldPosition;\nvoid main() {\n    vec3 direction = normalize( vWorldPosition );\n    vec2 sampleUV;\n    sampleUV.y = clamp( direction.y * 0.5 + 0.5, 0.0, 1.0 );\n    sampleUV.x = atan( direction.z, direction.x ) * RECIPROCAL_PI2 - 0.25;\n    sampleUV.x += (1.0 - step(0.0, sampleUV.x));\n    gl_FragColor = texture2D( tTexture, sampleUV );\n}\n",
wts_vert_gopro:"\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tProjectionDistance;\nuniform float tProjectionScale;\nuniform float tViewportResolutionRatio;\nvarying vec2 vUv;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    vec4 origin = vec4(vec3(0.0), 1.0);\n    camPt.z -= tProjectionDistance * distance(camPt, origin);\n    camPt.xyz /= max(1.0, tProjectionScale);\n    gl_Position = projectionMatrix * camPt;\n    vUv = uv;\n}\n",
wts_vert_gopro_equirectangular:"\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tProjectionDistance;\nuniform float tProjectionScale;\nuniform float tViewportResolutionRatio;\nvarying vec3 vWorldPosition;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    vec4 origin = vec4(vec3(0.0), 1.0);\n    camPt.z -= tProjectionDistance * distance(camPt, origin);\n    camPt.xyz /= max(1.0, tProjectionScale);\n    gl_Position = projectionMatrix * camPt;\n    vWorldPosition = vec3(position);\n}\n",
wts_vert_littleplanet:"\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tProjectionScale;\nuniform float tViewportResolutionRatio;\nvarying vec2 vUv;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    camPt.z -= distance(camPt, vec4(vec3(0.0), 1.0));\n    camPt.xyz /= tProjectionScale;\n    gl_Position = projectionMatrix * camPt;\n    vUv = uv;\n}\n",wts_vert_littleplanet_equirectangular:"\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tProjectionScale;\nuniform float tViewportResolutionRatio;\nvarying vec3 vWorldPosition;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    camPt.z -= distance(camPt, vec4(vec3(0.0), 1.0));\n    camPt.xyz /= tProjectionScale;\n    gl_Position = projectionMatrix * camPt;\n    vWorldPosition = vec3(position);\n}\n",
wts_vert_rectilinear:"\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tViewportResolutionRatio;\nvarying vec2 vUv;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    gl_Position = projectionMatrix * camPt;\n    vUv = uv;\n}\n",wts_vert_rectilinear_equirectangular:"\n#include <defines>\n#include <vert_attributes>\n#include <uniforms>\nuniform float tViewportResolutionRatio;\nvarying vec3 vWorldPosition;\nvoid main() {\n    vec4 camPt = modelViewMatrix * vec4( position, 1.0 );\n    gl_Position = projectionMatrix * camPt;\n    vWorldPosition = vec3( position );\n}\n"},
tb={screenToWorld:{rectilinear:{uniforms:{tTexture:{type:"t",value:null},tViewportResolution:{type:"v2",value:new THREE.Vector2},tViewportResolutionRatio:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:new THREE.Matrix4},tProjectionScale:{type:"f",value:1}},vertexShader:vb.stw_vert_proj,fragmentShader:vb.stw_frag_proj_rectilinear},gopro:{uniforms:{tTexture:{type:"t",value:null},tViewportResolution:{type:"v2",value:new THREE.Vector2},tViewportResolutionRatio:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",
value:new THREE.Matrix4},tProjectionDistance:{type:"f",value:0},tProjectionScale:{type:"f",value:1}},vertexShader:vb.stw_vert_proj,fragmentShader:vb.stw_frag_proj_gopro}},worldToScreen:{rectilinear:{mapping:{uniforms:{tTexture:{type:"t",value:null},tProjectionScale:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:vb.wts_vert_rectilinear,fragmentShader:vb.wts_frag},equirectangular:{uniforms:{tTexture:{type:"t",value:null},tProjectionScale:{type:"f",value:1},tViewportResolutionRatio:{type:"f",
value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:vb.wts_vert_rectilinear_equirectangular,fragmentShader:vb.wts_frag_equirectangular}},littlePlanet:{equirectangular:{uniforms:{tTexture:{type:"t",value:null},tProjectionScale:{type:"f",value:1},tViewportResolutionRatio:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:vb.wts_vert_littleplanet_equirectangular,fragmentShader:vb.wts_frag_equirectangular}},gopro:{mapping:{uniforms:{tTexture:{type:"t",value:null},
tProjectionScale:{type:"f",value:1},tProjectionDistance:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:vb.wts_vert_gopro,fragmentShader:vb.wts_frag},equirectangular:{uniforms:{tTexture:{type:"t",value:null},tProjectionScale:{type:"f",value:1},tProjectionDistance:{type:"f",value:1},tViewportResolutionRatio:{type:"f",value:1},tModelViewMatrixInverse:{type:"m4",value:null}},vertexShader:vb.wts_vert_gopro_equirectangular,fragmentShader:vb.wts_frag_equirectangular}}},eb:function(a){return a.replace(/#include +<([\w\d.]+)>/g,
function(a,d){a=vb[d];if("undefined"===typeof a&&(a=THREE.ShaderChunk[d],"undefined"===typeof a))throw Error("Can not resolve #include <"+d+">");return tb.eb(a)})}},Ta={yd:"undefined",wb:"rectilinear",fc:"gopro"};function wb(a,b,d,g){this.i=a;this.c=b;this.f=1;this.m=g;l.call(this,d||"ViewBase")}wb.prototype=Object.create(l.prototype);e=wb.prototype;e.constructor=wb;e.Fc=tb.screenToWorld.rectilinear;e.bc=tb.worldToScreen.rectilinear;e.tc=function(){};
e.oc=function(a){this.log(a);throw"Please implement "+this.Ua+"::updateScreenToWorld";};e.worldToScreen=function(a,b){this.log(a);this.log(b);throw"Please implement "+this.Ua+"::worldToScreen";};e.screenToWorld=function(a){this.log(a);throw"Please implement "+this.Ua+"::screenToWorld";};e.destroy=function(){this.c=this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(wb.prototype,"type",{get:function(){return this.m}});Object.defineProperty(wb.prototype,"fovMin",{get:function(){return this.c.fovMin}});
Object.defineProperty(wb.prototype,"fovMax",{get:function(){return this.c.fovMax}});function $a(a,b){wb.call(this,a,b,"ViewGoPro",Ta.fc);this.tc()}$a.prototype=Object.create(wb.prototype);e=$a.prototype;e.constructor=$a;e.Fc=tb.screenToWorld.gopro;e.bc=tb.worldToScreen.gopro;e.tc=function(){wb.prototype.tc.call(this);this.c.fovMin=10;this.c.fovMax=160};
e.oc=function(a){var b,d=G.Z(this.c.fov,this.c.fovMin,this.c.fovMax);b=60>d?0:180<d?1:.5*(1+Math.sin(Math.PI/2*((d-60)/120*2-1)));a.tProjectionDistance.value=b;d=Math.PI*d/360;this.f=(b+1)*Math.sin(d)/(b+Math.cos(d));a.tProjectionScale.value=this.f};function Za(a,b){wb.call(this,a,b,"ViewRectilinear",Ta.wb);this.tc()}Za.prototype=Object.create(wb.prototype);e=Za.prototype;e.constructor=Za;e.Fc=tb.screenToWorld.rectilinear;e.bc=tb.worldToScreen.rectilinear;
e.tc=function(){wb.prototype.tc.call(this);this.c.fovMin=10;this.c.fovMax=170};e.oc=function(a){this.f=Math.tan(G.da(G.Z(this.c.fov,this.c.fovMin,this.c.fovMax)/2));a.tProjectionScale.value=this.f};
e.worldToScreen=function(a,b){b=b||0;a=new THREE.Vector4(a.x,a.y,a.z,1);var d=G.ng(this.c.modelView),d=G.Rd(d.yaw,d.pitch,d.roll,!0),d=d.transpose();a.applyMatrix4(d);if(0>a.z)return new THREE.Vector2(Infinity,Infinity);d=Math.max(Number.EPSILON,a.z);a=(new THREE.Vector2(a.x,a.y)).divideScalar(d);a.x/=(1+b)*this.f;a.y/=this.f;b=this.i.renderer.displayResolution;a.x=b.width/2*(a.x/b.ratio+1);a.y=b.height/2*(a.y/b.ratio+1);return new THREE.Vector2(Math.round(a.x),b.height-Math.round(a.y))};
e.screenToWorld=function(a){var b=this.i.renderer.displayResolution;a=new THREE.Vector2(2*(a.x/b.width-1)*b.ratio,2*(a.y/b.height-1)*b.ratio);a.multiplyScalar(this.f);a=(new THREE.Vector4(a.x,a.y,-1,0)).applyMatrix4(this.c.modelViewInverse).normalize();return new THREE.Vector3(a.x,a.y,a.z)};function xb(a){this.c=a||[];l.call(this,"Timeline");B.Ga(this.c,"Keyframe")?this.c=B.nd(this.c,"time"):this.c=[]}xb.prototype=Object.create(l.prototype);e=xb.prototype;e.constructor=xb;
e.sn=function(){return!!this.c&&0<this.c.length};e.xb=function(a){B.T(a,"Keyframe")&&(this.c.push(a),this.c=B.nd(this.c,"time"))};e.mn=function(a){a=this.Wd(a);return{previous:this.c[a.previous],next:this.c[a.next]||null}};e.Wd=function(a){for(var b=-1,d=-1,g=this.c.length-1;0<=g;g--)if(a>=this.c[g].time){b=g;break}b!==this.c.length-1&&(d=b+1);return{previous:b,next:d}};e.uj=function(a){a=this.vj(a);return{previous:this.c[a.previous]||null,next:this.c[a.next]||null}};
e.vj=function(a){a=this.Wd(a);var b=0,d=a.next;0<a.previous&&(b=a.previous-1);a.next<this.c.length-2&&(d=a.next+1);return{previous:b,next:d}};e.fn=function(){for(;0<this.c.length;)this.c.pop().data=null;this.c=[]};e.destroy=function(){for(;0<this.c.length;)this.c.pop().data=null;this.c=null;l.prototype.destroy.call(this)};Object.defineProperty(xb.prototype,"keyframes",{get:function(){return this.c},set:function(a){B.Ga(a,"Keyframe")&&(this.c=B.nd(a,"time"))}});
function yb(a,b){l.call(this,"Keyframe");this.c=a;this.hb=b}yb.prototype=Object.create(l.prototype);yb.prototype.constructor=yb;Object.defineProperty(yb.prototype,"time",{get:function(){return this.c},set:function(a){"number"===typeof a&&(this.c=a)}});Object.defineProperty(yb.prototype,"data",{get:function(){return this.hb},set:function(a){this.hb=a}});
function Ab(a,b){this.i=a;this.oa=b||null;this.u=this.B=this.m=this.Ia=null;this.I=this.G=0;this.R=!1;this.f=null;this.N=0;this.U=!1;this.A=this.F=this.H=this.C=this.ba=this.S=null;l.call(this,"Animation");this.te()}Ab.prototype=Object.create(l.prototype);e=Ab.prototype;e.constructor=Ab;e.te=function(){this.f=new Bb(this.i,this);this.f.onStart.add(this.Jm,this);this.f.onStop.add(this.Km,this);this.f.onProgress.add(this.pk,this);this.f.onComplete.add(this.Im,this);this.i.tween.add(this.f);this.m=new xb};
function Cb(a,b){a=a.split(".");for(var d=0,g=a.length;d<g-1;d++)b=b[a[d]];return[b,a[d]]}
function Db(a,b){b=b||a.G;var d=a.m.Wd(b||a.G);a.u=a.m.keyframes[d.next];a.B=a.m.keyframes[d.previous];if(!a.u||-1===d.next)return!1;if(a.U){var g=a.m.uj(b);if(g.previous&&null!==g.next){b=(new THREE.Quaternion).copy(a.B.data.quaternion).normalize();var d=(new THREE.Quaternion).copy(a.u.data.quaternion).normalize(),h=(new THREE.Quaternion).copy(g.previous.data.quaternion).normalize(),g=(new THREE.Quaternion).copy(g.next.data.quaternion).normalize();a.S=H.ug(h,b,d);a.ba=H.ug(b,d,g)}}a.I=a.u.time-a.B.time;
a.f.Le({tweenTime:1},a.I);a.N=0;a.f.start();return!0}e.Jm=function(){!0!==this.R&&(this.C&&this.C.D(),this.R=!0)};e.Km=function(){this.R=!1;this.H&&this.H.D()};
e.pk=function(){var a=this.N;if(this.u){this.G=a*this.I+this.B.time;var b=[],d,g,h;Array.isArray(this.Ia.prop)||(this.Ia.prop=[this.Ia.prop]);h=this.Ia.prop.length;for(g=0;g<h;g++)b.push(Cb(this.Ia.prop[g],this.oa));if(!0===this.Ia.smooth&&"quaternion"===this.Ia.prop[0])d=b[0],d[0].quaternion=H.ek(this.B.data.quaternion,this.S,this.ba,this.u.data.quaternion,a);else if("quaternion"===this.Ia.prop[0])d=b[0],d[0].quaternion=H.slerp(this.B.data.quaternion,this.u.data.quaternion,a);else{var k=this.f.easing(a),
q,v,x=0;for(g=0;g<h;g++){q=Cb(this.Ia.prop[g],this.B.data);v=Cb(this.Ia.prop[g],this.u.data);d=b[g];q=q[0][q[1]];v=v[0][v[1]];if(this.Ia.Ta&&this.Ia.Ta[g]){var E=this.Ia.Ta[g][0],zb=this.Ia.Ta[g][1],x=Math.abs(E-zb)/2;Math.abs(q-v)>x?(q=G.Ta(q+x,E,zb),v=G.Ta(v+x,E,zb)):x=0}d[0][d[1]]=(1-k)*q+k*v-x}}"function"===typeof this.Ia.mj&&this.Ia.mj.call(this,a)}this.F&&this.F.D({progress:this.G/this.I})};e.Im=function(){Db(this)||this.A&&this.A.D()};
e.play=function(){this.G=0;this.B=this.m.keyframes[0];this.u=this.m.keyframes[1];Db(this,0)};e.stop=function(){this.f.stop()};e.resume=function(){Db(this)};e.destroy=function(){this.m&&(this.m.destroy(),this.m=null);this.f&&(this.f.destroy(),this.f=null);this.C&&(this.C.destroy(),this.C=null);this.H&&(this.H.destroy(),this.H=null);this.F&&(this.F.destroy(),this.F=null);this.A&&(this.A.destroy(),this.A=null);l.prototype.destroy.call(this)};Object.defineProperty(Ab.prototype,"timeline",{get:function(){return this.m}});
Object.defineProperty(Ab.prototype,"instruction",{get:function(){return this.Ia},set:function(a){this.Ia=a}});Object.defineProperty(Ab.prototype,"tween",{get:function(){return this.f},set:function(a){this.f=a}});Object.defineProperty(Ab.prototype,"tweenTime",{get:function(){return this.N},set:function(a){this.N=a}});Object.defineProperty(Ab.prototype,"smooth",{get:function(){return this.U},set:function(a){this.U=a}});
Object.defineProperty(Ab.prototype,"onPlay",{get:function(){this.C||(this.C=new p(this));return this.C}});Object.defineProperty(Ab.prototype,"onStop",{get:function(){this.H||(this.H=new p(this));return this.H}});Object.defineProperty(Ab.prototype,"onProgress",{get:function(){this.F||(this.F=new p(this));return this.F}});Object.defineProperty(Ab.prototype,"onComplete",{get:function(){this.A||(this.A=new p(this));return this.A}});
function Eb(a,b,d){this.i=a;this.oa=b||null;this.c=null;this.C=0;this.o=this.j=null;l.call(this,d)}Eb.prototype=Object.create(l.prototype);Eb.prototype.constructor=Eb;Eb.prototype.stop=function(){for(var a=0,b=this.c;a<b;a++)this.c[a].stop()};Eb.prototype.resume=function(){for(var a=0,b=this.c;a<b;a++)this.c[a].resume()};Eb.prototype.ic=function(){this.C++;this.C===this.c.length&&this.o&&this.o.D()};
function Fb(a,b,d,g,h,k){var q=null,v=null;d=B.nd(d,"time");for(var x=0;x<d.length;x++){var E="string"===typeof k?d[x].data[k][g]:d[x].data[g];if("undefined"!==typeof E&&null!==E&&(d[x].time<b&&(q=d[x]),d[x].time>b)){v=d[x];break}}null===q&&(q={time:0,data:{}},"string"===typeof k?q.data[k]=a.oa[k]:q.data[g]=a.oa[g]);if(null===v)return"string"===typeof k?q.data[k][g]:q.data[g];a=Gb[h]((b-q.time)/(v.time-q.time));return(1-a)*("string"===typeof k?q.data[k][g]:q.data[g])+a*("string"===typeof k?v.data[k][g]:
v.data[g])}function Hb(a){for(var b;a.c&&0<a.c.length;)b=a.c.pop(),b.onComplete.remove(a.ic,a),b.destroy();a.c=[];a.C=0}Object.defineProperty(Eb.prototype,"onComplete",{get:function(){this.o||(this.o=new p(this));return this.o}});function Ib(a){this.c=this.A=this.C=null;this.u=0;this.f=null;this.m=0;l.call(this,a)}Ib.prototype=Object.create(l.prototype);Ib.prototype.constructor=Ib;
Ib.prototype.j=function(a){this.O=a.uid;this.C=a.name;this.A=a.description;this.c=a.keyframes;this.f="LINEAR";this.m=0;"object"===typeof a.easing&&null!==a.easing&&(this.f=a.easing["default"]||this.f,this.m=a.easing.offset||this.m);ba(this)};Ib.prototype.destroy=function(){da(this)};Object.defineProperty(Ib.prototype,"name",{get:function(){return this.C}});Object.defineProperty(Ib.prototype,"description",{get:function(){return this.A}});Object.defineProperty(Ib.prototype,"keyframes",{get:function(){return this.c}});
Object.defineProperty(Ib.prototype,"count",{set:function(a){"number"===typeof a&&(this.u=a)},get:function(){return this.u}});Object.defineProperty(Ib.prototype,"easing",{get:function(){return this.f}});Object.defineProperty(Ib.prototype,"offset",{get:function(){return this.m}});Object.defineProperty(Ib.prototype,"duration",{get:function(){for(var a,b=0,d=this.c.length;b<d;b++)this.c[b].time>a&&(a=this.c[b].time);return a}});
function Jb(a,b){this.i=a;this.c=null;this.V="";this.P=this.K=!0;this.o=null;this.R=this.M=!1;this.F=this.A=this.C=this.H=null;l.call(this,b||"Object3D");this.De()}Jb.prototype=Object.create(l.prototype);e=Jb.prototype;e.constructor=Jb;e.De=function(){this.o={};this.c=new THREE.Mesh;this.i.renderer.objects.register(this)};e.click=function(){this.log("click "+this.c.id);!0===B.T(this.o.onClick,"ActionEventDispatcher")&&this.o.onClick.D();this.H&&this.H.D()};
e.Ee=function(){this.log("over "+this.c.id);!0===B.T(this.o.onOver,"ActionEventDispatcher")&&this.o.onOver.D();this.C&&this.C.D()};e.od=function(){this.log("out "+this.c.id);!0===B.T(this.o.onOut,"ActionEventDispatcher")&&this.o.onOut.D();this.A&&this.A.D()};
e.destroy=function(){this.i.renderer.objects.unregister(this);this.c&&(this.c.c=null,this.c.geometry&&(this.c.geometry.dispose(),this.c.geometry=null),this.c=this.c.material=null);this.H&&(this.H.destroy(),this.H=null);this.C&&(this.C.destroy(),this.C=null);this.A&&(this.A.destroy(),this.A=null);this.F&&(this.F.destroy(),this.F=null);this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(Jb.prototype,"mesh",{get:function(){return this.c}});
Object.defineProperty(Jb.prototype,"visible",{get:function(){return this.K},set:function(a){this.K=!!a;this.c&&(this.c.visible=this.K)}});Object.defineProperty(Jb.prototype,"hovered",{get:function(){return this.M},set:function(a){this.M=!!a}});Object.defineProperty(Jb.prototype,"interactive",{get:function(){return this.P},set:function(a){this.P=!!a}});Object.defineProperty(Jb.prototype,"fx",{get:function(){return this.V}});Object.defineProperty(Jb.prototype,"events",{get:function(){return this.o}});
Object.defineProperty(Jb.prototype,"ready",{get:function(){return this.R}});Object.defineProperty(Jb.prototype,"onClick",{get:function(){this.H||(this.H=new p(this));return this.H}});Object.defineProperty(Jb.prototype,"onOver",{get:function(){this.C||(this.C=new p(this));return this.C}});Object.defineProperty(Jb.prototype,"onOut",{get:function(){this.A||(this.A=new p(this));return this.A}});Object.defineProperty(Jb.prototype,"onReady",{get:function(){this.F||(this.F=new p(this));return this.F}});
function Qa(a){this.i=a;this.c=this.X=null;l.call(this,"ObjectRenderer");this.X=[];this.c=[]}Qa.prototype=Object.create(l.prototype);e=Qa.prototype;e.constructor=Qa;function Kb(a,b){var d=[];return d="undefined"===typeof b||""===b||null===b?a.X.filter(function(a){return"undefined"===typeof a.fx||""===a.fx||null===a.fx}):a.X.filter(function(a){return a.fx===b})}function Lb(a){var b=Kb(a,null);return B.Ti(a.X,b)}
function Mb(a){return Lb(a).reduce(function(a,d){0>a.indexOf(d.fx)&&a.push(d.fx);return a},[])}e.register=function(a){this.X.push(a)};e.unregister=function(a){this.X.splice(this.X.indexOf(a),1)};
e.Xi=function(){var a=this.i.renderer.camera.main,b=Kb(this,null);if(0<b.length){for(var d=new THREE.Scene,g=0,h=b.length;g<h;g++)d.add(b[g].mesh);h=new ab(this.i,d,a,null);this.c.push(h)}b=Mb(this);d=0;for(g=b.length;d<g;d++){for(var h=b[d],k=Kb(this,h),q=new THREE.Scene,v=0,x=k.length;v<x;v++)q.add(k[v].mesh);h=new ab(this.i,q,a,this.i.postProcessing.Vd(h));this.c.push(h)}};e.sj=function(){return this.X.filter(function(a){return!0===a.ready&&!0===a.interactive})};
e.pj=function(a){for(var b=0,d=this.X.length;b<d;b++)if(this.X[b].mesh===a)return this.X[b];return null};e.Fe=function(){for(var a=this.c.length;a--;)this.c.pop().destroy()};e.destroy=function(){this.Fe();this.i=this.c=null;l.prototype.destroy.call(this)};Object.defineProperty(Qa.prototype,"all",{get:function(){return this.X}});Object.defineProperty(Qa.prototype,"renderScenes",{get:function(){return this.c}});function Nb(a){this.i=a;this.c=this.f=null;l.call(this,"Raycaster")}Nb.prototype=Object.create(l.prototype);
e=Nb.prototype;e.constructor=Nb;
e.start=function(a){this.log("Raycaster start");this.f||(this.f=new THREE.Raycaster);a===Wa.Za?(this.log("Raycating start pointer"),!1===this.i.canvas.pointer.onClick.has(this.Bd,this)&&this.i.canvas.pointer.onClick.add(this.Bd,this),!1===this.i.canvas.pointer.onMove.has(this.Cd,this)&&this.i.canvas.pointer.onMove.add(this.Cd,this)):a===Wa.uc&&(this.log("Raycating start gaze"),!1===this.i.renderer.camera.onCameraChange.has(this.Ad,this)&&this.i.renderer.camera.onCameraChange.add(this.Ad,this))};
e.stop=function(){this.log("Raycaster stop");this.i.canvas.pointer.onClick.has(this.Bd,this)&&this.i.canvas.pointer.onClick.remove(this.Bd,this);this.i.canvas.pointer.onMove.has(this.Cd,this)&&this.i.canvas.pointer.onMove.remove(this.Cd,this);!1===this.i.renderer.camera.onCameraChange.has(this.Ad,this)&&this.i.renderer.camera.onCameraChange.remove(this.Ad,this);Ob(this);this.f=null};e.Bd=function(a){a.data.center=a.data.center||{x:a.data.x,y:a.data.y};Pb(this,"click",a.data.center)};
e.Cd=function(a){a.data.center=a.data.center||{x:a.data.x,y:a.data.y};Pb(this,"move",a.data.center)};e.Ad=function(){Pb(this,"move")};
function Pb(a,b,d){var g=a.i.renderer.canvasResolution;d=d||{x:g.width/2,y:g.height/2};var h=a.i.renderer.camera,k=(new THREE.Vector2(d.x/g.width,1-d.y/g.height)).multiplyScalar(2).addScalar(-1),g=a.i.renderer.objects.sj();d=0;for(var q=g.length;d<q;d++)g[d].hovered=!1;d=null;a.f.setFromCamera(k,h.main);h=[];k=0;for(q=g.length;k<q;k++)h.push(g[k].mesh);for(g=a.f.intersectObjects(h);null===d&&0<g.length;){var h=g.shift(),k=h.object,v=h.uv,h=a.i.renderer.objects.pj(k);if(!1===k.material.transparent)d=
h;else{q=h;k=v;v=null;if(null!==q.mesh&&null!==q.mesh.material&&"undefined"!==typeof q.mesh.material.uniforms.tTexture){var x=q.mesh.material.uniforms.tTexture.value,q=null;null!==x&&null!==x.image&&("img"===x.image.nodeName.toLowerCase()?(q=document.createElement("canvas"),q.width=x.image.width,q.height=x.image.height,q.getContext("2d").drawImage(x.image,0,0)):"canvas"===x.image.nodeName.toLowerCase()&&(q=x.image),null!==q&&(v=q.width,x=q.height,k=4*(Math.floor(x-k.y*x)*v+Math.floor(k.x*v)),q=q.getContext("2d").getImageData(0,
0,v,x).data,v=new Qb(0,0,0,q[k+3])))}else"undefined"!==typeof q.mesh.material.color&&(v=q.mesh.material.color);(k=v)&&10<k.alpha&&(d=h)}}d?"click"===b?a.click():"move"===b&&d!==a.c&&(Ob(a),a.c=d,d.Ee(),a.i.renderer.pickingManager.mode===Wa.uc&&a.i.renderer.camera.gaze.start()):Ob(a)}function Ob(a){a.c&&(a.c.od(),a.c=null,a.i.renderer.pickingManager.mode===Wa.uc&&a.i.renderer.camera.gaze.stop())}e.click=function(){this.c&&this.c.click()};e.uh=function(){this.c=null};
Object.defineProperty(Nb.prototype,"hoveredObject",{get:function(){return this.c}});
function Rb(a){this.i=a;this.c=this.f=this.oa=null;l.call(this,"PickingDrawPass");a=B.clone(this.i.renderer.view.bc.mapping);a.uniforms.tColor={type:"c",value:new THREE.Color(0)};this.f=new THREE.RawShaderMaterial({fragmentShader:tb.eb(vb.wts_frag_color),vertexShader:tb.eb(a.vertexShader),uniforms:a.uniforms,side:THREE.FrontSide,name:"PickingMaterial"});this.oa=new THREE.WebGLRenderTarget(this.i.renderer.canvasResolution.width/3,this.i.renderer.canvasResolution.height/3,{format:THREE.RGBAFormat});
this.oa.name="Picking RenderTarget"}Rb.prototype=Object.create(l.prototype);e=Rb.prototype;e.constructor=Rb;function Sb(a){return new THREE.Color(a.id)}
function Tb(a,b){b.data.center=b.data.center||{x:b.data.x,y:b.data.y};var d=new Uint8Array(4);a.i.renderer.webGLRenderer.readRenderTargetPixels(a.oa,b.data.center.x/b.data.target.width*a.oa.width,(1-b.data.center.y/b.data.target.height)*a.oa.height,1,1,d);b=new THREE.Color(d[0],d[1],d[2]);var g;a:{a=a.i.renderer.objects.all;for(g in a)if(a[g].mesh.id===((b.r&255)<<16|((b.g&255)<<8)+(b.b&255))){g=a[g];break a}g=null}return g}e.Yc=function(a){(a=Tb(this,a))&&a.click()};
e.Jd=function(a){a=Tb(this,a);a?a!==this.c&&(this.c&&this.c.od(),a.Ee(),this.c=a):this.c&&(this.c.od(),this.c=null)};e.start=function(){this.i.canvas.pointer.enabled=!0;!1===this.i.canvas.pointer.onClick.has(this.Yc,this)&&this.i.canvas.pointer.onClick.add(this.Yc,this);!1===this.i.canvas.pointer.onMove.has(this.Jd,this)&&this.i.canvas.pointer.onMove.add(this.Jd,this)};
e.stop=function(){this.i.canvas.pointer.onClick.has(this.Yc,this)&&this.i.canvas.pointer.onClick.remove(this.Yc,this);this.i.canvas.pointer.onMove.has(this.Jd,this)&&this.i.canvas.pointer.onMove.remove(this.Jd,this)};e.click=function(){this.c&&this.i.canvas.pointer.onClick.has(this.Yc,this)&&this.c.click()};e.setSize=function(a){this.oa&&this.oa.setSize(a.width,a.height)};e.eh=function(){this.c=null};
e.destroy=function(){this.f&&(this.f.dispose(),this.f=null);this.oa&&(this.oa.dispose(),this.oa=null);this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(Rb.prototype,"material",{get:function(){return this.f}});Object.defineProperty(Rb.prototype,"renderTarget",{get:function(){return this.oa}});function Oa(a){this.i=a;this.f=this.c=null;this.j=Wa.Za;l.call(this,"PickingManager")}Oa.prototype=Object.create(l.prototype);Oa.prototype.constructor=Oa;var Wa={Za:"pointer",uc:"gaze"};e=Oa.prototype;
e.lk=function(a){a===Ta.wb?this.f||(this.c&&(this.c.stop(),this.c.destroy(),this.c=null),this.f=new Nb(this.i),this.f.start(this.j)):this.c||(this.f&&(this.f.stop(),this.f.destroy(),this.f=null),this.c=new Rb(this.i),this.c.start())};e.fh=function(){this.f&&this.f.uh();this.c&&this.c.eh()};e.setSize=function(a){this.c&&this.c.setSize(a)};e.click=function(){this.f&&this.f.click();this.c&&this.c.click()};e.start=function(){this.f&&this.f.start(this.j);this.c&&this.c.start()};
e.stop=function(){this.f&&this.f.stop();this.c&&this.c.stop()};e.destroy=function(){this.f&&(this.f.stop(),this.f.destroy(),this.f=null);this.c&&(this.c.stop(),this.c.destroy(),this.c=null);l.prototype.destroy.call(this)};Object.defineProperty(Oa.prototype,"renderTarget",{get:function(){return this.c?this.c.renderTarget:null}});Object.defineProperty(Oa.prototype,"material",{get:function(){return this.c?this.c.material:null}});
Object.defineProperty(Oa.prototype,"mode",{get:function(){return this.j},set:function(a){a!==Wa.Za&&a!==Wa.uc||a===this.j||(this.stop(),this.j=a,this.start())}});function qa(a){this.i=a;this.c=[];l.call(this,"HotspotManager")}qa.prototype=Object.create(l.prototype);e=qa.prototype;e.constructor=qa;e.zk=function(){var a=this.i.story.scene;a.onUnloadStart.ca(this.Qm,this);"undefined"!==typeof a.config.hotspots&&this.ha(a.config.hotspots)};e.Qm=function(){this.ye()};
e.boot=function(){this.i.story.onSceneLoadStart.add(this.zk,this)};e.ln=function(a){return this.c.filter(function(b){return b.type===a})};e.ha=function(a){for(var b=0,d=a.length;b<d;b++){var g=a[b],h=null;switch(g.type||Ub.qf){case Ub.qf:h=new Vb(this.i,g)}h&&this.c.push(h)}};e.Pi=function(a){if(null!==a.tracks){a=a.tracks;for(var b=0,d=a.length;b<d;b++)new Wb(a[b])}};e.update=function(){for(var a=0,b=this.c.length;a<b;a++)this.c[a].update()};e.ye=function(){for(var a=this.c.length;a--;)this.c.pop().destroy()};
e.destroy=function(){this.ye();this.c=this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(qa.prototype,"all",{get:function(){return this.c}});Object.defineProperty(qa.prototype,"count",{get:function(){return this.c}});function Vb(a,b){this.G=b;this.N="";this.u=this.B=this.ba=this.j=this.f=null;this.U=!1;this.I=this.J=null;Jb.call(this,a,"Hotspot3D")}Vb.prototype=Object.create(Jb.prototype);e=Vb.prototype;e.constructor=Vb;
e.De=function(){Jb.prototype.De.call(this);this.f=new Xb;this.u=new Yb(this.i,this.f);this.j=new Zb(this.i);if("undefined"!==typeof this.G&&this.G){var a=this.G;this.O=a.uid;this.Ya=a.tags;ba(this);this.m=a.type;this.N=a.name;this.K=a.visible;this.U=a.facingCenter||!1;"undefined"!==typeof a.transform&&this.f.load(a.transform);"undefined"!==typeof a.animation&&(this.u.load(a.animation),this.u.onProgress.add(this.Ii,this));this.j.onReady.add(this.li,this);var b;"undefined"!==typeof a.material?b=a.material:
b=$b.$h;!0===this.Tc&&(b=B.ab(b,$b.Mh));this.j.load(b);"undefined"!==typeof a.sound&&(this.B=new ac(this.i),this.B.load(a.sound,a.transform));"string"===typeof a.fx&&(this.V=a.fx);if("object"===typeof a.events){var a=a.events,d;for(d in a)b=new bc(this.i),b.c(a[d]),this.o[d]=b}}this.J=this.yk.bind(this);this.I=this.hm.bind(this)};
e.yk=function(a,b,d,g,h){a=this.i.renderer.webGLRenderer.getContext();this.i.renderer.view.oc(h.uniforms);"HotspotMaterial"===h.name?this.j.type===cc.vd?h.uniforms.tColor.value=new THREE.Color(this.j.color):h.uniforms.tTexture.value=this.j.c:"PickingMaterial"===h.name&&h.program&&(b=this.ba,a.useProgram(h.program.program),h.program.getUniforms().map.tColor.setValue(a,b),h.uniforms.tColor.value=b)};e.hm=function(){};
e.li=function(){this.f.m(this.j);this.c.material=this.j.material;this.c.geometry=new THREE.PlaneBufferGeometry(this.f.size.width,this.f.size.height,8,8);this.c.material=this.j.material;this.c.c=this.G;this.c.f=this.i.renderer.view instanceof Za;this.Ii();this.R=!0;this.F&&this.F.D();this.ba=Sb(this.c);this.c.onBeforeRender=this.J;this.c.onAfterRender=this.I;!0===this.u.autoPlay&&this.u.play()};
e.Ii=function(){var a=G.Ta(Math.PI-G.da(this.f.position.theta),-Math.PI,Math.PI),b=G.da(this.f.position.phi),d=this.f.position.radius,d=d+50*this.i.renderer.camera.parallax,d=B.wg(d,a,b);this.c.position.copy((new THREE.Vector3).setFromSpherical(d));!0===this.U?(this.c.rotation.set(b,a+Math.PI,0,"YXZ"),this.c.rotation.x+=-G.da(this.f.rotation.x),this.c.rotation.y+=G.da(this.f.rotation.y),this.c.rotation.z+=G.da(this.f.rotation.z)):this.c.rotation.set(-G.da(this.f.rotation.x),G.da(this.f.rotation.y),
G.da(this.f.rotation.z),"YXZ")};e.update=function(){this.j&&this.j.update();this.B&&this.B.update()};e.destroy=function(){this.j.onReady.remove(this.li,this);this.I=this.J=null;this.f&&(this.f.destroy(),this.f=null);this.u&&(this.u.destroy(),this.u=null);this.j&&(this.j.destroy(),this.j=null);this.B&&(this.B.destroy(),this.B=null);Jb.prototype.destroy.call(this)};Object.defineProperty(Vb.prototype,"type",{get:function(){return this.m}});Object.defineProperty(Vb.prototype,"name",{get:function(){return this.N}});
Object.defineProperty(Vb.prototype,"animation",{get:function(){return this.u}});function ac(a){this.i=a;this.c=this.u=this.f=null;this.C=0;this.A=1;this.F=!1;this.H=0;this.B=!1;this.m={radius:200,theta:0,phi:0};this.o=360;l.call(this,"HotspotSound")}ac.prototype=Object.create(l.prototype);e=ac.prototype;e.constructor=ac;e.Ak=function(){this.log("Sound load complete");this.f&&this.f.D()};
e.load=function(a,b){if("undefined"!==typeof a.source&&"object"===typeof a.source)if(this.O=a.uid,"undefined"!==typeof a.source.url&&"string"===typeof a.source.url&&""!==a.source.url){this.j=a.source.url;if("undefined"!==typeof a.options&&"object"===typeof a.options){if("number"===typeof a.options.volume)this.A=a.options.volume;else if("object"===typeof a.options.volume){var d=a.options.volume;this.C="number"===typeof d.min?G.Z(d.min,0,1):0;this.A="number"===typeof d.max?G.Z(d.max,0,1):1}this.F="boolean"===
typeof a.options.loop?a.options.loop:!1;this.H="number"===typeof a.options.startTime?a.options.startTime:0;this.B="boolean"===typeof a.options.autoPlay?a.options.autoPlay:!1;this.o="number"===typeof a.options.range?G.Z(a.options.range,1,360):360}"undefined"!==typeof b&&"undefined"!==typeof b.position&&(this.m.theta="number"===typeof b.position.theta?G.Z(b.position.theta,-180,180):0,this.m.phi="number"===typeof b.position.phi?G.Z(b.position.phi,-90,90):0);this.c=new M(this.i,this.O,this.j||"");this.c.onCanPlayThrough.ca(this.Ak,
this);!0===360>this.o&&(a=B.wg(1,G.da(-this.m.theta),G.da(this.m.phi)),this.u=(new THREE.Vector3).setFromSpherical(a),this.c.spatialized=360>this.o,this.c.x=this.u.x,this.c.y=this.u.y,this.c.z=this.u.z);this.c.volume=this.A;this.c.loop=this.F;this.c.startTime=this.H;!0===this.B&&this.c.play(this.H,this.F,!0)}else"undefined"!==typeof a.source.target&&!0===n.Wa(a.source.target)&&n.get(a.source.target)};
e.update=function(){if(!1===this.i.audio.enabled)this.c&&this.c.stop();else if(!0===360>this.o&&!0===360>this.o&&"number"===typeof this.o){var a=this.i.renderer.camera,a=H.lc(G.da(a.yaw),G.da(a.pitch),0),b=H.lc(G.da(this.m.theta),G.da(this.m.phi),0),a=H.Si(b,a),b=G.da(this.o/2);this.c.volume=a<b?this.C+(this.A-this.C)*(1-a/b):this.C}};e.destroy=function(){this.c&&(this.c.destroy(),this.c=null);this.m=this.u=null;this.f&&this.f.destroy();l.prototype.destroy.call(this)};
Object.defineProperty(ac.prototype,"sound",{get:function(){return this.c}});Object.defineProperty(ac.prototype,"onReady",{get:function(){this.f||(this.f=new p(this));return this.f}});function Zb(a){this.i=a;this.o=null;this.m="";this.f=this.c=null;this.C=1;this.u=!1;this.A=16777215;this.L=null;this.F=!1;this.j=null;l.call(this,"HotspotMaterial")}Zb.prototype=Object.create(l.prototype);Zb.prototype.constructor=Zb;
var cc={IMAGE:"image",Wh:"plugin",vd:"graphics"},$b={$h:{color:"#ffffff",opacity:0,transparent:!1},Mh:{color:"#00ff00",opacity:.8,transparent:!1}};e=Zb.prototype;
e.Vl=function(a){a=a.emitter;this.log("Texture load complete (Image) : "+a.element.src);this.L=a;this.c=new THREE.Texture(a.element);this.c.image.crossOrigin="anonymous";this.c.wrapS=THREE.ClampToEdgeWrapping;this.c.wrapT=THREE.ClampToEdgeWrapping;this.c.minFilter=THREE.LinearFilter;this.c.magFilter=THREE.LinearFilter;this.c.needsUpdate=!0;this.log("Map new texture from image");dc(this)};
e.ui=function(a){a=a.data;a.uid===this.o.plugin&&(this.i.plugins.onInstanceCreate.remove(this.ui,this),ec(this,a))};function ec(a,b){!0===b.instanceReady?gc(a,b):b.onInstanceReady.ca(a.Mm,a)}e.Mm=function(a){a=a.emitter;if(null===a.instance||!1===a.instanceReady)throw Error("Plugin instance not available");gc(this,a)};
function gc(a,b){a.L=b.instance.texture;a.c=new THREE.Texture(a.L.dom);a.c.format=THREE.RGBAFormat;a.c.wrapS=THREE.ClampToEdgeWrapping;a.c.wrapT=THREE.ClampToEdgeWrapping;a.c.magFilter=THREE.LinearFilter;a.c.minFilter=THREE.LinearFilter;a.c.generateMipmaps=!1;a.c.needsUpdate=!0;a.log("Map new texture from plugin");dc(a)}
e.ze=function(){this.f&&(this.f.dispose(),this.f=null);var a=B.clone(this.i.renderer.view.bc.mapping);this.m===cc.vd&&(a.fragmentShader=vb.wts_frag_color,a.uniforms.tColor={type:"c",value:new THREE.Color(2105376)});var b=tb.eb(a.vertexShader),d=tb.eb(a.fragmentShader);this.f=new THREE.RawShaderMaterial({fragmentShader:d,vertexShader:b,uniforms:a.uniforms,side:THREE.DoubleSide,name:"HotspotMaterial"});this.c&&(this.f.transparent=this.u,this.f.needsUpdate=!0);this.f.needsUpdate=!0;this.j&&this.j.D()};
function dc(a){!0===a.i.renderer.viewReady&&a.ze();a.i.renderer.onViewReady.add(a.ze,a)}
e.load=function(a){a=this.o=a;this.C="number"===typeof a.opacity?G.Z(a.opacity,0,1):1;this.u="boolean"===typeof a.transparent?a.transparent:!1;this.A="string"===typeof a.color?a.color:16777215;this.F="boolean"===typeof a.update?a.update:!1;"undefined"!==typeof a.image&&null!==a.image?(a=a.image,this.m=cc.IMAGE,this.L=new hc(this.i,a),this.L.onLoadComplete.ca(this.Vl,this)):"undefined"!==typeof a.plugin&&null!==a.plugin?(a=a.plugin,this.m=cc.Wh,a=this.i.plugins.get(a),"undefined"===typeof a||null===
a?this.i.plugins.onInstanceCreate.add(this.ui,this):ec(this,a)):(this.m=cc.vd,dc(this))};e.update=function(){this.f&&this.f.uniforms&&(this.f.uniforms.tTexture.value=this.c);this.c&&!0===this.F&&(this.c.needsUpdate=!0)};e.destroy=function(){this.i.renderer.onViewReady.remove(this.ze,this);this.c&&(this.c.dispose(),this.c=null);this.f&&(this.f.dispose(),this.f=null);this.m===cc.IMAGE&&this.L&&this.L.destroy();this.L=null;this.j&&(this.j.destroy(),this.j=null);this.i=null;l.prototype.destroy.call(this)};
Object.defineProperty(Zb.prototype,"type",{get:function(){return this.m}});Object.defineProperty(Zb.prototype,"texture",{get:function(){return this.c}});Object.defineProperty(Zb.prototype,"material",{get:function(){return this.f}});Object.defineProperty(Zb.prototype,"opacity",{get:function(){return this.C}});Object.defineProperty(Zb.prototype,"transparent",{get:function(){return this.u}});Object.defineProperty(Zb.prototype,"color",{get:function(){return this.A}});
Object.defineProperty(Zb.prototype,"displayObject",{get:function(){return this.L}});Object.defineProperty(Zb.prototype,"onReady",{get:function(){this.j||(this.j=new p(this));return this.j}});function Xb(a,b){this.f=a||{radius:200,theta:0,phi:0};this.j=b||{x:0,y:0,z:0};this.c={theta:10,phi:10,width:0,height:0};l.call(this,"HotspotTransform")}Xb.prototype=Object.create(l.prototype);Xb.prototype.constructor=Xb;
Xb.prototype.m=function(a){a=a.texture;var b=1,d=1;null!==a&&"undefined"!==typeof a.image&&(b=a.image.width,d=a.image.height);a=b/d;"number"===typeof this.c.phi&&(d=G.da(this.c.phi),d=2*this.f.radius*Math.tan(d/2),"auto"===this.c.theta&&(b=d*a));"number"===typeof this.c.theta&&(b=G.da(this.c.theta),b=2*this.f.radius*Math.tan(b/2),"auto"===this.c.phi&&(d=b/a));this.c.width=b;this.c.height=d};
Xb.prototype.load=function(a){"undefined"!==typeof a.position&&(this.f.radius="number"===typeof a.position.radius?a.position.radius:0,this.f.theta="number"===typeof a.position.theta?a.position.theta:0,this.f.phi="number"===typeof a.position.phi?a.position.phi:0);if("undefined"!==typeof a.rotation&&"auto"!==a.rotation)this.j.x="number"===typeof a.rotation.x?a.rotation.x:0,this.j.y="number"===typeof a.rotation.y?a.rotation.y:0,this.j.z="number"===typeof a.rotation.z?a.rotation.z:0;else if("undefined"===
typeof a.rotation||"auto"===a.rotation){var b=this.f,d={x:0,y:0,z:0};"undefined"!==typeof b&&(d.y="number"===typeof b.theta?-b.theta:0,d.x="number"===typeof b.phi?-b.phi:0);this.j=d}"undefined"!==typeof a.size&&(this.c.theta="number"===typeof a.size.theta?a.size.theta:"auto",this.c.phi="number"===typeof a.size.phi?a.size.phi:"auto")};Object.defineProperty(Xb.prototype,"position",{get:function(){return this.f}});Object.defineProperty(Xb.prototype,"rotation",{get:function(){return this.j}});
Object.defineProperty(Xb.prototype,"size",{get:function(){return this.c}});function Yb(a,b){this.f=this.A=null;this.F=this.u=this.H=!1;this.m=null;Eb.call(this,a,b,"HotspotAnimation");this.j=[{prop:["rotation.x","rotation.y","rotation.z"],Ta:[[-180,180],[-180,180],[-180,180]],smooth:!1},{prop:["position.radius","position.theta","position.phi"],Ta:[null,[-180,180],[-180,180]],smooth:!1}]}Yb.prototype=Object.create(Eb.prototype);e=Yb.prototype;e.constructor=Yb;
e.load=function(a){!0===a.enabled&&(this.H="boolean"===typeof a.loop?a.loop:!1,this.u="boolean"===typeof a.random?a.random:!1,this.F="boolean"===typeof a.autoPlay?a.autoPlay:!1,null!==a.tracks&&B.Ga(a.tracks,"string")&&(this.f=!0===this.u?B.kd(a.tracks):a.tracks))};e.ic=function(){if(1<this.f.length){var a=this.f.indexOf(this.A)+1;if(a<this.f.length){this.play(a);return}}!0===this.H?(!0===this.u&&(this.f=B.kd(this.f)),this.play(0)):Eb.prototype.ic.call(this)};e.$g=function(){this.m&&this.m.D()};
e.play=function(a){this.A="number"===typeof a?this.f[a]:"string"===typeof a?a:this.f[0];a=n.get(this.A);Hb(this);var b,d=a.offset,g=new Ab(this.i,this.oa);g.tween.easing=Gb[a.easing];g.instruction=this.j[0];g.instruction.smooth=a.smooth;g.onComplete.add(this.ic,this);g.onProgress.add(this.$g,this);for(var h,k,q,v=0,x=a.keyframes.length;v<x;v++)b=a.keyframes[v].time+d,h=a.keyframes[v].data.rotation,"undefined"!==typeof h&&null!==h&&(k="undefined"!==typeof h.x&&null!==h.x?h.x:Fb(this,b,a.keyframes,
"x",a.easing,"rotation"),q="undefined"!==typeof h.y&&null!==h.y?h.y:Fb(this,b,a.keyframes,"y",a.easing,"rotation"),h="undefined"!==typeof h.z&&null!==h.z?h.z:Fb(this,b,a.keyframes,"z",a.easing,"rotation"),b=new yb(b+d,{rotation:{x:k,y:q,z:h}}),g.timeline.xb(b));if(0<g.timeline.keyframes.length&&0<g.timeline.keyframes[0].time||0<d)v={rotation:B.clone(this.oa.rotation)},b=new yb(0,v),g.timeline.xb(b);this.c.push(g);g=new Ab(this.i,this.oa);g.tween.easing=Gb[a.easing];g.instruction=this.j[1];g.instruction.smooth=
a.smooth;g.onComplete.add(this.ic,this);g.onProgress.add(this.$g,this);v=0;for(x=a.keyframes.length;v<x;v++)b=a.keyframes[v].time+d,h=a.keyframes[v].data.position,"undefined"!==typeof h&&null!==h&&(k="undefined"!==typeof h.radius&&null!==h.radius?h.radius:Fb(this,b,a.keyframes,"radius",a.easing,"position"),q="undefined"!==typeof h.theta&&null!==h.theta?G.Ta(h.theta,-180,180):Fb(this,b,a.keyframes,"theta",a.easing,"position"),h="undefined"!==typeof h.phi&&null!==h.phi?G.Ta(h.phi,-180,180):Fb(this,
b,a.keyframes,"phi",a.easing,"position"),b=new yb(b+d,{position:{radius:k,theta:q,phi:h}}),g.timeline.xb(b));if(0<g.timeline.keyframes.length&&0<g.timeline.keyframes[0].time||0<d)v={position:B.clone(this.oa.position)},b=new yb(0,v),g.timeline.xb(b);this.c.push(g);this.c[0].play();this.c[1].play()};Object.defineProperty(Yb.prototype,"autoPlay",{get:function(){return this.F}});Object.defineProperty(Yb.prototype,"onProgress",{get:function(){this.m||(this.m=new p(this));return this.m}});
function Wb(a){Ib.call(this,"HotspotAnimationTrack");this.j(a)}Wb.prototype=Object.create(Ib.prototype);Wb.prototype.constructor=Wb;var Ub={qf:"3d"};
function L(a){this.i=a;this.R=null;this.P=this.ba=this.K=this.V=this.M=this.G=this.S=this.W=this.I=0;this.H=Math.PI/2;this.B=this.J=this.N=0;this.f=this.j=this.c=this.o=this.F=this.A=null;this.U=0;this.m=this.u=this.C=null;l.call(this,"Camera");this.A=new THREE.Matrix4;this.F=new THREE.Matrix4;this.o=new THREE.Quaternion;this.u=new ic(this.i,jc.gaze);kc(this);this.j=this.c.clone();this.j.name="CameraLeft";this.j.layers.enable(1);this.j.add(this.u.object);this.f=this.c.clone();this.f.name="CameraRight";
this.f.layers.enable(2)}L.prototype=Object.create(l.prototype);L.prototype.constructor=L;var jc={parallax:0,yaw:{default:0},pitch:{default:0,min:-90,max:90},roll:{default:0},fov:{default:90},gaze:{delay:2E3,cursor:{innerRadius:.02,outerRadius:.04,color:16777215,opacity:.5},progress:{innerRadius:.02,outerRadius:.04,color:16711680,opacity:.5}}};
function kc(a){"undefined"!==typeof a.i.renderer&&(a.c=new THREE.PerspectiveCamera(a.H,a.i.renderer.displayResolution.ratio,.01,1E4),a.c.name="CameraMain",a.c.matrixAutoUpdate=!1)}
function lc(a,b){var d=Math.tan(G.da(a.upDegrees)),g=Math.tan(G.da(a.downDegrees)),h=Math.tan(G.da(a.leftDegrees)),k=Math.tan(G.da(a.rightDegrees));a=2/(h+k);var h=(h-k)*a*.5,k=2/(d+g),d=(d-g)*k*.5,g=new THREE.Matrix4,q=g.elements;q[0]=a;q[1]=0;q[2]=-h;q[3]=0;q[4]=0;q[5]=k;q[6]=d;q[7]=0;q[8]=0;q[9]=0;q[10]=b.far/(b.near-b.far);q[11]=b.far*b.near/(b.near-b.far);q[12]=0;q[13]=0;q[14]=-1;q[15]=0;g.transpose();return g}
function mc(a){a.A=G.Rd(a.I,a.G,a.K,!1);a.F=a.A.clone().transpose();a.o=H.lc(a.I,a.G,a.K)}function nc(a){a.A=H.gk(a.o);a.F=a.A.clone().transpose();var b=H.qe(a.o),d=b.pitch,g=b.roll,h=G.mb;oc(a,b.yaw,h);pc(a,d,h);qc(a,g,h);rc(a,null,h)}function sc(a){a.m&&a.m.D(null,!0)}function oc(a,b,d){if("number"!==typeof b||!0===isNaN(b))return!1;d=d===G.Na||d===G.mb?d:G.mb;b=d===G.Na?G.da(b):b;b=G.Ta(b,-Math.PI,Math.PI);b=G.Z(b,a.W,a.S);d=a.I!==b;a.I=b;return d}
function pc(a,b,d){if("number"!==typeof b||!0===isNaN(b))return!1;d=d===G.Na||d===G.mb?d:G.mb;b=d===G.Na?G.da(b):b;b=G.Ta(b,-Math.PI,Math.PI);b=G.Z(b,a.M,a.V);d=a.G!==b;a.G=b;return d}function qc(a,b,d){if("number"!==typeof b||!0===isNaN(b))return!1;d=d===G.Na||d===G.mb?d:G.mb;b=d===G.Na?G.da(b):b;b=G.Ta(b,-Math.PI,Math.PI);b=G.Z(b,a.ba,a.P);d=a.K!==b;a.K=b;return d}
function rc(a,b,d){if("number"!==typeof b||!0===isNaN(b))return!1;d=d===G.Na||d===G.mb?d:G.mb;b=d===G.Na?G.da(b):b;b=G.Z(b,a.N,a.J);d=a.H!==b;a.H=b;return d}
L.prototype.load=function(a){a=this.R=B.ab(jc,a);this.B=a.parallax;this.U=50*this.B;this.W=G.da(a.yaw.min);this.S=G.da(a.yaw.max);oc(this,a.yaw["default"],G.Na);this.M=G.da(a.pitch.min);this.V=G.da(a.pitch.max);pc(this,a.pitch["default"],G.Na);this.ba=G.da(a.roll.min);this.P=G.da(a.roll.max);qc(this,a.roll["default"],G.Na);"undefined"!==typeof a.fov.min&&(this.N=G.da(a.fov.min));"undefined"!==typeof a.fov.max&&(this.J=G.da(a.fov.max));rc(this,a.fov["default"],G.Na);mc(this);sc(this);this.u.load(a.gaze)};
L.prototype.Qj=function(a,b,d,g,h){if("number"!==typeof h||!h)h=G.Na,oc(this,a,h),pc(this,b,h),qc(this,d,h),rc(this,g,h),mc(this),sc(this);else if(null!==a||null!==b||null!==d||null!==g)a=new tc({keyframes:[{time:h,data:{yaw:a,pitch:b,roll:d,fov:g}}]}),this.animation.play(a.uid)};
L.prototype.update=function(){if(this.c){var a=(new THREE.Matrix4).copy(this.F);this.B&&a.multiply((new THREE.Matrix4).makeTranslation(0,0,-this.U));this.c.quaternion.setFromRotationMatrix(a);this.c.matrixWorld=a;this.c.matrixWorldInverse.getInverse(a);this.c.fov=G.Zb(this.H);this.c.aspect=this.i.renderer.displayResolution.ratio;this.c.updateProjectionMatrix()}if(!0===this.i.renderer.display.presentingVR){this.u.update();var a=this.i.renderer.display,b=a.rj();null!==b&&(this.o=b,nc(this));var b=a.vrDisplay.getEyeParameters("left"),
d=a.vrDisplay.getEyeParameters("right");this.c.matrixWorld.decompose(this.j.position,this.j.quaternion,this.j.scale);this.j.matrixWorld=(new THREE.Matrix4).makeRotationFromQuaternion(this.c.quaternion);this.c.matrixWorld.decompose(this.f.position,this.f.quaternion,this.f.scale);this.f.matrixWorld=(new THREE.Matrix4).makeRotationFromQuaternion(this.c.quaternion);this.j.matrixWorld.elements[12]=this.c.matrixWorld.elements[12]+b.offset[0];this.j.matrixWorld.elements[13]=this.c.matrixWorld.elements[13]+
b.offset[1];this.j.matrixWorld.elements[14]=this.c.matrixWorld.elements[14]+b.offset[2];this.f.matrixWorld.elements[12]=this.c.matrixWorld.elements[12]+d.offset[0];this.f.matrixWorld.elements[13]=this.c.matrixWorld.elements[13]+d.offset[1];this.f.matrixWorld.elements[14]=this.c.matrixWorld.elements[14]+d.offset[2];a=a.vrFrameData;null!==a?(this.j.projectionMatrix.elements=a.leftProjectionMatrix,this.f.projectionMatrix.elements=a.rightProjectionMatrix):(this.j.projectionMatrix=lc({upDegrees:b.fieldOfView.upDegrees,
downDegrees:b.fieldOfView.downDegrees,leftDegrees:b.fieldOfView.leftDegrees,rightDegrees:b.fieldOfView.rightDegrees},this.c),this.f.projectionMatrix=lc({upDegrees:d.fieldOfView.upDegrees,downDegrees:d.fieldOfView.downDegrees,leftDegrees:d.fieldOfView.leftDegrees,rightDegrees:d.fieldOfView.rightDegrees},this.c));sc(this);a=0;for(b=this.f.children.length;a<b;a++)this.f.remove(this.f.children[a]);b=0;for(d=this.j.children.length;b<d;b++)a=this.j.children[b].clone(),this.f.add(a)}};
L.prototype.destroy=function(){this.c=this.o=this.F=this.A=null;this.u.destroy();this.u=null;this.m&&(this.m.destroy(),this.m=null);this.C&&(this.C.destroy(),this.C=null);this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(L.prototype,"config",{get:function(){return this.R},set:function(a){this.load(a)}});Object.defineProperty(L.prototype,"yaw",{get:function(){return G.Zb(this.I)},set:function(a){!0===oc(this,a,G.Na)&&(mc(this),sc(this))}});
Object.defineProperty(L.prototype,"pitch",{get:function(){return G.Zb(this.G)},set:function(a){pc(this,a,G.Na)&&(mc(this),sc(this))}});Object.defineProperty(L.prototype,"roll",{get:function(){return G.Zb(this.K)},set:function(a){!0===qc(this,a,G.Na)&&(mc(this),sc(this))}});Object.defineProperty(L.prototype,"fov",{get:function(){return G.Zb(this.H)},set:function(a){!0===rc(this,a,G.Na)&&sc(this)}});
Object.defineProperty(L.prototype,"fovMin",{get:function(){return G.Zb(this.N)},set:function(a){this.N=G.da(a)}});Object.defineProperty(L.prototype,"fovMax",{get:function(){return G.Zb(this.J)},set:function(a){this.J=G.da(a)}});Object.defineProperty(L.prototype,"quaternion",{get:function(){return this.o},set:function(a){this.o=a;nc(this);sc(this)}});Object.defineProperty(L.prototype,"animation",{get:function(){this.C||(this.C=new uc(this.i,this));return this.C}});
Object.defineProperty(L.prototype,"parallax",{get:function(){return this.B},set:function(a){this.B=G.Z(a,0,1);sc(this)}});Object.defineProperty(L.prototype,"modelView",{get:function(){return this.A}});Object.defineProperty(L.prototype,"modelViewInverse",{get:function(){return this.F}});Object.defineProperty(L.prototype,"main",{get:function(){this.c||kc(this);return this.c}});Object.defineProperty(L.prototype,"perspectiveCameraRadius",{get:function(){return this.U}});
Object.defineProperty(L.prototype,"left",{get:function(){return this.j}});Object.defineProperty(L.prototype,"right",{get:function(){return this.f}});Object.defineProperty(L.prototype,"gaze",{get:function(){return this.u}});Object.defineProperty(L.prototype,"onCameraChange",{get:function(){this.m||(this.m=new p(this));return this.m}});function uc(a,b){Eb.call(this,a,b,"CameraAnimation");vc(this)}uc.prototype=Object.create(Eb.prototype);uc.prototype.constructor=uc;
function vc(a){a.j=[{prop:"quaternion",smooth:!0,mj:function(){!0===this.Ia.cancelRoll&&(this.oa.quaternion=H.cancelRoll(this.oa.quaternion))},cancelRoll:!0},{prop:"fov",smooth:!1}]}
uc.prototype.play=function(a){"string"===typeof a&&(a=n.get(a));Hb(this);var b=new Ab(this.i,this.oa);b.tween.easing=Gb[a.easing];b.instruction=this.j[0];b.instruction.smooth=a.smooth;b.smooth=a.smooth;b.instruction.cancelRoll=a.cancelRoll;b.onComplete.add(this.ic,this);this.c.push(b);var d=new Ab(this.i,this.oa);d.tween.easing=Gb[a.easing];d.instruction=this.j[1];d.instruction.smooth=a.smooth;d.onComplete.add(this.ic,this);this.c.push(d);var g=a.keyframes,h=a.offset;a=a.easing;for(var h=h||0,k,q,
v,x,E=0,zb=g.length;E<zb;E++)q=g[E].data,k="undefined"!==typeof q.yaw&&null!==q.yaw?q.yaw:Fb(this,g[E].time+h,g,"yaw",a),v="undefined"!==typeof q.pitch&&null!==q.pitch?q.pitch:Fb(this,g[E].time+h,g,"pitch",a),x="undefined"!==typeof q.roll&&null!==q.roll?q.roll:Fb(this,g[E].time+h,g,"roll",a),k=G.da(k),v=G.da(v),x=G.da(x),"undefined"!==typeof k&&null!==k&&"undefined"!==typeof v&&null!==v&&"undefined"!==typeof x&&null!==x&&(k=H.lc(k,v,x),k=new yb(g[E].time+h,{quaternion:k}),this.c[0].timeline.xb(k)),
"undefined"!==typeof q.fov&&null!==q.fov&&(q=q.fov,k=new yb(g[E].time+h,{fov:q}),this.c[1].timeline.xb(k));if(0<g[0].time||0<h)k=new yb(0,{quaternion:B.clone(this.oa.quaternion)}),this.c[0].timeline.xb(k),k=new yb(0,{fov:this.oa.fov}),this.c[1].timeline.xb(k);b.play();d.play()};
function ic(a,b){this.i=a;this.f=b;this.c=null;this.A=!1;this.u=this.m=null;this.o=0;l.call(this,"CameraGaze");this.m=this.i.clock.create(!1);this.c=new THREE.Object3D;this.c.name="CameraGaze";this.c.position.z=-2;wc(this)}ic.prototype=Object.create(l.prototype);e=ic.prototype;e.constructor=ic;function xc(a,b,d,g,h,k){k=k||2*Math.PI;return new THREE.RingBufferGeometry(a||.02,b||.04,d||32,g||1,h||0,k)}
function wc(a){var b=new THREE.MeshBasicMaterial({color:a.f.cursor.color,opacity:a.f.cursor.opacity,transparent:!0}),b=new THREE.Mesh(xc(a.f.cursor.innerRadius,a.f.cursor.outerRadius),b);b.name="cursor";a.c.add(b)}
function yc(a){var b=new THREE.MeshBasicMaterial({color:a.f.progress.color,opacity:a.f.progress.opacity,transparent:!0,side:THREE.DoubleSide}),b=new THREE.Mesh(xc(a.f.progress.innerRadius,a.f.progress.outerRadius,32,1,Math.PI/2,a.o/100*G.ai),b);b.name="progress";b.rotateY(Math.PI);a.c.add(b)}function zc(a,b){for(var d=null,g=0,h=a.c.children.length;g<h;g++)a.c.children[g].name===b&&(d=a.c.children[g]);null!==d&&(a.c.remove(d),d.geometry.dispose(),d.material.dispose())}
e.Tm=function(){this.stop();this.i.renderer.pickingManager.click()};e.load=function(a){this.f=a;zc(this,"progress");zc(this,"cursor");wc(this);!0===this.A&&this.o&&yc(this)};e.start=function(){this.log("startGazeAnimation");this.A=!0;this.o=0;zc(this,"progress");yc(this);this.m&&(this.m.stop(),this.u=this.m.add(2E3,this.Tm,this),this.m.start())};
e.stop=function(){this.log("stopGazeAnimation");this.A=!1;this.m.stop();this.u=null;this.o=0;var a=this.c.children[1];"undefined"!==typeof a&&null!==a&&(this.c.remove(a),a.geometry.dispose(),a.material.dispose())};e.update=function(){if(!0===this.A&&this.u){var a=100*(this.u.delay-this.m.duration)/this.u.delay;this.log("timer update : "+a+"%");this.o=a;zc(this,"progress");yc(this)}};
e.destroy=function(){this.stop();this.c&&("undefined"!==typeof this.c.geometry&&null!==this.c.geometry&&this.c.geometry.dispose(),"undefined"!==typeof this.c.material&&null!==this.c.material&&this.c.material.dispose(),this.c=null);this.j=null};Object.defineProperty(ic.prototype,"visible",{get:function(){return this.c.visible},set:function(a){this.c.visible=a}});Object.defineProperty(ic.prototype,"object",{get:function(){return this.c}});var Ac={Za:"pointer",Ve:"keyboard"};
function oa(a){this.i=a;this.c=[];this.m=!0;this.f=this.j=null;l.call(this,"ControllerManager")}oa.prototype=Object.create(l.prototype);oa.prototype.constructor=oa;var Bc={enabled:!0,instances:[{uid:"controller-pointer-0",type:Ac.Za,enabled:!0},{uid:"controller-keyboard-0",type:Ac.Ve,enabled:!0}]};e=oa.prototype;e.ge=function(a){this.j&&this.j.D({controller:a})};e.fe=function(a){this.f&&this.f.D({controller:a})};
e.update=function(){if(this.c)for(var a=0,b=this.c.length;a<b;a++)"function"===typeof this.c[a].update&&this.c[a].update()};e.ha=function(a){a="undefined"!==typeof a?a:Bc;this.m="boolean"===typeof a.enabled?a.enabled:!0;if("undefined"!==typeof a.instances)for(var b,d=0,g=a.instances.length;d<g;d++){b=a.instances[d];switch(b.type){case Ac.Za:b=new Dc(this.i,b);break;case Ac.Ve:b=new Ec(this.i,b);break;default:b=null}b&&this.c.push(b)}};
e.destroy=function(){for(var a=this.c.length-1;a--;)this.c[a].destroy(),this.c[a]=null;this.c=null;this.j&&(this.j.destroy(),this.j=null);this.f&&(this.f.destroy(),this.f=null);l.prototype.destroy.call(this)};Object.defineProperty(oa.prototype,"all",{get:function(){return this.c}});Object.defineProperty(oa.prototype,"enabled",{get:function(){return this.m},set:function(a){this.m=!!a}});
Object.defineProperty(oa.prototype,"active",{get:function(){for(var a=0,b=this.c.length;a<b;a++)if(!0===this.c[a].active)return!0;return!1}});Object.defineProperty(oa.prototype,"onControlStart",{get:function(){this.j||(this.j=new p(this));return this.j}});Object.defineProperty(oa.prototype,"onControlEnd",{get:function(){this.f||(this.f=new p(this));return this.f}});function Fc(a,b){this.i=a;this.c=null;this.C=this.A=!1;this.f=this.j=null;l.call(this,b||"ControllerBase");this.Kc()}Fc.prototype=Object.create(l.prototype);
e=Fc.prototype;e.constructor=Fc;e.Kc=function(){this.i.canvas.pointer.enabled=!0;this.c=this.i.renderer.camera};e.enable=function(){!0!==this.A&&(this.A=!0)};e.Gb=function(){!1!==this.A&&(this.A=!0)};e.destroy=function(){this.i=this.c=null;this.j&&(this.j.destroy(),this.j=null);this.f&&(this.f.destroy(),this.f=null);l.prototype.destroy.call(this)};Object.defineProperty(Fc.prototype,"enabled",{get:function(){return this.A},set:function(a){!0===!!a?this.enable():this.Gb()}});
Object.defineProperty(Fc.prototype,"active",{get:function(){return this.C}});Object.defineProperty(Fc.prototype,"onControlStart",{get:function(){this.j||(this.j=new p(this));return this.j}});Object.defineProperty(Fc.prototype,"onControlEnd",{get:function(){this.f||(this.f=new p(this));return this.f}});function Dc(a,b){this.G=b;this.H=this.m=this.F=this.o=null;Fc.call(this,a,"ControllerPointer")}Dc.prototype=Object.create(Fc.prototype);Dc.prototype.constructor=Dc;
var Gc={hardness:.6,damping:.15,velocityMax:300,invert:!1},Hc={hardness:5,invert:!1};e=Dc.prototype;e.Kc=function(){Fc.prototype.Kc.call(this);this.H=new THREE.Vector2;this.m=new THREE.Vector2;this.o=new THREE.Vector2;this.F=new THREE.Vector2;var a=this.G;this.O=a.uid;ba(this);var b=a.options||{};this.u=B.ab(Gc,b.orientation);this.B=B.ab(Hc,b.zoom);this.A="boolean"===typeof a.enabled?a.enabled:!0;!0===this.A&&this.enable()};
e.Mg=function(a){!1!==this.i.controllers.enabled&&(this.i.canvas.pointer.onPanMove.add(this.ue,this),this.log("_panStartHandler ("+a.data.velocityX.toFixed(2)+", "+a.data.velocityY.toFixed(2)+")"),this.C=!0,this.o=new THREE.Vector2(a.data.center.x,a.data.center.y),this.F.copy(this.o),this.m.set(0,0),this.j&&this.j.D(),this.i.controllers.ge(this))};e.ue=function(a){!1!==this.i.controllers.enabled&&this.F.set(a.data.center.x,a.data.center.y)};
e.Lg=function(){this.i.canvas.pointer.onPanMove.remove(this.ue,this);this.log("_panEndHandler");this.C=!1;this.m.set(0,0);this.o.set(0,0);this.F.copy(this.o);this.f&&this.f.D();this.i.controllers.fe(this)};e.Og=function(a){!1!==this.i.controllers.enabled&&(this.i.canvas.pointer.onPinchMove.add(this.Ng,this),this.log("_pinchStartHandler "+a))};e.Ng=function(a){!1!==this.i.controllers.enabled&&this.log("_pinchMoveHandler "+a.data.pinch)};
e.ve=function(a){this.i.canvas.pointer.onPinchMove.remove(this.Ng,this);this.log("_pinchEndHandler "+a)};e.Pg=function(a){if(!1!==this.i.controllers.enabled){a.data.preventDefault();var b=(this.B.invert?1:-1)/this.B.hardness;a.data.deltaY&&(b*=a.data.deltaY/5);this.c.fov=this.c.fov-b;this.log("_wheelHandler (fov:"+this.c.fov+")")}};
e.enable=function(){Fc.prototype.enable.call(this);this.i.canvas.pointer.onPanStart.add(this.Mg,this);this.i.canvas.pointer.onPanEnd.add(this.Lg,this);this.i.canvas.pointer.onPinchStart.add(this.Og,this);this.i.canvas.pointer.onPinchEnd.add(this.ve,this);this.i.canvas.pointer.onWheel.add(this.Pg,this)};
e.Gb=function(){Fc.prototype.Gb.call(this);this.i.canvas.pointer.onPanStart.remove(this.Mg,this);this.i.canvas.pointer.onPanMove.remove(this.ue,this);this.i.canvas.pointer.onPanEnd.remove(this.Lg,this);this.i.canvas.pointer.onPinchStart.remove(this.Og,this);this.i.canvas.pointer.onPinchMove.remove(this.ve,this);this.i.canvas.pointer.onPinchEnd.remove(this.ve,this);this.i.canvas.pointer.onWheel.remove(this.Pg,this)};
e.update=function(){var a=this.i.renderer.displayResolution,a=1/(this.u.hardness*Math.min(a.width,a.height));this.m.subVectors(this.F,this.o);this.m.length()>this.u.velocityMax&&this.m.setLength(this.u.velocityMax);this.m.multiplyScalar(a);var a=this.u.invert?-1:1,b=a*(this.m.x+this.H.x);.05<Math.abs(b)&&(this.c.yaw+=b);a*=this.m.y+this.H.y;.05<Math.abs(a)&&(this.c.pitch-=a);this.H.add(this.m).multiplyScalar(G.Z(1-this.u.damping,0,1))};
function Ec(a,b){this.K=b;this.m=this.H=this.u=this.o=this.B=null;Fc.call(this,a,"ControllerKeyboard")}Ec.prototype=Object.create(Fc.prototype);Ec.prototype.constructor=Ec;var Ic={hardness:.6,damping:.15,velocityMax:300,invert:!1},Jc={hardness:5,invert:!1};e=Ec.prototype;
e.Kc=function(){Fc.prototype.Kc.call(this);this.m=[];this.H=new THREE.Vector2;this.u=new THREE.Vector2;this.B=new THREE.Vector2;this.o=new THREE.Vector2;var a=this.K;this.O=a.uid;ba(this);var b=a.options||{};this.F=B.ab(Ic,b.orientation);this.G=B.ab(Jc,b.zoom);this.A="boolean"===typeof a.enabled?a.enabled:!0;!1!==b["default"]&&(a=new P(this.i,[81,37],this.Kd,this.Md,this.Ld,[68,39],this,"left"),this.m.push(a),a=new P(this.i,[68,39],this.Kd,this.Md,this.Ld,[81,37],this,"right"),this.m.push(a),a=new P(this.i,
[90,38],this.Kd,this.Md,this.Ld,[83,40],this,"up"),this.m.push(a),a=new P(this.i,[83,40],this.Kd,this.Md,this.Ld,[90,38],this,"down"),this.m.push(a),a=new P(this.i,107,this.Ji,this.Li,this.Ki,109,this,"plus"),this.m.push(a),a=new P(this.i,109,this.Ji,this.Li,this.Ki,107,this,"minus"),this.m.push(a));if(!0===Array.isArray(b.bindings))for(var a=0,d=b.bindings.length;a<d;a++){var g=b.bindings[a],h=g.in,k=g.out,q=g.name,g=g.events;!1===B.T(h,"number")&&!1===B.Ga(h,"number")?this.warn("Can't add custom keyboard binding, keys in are invalid!"):
"object"!==typeof g&&null===g?this.warn("Can't add custom keyboard binding, events are invalid!"):(h=new P(this.i,h,g.onDown,g.onUp,g.onHold,k,this,q),this.m.push(h))}!0===this.A&&this.enable()};e.Kd=function(a){if(!1!==this.i.controllers.enabled){this.C=!0;switch(a.name){case "left":case "right":this.u.setX(0);break;case "up":case "down":this.u.setY(0)}this.j&&this.j.D();this.i.controllers.ge(this)}};
e.Ld=function(a){if(!1!==this.i.controllers.enabled)switch(a.name){case "left":this.o.setX(this.o.x-5);break;case "right":this.o.setX(this.o.x+5);break;case "up":this.o.setY(this.o.y-5);break;case "down":this.o.setY(this.o.y+5)}};e.Md=function(a){this.C=!1;switch(a.name){case "left":case "right":this.u.setX(0);this.o.setX(0);break;case "up":case "down":this.u.setY(0),this.o.setY(0)}this.f&&this.f.D();this.i.controllers.fe(this)};
e.Ji=function(a){!1!==this.i.controllers.enabled&&(this.C=!0,Kc(this,a),this.j&&this.j.D(),this.i.controllers.ge(this))};e.Ki=function(a){Kc(this,a)};e.Li=function(){this.C=!1;this.f&&this.f.D();this.i.controllers.fe(this)};function Kc(a,b){var d=(a.G.invert?1:-1)/a.G.hardness;switch(b.name){case "minus":d*=10;break;case "plus":d*=-10}a.c.fov=a.c.fov-d}e.enable=function(){Fc.prototype.enable.call(this);for(var a,b=0,d=this.m.length;b<d;b++)a=this.m[b],this.i.keyboard.Cf(a)};
e.Gb=function(){Fc.prototype.Gb.call(this);for(var a,b=0,d=this.m.length;b<d;b++)a=this.m[b],this.i.keyboard.ne(a)};
e.update=function(){var a=this.i.renderer.displayResolution,a=1/(this.F.hardness*Math.min(a.width,a.height));this.u.subVectors(this.o,this.B);this.u.length()>this.F.velocityMax&&this.u.setLength(this.F.velocityMax);this.u.multiplyScalar(a);a=this.F.invert?-1:1;this.c.yaw+=a*(this.u.x+this.H.x);this.c.pitch-=a*(this.u.y+this.H.y);this.H.add(this.u).multiplyScalar(G.Z(1-this.F.damping,0,1))};
function u(a){this.i=a;this.J=null;this.j=1;this.V=!1;this.R=this.G=this.U=1;this.B=!1;this.N=!0;this.c=null;this.I=!1;this.m=!0;this.A=this.u=this.H=this.F=this.C=this.o=this.K=this.f=null;l.call(this,"SoundManager")}u.prototype=Object.create(l.prototype);e=u.prototype;e.constructor=u;
e.boot=function(){this.c=[];if(!0===N.Cg)try{"function"===typeof window.AudioContext?this.f=new window.AudioContext:this.f=new window.webkitAudioContext}catch(a){this.f=null,this.m=!1}!0!==N.Df||this.f||(this.m=!1,this.I=!0);this.f&&(this.o="undefined"===typeof this.f.createGain?this.f.createGainNode():this.f.createGain(),this.K=this.f.createAnalyser(),this.K.connect(this.o),this.o.gain.value=this.j,this.o.connect(this.f.destination),this.f.listener.setOrientation(0,0,-1,0,1,0));this.i.story.onSceneLoadStart.add(this.zh,
this)};e.zh=function(){if("undefined"!==typeof this.i.story.scene.config.audio){var a=B.ab(this.J,this.i.story.scene.config.audio);Lc(this,a)}else Lc(this,this.J);!1===this.N?this.u&&this.u.D():this.A&&this.A.D()};function Lc(a,b){b&&(a.N="undefined"!==typeof b.enabled?!!b.enabled:!0,a.G="undefined"!==typeof b.volume&&"number"===b.volume.max?G.Z(b.volume.max,0,1):1,a.U=!1===a.V?"undefined"!==typeof b.volume&&"number"===typeof b.volume["default"]?G.Z(b.volume["default"],0,a.G):1:G.Z(a.j,0,a.G))}
e.ha=function(a){this.J=a;Lc(this,a);"number"===typeof this.U&&!1===this.V&&(this.j=G.Z(this.U,0,1));Mc(this)};e.update=function(){for(var a=0,b=this.c.length;a<b;a++)this.c[a].update();if(!0===this.m&&null!==this.i.renderer.camera.main){a=new THREE.Vector3;b=this.i.renderer.camera.main.quaternion;a.set(0,0,1);a.applyQuaternion(b);var d=a.clone();a.set(0,1,0);a.applyQuaternion(b);this.f.listener.setOrientation(d.x,d.y,d.z,a.x,a.y,a.z)}};e.add=function(a){-1===Nc(this,a)&&this.c.push(a)};
e.remove=function(a){a=Nc(this,a);-1<a&&this.c.splice(a,1)};function Nc(a,b){if(!a.c)return-1;for(var d,g=0,h=a.c.length;g<h;g++)if(d=a.c[g],d===b)return g;return-1}e.Ff=function(){if(this.f&&"undefined"!==typeof this.f.suspend&&!0===this.m&&"running"===this.f.state){for(var a=!0,b=0,d=this.c.length;b<d;b++)if(!0===this.c[b].playing||!0===this.c[b].paused){a=!1;break}!0===a&&this.f.suspend()}};
e.Ef=function(){if(this.f&&"undefined"!==typeof this.f.resume&&!0===this.m&&"suspended"===this.f.state)for(var a=0,b=this.c.length;a<b;a++)if(!0===this.c[a].playing||!0===this.c[a].paused){this.f.resume();break}};e.bb=function(){!0!==this.B&&(this.B=!0,this.R=this.j,this.j=0,!0===this.m&&(this.R=this.o.gain.value),Mc(this),this.C&&this.C.D())};e.Ah=function(){!1!==this.B&&(this.B=!1,this.j=this.R,Mc(this),this.F&&this.F.D())};
function Mc(a){if(!0===a.m)a.o.gain.value=a.j;else if(!0===a.I)for(var b=0;b<a.c.length;b++)a.c[b].c.data.volume=G.Z(a.c[b].C,0,1)*a.j;a.V=!0;a.H&&a.H.D()}
e.destroy=function(){this.i.story.onSceneLoadStart.remove(this.zh,this);this.J=this.i=null;for(var a=this.c.length;a--;)this.c[a].destroy();this.o=this.K=this.f=this.c=null;this.C&&(this.C.destroy(),this.C=null);this.F&&(this.F.destroy(),this.F=null);this.H&&(this.H.destroy(),this.H=null);this.u&&(this.u.destroy(),this.u=null);this.A&&(this.A.destroy(),this.A=null);l.prototype.destroy.call(this)};Object.defineProperty(u.prototype,"context",{get:function(){return this.f}});
Object.defineProperty(u.prototype,"analyser",{get:function(){return this.K}});Object.defineProperty(u.prototype,"inputNode",{get:function(){return this.K}});Object.defineProperty(u.prototype,"masterGain",{get:function(){return this.o}});Object.defineProperty(u.prototype,"useWebAudio",{get:function(){return this.m},set:function(a){"boolean"===typeof a&&(this.m=a,this.I=!a)}});
Object.defineProperty(u.prototype,"useAudioTag",{get:function(){return this.I},set:function(a){"boolean"===typeof a&&(this.I=a,this.m=!a)}});Object.defineProperty(u.prototype,"enabled",{get:function(){return this.N}});Object.defineProperty(u.prototype,"muted",{get:function(){return this.B},set:function(a){"boolean"===typeof a&&(!0===a?this.bb():this.Ah())}});
Object.defineProperty(u.prototype,"volume",{get:function(){return!0===this.m?this.o.gain.value:this.j},set:function(a){"number"===typeof a&&(a=G.Z(a,0,1),this.j=this.G<a?this.G:a,0<this.j&&(this.B=!1),Mc(this))}});Object.defineProperty(u.prototype,"onMute",{get:function(){this.C||(this.C=new p(this));return this.C}});Object.defineProperty(u.prototype,"onUnmute",{get:function(){this.F||(this.F=new p(this));return this.F}});
Object.defineProperty(u.prototype,"onVolumeChange",{get:function(){this.H||(this.H=new p(this));return this.H}});Object.defineProperty(u.prototype,"onDisable",{get:function(){this.u||(this.u=new p(this));return this.u}});Object.defineProperty(u.prototype,"onEnable",{get:function(){this.A||(this.A=new p(this));return this.A}});var Ga={vl:"stereo",ul:"3d",Me:"ambisonic"};
function M(a,b,d,g){this.i=a;this.ga=b;this.j=d;this.pa=this.C=1;this.ea=!1;this.J=!0;this.$=!1;this.A=this.za=this.G=this.K=this.o=0;this.u=this.N=!1;this.Aa=0;this.B=!1;this.H=this.Ca=this.f=this.m=this.ia=this.c=this.I=null;this.Da=this.qa=this.Ba=0;this.la=null;this.ka=g||!1;this.Fa=[0,1,2,3];this.fa=this.ya=!1;this.sa=this.ra=null;this.wa=!1;this.V=this.W=this.S=this.na=this.F=this.va=this.ma=this.ba=this.U=this.R=this.P=this.M=this.xa=null;l.call(this,"Sound");!0===this.ka&&!1===Oc(this)&&(this.log("$_Sound: can't manage ambisonic sound without Google Chrome Omnitone library and WebAudio API."),
this.ka=!1);this.O=this.ga;ba(this);!0===this.i.audio.useWebAudio&&(this.f=this.i.audio.context,this.Ca=this.i.audio.inputNode,this.H="undefined"===typeof this.f.createGain?this.f.createGainNode():this.f.createGain(),this.H.gain.value=this.C*this.i.audio.volume,this.H.connect(this.Ca));if(!0===this.i.audio.useAudioTag||!0===Oc(this))!0===this.i.cache.has(A.nb,this.ga)&&this.Ch(this.i.cache.get(A.nb,this.ga)),this.i.audio.onVolumeChange.add(this.Dh,this);this.i.audio.onDisable.add(this.Bh,this);""!==
this.j&&(this.i.load.sound(this.ga,this.j,this.Ch,this,Oc(this)),this.M&&this.M.D());this.i.audio.add(this)}M.prototype=Object.create(l.prototype);e=M.prototype;e.constructor=M;
e.Ch=function(a){this.I=a;this.fa=!0;this.P&&this.P.D();!0===this.i.audio.useWebAudio?(a=this.I)&&!1===this.wa&&(this.ra=this.ci.bind(this),this.sa=this.Pl.bind(this),!0===Oc(this)?(this.la=Omnitone.createFOADecoder(this.f,a.data,{channelMap:this.Fa}),this.la.initialize().then(this.ra,this.sa)):this.f.decodeAudioData(a.data,this.ra,this.sa)):(Pc(this),this.ci(null))};e.Pl=function(){this.I&&(this.I.data=null,this.wa=!1)};function Pc(a){a.xa&&a.xa.D();a.R&&a.R.D();a.U&&a.U.D()}
e.ci=function(a){if(this.I){a&&(this.I.data=a);this.wa=!0;Pc(this);if(!0===this.i.audio.useAudioTag||!0===Oc(this))this.c=this.i.cache.get(A.nb,this.ga),Qc(this),this.o=0,this.c.data.duration&&(this.o=this.c.data.duration,this.K=Math.ceil(1E3*this.o));!0===this.ya&&this.play(this.A,this.N,!0)}};e.Dh=function(){Qc(this)};function Qc(a){!a.c||!0!==a.i.audio.useAudioTag&&!0!==Oc(a)||(a.c.data.volume=G.Z(a.C,0,1)*a.i.audio.volume)}e.Bh=function(){!0===this.u?this.pause():!1===this.paused&&this.stop()};
function Rc(a){a.A=0;a.ya=!1;a.u=!1;a.B=!1}function Sc(a,b){a.m||(a.m=a.f.createPanner(),a.m.panningModel="HRTF",a.m.distanceModel="inverse",a.m.refDistance=1,a.m.maxDistance=1E4,a.m.rolloffFactor=1,a.m.coneInnerAngle=360,a.m.coneOuterAngle=0,a.m.coneOuterGain=0,a.m.setOrientation(0,0,0),a.m.setPosition(0,0,0));a.m.setPosition(a.Ba,a.qa,a.Da);!0===b&&(a.c.connect(a.m),a.m.connect(a.H))}function Oc(a){return!0===a.ka&&!0===a.i.audio.useWebAudio&&"undefined"!==typeof Omnitone}
e.update=function(){if(!0===this.u&&!1===this.B){var a=this.i.clock.time-this.G;if(a>=this.K){if(this.A=this.K,!0===this.i.audio.useWebAudio||!0===this.i.audio.useAudioTag)this.stop(!0),this.V&&this.V.D(),!0===this.N&&(this.A=0,this.resume())}else this.A=a}this.la&&!0===this.u&&this.la.setRotationMatrixFromCamera(this.i.renderer.camera.modelViewInverse)};
e.play=function(a,b,d){if(!1===this.i.audio.enabled||!1===this.J)this.B=this.u=!1;else{this.N=b||this.N;if(!0===this.u)if(!0===d)this.stop();else return;if(!1===this.fa)this.ya=!0;else if(!0===this.i.audio.useWebAudio&&!1===Oc(this))!0===this.wa?(this.ia||(this.ia=this.I.data),this.c=this.f.createBufferSource(),this.c.buffer=this.ia,!0===this.$?Sc(this,!0):this.c.connect(this.H),this.o=this.c.buffer.duration,this.K=Math.ceil(1E3*this.o),!isNaN(a)&&a<this.K?this.G=this.i.clock.time-a:(a=0,this.G=this.i.clock.time),
b=G.ld(a/1E3),"undefined"===typeof this.c.start?this.c.noteGrainOn(0,b%this.o,this.o):this.c.start(0,b%this.o,this.o),this.u=!0,this.A=a,this.Aa++,this.F&&this.F.D(),this.i.audio.Ef()):(this.log("Sound is not decoded yet"),this.ya=!0);else if(!0===this.i.audio.useAudioTag||!0===Oc(this))this.o?Infinity===this.o&&(this.c.data.loop=!0):(this.o=this.c.data.duration,this.K=Math.ceil(1E3*this.o)),!isNaN(a)&&this.K&&a<this.K?(this.c.data.currentTime=G.ld(a/1E3),this.G=this.i.clock.time-a):(a=0,this.c.data.currentTime=
a,this.G=this.i.clock.time),this.c.data.play(),this.u=!0,this.A=a,this.Aa++,this.F&&this.F.D()}};e.stop=function(a){this.c?(Tc(this,!0),this.G=this.za=this.i.clock.time,this.B=this.u=this.ya=!1,this.na&&!0===a&&this.na.D(),this.i.audio.Ff()):!1!==this.fa&&!0===this.wa||Rc(this)};
function Tc(a,b){if(!0===a.i.audio.useWebAudio&&!1===Oc(a)){if("undefined"===typeof a.c.stop)a.c.noteOff(0);else try{a.c.stop(0)}catch(d){}a.c.disconnect(0);!0===b&&(a.A=0)}else if(!0===a.i.audio.useAudioTag||!0===Oc(a))a.c.data.pause(),!0===b&&(a.A=0,a.c.data.currentTime=0)}e.pause=function(){!0===this.u&&this.c?(Tc(this,!1),this.B=!0,this.za=this.i.clock.time,this.u=this.ya=!1,this.S&&this.S.D(),this.i.audio.Ff()):!1!==this.fa&&!0===this.wa||Rc(this)};
e.resume=function(){if(!1!==this.i.audio.enabled&&!1!==this.J)if(!0===this.B||!1===this.u)if(this.c){this.G=this.i.clock.time-(this.za-this.G);this.A=this.i.clock.time-this.G;var a=G.ld(this.A/1E3);if(!0===this.i.audio.useWebAudio&&!1===Oc(this)){this.c=this.f.createBufferSource();this.c.buffer=this.ia;!0===this.$?Sc(this,!0):this.c.connect(this.H);var b=Math.ceil((this.K-this.A)/1E3);"undefined"===typeof this.c.start?this.c.noteGrainOn(0,a%this.o,b):this.c.start(0,a%this.o,b)}else if(!0===this.i.audio.useAudioTag||
!0===Oc(this))this.c.data.currentTime=G.ld(a/1E3),this.c.data.play();this.u=!0;this.B=!1;this.W&&this.W.D();this.i.audio.Ef()}else this.play(this.A,this.N,!0);else if(!1===this.fa||!1===this.wa)Rc(this),this.ya=!0};e.bb=function(){!0!==this.ea&&!1!==this.i.audio.enabled&&!1!==this.J&&(this.ea=!0,this.pa=this.C,this.C=0,!0===this.i.audio.useWebAudio&&!1===Oc(this)?this.H.gain.value=this.C:!0!==this.i.audio.useAudioTag&&!0!==Oc(this)||!this.c||(this.c.data.volume=this.C),this.ba&&this.ba.D())};
e.Eh=function(){!1!==this.ea&&!1!==this.i.audio.enabled&&!1!==this.J&&(this.ea=!1,this.C=this.pa,!0===this.i.audio.useWebAudio&&!1===Oc(this)?this.H.gain.value=this.pa:!0!==this.i.audio.useAudioTag&&!0!==Oc(this)||!this.c||(this.c.data.volume=this.pa),this.ma&&this.ma.D())};
e.destroy=function(){this.stop();!0!==this.i.audio.useAudioTag&&!0!==Oc(this)||this.i.audio.onVolumeChange.remove(this.Dh,this);this.i.audio.onDisable.remove(this.Bh,this);this.i.audio.remove(this);this.sa=this.ra=this.m=this.H=this.Ca=this.f=this.ia=this.c=this.I=this.i=null;this.xa&&(this.xa.destroy(),this.xa=null);this.M&&(this.M.destroy(),this.M=null);this.P&&(this.P.destroy(),this.P=null);this.R&&(this.R.destroy(),this.R=null);this.U&&(this.U.destroy(),this.U=null);this.ba&&(this.ba.destroy(),
this.ba=null);this.ma&&(this.ma.destroy(),this.ma=null);this.va&&(this.va.destroy(),this.va=null);this.F&&(this.F.destroy(),this.F=null);this.na&&(this.na.destroy(),this.na=null);this.S&&(this.S.destroy(),this.S=null);this.W&&(this.W.destroy(),this.W=null);this.V&&(this.V.destroy(),this.V=null);l.prototype.destroy.call(this)};Object.defineProperty(M.prototype,"enabled",{get:function(){return this.J},set:function(a){"boolean"===typeof a&&(this.J=a,!1!==this.J||!0!==this.u&&!0!==this.B||this.stop())}});
Object.defineProperty(M.prototype,"currentTime",{get:function(){return this.A},set:function(a){"number"===typeof a&&(this.pause(),this.A=a,!0===this.u&&this.resume())}});Object.defineProperty(M.prototype,"spatialized",{get:function(){return this.$},set:function(a){"boolean"===typeof a&&(this.$=a)}});Object.defineProperty(M.prototype,"ambisonic",{get:function(){return this.ka}});Object.defineProperty(M.prototype,"duration",{get:function(){return this.o}});
Object.defineProperty(M.prototype,"muted",{get:function(){return this.ea||this.i.audio.bb},set:function(a){"boolean"===typeof a&&(!0===a?this.bb():this.Eh())}});Object.defineProperty(M.prototype,"volume",{get:function(){return this.C},set:function(a){"number"===typeof a&&!0!==isNaN(a)&&(a=G.Z(a,0,1),a!==this.C&&!1!==this.i.audio.enabled&&!1!==this.J&&(this.C=a,0<this.C&&(this.ea=!1),!0===this.i.audio.useWebAudio&&!1===Oc(this)?this.H.gain.value=a:Qc(this),this.va&&this.va.D()))}});
Object.defineProperty(M.prototype,"decoded",{get:function(){return this.I?this.wa:!1}});Object.defineProperty(M.prototype,"playCount",{get:function(){return this.Aa}});Object.defineProperty(M.prototype,"playing",{get:function(){return this.u}});Object.defineProperty(M.prototype,"ready",{get:function(){return this.fa}});Object.defineProperty(M.prototype,"paused",{get:function(){return this.B}});
Object.defineProperty(M.prototype,"loop",{get:function(){return this.N},set:function(a){"boolean"===typeof a&&(this.N=a,!0!==this.i.audio.useAudioTag&&!0!==Oc(this)||!this.c||Infinity!==this.o||(this.c.data.loop=this.N))}});Object.defineProperty(M.prototype,"x",{get:function(){return this.Ba},set:function(a){"number"===typeof a&&(this.Ba=a,!0===this.i.audio.useWebAudio&&!1===Oc(this)&&this.c&&this.m&&!0===this.$&&Sc(this))}});
Object.defineProperty(M.prototype,"y",{get:function(){return this.qa},set:function(a){"number"===typeof a&&(this.qa=a,!0===this.i.audio.useWebAudio&&!1===Oc(this)&&this.c&&this.m&&!0===this.$&&Sc(this))}});Object.defineProperty(M.prototype,"z",{get:function(){return this.qa},set:function(a){"number"===typeof a&&(this.Da=a,!0===this.i.audio.useWebAudio&&!1===Oc(this)&&this.c&&this.m&&!0===this.$&&Sc(this))}});
Object.defineProperty(M.prototype,"onSoundDecode",{get:function(){this.xa||(this.xa=new p(this));return this.xa}});Object.defineProperty(M.prototype,"onLoadStart",{get:function(){this.M||(this.M=new p(this));return this.M}});Object.defineProperty(M.prototype,"onLoadedData",{get:function(){this.P||(this.P=new p(this));return this.P}});Object.defineProperty(M.prototype,"onCanPlay",{get:function(){this.R||(this.R=new p(this));return this.R}});
Object.defineProperty(M.prototype,"onCanPlayThrough",{get:function(){this.U||(this.U=new p(this));return this.U}});Object.defineProperty(M.prototype,"onMute",{get:function(){this.ba||(this.ba=new p(this));return this.ba}});Object.defineProperty(M.prototype,"onUnmute",{get:function(){this.ma||(this.ma=new p(this));return this.ma}});Object.defineProperty(M.prototype,"onVolumeChange",{get:function(){this.va||(this.va=new p(this));return this.va}});
Object.defineProperty(M.prototype,"onPlay",{get:function(){this.F||(this.F=new p(this));return this.F}});Object.defineProperty(M.prototype,"onStop",{get:function(){this.na||(this.na=new p(this));return this.na}});Object.defineProperty(M.prototype,"onPause",{get:function(){this.S||(this.S=new p(this));return this.S}});Object.defineProperty(M.prototype,"onResume",{get:function(){this.W||(this.W=new p(this));return this.W}});
Object.defineProperty(M.prototype,"onEnded",{get:function(){this.V||(this.V=new p(this));return this.V}});
function Q(a,b){this.i=a;this.j=b;this.K=this.c=null;this.f=this.N="";this.I=this.m=1;this.G=this.J=this.B=!0;this.o=this.F=this.u=this.H=this.A=this.C=null;l.call(this,"Playlist");this.O=this.j.uid;ba(this);this.K=new za(this.i,this.j.name);this.c=[];a=this.j;this.B="undefined"!==typeof a.autoPlay?!!a.autoPlay:!0;this.G="undefined"!==typeof a.loop?!!a.loop:!0;this.m="undefined"!==typeof a.volume&&"number"===typeof a.volume.max?G.Z(a.volume.max,0,1):1;this.I="undefined"!==typeof a.volume&&"number"===
typeof a.volume["default"]?G.Z(a.volume["default"],0,this.m):G.Z(1,0,this.m);a=this.j;"undefined"!==typeof a.tracks&&!0===B.Ga(a.tracks,"string")?this.c=a.tracks:this.warn("A playlist has no track in its configuration, or configuration is not valid!");"string"===typeof a["default"]&&""!==a["default"]?this.N=a["default"]:"number"===typeof a["default"]&&0<=a["default"]&&a["default"]<this.c.length?this.N=this.c[a["default"]].uid:this.warn("A playlist has a default track that is not in its tracks array!");
this.f=this.N;this.C&&this.C.D()}Q.prototype=Object.create(l.prototype);e=Q.prototype;e.constructor=Q;e.Od=function(){0<this.c.length&&this.c.indexOf(this.f)+1===this.c.length&&(!1===this.G||!0===this.track.loop)?this.f=this.c[0]:this.jd()};e.Ok=function(){this.A&&this.A.D()};e.Qk=function(){this.H&&this.H.D()};e.Nk=function(){this.u&&this.u.D()};e.Pk=function(){this.F&&this.F.D()};e.Mk=function(){this.o&&this.o.D()};e.Rk=function(){return!!this.c.length};
e.play=function(a,b){this.J="undefined"!==typeof b?b:!1;var d;if("string"===typeof a&&n.T(a,"PlaylistTrack"))d=a;else if(B.T(a,"PlaylistTrack"))d=a.uid;else if("number"===typeof a&&0<=a&&a<this.c.length)d=this.c[a];else if(""!==this.f)d=this.f;else if("undefined"===typeof a||""===a)d=this.c[0];if("undefined"!==typeof d){this.stop();this.f=d;if(!0===this.J&&!1===this.B)return this.warn("$_Playlist.play(); autoPlay is disabled"),this.track;this.track.play();!1===this.track.onEnded.has(this.Od,this)&&
this.track.onEnded.add(this.Od,this);this.log("$_Playlist.play(); [uid: "+this.f+"]");return this.track}return null};e.stop=function(){null!==this.track&&(this.track.stop(),"undefined"!==typeof this.track.onEnded&&!1===this.track.onEnded.has(this.Od,this)&&this.track.onEnded.remove(this.Od,this))};e.pause=function(){null!==this.track&&this.track.pause()};e.resume=function(){null!==this.track&&this.track.resume()};
e.jd=function(){var a=-1;0<this.c.length&&(a=this.c.indexOf(this.f)+1,a===this.c.length&&(a=0));this.play(a,this.J);!0===this.paused&&this.pause()};e.me=function(){var a=-1;0<this.c.length&&(a=this.c.indexOf(this.f)-1,-1===a&&(a=this.c.length-1));this.play(a,this.J);!0===this.paused&&this.pause()};e.destroy=function(){this.stop();this.i=null;this.K.destroy();this.K=null;0<this.c.length&&(this.c.length=0,this.c=null);this.j=null;l.prototype.destroy.call(this)};
Object.defineProperty(Q.prototype,"tracks",{get:function(){return this.c}});Object.defineProperty(Q.prototype,"name",{get:function(){return this.K.value}});Object.defineProperty(Q.prototype,"ready",{get:function(){return null!==this.track?this.track.ready:!1}});Object.defineProperty(Q.prototype,"decoded",{get:function(){return null!==this.track?this.track.decoded:!1}});Object.defineProperty(Q.prototype,"playing",{get:function(){return null!==this.track?this.track.playing:!1}});
Object.defineProperty(Q.prototype,"paused",{get:function(){return null!==this.track?this.track.paused:!1}});Object.defineProperty(Q.prototype,"track",{get:function(){return!0===n.T(this.f,"PlaylistTrack")?n.get(this.f,"PlaylistTrack"):null}});Object.defineProperty(Q.prototype,"loop",{get:function(){return this.G},set:function(a){this.G=!!a}});Object.defineProperty(Q.prototype,"autoPlay",{get:function(){return this.B},set:function(a){this.B=!!a}});
Object.defineProperty(Q.prototype,"volume",{get:function(){return this.I},set:function(a){"number"===typeof a&&(a=G.Z(a,0,1),this.I=this.m<a?this.m:a,!0===n.T(this.f,"PlaylistTrack")&&(a=n.get(this.f,"PlaylistTrack"),null!==a&&(a.volume=this.I*this.i.playlists.volume)))}});Object.defineProperty(Q.prototype,"onPlay",{get:function(){this.A||(this.A=new p(this));return this.A}});Object.defineProperty(Q.prototype,"onStop",{get:function(){this.H||(this.H=new p(this));return this.H}});
Object.defineProperty(Q.prototype,"onPause",{get:function(){this.u||(this.u=new p(this));return this.u}});Object.defineProperty(Q.prototype,"onResume",{get:function(){this.F||(this.F=new p(this));return this.F}});Object.defineProperty(Q.prototype,"onEnded",{get:function(){this.o||(this.o=new p(this));return this.o}});Object.defineProperty(Q.prototype,"onReady",{get:function(){this.C||(this.C=new p(this));return this.C}});
function z(a){this.i=a;this.u=this.c=this.K=null;this.f=this.j="";this.I=this.A=1;this.m=!0;this.o=this.N=!1;this.C=this.B=this.F=this.G=this.H=this.J=null;l.call(this,"PlaylistManager")}z.prototype=Object.create(l.prototype);e=z.prototype;e.constructor=z;e.boot=function(){this.c=[];this.u=[];this.i.audio.onEnable.add(this.fi,this);this.i.story.onSceneLoadStart.add(this.gh,this)};
e.fi=function(){!0===this.m&&0<this.c.length&&!0===this.ready&&!0===this.decoded&&!1===this.o&&(!0===this.paused?this.resume():!1===this.playing&&this.play())};
e.gh=function(){if("undefined"!==typeof this.i.story.scene.config.playlists){var a=B.ab(this.K,this.i.story.scene.config.playlists);Uc(this,a);!1===this.o&&(!1===this.m?Vc(this):Wc(this,this.f)||!0===this.playing&&Vc(this))}else Uc(this,this.K),!1===this.o&&this.f!==this.j&&(!1!==this.m&&!1!==this.ready&&!1!==this.decoded&&!0!==this.playing||Vc(this),Wc(this,this.f))};
function Uc(a,b){b&&(a.m="undefined"!==typeof b.enabled?!!b.enabled:!0,"undefined"!==typeof b["default"]&&("string"===typeof b["default"]&&""!==b["default"]?a.f=b["default"]:"number"===typeof b["default"]&&0<=b["default"]&&b["default"]<a.c.length&&(a.f=a.c[b["default"]].uid)),a.A="undefined"!==typeof b.volume&&"number"===typeof b.volume.max?G.Z(b.volume.max,0,1):1,a.I="undefined"!==typeof b.volume&&"number"===typeof b.volume["default"]?G.Z(b.volume["default"],0,a.A):G.Z(1,0,a.A))}
e.ha=function(a){var b;this.K=a;if("undefined"!==typeof a.lists)for(var d=0,g=a.lists.length;d<g;d++)b=new Q(this.i,a.lists[d]),this.add(b);if("undefined"!==typeof a.tracks)for(d=0,g=a.tracks.length;d<g;d++)b=new Xc(this.i,a.tracks[d]),this.hh(b),!0===this.N&&this.warn("Preload is not supported yet.");Uc(this,a);"undefined"!==typeof a.lists&&0<a.lists.length&&(""===this.f&&this.warn("The playlist manager has a default playlist that is not in its playlists array!"),this.j=this.f);if(!(0>=this.c.length)){var h;
"string"===typeof this.f&&""!==this.f?h=this.f:h=this.c[0].uid;void 0===n.get(h)&&this.warn('PlaylistManager : uid "'+h+'" is not into playlists');!0===n.T(h,"Playlist")?this.play(h,!0):this.warn("Impossible to play the playlist with uid "+h+", it doesn't seem to be a playlist!")}};
function Wc(a,b){return null!==b&&!0===n.T(b,"Playlist")?(null!==a.playlist&&a.playlist.uid===b?null!==a.playlist.track&&"undefined"!==typeof a.playlist.track.uid&&""!==a.playlist.track.uid?!0===a.paused?a.resume():!1===a.playing&&a.play(b,!0):(a.stop(),a.play(b,!0)):(a.stop(),a.play(b,!0)),!0):!1}function Vc(a){!0===a.playing?a.pause():a.stop()}e.Ik=function(){this.H&&this.H.D();null!==this.playlist&&Q.prototype.Ok.call(this.playlist)};e.Kk=function(){this.G&&this.G.D();null!==this.playlist&&Q.prototype.Qk.call(this.playlist)};
e.Hk=function(){this.F&&this.F.D();null!==this.playlist&&Q.prototype.Nk.call(this.playlist)};e.Jk=function(){this.B&&this.B.D();null!==this.playlist&&Q.prototype.Pk.call(this.playlist)};e.Gk=function(){this.C&&this.C.D();null!==this.playlist&&Q.prototype.Mk.call(this.playlist)};e.add=function(a){this.c.push(a)};e.hh=function(a){this.u.push(a)};e.tn=function(){return!!this.c.length};e.Lk=function(){return!!this.u.length};
e.play=function(a,b){var d;if("string"===typeof a&&n.T(a,"Playlist"))d=a;else if(B.T(a,"Playlist"))d=a.uid;else if("number"===typeof a&&0<=a&&a<this.c.length)d=this.c[a].uid;else if(""!==this.j)d=this.j;else if("undefined"===typeof a||""===a)d=this.c[0].uid;"undefined"!==typeof d&&(!0===this.playing&&this.stop(),this.j=d,!0===this.m&&(this.o=!1,this.playlist.play(null,b),this.log("$_PlaylistManager.play(); [uid: "+this.j+"]")))};e.stop=function(){null!==this.playlist&&this.playlist.stop()};
e.pause=function(){null!==this.playlist&&!0===this.playlist.playing&&(this.o=!0,this.playlist.pause())};e.resume=function(){if(null!==this.playlist&&!0===this.m&&!0===this.playlist.paused){var a=this.o;this.o=!1;!0===a&&this.f!==this.j?Wc(this,this.f):this.playlist.resume()}};e.jd=function(){null!==this.playlist&&!0===this.m&&this.playlist.jd()};e.me=function(){null!==this.playlist&&!0===this.m&&this.playlist.me()};
e.destroy=function(){this.stop();this.i.audio.onEnable.remove(this.fi,this);this.i.story.onSceneLoadStart.remove(this.gh,this);this.K=this.i=null;for(var a=this.c.length;a--;)this.c[a].destroy();this.c=null;for(a=this.u.length;a--;)this.u[a].destroy();this.u=null;l.prototype.destroy.call(this)};Object.defineProperty(z.prototype,"playlists",{get:function(){return this.c}});Object.defineProperty(z.prototype,"tracks",{get:function(){return this.u}});
Object.defineProperty(z.prototype,"playlist",{get:function(){return!0===n.T(this.j,"Playlist")?n.get(this.j,"Playlist"):null}});Object.defineProperty(z.prototype,"loop",{get:function(){return null!==this.playlist?this.playlist.loop:!0}});Object.defineProperty(z.prototype,"autoPlay",{get:function(){return null!==this.playlist?this.playlist.autoPlay:!0}});Object.defineProperty(z.prototype,"preload",{get:function(){return this.N},set:function(a){this.N=!!a}});
Object.defineProperty(z.prototype,"enabled",{get:function(){return this.m}});Object.defineProperty(z.prototype,"ready",{get:function(){return null!==this.playlist?this.playlist.ready:!1}});Object.defineProperty(z.prototype,"decoded",{get:function(){return null!==this.playlist?this.playlist.decoded:!1}});Object.defineProperty(z.prototype,"playing",{get:function(){return null!==this.playlist?this.playlist.playing:!1}});
Object.defineProperty(z.prototype,"paused",{get:function(){return null!==this.playlist?this.playlist.paused:!1}});Object.defineProperty(z.prototype,"volume",{get:function(){return this.I},set:function(a){if("number"===typeof a&&(a=G.Z(a,0,1),this.I=this.A<a?this.A:a,!0===n.T(this.j,"Playlist")&&(a=n.get(this.j,"Playlist"),null!==a))){var b=a.track;null!==b&&(b.volume=a.volume*this.I)}}});Object.defineProperty(z.prototype,"onReady",{get:function(){this.J||(this.J=new p(this));return this.J}});
Object.defineProperty(z.prototype,"onPlay",{get:function(){this.H||(this.H=new p(this));return this.H}});Object.defineProperty(z.prototype,"onStop",{get:function(){this.G||(this.G=new p(this));return this.G}});Object.defineProperty(z.prototype,"onPause",{get:function(){this.F||(this.F=new p(this));return this.F}});Object.defineProperty(z.prototype,"onResume",{get:function(){this.B||(this.B=new p(this));return this.B}});
Object.defineProperty(z.prototype,"onEnded",{get:function(){this.C||(this.C=new p(this));return this.C}});function Xc(a,b){this.i=a;this.u=b;this.o=this.m=null;this.j="";this.f=!1;this.c=null;l.call(this,"PlaylistTrack");this.O=this.u.uid;ba(this);a=this.u;da(this);this.O=a.uid;ba(this);this.m=new za(this.i,a.name);this.o=new za(this.i,a.author);this.j=a.url;this.f=a.loop||!1}Xc.prototype=Object.create(l.prototype);e=Xc.prototype;e.constructor=Xc;e.kh=function(){z.prototype.Ik.call(this.i.playlists)};
e.pi=function(){z.prototype.Kk.call(this.i.playlists)};e.jh=function(){z.prototype.Hk.call(this.i.playlists)};e.oi=function(){z.prototype.Jk.call(this.i.playlists)};e.ih=function(){z.prototype.Gk.call(this.i.playlists)};
e.play=function(){this.c||(this.c=new M(this.i,this.O+"-sound",this.j),this.c.volume=this.i.playlists.volume*this.i.playlists.playlist.volume,!0===this.f&&(this.c.loop=this.f),this.c.onPlay.add(this.kh,this),this.c.onStop.add(this.pi,this),this.c.onPause.add(this.jh,this),this.c.onResume.add(this.oi,this),this.c.onEnded.add(this.ih,this));this.c.play()};e.stop=function(){this.c&&this.c.stop(!0)};e.pause=function(){this.c&&this.c.pause()};e.resume=function(){this.c&&this.c.resume()};
e.destroy=function(){this.u=this.i=null;this.m.destroy();this.m=null;this.o.destroy();this.o=null;this.c&&(this.c.onPlay.remove(this.kh,this),this.c.onStop.remove(this.pi,this),this.c.onPause.remove(this.jh,this),this.c.onResume.remove(this.oi,this),this.c.onEnded.remove(this.ih,this),this.c.destroy(),this.c=null);l.prototype.destroy.call(this)};Object.defineProperty(Xc.prototype,"name",{get:function(){return this.m.value}});Object.defineProperty(Xc.prototype,"author",{get:function(){return this.o.value}});
Object.defineProperty(Xc.prototype,"currentTime",{get:function(){return this.c?this.c.currentTime:0},set:function(a){this.c&&(this.c.currentTime=a)}});Object.defineProperty(Xc.prototype,"volume",{get:function(){return this.c?this.c.volume:!1},set:function(a){if(!this.c)return!1;this.c.volume=a}});Object.defineProperty(Xc.prototype,"ready",{get:function(){return this.c?this.c.ready:!1}});Object.defineProperty(Xc.prototype,"decoded",{get:function(){return this.c?this.c.decoded:!1}});
Object.defineProperty(Xc.prototype,"playing",{get:function(){return this.c?this.c.playing:!1}});Object.defineProperty(Xc.prototype,"paused",{get:function(){return this.c?this.c.paused:!1}});Object.defineProperty(Xc.prototype,"loop",{get:function(){return this.f},set:function(a){this.f=!!a}});Object.defineProperty(Xc.prototype,"onPlay",{get:function(){if(this.c)return this.c.onPlay}});Object.defineProperty(Xc.prototype,"onStop",{get:function(){if(this.c)return this.c.onStop}});
Object.defineProperty(Xc.prototype,"onPause",{get:function(){if(this.c)return this.c.onPause}});Object.defineProperty(Xc.prototype,"onResume",{get:function(){if(this.c)return this.c.onResume}});Object.defineProperty(Xc.prototype,"onEnded",{get:function(){if(this.c)return this.c.onEnded}});function sa(a){this.i=a;this.j=this.c=null;this.M=this.V=this.P=!1;this.J=-1;this.K=this.o=null;l.call(this,"Director");this.te()}sa.prototype=Object.create(l.prototype);e=sa.prototype;e.constructor=sa;
e.te=function(){this.o=this.i.clock.create(!1);this.i.story.onSceneLoadComplete.add(this.Ci,this);this.i.onReady.add(this.Qg,this)};e.load=function(a){if(null!==a.tracks&&Array.isArray(a.tracks))for(var b=0,d=a.tracks.length;b<d;b++)new tc(a.tracks[b])};e.Qg=function(){this.i.controllers.onControlStart.add(this.Vc,this);this.i.controllers.onControlEnd.add(this.Uc,this)};
e.Ci=function(){var a=this.i.story.scene;this.stop();Yc(this);this.c=null;this.j=[];"undefined"!==typeof a.config.director&&(a=a.config.director.animation,"undefined"!==typeof a&&null!==a&&!1!==a.enabled&&(this.P="boolean"===typeof a.loop?a.loop:!1,this.V="boolean"===typeof a.random?a.random:!1,this.M="boolean"===typeof a.stoppable?a.stoppable:!1,this.J="number"===typeof a.idleTime?a.idleTime:0,null!==a.tracks&&B.Ga(a.tracks,"string")&&(this.j=!0===this.V?B.kd(a.tracks):a.tracks),this.i.renderer.camera.animation.onComplete.add(this.ri,
this),"undefined"!==typeof this.i.story.scene.config.media&&this.i.story.scene.config.media.type===Ja.VIDEO&&(this.i.renderer.media.displayObject.onPause.add(this.Nd,this),this.i.renderer.media.displayObject.onWaiting.add(this.Vb,this),this.i.renderer.media.displayObject.onStalled.add(this.Vb,this),this.i.renderer.media.displayObject.onEnded.add(this.gi,this),this.i.renderer.media.displayObject.onCurrentTimeChange.add(this.Gi,this),document.addEventListener(N.yg,null)),"number"===typeof a.delay&&
(this.K=this.o.add(a.delay,this.wf,this),this.o.start())))};e.Nd=function(){this.stop();this.i.renderer.media.displayObject.onPause.remove(this.Nd,this);this.i.renderer.media.displayObject.onPlay.add(this.yf,this);this.i.controllers.onControlStart.remove(this.Vc,this);this.i.controllers.onControlEnd.remove(this.Uc,this)};
e.yf=function(){null!==this.c&&this.play(this.c);this.i.renderer.media.displayObject.onPause.add(this.Nd,this);this.i.renderer.media.displayObject.onPlay.remove(this.yf,this);this.i.controllers.onControlStart.add(this.Vc,this);this.i.controllers.onControlEnd.add(this.Uc,this)};
e.Vb=function(){this.stop();this.i.renderer.media.displayObject.onWaiting.remove(this.Vb,this);this.i.renderer.media.displayObject.onStalled.remove(this.Vb,this);this.i.renderer.media.displayObject.onPlaying.add(this.zf,this);this.i.controllers.onControlStart.remove(this.Vc,this);this.i.controllers.onControlEnd.remove(this.Uc,this)};
e.zf=function(){null!==this.c&&this.play(this.c);this.i.renderer.media.displayObject.onPlaying.remove(this.zf,this);this.i.renderer.media.displayObject.onWaiting.add(this.Vb,this);this.i.renderer.media.displayObject.onStalled.add(this.Vb,this);this.i.controllers.onControlStart.add(this.Vc,this);this.i.controllers.onControlEnd.add(this.Uc,this)};e.gi=function(){!0===this.i.renderer.media.displayObject.loop&&this.Ci()};e.Vc=function(){null!==this.c&&!0===this.M&&this.stop();this.o.stop(!0)};
e.Uc=function(){this.K&&this.o.remove(this.K);null!==this.c&&!0===this.M&&(null===this.c&&"number"===typeof this.i.story.scene.config.director.animation.delay?(this.K=this.o.add(this.i.story.scene.config.director.animation.delay,this.wf,this),this.o.start()):"number"===typeof this.J&&-1<this.J&&(this.K=this.o.add(this.J,this.wf,this),this.o.start()))};
e.ri=function(){if(1<this.j.length){var a=this.j.indexOf(this.c)+1;if(a<this.j.length){this.play(a);return}}!0===this.P&&(!0===this.V&&(this.j=B.kd(this.j)),this.play(0))};e.wf=function(){this.play(this.c);this.o.stop(!0)};
e.Gi=function(a){this.stop();this.c=null;"number"===typeof a?a*=1E3:"number"===typeof a.data?a=1E3*a.data:a=this.i.renderer.media.displayObject.currentTimeMS;var b=0,d,g;g=n.get(this.j[0]);if(g.duration>a)this.c=g.uid;else for(var h=1,k=this.j.length-1;h<k;h++){d=g;g=n.get(this.j[h]);if(d.duration+b<a&&g.duration+d.duration+b>a){this.c=g.uid;break}b+=d.duration}null===this.c?(a=g.keyframes[g.keyframes.length-1].data,this.i.renderer.camera.Qj(a.yaw,a.pitch,a.roll,a.fov)):this.i.renderer.camera.animation.play(this.c)};
e.play=function(a){this.stop();this.c=null;this.c="number"===typeof a?this.j[a]:"string"===typeof a?a:this.j[0];this.i.renderer.camera.animation.play(this.c)};e.stop=function(){this.i.renderer.camera.animation.stop()};
function Yc(a){a.i.renderer.camera.animation.onComplete.remove(a.ri,a);"undefined"!==typeof a.i.story.scene.config.media&&a.i.story.scene.config.media.type===Ja.VIDEO&&(a.i.renderer.media.displayObject.onPlay.remove(a.yf,a),a.i.renderer.media.displayObject.onPause.remove(a.Nd,a),a.i.renderer.media.displayObject.onWaiting.remove(a.Vb,a),a.i.renderer.media.displayObject.onStalled.remove(a.Vb,a),a.i.renderer.media.displayObject.onPlaying.remove(a.zf,a),a.i.renderer.media.displayObject.onEnded.remove(a.gi,
a),a.i.renderer.media.displayObject.onCurrentTimeChange.remove(a.Gi,a))}e.destroy=function(){Yc(this);this.i.onReady.remove(this.Qg,this);this.c=this.j=this.i=null;l.prototype.destroy.call(this)};function tc(a){this.F=this.o=!1;Ib.call(this,"DirectorTrack");this.j(a)}tc.prototype=Object.create(Ib.prototype);tc.prototype.constructor=tc;tc.prototype.j=function(a){this.o=a.smooth;this.F=a.cancelRoll;Ib.prototype.j.call(this,a)};Object.defineProperty(tc.prototype,"smooth",{get:function(){return this.o}});
Object.defineProperty(tc.prototype,"cancelRoll",{get:function(){return this.F}});function bc(a){this.i=a;this.f=[];l.call(this,"ActionEventDispatcher")}bc.prototype=Object.create(l.prototype);bc.prototype.constructor=bc;bc.prototype.c=function(a){if(!0===B.Ga(a,"string")||B.T(a,"string"))this.f=this.f.concat(a)};bc.prototype.D=function(){for(var a=0,b=this.f.length;a<b;a++){var d=this.i.actions.get(this.f[a]);"undefined"!==typeof d&&null!==d&&d.yb()}};bc.prototype.destroy=function(){this.i=null;l.prototype.destroy.call(this)};
function Zc(a,b){this.i=a;this.j=b;this.oa="";this.c=this.f=null;l.call(this,"Action");a=this.j;this.O=a.uid;this.oa=a.target;this.f="undefined"!==typeof a.method?a.method:null;this.c="undefined"!==typeof a.property?a.property:null;ba(this)}Zc.prototype=Object.create(l.prototype);Zc.prototype.constructor=Zc;var $c={mf:"set",Lh:"add",Yh:"substract",Th:"multiply",Oh:"divide",Zh:"toggle"};
function ad(a,b){var d=null;if("undefined"===typeof b)d=window;else{var g=b,h=b;"object"===typeof b&&("string"===typeof b.identifier&&(g=b.identifier),"string"===typeof b.accessor&&(h=b.accessor));b=n.get(g);"undefined"!==typeof b&&null!==b&&(B.T(b,"Plugin")?d=b.instance:d=b);h=h.split(".");b=0;"viewer"===h[0].toLowerCase()&&(d=a.i,b=1);for(g=h.length;b<g;b++)"object"===typeof d[h[b]]&&(d=d[h[b]])}null===d&&a.warn("The target of the action "+a.O+" is invalid.");return d}
Zc.prototype.yb=function(){var a=ad(this,this.oa);if(null!==a){if(this.c){var b=this.c;if("undefined"!==typeof a[b.name])switch("undefined"===typeof b.operation&&(b.operation=$c.mf),b.operation){case $c.mf:a[b.name]=b.value;break;case $c.Lh:a[b.name]+=b.value;break;case $c.Yh:a[b.name]-=b.value;break;case $c.Th:a[b.name]*=b.value;break;case $c.Oh:a[b.name]/=b.value;break;case $c.Zh:a[b.name]=!a[b.name]}}if(this.f&&(b=this.f,"function"===typeof a[b.name])){var d="undefined"!==typeof b.args?b.args:
null;Array.isArray(d)||(d=[d]);a[b.name].apply(a,d)}}};Zc.prototype.destroy=function(){this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(Zc.prototype,"target",{get:function(){return ad(this,this.oa)}});Object.defineProperty(Zc.prototype,"count",{get:function(){return 0}});function ra(a){this.i=a;this.c=[];l.call(this,"ActionManager")}ra.prototype=Object.create(l.prototype);ra.prototype.constructor=ra;ra.prototype.get=function(a){return n.get(a,"Action")};
ra.prototype.ha=function(a){var b;if(!0===Array.isArray(a))for(var d=0,g=a.length;d<g;d++)b=new Zc(this.i,a[d]),this.c.push(b);else b=new Zc(this.i,a),this.c.push(b)};ra.prototype.destroy=function(){if(B.Ga(this.c,"Action"))for(;0<this.c.length;)this.c.pop().destroy()};
function R(a,b,d,g){this.i=a;this.F=b;this.H=d;this.A=this.K=null;this.V=g;this.c=this.j=this.I=this.J=null;this.R=!1;this.B=this.G=this.C=this.f=this.m=null;this.N=this.U=!0;this.u=this.o=null;l.call(this,"Plugin");this.O=this.H.uid;this.Ya=this.H.tags;ba(this);this.B={}}R.prototype=Object.create(l.prototype);e=R.prototype;e.constructor=R;
function bd(a){a.A=B.ab(a.F.defaultConfig,a.H,a.K);a.J=a.A.options;a.hb=a.A.data;a.I=a.A.actions;for(var b in a.j)a.j[b].destroy(),a.j[b]=null;b=a.A.events;a.j={};var d,g;for(g in b)d=new bc(a.i),d.c(b[g]),a.j[g]=d}e.Jj=function(){!0===this.F.loaded?cd(this):this.F.onLoadComplete.ca(this.Tl,this)};e.Tl=function(){cd(this)};
function cd(a){a.log("Plugin._instantiatePlugin(); "+a.O);var b=a.H;"string"===typeof b.parent&&(a.m=b.parent);a.U="boolean"===typeof b.keep?b.keep:!0;a.N="boolean"===typeof b.reset?b.reset:!0;a.G||!0!==B.Ga(b.scenes,"string")||(a.G=b.scenes);bd(a);a.c=a.F.qj(a);a.c.boot.call(a.c);a.o&&a.o.D()}e.Gn=function(){this.R=!0;this.u&&this.u.D()};e.update=function(){this.c&&"function"===typeof this.c.update&&this.c.update.call(this.c)};
e.$j=function(){bd(this);this.c&&("function"===typeof this.c.reset?this.c.reset.call(this.c):this.warn("There is no reset function on plugin "+this.F.uid))};
e.destroy=function(){if(!1!==this.ib){this.c&&(this.c.viewer=null,this.c.plugin=null,this.c.destroy(),this.c=null);this.C&&(this.C.destroy(),this.C=null);this.f&&(this.f.destroy(),this.f=null);this.o&&(this.o.destroy(),this.o=null);this.u&&(this.u.destroy(),this.u=null);for(var a=this.j.length;a--;)this.j[a].destroy();this.B=this.i=this.j=null;l.prototype.destroy.call(this)}};Object.defineProperty(R.prototype,"fullUrl",{get:function(){return this.F.fullUrl}});
Object.defineProperty(R.prototype,"options",{get:function(){return this.J}});Object.defineProperty(R.prototype,"actions",{get:function(){return this.I}});Object.defineProperty(R.prototype,"events",{get:function(){return this.j}});Object.defineProperty(R.prototype,"scenes",{get:function(){return this.G}});Object.defineProperty(R.prototype,"persistentData",{get:function(){return this.B},set:function(a){this.B=a}});Object.defineProperty(R.prototype,"instance",{get:function(){return this.c}});
Object.defineProperty(R.prototype,"instanceReady",{get:function(){return this.R}});Object.defineProperty(R.prototype,"container",{get:function(){if(!this.f){if("string"===typeof this.m&&""!==this.m){this.m=document.getElementById(this.m);if("undefined"===typeof this.m||!this.m||!1===ha.Zf(this.m))throw"$_Plugin.boot : Plugin parent is invalid";this.f=new t(this.i,null,null,this.m)}else this.f=new t(this.i),this.i.pluginContainer.Wb(this.f),this.f.Ab(!0);this.f.id=this.O;this.f.index=this.V}return this.f}});
Object.defineProperty(R.prototype,"create",{get:function(){this.C||(this.C=new S(this.i,this));return this.C}});Object.defineProperty(R.prototype,"keep",{get:function(){return this.U}});Object.defineProperty(R.prototype,"reset",{get:function(){return this.N}});Object.defineProperty(R.prototype,"contextualConfig",{get:function(){return this.K},set:function(a){this.K=a}});Object.defineProperty(R.prototype,"instanceConfig",{get:function(){return this.H}});Object.defineProperty(R.prototype,"config",{get:function(){return this.A}});
Object.defineProperty(R.prototype,"onInstanceCreate",{get:function(){this.o||(this.o=new p(this,!0));return this.o}});Object.defineProperty(R.prototype,"onInstanceReady",{get:function(){this.u||(this.u=new p(this,!0));return this.u}});function dd(a){l.call(this,"PluginEngine");this.i=a;this.C=null;this.o=this.N=this.j=this.J="";this.K=null;this.u="";this.A=null;this.G="";this.m=this.F=this.B=this.H=this.f=null;this.R=0;this.I=!1;this.c=null}dd.prototype=Object.create(l.prototype);
dd.prototype.constructor=dd;var ed=["boot","destroy"],fd=["viewer","plugin"];e=dd.prototype;
e.load=function(a){if("undefined"!==typeof a){a=this.C=a;if("undefined"===typeof a.uid)throw"Can't load a plugin engine, missing id in config";this.O=a.uid;ba(this);this.J="string"===typeof a.prefix?a.prefix:this.i.plugins.prefix;if("undefined"===typeof a.url)throw"Can't load a plugin engine, missing url in config";this.j=a.url;this.o=this.J+this.j;this.N="string"===typeof a.manifest?a.manifest:"manifest.json";this.i.load.json(this.O,this.o+this.N,this.dm,this);return!0}return!1};
e.qj=function(a){for(var b=new this.f,d=0,g=fd.length;d<g;d++)if("undefined"!==typeof b[fd[d]])throw"$_PluginEngine instance validation failed, "+fd[d]+" is reserved";if(this.m)for(d=0,g=this.m.length;d<g;d++)if("function"!==typeof b[this.m[d]])throw"$_PluginEngine instance validation failed, action "+this.m[d]+" is undefined on plugin "+this.G;b.i=this.i;b.Ub=a;return b};
e.dm=function(a){a=this.K=this.i.cache.get(A.JSON,a.key).data;if(this.O!==a.uid)throw"Plugin Engine UID doesn't match with manifest UID";var b=a.viewer,d="0.0.0",g="9.9.9";"undefined"!==typeof b&&("undefined"!==typeof b.min&&(d=b.min),"undefined"!==typeof b.max&&(g=b.max));for(var b=["0","3","0"],d=d.split("."),g=g.split("."),h=0,k=0,q=0,v=Math.max(b.length,d.length,g.length)-1;0<=v;v--)"undefined"!==typeof b[v]&&(h=parseInt(b[v],10)),"undefined"!==typeof d[v]&&(k=parseInt(d[v],10)),"undefined"!==
typeof g[v]&&(q=parseInt(g[v],10));if(!1===(h<k||h>q?!1:!0))this.warn("Version compatibility check for plugin "+a.uid+" failed!"),this.warn(a.viewer);else{var x;a:{b=a.device;if("undefined"!==typeof b)for(x in b)if("undefined"===typeof N[x])this.warn("Unable to check plugin device compatibility for: "+x);else if(N[x]!==b[x]){x=!1;break a}x=!0}if(!1===x)this.warn("Device compatibility check for plugin "+a.uid+" failed!"),this.warn(a.device);else{"undefined"!==typeof a.options&&(this.B=a.options);"undefined"!==
typeof a.data&&(this.hb=a.data);"undefined"!==typeof a.actions&&(this.m=a.actions);"undefined"!==typeof a.events&&(this.F=a.events);this.u=a.name;this.A=a.sources;this.G=a.constructor;x=null;if("undefined"!==typeof a.i18n&&(x=a.i18n,"undefined"!==typeof x.locales))for(b=0,d=x.locales.length;b<d;b++)if(a=x.locales[b],"undefined"!==typeof a.files)for(h=0,k=a.files.length;h<k;h++)g=a.files[h],g.key=this.O+"-"+g.key,g.url=this.o+g.url;this.H=x;a=this.A;x=0;for(b=a.length;x<b;x++)d="http://"===String(a[x]).substring(0,
7)||"https://"===String(a[x]).substring(0,8)?a[x]:this.o+a[x],"css"===Da(d).extension?this.i.load.Yi(d,this.ki,this):this.i.load.rg(d,this.ki,this)}}this.log("$_Plugin._manifestLoadComplete();")};
e.ki=function(){this.R++;if(this.R===this.A.length){var a;a:{a=this.G;if("string"===typeof a&&""!==a){a=a.split(".");for(var b=window,d=0,g=a.length;d<g;d++){if(d===a.length-1&&"function"===typeof b[a[d]]){a=b[a[d]];break a}if("object"===typeof b[a[d]])b=b[a[d]];else break}}a=null}this.f=a;!0===gd(this)&&((a=this.H)&&this.i.i18n.ha(a),this.I=!0,this.c&&this.c.D())}};
function gd(a){if(!a.f||"function"!==typeof a.f)throw"Plugin engine "+a.O+" can't find it's constructor";for(var b=0,d=ed.length;b<d;b++)if("function"!==typeof a.f.prototype[ed[b]])throw"$_PluginEngine engine validation failed, missing required method "+ed[b]+" on plugin engine "+a.u;Object.defineProperty(a.f.prototype,"viewer",{get:function(){return this.i}});Object.defineProperty(a.f.prototype,"plugin",{get:function(){return this.Ub}});return!0}
e.destroy=function(){this.H=this.f=this.A=this.u=this.K=this.C=this.i=null;this.c&&(this.c.destroy(),this.c=null);l.prototype.destroy.call(this)};Object.defineProperty(dd.prototype,"name",{get:function(){return this.u}});Object.defineProperty(dd.prototype,"loaded",{get:function(){return this.I}});Object.defineProperty(dd.prototype,"url",{get:function(){return this.j}});Object.defineProperty(dd.prototype,"fullUrl",{get:function(){return this.o}});Object.defineProperty(dd.prototype,"options",{get:function(){return this.B}});
Object.defineProperty(dd.prototype,"actions",{get:function(){return this.m}});Object.defineProperty(dd.prototype,"events",{get:function(){return this.F}});Object.defineProperty(dd.prototype,"defaultConfig",{get:function(){return{data:this.hb,options:this.B,actions:this.m,events:this.F}}});Object.defineProperty(dd.prototype,"onLoadComplete",{get:function(){this.c||(this.c=new p(this));return this.c}});
function pa(a){l.call(this,"PluginManager");this.i=a;this.m=!0;this.u="";this.f=this.c=this.j=null}pa.prototype=Object.create(l.prototype);e=pa.prototype;e.constructor=pa;
e.Sk=function(a){a=a.data.uid;for(var b,d=this.c.size;d--;)b=this.c.get(d),(!1===b.keep||null!==b.scenes&&-1===b.scenes.indexOf(a))&&this.remove(b.uid);!0===this.m&&"undefined"!==typeof this.o&&(a=this.o,hd(this,a.engines),id(this,a.instances),jd(this,a.configurations));!0===this.m&&"undefined"!==typeof this.i.story.scene.config.plugins&&(a=this.i.story.scene.config.plugins,hd(this,a.engines),id(this,a.instances),jd(this,a.configurations));for(b=this.c.size;b--;)a=this.c.get(b),!0===a.reset&&a.$j()};
function hd(a,b){if("undefined"!==typeof b)for(var d=0,g=b.length;d<g;d++){var h=b[d];if("string"===typeof h.uid&&!1===n.Wa(h.uid)){var k=new dd(a.i);a.j.add(k);k.load(h)}}}
function id(a,b){if("undefined"!==typeof b)for(var d=0,g=b.length;d<g;d++){var h=!1!==b[d].enabled?!0:!1,k=a.Td(b[d].uid),q=a.i.story.sceneUid,v=B.Ga(b[d].scenes,"string")?b[d].scenes:[],q=0===v.length||""===q&&0===v.length||-1!==v.indexOf(q);if(!0===h&&!k&&!0===q){h=a;k=b[d];if("undefined"===typeof k.engine)throw"Can't create plugin instance, engineUid is undefined";a:{for(var v=h,x=k.engine,E=0,zb=v.j.size;E<zb;E++)if(q=v.j.get(E),q.uid===x)break a;q=null}if(!q)throw"Plugin Engine "+k.engine+" doesn't exist";
k=new R(h.i,q,k,"number"===typeof k.index?k.index:h.c.size);k.onInstanceCreate.ca(h.mm,h);h.c.add(k);k.Jj()}}}function jd(a,b){if("undefined"!==typeof b)for(var d=0,g=b.length;d<g;d++){var h=!1!==b[d].enabled?!0:!1,k=a.Td(b[d].instance),q=null;!0===h&&(q=b[d]);k&&(k.contextualConfig=q)}}e.mm=function(a){a=a.emitter;this.f&&this.f.D(a)};e.boot=function(){this.j=new kd;this.c=new kd;this.i.story.onSceneLoadStart.add(this.Sk,this)};
e.ha=function(a){this.o=a;this.m="boolean"===typeof a.enabled?a.enabled:!0;this.u="string"===typeof a.prefix?a.prefix:"./plugins/"};e.Td=function(a){for(var b,d=0,g=this.c.size;d<g;d++)if(b=this.c.get(d),b.uid===a)return b;return null};e.oj=function(a){a=this.c.get(a);return"undefined"!==typeof a?a:null};e.get=function(a){var b=null;"string"===typeof a?b=this.Td(a):"number"===typeof a&&(b=this.oj(a));return b};e.remove=function(a){a=this.get(a);a.destroy();this.c.remove(a)};
e.update=function(){for(var a,b=0,d=this.c.size;b<d;b++)a=this.c.get(b),a.update()};e.render=function(){};e.destroy=function(){this.i=null;this.f&&(this.f.destroy(),this.f=null);for(var a=0,b=this.j.size;a<b;a++)this.j.get(a).destroy();this.j=null;a=0;for(b=this.c.size;a<b;a++)this.c.get(a).destroy();this.c=null;l.prototype.destroy.call(this)};Object.defineProperty(pa.prototype,"all",{get:function(){return this.c}});Object.defineProperty(pa.prototype,"enabled",{get:function(){return this.m}});
Object.defineProperty(pa.prototype,"prefix",{get:function(){return this.u}});Object.defineProperty(pa.prototype,"onInstanceCreate",{get:function(){this.f||(this.f=new p(this,!0));return this.f}});function S(a,b){this.i=a;this.Ub=b;this.X=[];l.call(this,"PluginObjectFactory")}S.prototype=Object.create(l.prototype);e=S.prototype;e.constructor=S;e.kb=function(a){a:{for(var b=this.X.length,d;b--;)if(d=this.X[b],d===a.emitter){a=b;break a}a=-1}this.X.splice(a,1)};
e.Pn=function(a){a=new za(this.i,a);a.onDestroy.ca(this.kb,this);this.X.push(a);return a};e.Qn=function(a){a=new T(this.i,a);a.onDestroy.ca(this.kb,this);this.X.push(a);return a};e.sound=function(a,b){a=new M(this.i,a,b);a.onDestroy.ca(this.kb,this);this.X.push(a);return a};e.en=function(a){a=new t(this.i,a);a.onDestroy.ca(this.kb,this);this.X.push(a);return a};e.Uk=function(a){a=new U(this.i,a);a.onDestroy.ca(this.kb,this);this.X.push(a);return a};
e.image=function(a,b){var d=a;"string"===typeof a&&(d={key:null,url:a});d.key=this.Ub.uid+"-"+d.key;!1!==b&&(d.url=this.Ub.fullUrl+d.url);a=new I(this.i,d);a.onDestroy.ca(this.kb,this);this.X.push(a);return a};e.Nn=function(a,b){a.key=this.Ub.uid+"-"+a.key;!1!==b&&(a.url=this.Ub.fullUrl+a.url,a.frames=this.Ub.fullUrl+a.frames);a=new ld(this.i,a);a.onDestroy.ca(this.kb,this);this.X.push(a);return a};e.Tk=function(a){a=new md(this.i,a);a.onDestroy.ca(this.kb,this);this.X.push(a);return a};
e.Wk=function(a,b,d,g,h){var k;"undefined"!==typeof d&&d.toLowerCase()===Ma.Ne?k=new J(this.i,a,b,g):k=new K(this.i,a,b,g,h);k.onDestroy.ca(this.kb,this);this.X.push(k);return k};e.canvas=function(){var a=new ia(this.i);a.onDestroy.ca(this.kb,this);this.X.push(a);return a};e.Vk=function(a){a=new Bb(this.i,a);a.onDestroy.ca(this.kb,this);this.i.tween.add(a);this.X.push(a);return a};e.bj=function(){this.log("destroyAllObjects();");for(var a=this.X.length;a--;)this.X[a].destroy()};
e.destroy=function(){this.bj();this.X=this.Ub=this.i=null;l.prototype.destroy.call(this)};
var N=function(a){a=a();a.prototype=Object.create(null);a.prototype.constructor=a;a.prototype.Ll=function(){if(/Playstation Vita/.test(this.aa))this.cb="Playstation Vita",this.zg=!0;else if(/Xbox/.test(this.aa))this.cb="Xbox",this.Jg=!0;else if(/Kindle/.test(this.aa)||/\bKF[A-Z][A-Z]+/.test(this.aa)||/Silk.*Mobile Safari/.test(this.aa))this.cb="Kindle",this.bg=!0;else if(/Windows Phone/i.test(this.aa)||/IEMobile/i.test(this.aa))this.cb="Windows Phone",this.se=!0,/Windows Phone (\d+)/.test(this.aa)&&
(this.Yb=parseInt(RegExp.$1,10));else if(/Android/.test(this.aa))this.cb="Android",this.Qi=!0,/Android ([\.\_\d]+)/.test(this.aa)&&(this.Yb=parseInt(RegExp.$1,10));else if(/CrOS/.test(this.aa))this.cb="Chrome OS",this.Hf=!0;else if(/iP[ao]d|iPhone/i.test(this.aa))this.cb="iOS",this.Ec=!0,/OS (\d+)/.test(navigator.appVersion)&&(this.Yb=parseInt(RegExp.$1,10));else if(/(Linux|X11)/.test(this.aa))this.cb="Linux",this.cg=!0;else if(/Mac OS X/.test(this.aa))this.cb="Mac OS X",this.fg=!0,/Mac OS X (10[\.\_\d]+)/.test(this.aa)&&
(this.Yb=parseInt(RegExp.$1,10));else if(/Windows/.test(this.aa)||/WPDesktop/i.test(this.aa))/WPDesktop/i.test(this.aa)?(this.cb="Windows Phone",this.se=!0):(this.cb="Windows",this.Ig=!0),/(Windows 10.0|Windows NT 10.0)/.test(this.aa)?this.Yb=10:/(Windows 8.1|Windows NT 6.3)/.test(this.aa)||/(Windows 8|Windows NT 6.2)/.test(this.aa)?this.Yb=8:/(Windows 7|Windows NT 6.1)/.test(this.aa)&&(this.Yb=7)};a.prototype.Cl=function(){this.ed="undefined"!==typeof document.documentMode;this.Qd=!1===this.ed&&
!0===!!window.StyleMedia;this.Pf="undefined"!==typeof window.InstallTrigger;this.opera=!0===!!window.opr||0<=this.aa.indexOf(" OPR/")||0<=this.aa.indexOf("Opera");this.og=0<Object.prototype.toString.call(window.HTMLElement).indexOf("Constructor");this.chrome=!1===this.ed&&!1===this.Qd&&!1===this.opera&&(!0===!!window.chrome||0<=this.aa.indexOf("CriOS"));if(this.Qd)this.lb="Edge",/Edge\/(\d+)/.test(this.aa)&&(this.$a=this.dj=parseInt(RegExp.$1,10));else if(this.chrome)this.lb="Chrome",/CriOS\/(\d+)/.test(this.aa)?
this.$a=this.If=parseInt(RegExp.$1,10):/Chrome\/(\d+)/.test(this.aa)&&(this.$a=this.If=parseInt(RegExp.$1,10));else if(this.Pf)this.lb="Firefox",/Firefox\D+(\d+)/.test(this.aa)&&(this.$a=this.hj=parseInt(RegExp.$1,10));else if(this.bg)/Silk/.test(this.aa)&&(this.lb="Silk",this.tg=!0);else if(this.ed)this.lb="Internet Explorer",/MSIE (\d+\.\d+);/.test(this.aa)?this.$a=this.Yf=parseInt(RegExp.$1,10):/Trident\/(\d+\.\d+)(.*)rv:(\d+\.\d+)/.test(this.aa)&&(this.$a=this.Yf=parseInt(RegExp.$3,10));else if(this.opera)this.lb=
"Opera",/OPR\/(\d+)/.test(this.aa)?this.$a=this.he=parseInt(RegExp.$1,10):0<=this.aa.indexOf("Opera/")?/Version\/(\d+)/.test(this.aa)&&(this.$a=this.he=parseInt(RegExp.$1,10)):/Opera (\d+)/.test(this.aa)&&(this.$a=this.he=parseInt(RegExp.$1,10));else if(this.og)this.lb="Safari",/version\/(\d+(\.\d+)?)/i.test(this.aa)&&(this.$a=this.bk=parseInt(RegExp.$1,10));else{var a=this.aa.match(/Android.*AppleWebKit\/([\d.]+)/);a&&537>a[1]&&(this.lb="Android Stock",this.Lj=!0,this.$a=this.Ri=parseFloat(this.aa.slice(this.aa.indexOf("Android")+
8)))}navigator.j&&(this.nk=!0);this.Zj="CSS1Compat"===document.compatMode?!1:!0};a.prototype.El=function(){this.nc=window.devicePixelRatio||1;this.Hj=!0===this.Ec&&-1!==this.aa.toLowerCase().indexOf("iphone");this.Ij=!0===this.Ec&&-1!==this.aa.toLowerCase().indexOf("ipod");this.Xf=!0===this.Ec&&-1!==this.aa.toLowerCase().indexOf("ipad");this.ak=2<=this.nc&&!0===this.Ec;this.Ig&&!this.se||this.fg||this.cg&&!this.tg||this.Hf?this.Cc=!0:/Mobi/i.test(this.aa)&&!1===this.Xf?this.ee=!0:this.vg=!0;if(/TV/i.test(this.aa)||
!0===this.zg||!0===this.Jg||this.Cc&&/Windows NT/i.test(this.aa)&&/Touch/i.test(this.aa))this.Vj=!0,this.Cc=this.vg=this.ee=!1};a.prototype.Nl=function(){var a=document.createElement("video");try{"function"===typeof a.canPlayType&&(a.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,"")&&(this.kg=!0),a.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,"")&&(this.ig=this.Tf=!0),a.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")&&(this.Hg=!0),a.canPlayType('video/webm; codecs="vp9"').replace(/^no$/,
"")&&(this.Ag=!0),a.canPlayType('application/x-mpegURL; codecs="avc1.42E01E"').replace(/^no$/,"")&&(this.Wf=!0))}catch(d){}};a.prototype.Al=function(){this.Df="undefined"!==typeof window.Audio;this.Cg="undefined"!==typeof window.AudioContext||"undefined"!==typeof window.webkitAudioContext;var a=document.createElement("audio");try{if("function"===typeof a.canPlayType){a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,"")&&(this.jg=!0);a.canPlayType("audio/mpeg;").replace(/^no$/,"")&&(this.gg=
!0);if(a.canPlayType('audio/ogg; codecs="opus"').replace(/^no$/,"")||a.canPlayType("audio/opus;").replace(/^no$/,""))this.je=!0;a.canPlayType('audio/wav; codecs="1"').replace(/^no$/,"")&&(this.Bg=!0);a.canPlayType("audio/aac;").replace(/^no$/,"")&&(this.Bf=!0);if(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/m4a;")||a.canPlayType("audio/aac;").replace(/^no$/,""))this.eg=!0;if(a.canPlayType("audio/x-mp4;")||a.canPlayType("audio/mp4;")||a.canPlayType("audio/aac;").replace(/^no$/,""))this.hg=!0;
a.canPlayType('audio/webm; codecs="vorbis"').replace(/^no$/,"")&&(this.Fg=this.Gg=!0)}}catch(d){}};a.prototype.Fl=function(){this.xg="undefined"!==typeof navigator.xg||"undefined"!==typeof navigator.o||"undefined"!==typeof navigator.c||"undefined"!==typeof navigator.f;this.Gf="function"===typeof navigator.getBattery};a.prototype.Hl=function(){this.canvas="undefined"!==typeof window.CanvasRenderingContext2D;if(!0===this.canvas){this.Vi="function"===typeof document.createElement("canvas").getContext("2d").fillText;
var a=document.createElement("canvas").getContext("2d");a.rect(0,0,10,10);a.rect(2,2,6,6);this.Wi=!1===a.isPointInPath(5,5,"evenodd")}try{this.localStorage="object"===typeof window.localStorage&&"function"===typeof window.localStorage.getItem}catch(g){this.localStorage=!1}this.Sj="function"===typeof window.MediaSource;this.ej="function"===typeof window.HTMLMediaElement&&"function"===typeof window.O&&"function"===typeof window.f&&"function"===typeof navigator.O;this.applicationCache="object"===typeof window.applicationCache;
this.addEventListener="function"===typeof window.addEventListener;this.raf="function"===typeof window.requestAnimationFrame||"function"===typeof window.webkitRequestAnimationFrame||"function"===typeof window.mozRequestAnimationFrame;try{var d=document.createElement("canvas");d.f=!1;this.Dg="function"===typeof d.getContext&&"undefined"!==typeof window.WebGLRenderingContext&&!(!d.getContext("webgl")&&!d.getContext("experimental-webgl"))}catch(g){this.Dg=!1}this.Eg="function"===typeof navigator.getVRDisplays?
!0:!1;this.JSON="object"===typeof window.JSON&&"function"===typeof window.JSON.parse&&"function"===typeof window.JSON.stringify;this.geolocation="object"===typeof navigator.geolocation;this.history="object"===typeof window.history&&"function"===typeof window.history.pushState;this.fk="function"===typeof document.createElementNS&&"function"===typeof document.createElementNS("http://www.w3.org/2000/svg","svg").c;this.contextMenu="undefined"!==typeof document.documentElement.contextMenu&&"function"===
typeof window.HTMLMenuItemElement};a.prototype.Gl=function(){this.Nj=/^https/i.test(window.location.protocol);try{this.$f=window.self!==window.top}catch(b){this.$f=!0}};a.prototype.Kl=function(){this.hk="undefined"!==typeof window.ontouchstart||"undefined"!==typeof window.c&&document instanceof window.c||"number"===typeof navigator.maxTouchPoints&&0<navigator.maxTouchPoints||"number"===typeof navigator.msMaxTouchPoints&&0<navigator.msMaxTouchPoints;if("undefined"!==typeof window.j||"undefined"!==
typeof window.m)this.ik=!(!MouseEvent.f||!MouseEvent.c);this.nj="function"===typeof navigator.getGamepads||"function"===typeof navigator.webkitGetGamepads};a.prototype.Il=function(){for(var a="requestFullscreen requestFullScreen webkitRequestFullscreen webkitRequestFullScreen mozRequestFullScreen mozRequestFullscreen msRequestFullscreen msRequestFullScreen".split(" "),d="cancelFullscreen cancelFullScreen exitFullscreen exitFullScreen webkitCancelFullscreen webkitCancelFullScreen webkitExitFullscreen webkitExitFullScreen mozCancelFullscreen mozCancelFullScreen mozExitFullscreen mozExitFullScreen msCancelFullscreen msCancelFullScreen msExitFullscreen msExitFullScreen".split(" "),
g=document.createElement("div"),h=0,k=a.length;h<k;h++)if(g[a[h]]){this.requestFullscreen=a[h];break}a=0;for(g=d.length;a<g;a++)if(document[d[a]]){this.exitFullscreen=d[a];break}"function"===typeof window.Element&&Element.ALLOW_KEYBOARD_INPUT&&(this.lj=!0);d=["fullscreenElement","mozFullScreenElement","webkitFullscreenElement","msFullscreenElement"];a=0;for(g=d.length;a<g;a++)if("undefined"!==typeof document[d[a]]){this.fullscreenElement=d[a];break}d=["fullscreenEnabled","mozFullScreenEnabled","webkitFullscreenEnabled",
"msFullscreenEnabled"];a=0;for(g=d.length;a<g;a++)if("undefined"!==typeof document[d[a]]){this.fullscreenEnabled=d[a];break}};a.prototype.Bl=function(){for(var a=["visibilitychange","mozvisibilitychange","webkitvisibilitychange","msvisibilitychange"],d=["hidden","mozHidden","webkitHidden","msHidden"],g=0,h=d.length;g<h;g++)if("undefined"!==typeof document[d[g]]){this.visibilityState=d[g];this.yg=a[g];break}a=["orientation","mozOrientation","msOrientation"];d=0;for(g=a.length;d<g;d++)if("string"===
typeof screen[a[d]]){this.orientation=a[d];break}this.ck="object"===typeof screen.orientation&&"string"===typeof screen.orientation.type&&"function"===typeof screen.orientation.lock;a=["lockOrientation","mozLockOrientation","msLockOrientation"];d=["unlockOrientation","mozUnlockOrientation","msUnlockOrientation"];g=0;for(h=a.length;g<h;g++)if("function"===typeof screen[a[g]]){this.Pj=a[g];this.jk=d[g];break}this.file="undefined"!==typeof window.File&&"undefined"!==typeof window.FileReader&&"undefined"!==
typeof window.FileList&&"undefined"!==typeof window.Blob;this.gj="undefined"!==typeof window.requestFileSystem||"undefined"!==typeof window.webkitRequestFileSystem;this.Yj="undefined"!==typeof document.f||"undefined"!==typeof document.c||"undefined"!==typeof document.O};a.prototype.Dl=function(){var a=document.createElement("a").style;a.cssText="pointer-events:auto";this.$c="auto"===a.pointerEvents;a.cssText="background-color:rgba(150,255,150,.5)";this.aj=-1<(""+a.backgroundColor).indexOf("rgba");
this.$i="undefined"!==typeof a.animationName||"undefined"!==typeof a.webkitAnimationName||"undefined"!==typeof a.m||"undefined"!==typeof a.o;var a=document.createElement("p"),d,g={webkitTransform:"-webkit-transform",OTransform:"-o-transform",msTransform:"-ms-transform",MozTransform:"-moz-transform",transform:"transform"};document.body.insertBefore(a,null);for(var h in g)"undefined"!==typeof a.style[h]&&(a.style[h]="translate3d(1px,1px,1px)",d=window.getComputedStyle(a).getPropertyValue(g[h]));document.body.removeChild(a);
this.Zi="undefined"!==typeof d&&0<d.length&&"none"!==d};a.prototype.Rl=function(a){null!==a.rotationRate&&"undefined"!==typeof a.rotationRate.alpha&&"undefined"!==typeof a.rotationRate.beta&&"undefined"!==typeof a.rotationRate.gamma&&(this.Lf=!0);"undefined"!==typeof a.acceleration&&"undefined"!==typeof a.acceleration.x&&"undefined"!==typeof a.acceleration.y&&"undefined"!==typeof a.acceleration.z&&(this.Kf=!0);this.vi();"function"!==typeof this.Ac&&this.sf()};a.prototype.Sl=function(a){"undefined"!==
typeof a.alpha&&"undefined"!==typeof a.beta&&"undefined"!==typeof a.gamma&&(this.Nf=!0);this.wi();"function"!==typeof this.zc&&this.sf()};a.prototype.vi=function(){window.removeEventListener("devicemotion",this.zc,!1);this.zc=null};a.prototype.wi=function(){window.removeEventListener("deviceorientation",this.Ac,!1);this.Ac=null};a.prototype.Jl=function(){this.Jf="undefined"!==typeof window.DeviceMotionEvent;this.Mf="undefined"!==typeof window.DeviceOrientationEvent;window.addEventListener("deviceorientation",
this.Ac,!1);window.addEventListener("devicemotion",this.zc,!1)};a.prototype.Ml=function(){var a=document.createElement("div");a.style.width="1in";a.style.height="1in";document.body.appendChild(a);this.cj=a.offsetWidth;document.body.removeChild(a);this.ee?(this.qg=Math.floor(Math.min(window.screen.width,window.screen.height)*this.nc),this.pg=Math.floor(Math.max(window.screen.width,window.screen.height)*this.nc)):(this.qg=Math.floor(Math.max(window.screen.width,window.screen.height)*this.nc),this.pg=
Math.floor(Math.min(window.screen.width,window.screen.height)*this.nc))};a.prototype.zl=function(){this.aa=navigator.userAgent;this.language=navigator.languages&&navigator.languages[0]||navigator.language||navigator.m||"";this.Ll();this.Cl();this.El();this.Al();this.Nl();this.Fl();this.Hl();this.Gl();this.Bl();this.Il();this.Kl();this.Dl();this.zc=this.Rl.bind(this);this.Ac=this.Sl.bind(this);this.Jl();this.Ml();!1===this.Jf&&!1===this.Mf&&this.sf()};a.prototype.sf=function(){"function"===typeof this.zc&&
this.vi();"function"===typeof this.Ac&&this.wi();!0===this.Lf&&!0===this.Kf&&!0===this.Nf&&(this.Aj=!0);this.ready=!0;Object.freeze(N)};a.prototype.bn=function(a){return"mp3"===a&&!0===this.gg||"ogg"===a&&(!0===this.jg||!0===this.je)||"m4a"===a&&!0===this.eg||"mp4"===a&&!0===this.hg||"opus"===a&&!0===this.je||"wav"===a&&!0===this.Bg||"aac"===a&&!0===this.Bf||"webm"===a&&!0===this.Gg||"weba"===a&&!0===this.Fg?!0:!1};a.prototype.cn=function(a){if("webm"!==a||!0!==this.Hg&&!0!==this.Ag)if("mp4"!==a||
!0!==this.ig&&!0!==this.Tf){if(("ogg"===a||"ogv"===a)&&!0===this.kg||"mpeg"===a&&!0===this.Wf)return!0}else return!0;else return!0;return!1};a.prototype.Bn=function(){return navigator.getBattery().then(function(a){return this.Gf&&!a.charging&&.2>=a.level}.bind(this),function(){return!1})};return new a}(function(){return function(){this.ready=!1;this.cb=this.language=this.aa="";this.Yb=0;this.Pf=this.se=this.Ig=this.fg=this.cg=this.Ec=this.Hf=this.Qi=this.bg=this.Jg=this.zg=!1;this.hj=0;this.chrome=
!1;this.If=0;this.ed=!1;this.Yf=0;this.opera=!1;this.he=0;this.Qd=!1;this.dj=0;this.og=!1;this.bk=0;this.tg=!1;this.lb="";this.$a=0;this.Lj=this.nk=!1;this.Ri=0;this.Zj=!1;this.fullscreenElement=this.exitFullscreen=this.requestFullscreen=this.fullscreenEnabled="";this.Xf=this.Ij=this.ak=this.Hj=this.lj=!1;this.nc=1;this.$f=this.Nj=this.fk=this.history=this.JSON=this.ej=this.Sj=this.contextMenu=this.Yj=this.geolocation=this.applicationCache=this.localStorage=this.gj=this.file=this.Eg=this.Dg=this.raf=
this.addEventListener=this.Vi=this.Wi=this.canvas=this.Wf=this.Ag=this.Hg=this.ig=this.Tf=this.kg=this.Fg=this.Gg=this.Bf=this.hg=this.eg=this.Bg=this.je=this.gg=this.jg=this.Cg=this.Df=this.ik=this.nj=this.hk=this.Vj=this.ee=this.vg=this.Cc=this.Gf=this.xg=!1;this.yg=this.visibilityState="";this.Nf=this.Lf=this.Kf=this.Mf=this.Jf=this.Aj=this.$i=this.$c=this.aj=this.Zi=!1;this.Ac=this.zc=null;this.pg=this.qg=this.cj=0;this.ck=!1;this.jk=this.Pj=this.orientation="";this.zl()}});
function la(a){this.i=a;this.m=!1;this.c=null;this.j=!1;this.f=null}e=la.prototype;e.constructor=la;e.boot=function(){for(var a=["ms","moz","webkit","o"],b=0;b<a.length&&!window.requestAnimationFrame;b++)window.requestAnimationFrame=window[a[b]+"RequestAnimationFrame"],window.cancelAnimationFrame=window[a[b]+"CancelAnimationFrame"];this.f=window};
e.start=function(a){this.f="undefined"!==typeof a&&(a===window||a instanceof VRDisplay)?a:window;this.j=!0;"undefined"===typeof this.f.requestAnimationFrame||"timeout"===this.i.config.update?(this.m=!0,this.c=function(){!0===this.j&&(this.i.update(0),this.O=window.setTimeout(this.c.bind(this),1E3/30))},this.O=window.setTimeout(this.c.bind(this),0)):(this.m=!1,this.c=function(a){!0===this.j&&(this.i.update(Math.floor(a)),this.O=window.requestAnimationFrame(this.c.bind(this)))},this.O=this.f.requestAnimationFrame(this.c.bind(this)))};
e.stop=function(){this.m?clearTimeout(this.O):(this.f.cancelAnimationFrame(this.O),this.O=null);this.j=!1};e.destroy=function(){this.stop();this.f=this.c=this.i=null};Object.defineProperty(la.prototype,"running",{get:function(){return this.j}});function na(a){this.i=a;this.c=!0;l.call(this,"History")}na.prototype=Object.create(l.prototype);e=na.prototype;e.constructor=na;
e.Zg=function(){this.log("_addState");var a=this.i.story.scene,b={viewer:{uid:this.i.uid},scene:{uid:a.uid},locale:this.i.i18n.locale},d=window.history.state;null===d?window.history.replaceState(b,a.name,nd(a)):d.scene.uid!==b.scene.uid&&window.history.pushState(b,a.name,nd(a))};
e.Yg=function(){this.log("_updateState");var a=window.history.state,b;a?(b="undefined"!==typeof a.scene&&"string"===typeof a.scene.uid,b=!0===("undefined"!==typeof a.viewer&&"string"===typeof a.viewer.uid)&&!0===b):b=!1;b&&(b=n.get(a.scene.uid),a.locale=this.i.i18n.locale,window.history.replaceState(a,b.name,nd(b)))};function nd(a){return"#"+a.slug+"&uid="+a.uid}e.ni=function(a){if(null!==a.state){var b=n.get(a.state.viewer.uid);b.history.log("_onPopStateHandler");b.story.scene=a.state.scene.uid}};
e.ha=function(a){this.c="boolean"===typeof a.enabled?a.enabled:!0;!0===this.c&&(this.i.story.onSceneLoadStart.add(this.Zg,this),this.i.i18n.onLocaleChangeComplete.add(this.Yg,this),window.addEventListener("popstate",this.ni,!1))};e.destroy=function(){this.i.story.onSceneLoadStart.remove(this.Zg,this);this.i.i18n.onLocaleChangeComplete.remove(this.Yg,this);window.removeEventListener("popstate",this.ni,!1);this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(na.prototype,"enabled",{get:function(){return this.c}});
function p(a,b){this.o=a;this.j=b||!1;this.c=this.m=null;this.f=!0;l.call(this,"EventDispatcher")}p.prototype=Object.create(l.prototype);e=p.prototype;e.constructor=p;
function od(a,b,d,g,h){if("function"!==typeof b)a.warn("You're trying to add an undefined listener");else if(!0===a.has(b,g))a.warn("You're trying to add a duplicate listener for this context");else{b=new pd(a,b,d,g,h);a.c||(a.c=[]);if(a.c.length){d=a.c.length;do d--;while(a.c[d]&&b.Af<=a.c[d].Af);a.c.splice(d+1,0,b)}else a.c.push(b);!0===a.j&&!0===a.f&&null!==a.m&&b.yb(a.m)}}
function qd(a,b,d){if(!a.c)return-1;"undefined"===typeof d&&(d=null);for(var g,h=0,k=a.c.length;h<k;h++)if(g=a.c[h],g.listener===b&&g.context===d)return h;return-1}e.add=function(a,b,d){od(this,a,!1,b,d)};e.ca=function(a,b,d){od(this,a,!0,b,d)};e.remove=function(a,b){a=qd(this,a,b);-1!==a&&(this.c[a].destroy(),this.c.splice(a,1))};e.has=function(a,b){return-1!==qd(this,a,b)};
e.D=function(a,b){!0===this.j&&(this.m=void 0===a?null:a);if(!1!==this.f&&this.c)for(var d=this.c.length;d--;)this.c[d].yb(a,b)};e.destroy=function(){if(!1!==this.ib){if(this.c){for(var a=this.c.length;a--;)this.c[a].destroy();this.c=null}this.m=this.o=null;l.prototype.destroy.call(this)}};Object.defineProperty(p.prototype,"emitter",{get:function(){return this.o}});Object.defineProperty(p.prototype,"memorize",{get:function(){return this.j},set:function(a){this.j=!!a}});
Object.defineProperty(p.prototype,"active",{get:function(){return this.f},set:function(a){this.f=!!a}});function rd(a,b){this.f=a;this.c=b||null}rd.prototype.constructor=rd;Object.defineProperty(rd.prototype,"emitter",{get:function(){return this.f}});Object.defineProperty(rd.prototype,"data",{get:function(){return this.c}});function pd(a,b,d,g,h){this.j=a;this.c=b;this.f=g||null;this.o=d||!1;this.Af=h||0;this.m=0;this.O=!1}e=pd.prototype;e.constructor=pd;
e.ii=function(a){this.c.call(this.f,new rd(this.j.emitter,a));this.m++;!0===this.o&&this.bh();this.O=!1};e.yb=function(a,b){this.c&&(!0===b&&!1===this.O?(this.O=!0,window.setTimeout(this.ii.bind(this,a),0)):!0!==b&&this.ii(a))};e.bh=function(){return this.j.remove(this.c,this.f)};e.destroy=function(){this.f=this.c=this.j=null};Object.defineProperty(pd.prototype,"listener",{get:function(){return this.c}});Object.defineProperty(pd.prototype,"context",{get:function(){return this.f}});
Object.defineProperty(pd.prototype,"priority",{get:function(){return this.Af}});Object.defineProperty(pd.prototype,"callCount",{get:function(){return this.m}});function ma(a){this.i=a;this.c=null;this.f=-1;this.o="";this.u=!0;this.j=this.m=null;l.call(this,"LocaleManager");this.log("$_LocaleManager._boot();");this.c=new kd}ma.prototype=Object.create(l.prototype);e=ma.prototype;e.constructor=ma;
e.ha=function(a){this.u="boolean"===typeof a.enabled?a.enabled:!0;"undefined"!==typeof a.auto&&!0===a.auto&&""!==N.language?this.o=N.language:"string"===typeof a["default"]&&(this.o=a["default"]);if(!1===this.u)this.warn("$_LocaleManager: locale management is deactivated");else if("undefined"!==typeof a.locales){for(var b=!1,d=0,g=a.locales.length;d<g;d++){var h;var k=a.locales[d],q=sd(this,k.uid);-1===q?(h=new td(this.i),h.f.add(this.cm,this),q=this.c.add(h)-1):h=this.c.get(q);h.ha(k);q===this.f||
this.o.toLowerCase()===k.uid.toLowerCase()?(h.dg(),-1===this.f&&ud(this,q),h=!0):h=!1;!0===h&&(b=!0)}!1===b&&(-1===sd(this,this.o)&&(this.o=a.locales[0].uid),ud(this,sd(this,a.locales[0].uid)))}};function sd(a,b){for(var d,g=0,h=a.c.size;g<h;g++)if(d=a.c.get(g),d.uid.toLowerCase()===b.toLowerCase())return g;return-1}
function ud(a,b){if(0>b||b>=a.c.size)throw"The locale you are trying to set doesn't exist";a.f===b?a.warn("$_LocaleManager: You're trying to set a locale that is already the actual locale"):(a.f=b,a.m&&a.m.D(),a.c.get(a.f).dg())}e.cm=function(){this.log("$_LocaleManager._localeAllFilesLoaded();");this.j&&this.j.D()};
e.Xb=function(a,b){if(-1===this.f)return this.warn("$_LocaleManager: You trying to get a value with no locale selected!"),a;var d=this.c.get(this.f).Xb(a,b),g=sd(this,this.o);this.f!==g&&-1!==g&&d===a&&(d=this.c.get(g).Xb(a,b));return d};e.vb=function(a,b){if(-1===this.f)return!1;var d=this.c.get(this.f).vb(a,b),g=sd(this,this.o);this.f!==g&&-1!==g&&!1===d&&(d=this.c.get(g).vb(a,b));return d};
e.destroy=function(){this.i=null;if(this.c){for(var a=0,b=this.c.size;a<b;a++)this.c.get(a).destroy();this.c=null}this.m&&(this.m.destroy(),this.m=null);this.j&&(this.j.destroy(),this.j=null);l.prototype.destroy.call(this)};Object.defineProperty(ma.prototype,"locale",{get:function(){return-1!==this.f?this.c.get(this.f).uid:""},set:function(a){var b;"number"===typeof a&&a<this.c.size?b=a:"string"===typeof a&&(b=sd(this,a));ud(this,b)}});
Object.defineProperty(ma.prototype,"localeIndex",{get:function(){return this.f},set:function(a){"number"===typeof a&&a<this.c.size&&ud(this,a)}});Object.defineProperty(ma.prototype,"localeObject",{get:function(){return-1!==this.f?this.c.get(this.f):null}});Object.defineProperty(ma.prototype,"locales",{get:function(){for(var a=[],b=0,d=this.c.size;b<d;b++)a.push(this.c.get(b).uid);return a}});Object.defineProperty(ma.prototype,"onLocaleChangeRequest",{get:function(){this.m||(this.m=new p(this));return this.m}});
Object.defineProperty(ma.prototype,"onLocaleChangeComplete",{get:function(){this.j||(this.j=new p(this));return this.j}});function za(a,b,d,g){this.i=a;this.c=b;this.m=d;this.j=g;this.f=null;l.call(this,"LocaleString")}za.prototype=Object.create(l.prototype);za.prototype.constructor=za;za.prototype.destroy=function(){this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(za.prototype,"key",{get:function(){return this.c},set:function(a){this.c=a}});
Object.defineProperty(za.prototype,"jsonKey",{get:function(){return this.m},set:function(a){this.m=a}});Object.defineProperty(za.prototype,"value",{get:function(){if(""===this.i.i18n.locale)return"undefined"!==typeof this.j?this.j:this.c;this.f=this.i.i18n.Xb(this.c,this.m);this.f===this.c&&"undefined"!==typeof this.j&&(this.f=this.j);return this.f}});Object.defineProperty(za.prototype,"loaded",{get:function(){var a=this.i.i18n.Xb(this.c,this.m);return"undefined"!==typeof a&&a!==this.c}});
function td(a){this.i=a;this.m="";this.f=this.j=this.c=null;l.call(this,"Locale");this.c=new kd;this.j=new p(this);this.f=new p(this)}td.prototype=Object.create(l.prototype);e=td.prototype;e.constructor=td;
e.ha=function(a){"string"===typeof a.uid&&(this.O=a.uid);""===this.m&&"string"===typeof a.name&&(this.m=a.name);if("undefined"!==typeof a.files)for(var b,d=0,g=a.files.length;d<g;d++)b=a.files[d],null===vd(this,b.key)&&(b.zb=!1,b.loaded=!1,this.c.add(b));this.log("Locale.addConfig(); number of files : "+this.c.size)};
e.dg=function(){if(!0===wd(this))return this.f.D(),!0;for(var a,b=0,d=this.c.size;b<d;b++)a=this.c.get(b),!1===a.zb&&!1===a.loaded&&!1===a.zb&&!1===a.loaded&&(a.zb=!0,this.i.load.json(a.key,a.url,this.am,this))};function vd(a,b){for(var d,g=0,h=a.c.size;g<h;g++)if(d=a.c.get(g),d.key===b)return d;return null}e.am=function(a){a=vd(this,a.key);a.zb=!1;a.loaded=!0;this.log("loadFileComplete(); "+a.key);this.j.D();!0===wd(this)&&this.f.D()};
function wd(a){for(var b,d=0,g=a.c.size;d<g;d++)if(b=a.c.get(d),!1===b.loaded)return!1;return!0}e.Xb=function(a,b){for(var d,g=0,h=this.c.size;g<h;g++)if(d=this.c.get(g),!0===this.i.cache.has(A.JSON,d.key)&&("undefined"===typeof b||b===d.key)&&(d=this.i.cache.get(A.JSON,d.key),"undefined"!==typeof d.data[a]))return d.data[a];"undefined"!==typeof b&&(this.warn("$_Locale: value not found into the specified JSON file, try to find it in all files."),this.Xb(a));return a};
e.vb=function(a,b){for(var d,g=0,h=this.c.size;g<h;g++)if(d=this.c.get(g),!0===this.i.cache.has(A.JSON,d.key)&&("undefined"===typeof b||b===d.key)&&(d=this.i.cache.get(A.JSON,d.key),"undefined"!==typeof d.data[a]))return!0;"undefined"!==typeof b&&(this.warn("$_Locale: key not found into the specified JSON file, try to find it in all files."),this.vb(a));return!1};
e.dh=function(a,b){for(var d,g=0,h=this.c.size;g<h;g++)if(d=this.c.get(g),!0===this.i.cache.has(A.JSON,d.key)&&("undefined"===typeof b||b===d.key)){d=this.i.cache.get(A.JSON,d.key);for(var k in d.data)if(d.data[k]===a)return k}"undefined"!==typeof b&&(this.warn("$_Locale: value not found into the specified JSON file, try to find it in all files."),this.dh(a))};e.destroy=function(){this.c=this.i=null;this.j.destroy();this.j=null;this.f.destroy();this.f=null;l.prototype.destroy.call(this)};
Object.defineProperty(td.prototype,"name",{get:function(){return this.m}});function ua(a){this.i=a;this.j=!0;this.o=this.m=this.f=this.c=null;l.call(this,"Keyboard");this.c=[];this.f=[];this.m=this.Yl.bind(this);this.o=this.Zl.bind(this);window.addEventListener("keydown",this.m,!1);window.addEventListener("keyup",this.o,!1)}ua.prototype=Object.create(l.prototype);e=ua.prototype;e.constructor=ua;
e.Yl=function(a){if(!1!==this.j){var b=a.keyCode;this.log("keyDown "+b);-1===this.f.indexOf(b)?(this.f.push(b),b=!0):b=!1;!0===b&&xd(this,a)}};
e.Zl=function(a){if(!1!==this.j){var b=a.keyCode;this.log("keyUp "+b);b=this.f.indexOf(b);-1!==b?(this.f.splice(b,1),b=!0):b=!1;if(!0===b)a:if(b=a.keyCode,!0!==this.ag(b))for(var b=this.Rf(b),d,g=0,h=b.length;g<h;g++){d=b[g];for(var k=0,q=this.f.length;k<q;k++)if(d.Yd(this.f[k]))break a;d.kk(a);k=0;for(q=this.f.length;k<q;k++)if(d.Uf(this.f[k])){var v=new KeyboardEvent("keydown",{jo:this.f[k],ctrlKey:a.ctrlKey,shiftKey:a.shiftKey,altKey:a.altKey});xd(this,v)}}}};
function yd(a,b){if(!a.c||!a.c.length)return-1;if("object"===typeof b&&"KeyBinding"===b.type)return a.c.indexOf(b);if("number"===typeof b)for(var d=0,g=a.c.length;d<g;d++)if(!0===a.c[d].Yd(b))return d;return-1}function xd(a,b){var d=b.keyCode;if(!0!==a.ag(d)){a=a.Rf(d);for(var g=0,h=a.length;g<h;g++)d=a[g],!1===d.pressed&&d.ah(b)}}e.update=function(){for(var a,b=0,d=this.c.length;b<d;b++)if(a=this.c[b],!0===a.pressed){if(!0===a.hasToWaitToHold&&!1===a.downComplete)break;a.Gj()}};
e.An=function(a){return-1!==this.f.indexOf(a)};e.ag=function(a){for(var b,d=0,g=this.c.length;d<g;d++)if(b=this.c[d],!0===b.pressed&&!0===b.Uf(a))return!0;return!1};e.Cf=function(a){if("object"!==typeof a&&"KeyBinding"!==a.type)return!1;if(-1===yd(this,a))return this.c.push(a),!0;this.warn("Trying to add a duplicate key binding on keyboard!");return!1};e.ne=function(a){a=yd(this,a);return-1!==a?(this.c[a].destroy(),this.c.splice(a,1),!0):!1};e.qn=function(a){return-1!==yd(this,a)};
e.Rf=function(a){for(var b=[],d=0,g=this.c.length;d<g;d++)!0===this.c[d].Yd(a)&&b.push(this.c[d]);return b};e.destroy=function(){this.i=null;window.removeEventListener("keydown",this.m,!1);window.removeEventListener("keyup",this.o,!1);for(var a=this.c.length;a--;)this.ne(this.c[a]);this.o=this.m=this.c=null;l.prototype.destroy.call(this)};Object.defineProperty(ua.prototype,"enabled",{get:function(){return this.j},set:function(a){this.j=!!a}});
function P(a,b,d,g,h,k,q,v){this.i=a;this.F=b||[];this.o=d||null;this.C=g||null;this.u=h||null;this.A=k||null;this.f=q||this;this.I=v||"";this.uf=this.H=this.K=!1;this.G=this.B=this.Wc=0;this.m=this.j=this.c=null;l.call(this,"KeyBinding");if(!0===B.T(this.o,"string")||B.Ga(this.o,"string"))this.c=new bc(this.i),this.c.c(this.o);if(!0===B.T(this.u,"string")||B.Ga(this.u,"string"))this.j=new bc(this.i),this.j.c(this.u);if(!0===B.T(this.C,"string")||B.Ga(this.C,"string"))this.m=new bc(this.i),this.m.c(this.C)}
P.prototype=Object.create(l.prototype);e=P.prototype;e.constructor=P;e.Yd=function(a){return"number"===typeof this.F&&this.F===a?!0:"function"===typeof this.F.indexOf?-1!==this.F.indexOf(a):!1};e.Uf=function(a){if(null!==this.A){if("number"===typeof this.A&&this.A===a)return!0;if("function"===typeof this.A.indexOf)return-1!==this.A.indexOf(a)}return!1};e.ah=function(a){this.log("down");this.Wc++;this.H=!0;"function"===typeof this.o?this.o.call(this.f,this,a):this.c&&this.c.D()};
e.Tn=function(){this.K=!0;var a=this.Wc;return function(){this.log("downCompleteCallback "+a+" "+this.Wc);a===this.Wc&&(this.uf=!0)}.bind(this)};e.kk=function(a){this.log("up");this.G++;this.uf=this.H=!1;"function"===typeof this.C?this.C.call(this.f,this,a):this.m&&this.m.D()};e.Gj=function(){this.log("hold");this.B++;"function"===typeof this.u?this.u.call(this.f,this):this.j&&this.j.D()};
e.destroy=function(){this.f=this.A=this.u=this.C=this.o=this.F=null;this.c&&(this.c.destroy(),this.c=null);this.j&&(this.j.destroy(),this.j=null);this.m&&(this.m.destroy(),this.m=null);l.prototype.destroy.call(this)};Object.defineProperty(P.prototype,"name",{get:function(){return this.I}});Object.defineProperty(P.prototype,"pressed",{get:function(){return this.H}});Object.defineProperty(P.prototype,"downCount",{get:function(){return this.Wc}});Object.defineProperty(P.prototype,"upCount",{get:function(){return this.G}});
Object.defineProperty(P.prototype,"holdCount",{get:function(){return this.B}});Object.defineProperty(P.prototype,"hasToWaitToHold",{get:function(){return this.K}});Object.defineProperty(P.prototype,"downComplete",{get:function(){return this.uf}});function zd(a){this.f=this.L=a;this.J=!1;this.c=null;this.j="";this.F=this.I=null;this.K=this.B=this.H=!1;this.m=null;this.R=200;this.G=this.N=1;this.U=Gb.LINEAR;this.C=this.u=this.A=this.o=null;l.call(this,"Drag");this.G=this.L.alpha}zd.prototype=Object.create(l.prototype);
e=zd.prototype;e.constructor=zd;function Ad(a,b){a.f&&(a.f&&(a.f.pointer.onPanStart.remove(a.Wg,a),a.f.pointer.onPanMove.remove(a.Vg,a),a.f.pointer.onPanEnd.remove(a.Ug,a)),a.f=null);a.f=b;a.f.pointer.enabled=!0;a.f.pointer.onPanStart.add(a.Wg,a);a.f.pointer.onPanMove.add(a.Vg,a);a.f.pointer.onPanEnd.add(a.Ug,a)}
e.Wg=function(a){this.log("_panStartHandler");var b=a.data;a=a.data.srcEvent;"undefined"!==typeof a.touches&&"object"===typeof a.touches[0]&&(a=a.touches[0]);if(b=!0!==this.K&&b.target===this.f.dom){if(this.c)var b=this.L.globalOffset,d=this.c.globalOffset,g=b.left+this.L.pixelWidth>d.left+this.c.innerWidth,h=b.top<d.top,k=b.top+this.L.pixelHeight>d.top+this.c.innerHeight,b=!0===b.left<d.left||!0===g||!0===h||!0===k?!1:!0;else b=!0;b=!1!==b}b&&(this.H=!0,this.I={x:this.L.x,y:this.L.y},this.L.top=
null,this.L.right=null,this.L.bottom=null,this.L.left=null,this.F={x:a.pageX,y:a.pageY},this.N=this.L.alpha,this.L.alpha=this.G,this.o&&this.o.D())};e.Ug=function(){this.log("_panEndHandler");!0===this.H&&(this.H=!1,this.u&&this.u.D(),!0===this.B&&this.m?(this.K=!0,this.m.Le({x:this.I.x,y:this.I.y},this.R,this.U).start()):this.L.alpha=this.N,this.F=this.I=null)};
e.Vg=function(a){this.log("_panMoveHandler");if(!0===this.H){a=a.data.srcEvent;"undefined"!==typeof a.touches&&"object"===typeof a.touches[0]&&(a=a.touches[0]);var b={x:a.pageX,y:a.pageY};a=b.x-this.F.x;var d=b.y-this.F.y;this.F=b;if(this.c){var b=this.L.globalOffset,g=this.L.parent.globalOffset,h=this.c.globalOffset;if(""===this.j||"x"===this.j)b.left+a<h.left?(this.log("out left"),this.L.x=Math.abs(g.left-h.left)):b.left+a+this.L.pixelWidth>h.left+this.c.innerWidth?(this.log("out right"),this.L.x=
Math.abs(g.left-h.left)+this.c.innerWidth-this.L.pixelWidth):this.L.x+=a;if(""===this.j||"y"===this.j)b.top+d<h.top?(this.log("out top"),this.L.y=Math.abs(g.top-h.top)):b.top+d+this.L.pixelHeight>h.top+this.c.innerHeight?(this.log("out bottom"),this.L.y=Math.abs(g.top-h.top)+this.c.innerHeight-this.L.pixelHeight):this.L.y+=d}else{if(""===this.j||"x"===this.j)this.L.x+=a;if(""===this.j||"y"===this.j)this.L.y+=d}this.A&&this.A.D()}};
e.yi=function(){this.log("_revertCompleteHandler");this.K=!1;this.L.alpha=this.N;this.C&&this.C.D()};e.enable=function(){this.J=!0;Ad(this,this.f)};e.Xg=function(){this.J=!1};e.destroy=function(){this.revert=!1;this.o&&(this.o.destroy(),this.o=null);this.A&&(this.A.destroy(),this.A=null);this.u&&(this.u.destroy(),this.u=null);this.C&&(this.C.destroy(),this.C=null);this.F=this.c=this.L=this.f=null;l.prototype.destroy.call(this)};
Object.defineProperty(zd.prototype,"enabled",{get:function(){return this.J},set:function(a){!0===!!a?this.enable():this.Xg()}});Object.defineProperty(zd.prototype,"dragging",{get:function(){return this.H}});Object.defineProperty(zd.prototype,"handle",{get:function(){return this.f},set:function(a){Ad(this,a)}});Object.defineProperty(zd.prototype,"constrain",{get:function(){return this.c},set:function(a){this.c=a}});
Object.defineProperty(zd.prototype,"progress",{get:function(){if(this.c){var a=this.L.globalOffset,b=this.c.globalOffset;return{x:(a.left-b.left)/(this.c.innerWidth-this.L.pixelWidth),y:(a.top-b.top)/(this.c.innerHeight-this.L.pixelHeight)}}}});Object.defineProperty(zd.prototype,"axis",{get:function(){return this.j},set:function(a){"x"===a||"y"===a?this.j=a:this.j=""}});Object.defineProperty(zd.prototype,"alpha",{get:function(){return this.G},set:function(a){"number"===typeof a&&(this.G=a)}});
Object.defineProperty(zd.prototype,"reverting",{get:function(){return this.K}});Object.defineProperty(zd.prototype,"revert",{get:function(){return this.B},set:function(a){this.B=!!a;!0!==this.B||this.m?!1===this.B&&this.m&&(this.L.viewer.tween.remove(this.m),this.m.onComplete.remove(this.yi,this),this.m.destroy(),this.m=null):(this.m=new Bb(this.L.viewer,this.L),this.m.onComplete.add(this.yi,this),this.L.viewer.tween.add(this.m))}});
Object.defineProperty(zd.prototype,"revertDuration",{get:function(){return this.R},set:function(a){"number"===typeof a&&(this.R=a)}});Object.defineProperty(zd.prototype,"revertEasing",{get:function(){return this.U},set:function(a){"function"===typeof a&&(this.U=a)}});Object.defineProperty(zd.prototype,"onStart",{get:function(){this.o||(this.o=new p(this.L));return this.o}});Object.defineProperty(zd.prototype,"onDrag",{get:function(){this.A||(this.A=new p(this.L));return this.A}});
Object.defineProperty(zd.prototype,"onStop",{get:function(){this.u||(this.u=new p(this.L));return this.u}});Object.defineProperty(zd.prototype,"onRevert",{get:function(){this.C||(this.C=new p(this.L));return this.C}});
function V(a){this.L=a;this.c=!1;this.$=Bd.DEFAULT;this.Va=null;this.pd=[];this.P=this.f=this.j=this.m=this.A=this.u=this.V=this.N=this.R=this.U=this.B=this.G=this.K=this.C=this.F=this.H=this.I=this.J=this.o=this.M=this.ba=this.S=this.ya=this.xa=this.ma=this.na=this.wa=this.va=this.W=null;l.call(this,"Pointer");this.Va=new Hammer.Manager(this.L.dom);this.Va.set({enable:!1})}V.prototype=Object.create(l.prototype);e=V.prototype;e.constructor=V;
function Cd(a,b,d,g){for(var h,k=0,q=a.pd.length;k<q;k++)if(h=a.pd[k],h.event===b&&h.an===d&&h.type===g)return k;return-1}function Dd(a,b,d,g){if(-1===Cd(a,b,d,g))if(a.pd.push({event:b,an:d,type:g}),g===W.Ra)a.L.dom.addEventListener(b,Hammer.bindFn(d,a));else if(g===W.ja)a.Va.on(b,Hammer.bindFn(d,a))}function Ed(a,b,d){return function(){var g=Cd(this,a,b,d);-1!==g&&(this.pd.splice(g,1),d===W.Ra?this.L.dom.removeEventListener(a,b):d===W.ja&&this.Va.off(a))}}e.Hi=function(a){this.M&&!0===this.c&&this.M.D(a)};
e.ei=function(a){this.o&&!0===this.c&&this.o.D(a)};e.sh=function(a){this.J&&!0===this.c&&this.J.D(a)};e.rh=function(a){this.I&&!0===this.c&&this.I.D(a)};e.nh=function(a){this.H&&!0===this.c&&this.H.D(a)};e.mh=function(a){this.F&&!0===this.c&&this.F.D(a)};e.lh=function(a){this.C&&!0===this.c&&this.C.D(a)};e.qh=function(a){this.K&&!0===this.c&&this.K.D(a)};e.ph=function(a){this.G&&!0===this.c&&this.G.D(a)};e.oh=function(a){this.B&&!0===this.c&&this.B.D(a)};e.Bi=function(a){this.U&&!0===this.c&&this.U.D(a)};
e.Ai=function(a){this.R&&!0===this.c&&this.R.D(a)};e.zi=function(a){this.N&&!0===this.c&&this.N.D(a)};e.Fi=function(a){this.V&&!0===this.c&&this.V.D(a)};e.hi=function(a){this.u&&!0===this.c&&this.u.D(a)};e.ji=function(a){this.A&&!0===this.c&&this.A.D(a)};e.ti=function(a){this.m&&!0===this.c&&this.m.D(a)};e.si=function(a){this.j&&!0===this.c&&this.j.D(a)};e.mi=function(a){this.f&&!0===this.c&&this.f.D(a)};e.th=function(a){this.P&&!0===this.c&&this.P.D(a)};
e.enable=function(){!0===N.$c&&(this.L.dom.style.pointerEvents="auto");this.Va.set({enable:!0});this.W||(this.W=new Hammer.Tap,this.Va.add(this.W));this.va||(this.va=(new Hammer.Tap({event:V.events.ud,mo:2})).recognizeWith(this.W),this.Va.add(this.va));this.wa||(this.wa=(new Hammer.Press).recognizeWith(this.W),this.Va.add(this.wa));this.na||(this.na=new Hammer.Pan,this.Va.add(this.na));this.ma||(this.ma=new Hammer.Pinch,this.Va.add(this.ma));this.xa||(this.xa=(new Hammer.Rotate).recognizeWith(this.ma),
this.Va.add(this.xa));this.ya||(this.ya=(new Hammer.Swipe).recognizeWith(this.na),this.Va.add(this.ya));this.c=!0;this.S&&this.S.D()};e.Ge=function(){!0===N.$c&&(this.L.dom.style.pointerEvents="none");this.c=!1;this.Va.set({enable:!1});this.ba&&this.ba.D()};
e.destroy=function(){this.Ge();this.ya=this.xa=this.ma=this.na=this.wa=this.va=this.W=null;this.S&&(this.S.destroy(),this.S=null);this.ba&&(this.ba.destroy(),this.ba=null);this.M&&(this.M.destroy(),this.M=null);this.o&&(this.o.destroy(),this.o=null);this.J&&(this.J.destroy(),this.J=null);this.I&&(this.I.destroy(),this.I=null);this.H&&(this.H.destroy(),this.H=null);this.F&&(this.F.destroy(),this.F=null);this.C&&(this.C.destroy(),this.C=null);this.K&&(this.K.destroy(),this.K=null);this.G&&(this.G.destroy(),
this.G=null);this.B&&(this.B.destroy(),this.B=null);this.U&&(this.U.destroy(),this.U=null);this.R&&(this.R.destroy(),this.R=null);this.N&&(this.N.destroy(),this.N=null);this.V&&(this.V.destroy(),this.V=null);this.u&&(this.u.destroy(),this.u=null);this.A&&(this.A.destroy(),this.A=null);this.m&&(this.m.destroy(),this.m=null);this.j&&(this.j.destroy(),this.j=null);this.f&&(this.f.destroy(),this.f=null);this.P&&(this.P.destroy(),this.P=null);this.L=null;l.prototype.destroy.call(this)};
Object.defineProperty(V.prototype,"enabled",{get:function(){return this.c},set:function(a){!0===!!a?this.enable():this.Ge()}});Object.defineProperty(V.prototype,"cursor",{get:function(){return this.$},set:function(a){this.L.dom.style.cursor=a;if(a!==this.L.dom.style.cursor||""===this.L.dom.style.cursor)this.L.dom.style.cursor="-webkit-"+a;this.$=a}});Object.defineProperty(V.prototype,"onEnable",{get:function(){this.S||(this.S=new p(this));return this.S}});
Object.defineProperty(V.prototype,"onDisable",{get:function(){this.ba||(this.ba=new p(this));return this.ba}});Object.defineProperty(V.prototype,"onTap",{get:function(){this.M||(this.M=new p(this.L),this.M.onDestroy.ca(Ed(V.events.pf,this.Hi,W.ja),this),Dd(this,V.events.pf,this.Hi,W.ja));return this.M}});Object.defineProperty(V.prototype,"onClick",{get:function(){return this.onTap}});
Object.defineProperty(V.prototype,"onDoubleTap",{get:function(){this.o||(this.o=new p(this.L),this.o.onDestroy.ca(Ed(V.events.ud,this.ei,W.ja),this),Dd(this,V.events.ud,this.ei,W.ja));return this.o}});Object.defineProperty(V.prototype,"onDoubleClick",{get:function(){return this.onDoubleTap}});Object.defineProperty(V.prototype,"onPressStart",{get:function(){this.J||(this.J=new p(this.L),this.J.onDestroy.ca(Ed(V.events.hf,this.sh,W.ja),this),Dd(this,V.events.hf,this.sh,W.ja));return this.J}});
Object.defineProperty(V.prototype,"onDown",{get:function(){return this.onPressStart}});Object.defineProperty(V.prototype,"onPressEnd",{get:function(){this.I||(this.I=new p(this.L),this.I.onDestroy.ca(Ed(V.events.gf,this.rh,W.ja),this),Dd(this,V.events.gf,this.rh,W.ja));return this.I}});Object.defineProperty(V.prototype,"onUp",{get:function(){return this.onPressEnd}});
Object.defineProperty(V.prototype,"onPanStart",{get:function(){this.H||(this.H=new p(this.L),this.H.onDestroy.ca(Ed(V.events.bf,this.nh,W.ja),this),Dd(this,V.events.bf,this.nh,W.ja));return this.H}});Object.defineProperty(V.prototype,"onPanMove",{get:function(){this.F||(this.F=new p(this.L),this.F.onDestroy.ca(Ed(V.events.af,this.mh,W.ja),this),Dd(this,V.events.af,this.mh,W.ja));return this.F}});
Object.defineProperty(V.prototype,"onPanEnd",{get:function(){this.C||(this.C=new p(this.L),this.C.onDestroy.ca(Ed(V.events.$e,this.lh,W.ja),this),Dd(this,V.events.$e,this.lh,W.ja));return this.C}});Object.defineProperty(V.prototype,"onPinchStart",{get:function(){this.K||(this.K=new p(this.L),this.K.onDestroy.ca(Ed(V.events.ff,this.qh,W.ja),this),Dd(this,V.events.ff,this.qh,W.ja));return this.K}});
Object.defineProperty(V.prototype,"onPinchMove",{get:function(){this.G||(this.G=new p(this.L),this.G.onDestroy.ca(Ed(V.events.ef,this.ph,W.ja),this),Dd(this,V.events.ef,this.ph,W.ja));return this.G}});Object.defineProperty(V.prototype,"onPinchEnd",{get:function(){this.B||(this.B=new p(this.L),this.B.onDestroy.ca(Ed(V.events.df,this.oh,W.ja),this),Dd(this,V.events.df,this.oh,W.ja));return this.B}});
Object.defineProperty(V.prototype,"onRotateStart",{get:function(){this.U||(this.U=new p(this.L),this.U.onDestroy.ca(Ed(V.events.lf,this.Bi,W.ja),this),Dd(this,V.events.lf,this.Bi,W.ja));return this.U}});Object.defineProperty(V.prototype,"onRotateMove",{get:function(){this.R||(this.R=new p(this.L),this.R.onDestroy.ca(Ed(V.events.kf,this.Ai,W.ja),this),Dd(this,V.events.kf,this.Ai,W.ja));return this.R}});
Object.defineProperty(V.prototype,"onRotateEnd",{get:function(){this.N||(this.N=new p(this.L),this.N.onDestroy.ca(Ed(V.events.jf,this.zi,W.ja),this),Dd(this,V.events.jf,this.zi,W.ja));return this.N}});Object.defineProperty(V.prototype,"onSwipe",{get:function(){this.V||(this.V=new p(this.L),this.V.onDestroy.ca(Ed(V.events.nf,this.Fi,W.ja),this),Dd(this,V.events.nf,this.Fi,W.ja));return this.V}});
Object.defineProperty(V.prototype,"onEnter",{get:function(){this.u||(this.u=new p(this.L),this.u.onDestroy.ca(Ed(V.events.Pe,this.hi,W.Ra),this),Dd(this,V.events.Pe,this.hi,W.Ra));return this.u}});Object.defineProperty(V.prototype,"onLeave",{get:function(){this.A||(this.A=new p(this.L),this.A.onDestroy.ca(Ed(V.events.We,this.ji,W.Ra),this),Dd(this,V.events.We,this.ji,W.Ra));return this.A}});
Object.defineProperty(V.prototype,"onOver",{get:function(){this.m||(this.m=new p(this.L),this.m.onDestroy.ca(Ed(V.events.Ze,this.ti,W.Ra),this),Dd(this,V.events.Ze,this.ti,W.Ra));return this.m}});Object.defineProperty(V.prototype,"onOut",{get:function(){this.j||(this.j=new p(this.L),this.j.onDestroy.ca(Ed(V.events.Ye,this.si,W.Ra),this),Dd(this,V.events.Ye,this.si,W.Ra));return this.j}});
Object.defineProperty(V.prototype,"onMove",{get:function(){this.f||(this.f=new p(this.L),this.f.onDestroy.ca(Ed(V.events.Xe,this.mi,W.Ra),this),Dd(this,V.events.Xe,this.mi,W.Ra));return this.f}});Object.defineProperty(V.prototype,"onWheel",{get:function(){this.P||(this.P=new p(this.L),this.P.onDestroy.ca(Ed(V.events.rf,this.th,W.Ra),this),Dd(this,V.events.rf,this.th,W.Ra));return this.P}});var W={Ra:0,ja:1};V.events={};V.events.pf="tap";V.events.ud="doubletap";V.events.hf="press";V.events.gf="pressup";
V.events.bf="panstart";V.events.af="panmove";V.events.$e="panend";V.events.ff="pinchstart";V.events.ef="pinchmove";V.events.df="pinchend";V.events.lf="rotatestart";V.events.kf="rotatemove";V.events.jf="rotateend";V.events.nf="swipe";V.events.Pe="mouseenter";V.events.We="mouseleave";V.events.Ze="mouseover";V.events.Ye="mouseout";V.events.Xe="mousemove";V.events.rf="wheel";var Bd={DEFAULT:"default",Za:"pointer",ol:"grab",pl:"grabbing"};
function ga(a){this.i=a;this.X=[];this.f=[];this.j=this.c=null;l.call(this,"DisplayList");this.c=this.Ul.bind(this);document.addEventListener("fullscreenchange",this.c,!1);document.addEventListener("mozfullscreenchange",this.c,!1);document.addEventListener("webkitfullscreenchange",this.c,!1);document.addEventListener("MSFullscreenChange",this.c,!1)}ga.prototype=Object.create(l.prototype);e=ga.prototype;e.constructor=ga;
e.Ul=function(){this.log("_fullScreenChangeHandler");if(null!==document[N.fullscreenElement])for(var a,b=this.X.length;b--;){if(a=this.X[b],a.dom===document[N.fullscreenElement]){a=this.j=a;a.log("_notifyFullscreenEnter");b=a;b.log("_fullscreenSaveData");b.U={x:b.F,y:b.H,width:b.u,unitWidth:b.C,height:b.o,unitHeight:b.A,top:b.Rb,right:b.ya,bottom:b.Ib,left:b.va};b.F=0;b.H=0;b.u=screen.width;b.C="px";b.c.style.width=b.u+"px";b.o=screen.height;b.A="px";b.c.style.height=b.o+"px";b.Rb=null;b.ya=null;
b.Ib=null;b.va=null;b.c.style.top="0";b.c.style.left="0";b.ta({property:"both"});a.Ob&&a.Ob.D();break}}else a=this.j,a.log("_notifyFullscreenChange"),a.log("_fullscreenRestoreData"),a.F=a.U.x,a.c.style.left=a.F+"px",a.H=a.U.y,a.c.style.top=a.H+"px",a.u=a.U.width,a.C=a.U.unitWidth,a.c.style.width=a.pixelWidth+"px",a.o=a.U.height,a.A=a.U.unitHeight,a.c.style.height=a.pixelHeight+"px",a.Rb=a.U.top,a.ya=a.U.right,a.Ib=a.U.bottom,a.va=a.U.left,a.ta({property:"both"}),a.U=null,a.Pb&&a.Pb.D(),this.j=null};
e.register=function(a,b){this.X.push(a);!0===b&&this.f.push(a)};e.unregister=function(a){this.X.splice(this.X.indexOf(a),1);a=this.f.indexOf(a);-1!==a&&this.f.splice(a,1)};e.update=function(){for(var a=0,b=this.f.length;a<b;a++)this.f[a].update()};
e.destroy=function(){for(var a=this.X.length;a--;)this.X[a].destroy();this.X=[];this.f=[];document.removeEventListener("fullscreenchange",this.c,!1);document.removeEventListener("mozfullscreenchange",this.c,!1);document.removeEventListener("webkitfullscreenchange",this.c,!1);document.removeEventListener("MSFullscreenChange",this.c,!1);this.j=this.c=null};var Fd="DisplayObject DisplayObjectContainer Image TextField Button Video Canvas Sprite Iframe".split(" ");
function U(a,b,d){this.i=a;this.c=b||null;this.m=null;this.ae=0;this.Oe="";this.H=this.F=0;this.Kb=!1;this.u=0;this.C="px";this.ma=1;this.o=0;this.A="px";this.na=1;this.yc=this.wc=!1;this.va=this.Ib=this.ya=this.Rb=null;this.$d=1;this.ce=0;this.vc=this.xc=null;this.Qc="";this.Sc="solid";this.N=0;this.Rc="rgb(0, 0, 0)";this.le=0;this.R=!1;this.qd="";this.hb=null;this.be=!1;this.V=!0;this.xa=null;this.ba=!1;this.Pb=this.Ob=this.Lc=this.dd=this.Lb=this.Mb=this.K=this.Nb=this.Qb=this.wa=this.U=null;l.call(this,
d||"DisplayObject");this.Ea()}U.prototype=Object.create(l.prototype);e=U.prototype;e.constructor=U;
e.Ea=function(){!0!==this.be&&("undefined"!==typeof this.c&&this.c?(this.u=ha.zj(this.c),this.C=ha.xj(this.c),this.o=ha.yj(this.c),this.A=ha.wj(this.c)):this.c=document.createElement("div"),this.c.style.width=this.u+""+this.C,this.c.style.height=this.o+""+this.A,this.c.style.display="block",this.c.style.position="relative",this.c.style.margin="0px",this.c.style.padding="0px",this.c.style.top=this.H+"px",this.c.style.left=this.F+"px",this.c.style.overflow="hidden",this.c.style.boxSizing="border-box",
!0===N.$c&&(this.c.style.pointerEvents="none"),this.c.style.O="none",this.c.style.webkitUserSelect="none",this.c.style.c="none",this.c.style.f="none",this.c.style.j="none",this.c.style.borderStyle=this.Sc,this.c.style.borderWidth=this.N+"px",this.c.style.borderColor=this.Rc,this.c.style.background=this.Qc,this.xa=[],"DisplayObject"===this.Ua&&(this.i.display.register(this),Gd(this),Hd(this)))};function Gd(a){!0!==a.be&&(a.log("_notifyReady"),a.be=!0,a.wa&&a.wa.D())}
e.Hd=function(){this.log("_notifyAddedToDom");this.Lb&&this.Lb.D()};e.hc=function(){this.log("_notifyShow");!1!==this.gd()&&this.dd&&!0===this.visible&&this.dd.D()};e.Id=function(){this.log("_notifyHide");this.Lc&&!1===this.visible&&this.Lc.D()};e.xf=function(){this.Nb&&this.Nb.D()};e.ta=function(a){Id(this);this.Qb&&this.Qb.D(a)};
function Id(a){a.m&&a.u&&a.o&&(a.log("_updateAnchors"),!0===a.wc?a.horizontalCenter=!0:(a.left=a.va,a.right=a.ya),!0===a.yc?a.verticalCenter=!0:(a.top=a.Rb,a.bottom=a.Ib))}
function Jd(a,b){var d=-1!==b.toLowerCase().indexOf("height")||"both"===b;!0===(-1!==b.toLowerCase().indexOf("width")||"both"===b)&&"%"===a.C&&(a.c.style.width=a.pixelWidth+"px",a.c.width=a.pixelWidth,a.ta({property:"width"}));!0===d&&"%"===a.A&&(a.c.style.height=a.pixelHeight+"px",a.c.height=a.pixelHeight,a.ta({property:"height"}))}function Kd(a,b,d){a.xa.push({prop:b,value:d})}
function Hd(a){a.log("_applyPending");a.V=!1;if(a.xa&&0!==a.xa.length){a.ba=!0;for(var b=0,d=a.xa.length;b<d;b++)a[a.xa[b].prop]=a.xa[b].value;a.ba=!1;a.xa=[]}}e.Tg=function(){this.c.style.display="block";this.hc()};e.Fj=function(){this.c.style.display="none";this.Id()};e.Rn=function(){this.visible=!this.visible};
e.Ab=function(a){!0===a&&(this.R=!0,!0===this.V&&Kd(this,"maximized",!0));this.m&&(this.Kb=!1,a=this.pixelWidth,this.u=this.m.innerWidth,this.C="px",this.c.style.width=this.m.innerWidth+"px",this.c.width=this.m.innerWidth,a!==this.pixelWidth&&this.ta({property:"width"}),a=this.pixelHeight,this.o=this.m.innerHeight,this.A="px",this.c.style.height=this.m.innerHeight+"px",this.c.height=this.m.innerHeight,a!==this.pixelHeight&&this.ta({property:"height"}))};e.gd=function(){return ha.has(this.c)};
e.Sg=function(a,b){null!==a&&"undefined"!==typeof a&&(this.width=a);null!==b&&"undefined"!==typeof b&&(this.height=b)};e.jj=function(){if(!0===document[N.fullscreenEnabled]&&!1===this.fd())this.c[N.requestFullscreen]()};e.kj=function(){if(!0===document[N.fullscreenEnabled]&&!0===this.fd())document[N.exitFullscreen]()};e.fd=function(){return document[N.fullscreenElement]===this.c};
e.destroy=function(){!1!==this.ib&&(this.i.display.unregister(this),this.m&&(this.m.removeChild(this,!1),this.m=null),this.xc&&(this.xc.destroy(),this.xc=null),this.vc&&(this.vc.destroy(),this.vc=null),this.Qb&&(this.Qb.destroy(),this.Qb=null),this.Nb&&(this.Nb.destroy(),this.Nb=null),this.wa&&(this.wa.destroy(),this.wa=null),this.Mb&&(this.Mb.destroy(),this.Mb=null),this.Lb&&(this.Lb.destroy(),this.Lb=null),this.Ob&&(this.Ob.destroy(),this.Ob=null),this.Pb&&(this.Pb.destroy(),this.Pb=null),this.i=
this.hb=this.c=null,l.prototype.destroy.call(this))};Object.defineProperty(U.prototype,"viewer",{get:function(){return this.i}});Object.defineProperty(U.prototype,"dom",{get:function(){return this.c}});Object.defineProperty(U.prototype,"id",{get:function(){return this.Oe},set:function(a){this.Oe=a;this.c.id=this.Oe}});Object.defineProperty(U.prototype,"ready",{get:function(){return this.be}});
Object.defineProperty(U.prototype,"parent",{get:function(){return this.m},set:function(a){"object"===typeof a&&!1!==Array.isArray(a.children)&&a!==this.m&&(this.m=a,this.c.style.position="absolute",!0===this.R&&this.Ab(this.R),Jd(this,"both"),Id(this),this.Mb&&this.Mb.D(),!0===this.m.gd()&&(this.Hd(),this.hc()))}});Object.defineProperty(U.prototype,"visible",{get:function(){return"block"===this.c.style.display},set:function(a){"boolean"===typeof a&&(!0===a?this.Tg():this.Fj())}});
Object.defineProperty(U.prototype,"x",{get:function(){return this.F},set:function(a){if("number"===typeof a){var b=this.F;this.F=a;this.c.style.left=this.F+"px";this.K&&b!==this.F&&this.K.D({property:"x"})}}});Object.defineProperty(U.prototype,"y",{get:function(){return this.H},set:function(a){if("number"===typeof a){var b=this.H;this.H=a;this.c.style.top=this.H+"px";this.K&&b!==this.H&&this.K.D({property:"y"})}}});
Object.defineProperty(U.prototype,"keepRatio",{get:function(){return this.Kb},set:function(a){"boolean"===typeof a&&a!==this.Kb&&(this.Kb=a)}});
Object.defineProperty(U.prototype,"width",{get:function(){return this.u},set:function(a){var b=this.u,d=this.C;if("string"===typeof a){var g=B.lg(a);if(null===g.value||null===g.Gc)throw"$_DisplayObject.width value "+a+" is incorrect";this.C=g.Gc;this.u=g.value}else if("number"===typeof a)this.u=a;else return;!0===this.V?Kd(this,"width",this.u):(this.R=!1,this.c.style.width=this.pixelWidth+"px",this.c.width=this.pixelWidth,b===this.u&&d===this.C&&!0!==this.ba||this.ta({property:"width"}))}});
Object.defineProperty(U.prototype,"pixelWidth",{get:function(){if("px"===this.C)return this.u;if("%"===this.C)return this.m?this.m.innerWidth*this.u/100:0},set:function(a){if("number"===typeof a){var b=this.u,d=this.C;this.u=a;this.C="px";!0===this.V?Kd(this,"pixelWidth",a):(this.R=!1,this.c.style.width=this.pixelWidth+"px",this.c.width=this.pixelWidth,b===this.u&&"px"===d&&!0!==this.ba||this.ta({property:"pixelWidth"}))}}});
Object.defineProperty(U.prototype,"percentWidth",{get:function(){if("%"===this.C)return this.u;if("px"===this.C)return this.m?this.u/this.m.innerWidth*100:0},set:function(a){if("number"===typeof a){var b=this.u,d=this.C;this.u=a;this.C="%";!0===this.V?Kd(this,"percentWidth",a):(this.R=!1,this.c.style.width=this.pixelWidth+"px",this.c.width=this.pixelWidth,b===this.u&&"%"===d&&!0!==this.ba||this.ta({property:"percentWidth"}))}}});
Object.defineProperty(U.prototype,"unitWidth",{get:function(){return this.C},set:function(a){if("string"===typeof a&&("px"===a||"%"===a)){var b=this.C;this.C=a;!0===this.V?Kd(this,"unitWidth",a):(this.R=!1,this.c.style.width=this.pixelWidth+"px",this.c.width=this.pixelWidth,b===this.C&&!0!==this.ba||this.ta({property:"unitWidth"}))}}});Object.defineProperty(U.prototype,"innerWidth",{get:function(){return this.pixelWidth-2*this.N}});
Object.defineProperty(U.prototype,"height",{get:function(){return this.o},set:function(a){var b=this.o,d=this.A;if("string"===typeof a){var g=B.lg(a);if(null===g.value||null===g.Gc)throw"$_DisplayObject.height value "+a+" is incorrect";this.A=g.Gc;this.o=g.value}else if("number"===typeof a)this.o=a;else return;!0===this.V?Kd(this,"height",this.o):(this.R=!1,this.c.style.height=this.pixelHeight+"px",this.c.height=this.pixelHeight,b===this.o&&d===this.A&&!0!==this.ba||this.ta({property:"height"}))}});
Object.defineProperty(U.prototype,"pixelHeight",{get:function(){if("px"===this.A)return this.o;if("%"===this.A)return this.m?this.m.innerHeight*this.o/100:0},set:function(a){if("number"===typeof a){var b=this.o,d=this.A;this.o=a;this.A="px";!0===this.V?Kd(this,"pixelHeight",a):(this.R=!1,this.c.style.height=this.pixelHeight+"px",this.c.height=this.pixelHeight,b===this.o&&"px"===d&&!0!==this.ba||this.ta({property:"pixelHeight"}))}}});
Object.defineProperty(U.prototype,"percentHeight",{get:function(){if("%"===this.A)return this.o;if("px"===this.A)return this.m?this.o/this.m.innerHeight*100:0},set:function(a){if("number"===typeof a){var b=this.o,d=this.A;this.o=a;this.A="%";!0===this.V?Kd(this,"percentHeight",a):(this.R=!1,this.c.style.height=this.pixelHeight+"px",this.c.height=this.pixelHeight,b===this.o&&"%"===d&&!0!==this.ba||this.ta({property:"percentHeight"}))}}});
Object.defineProperty(U.prototype,"unitHeight",{get:function(){return this.A},set:function(a){if("string"===typeof a){var b=this.A;this.A=a;!0===this.V?Kd(this,"unitHeight",a):(this.R=!1,this.c.style.height=this.pixelHeight+"px",this.c.height=this.pixelHeight,b===this.A&&!0!==this.ba||this.ta({property:"unitHeight"}))}}});Object.defineProperty(U.prototype,"innerHeight",{get:function(){return this.pixelHeight-2*this.N}});
Object.defineProperty(U.prototype,"maximized",{get:function(){return this.R},set:function(a){"boolean"===typeof a&&(this.R=a,!0===this.R&&this.Ab(!0))}});Object.defineProperty(U.prototype,"horizontalCenter",{get:function(){return this.wc},set:function(a){"boolean"===typeof a&&(this.wc=a,!0===this.wc&&(this.ya=this.va=null),this.m&&(a=this.F,this.F=(this.m.innerWidth-this.pixelWidth)/2,this.c.style.left=this.F+"px",this.K&&a!==this.F&&this.K.D({property:"x"})))}});
Object.defineProperty(U.prototype,"verticalCenter",{get:function(){return this.yc},set:function(a){"boolean"===typeof a&&(this.yc=a,!0===this.yc&&(this.Ib=this.Rb=null),this.m&&(a=this.H,this.H=(this.m.innerHeight-this.pixelHeight)/2,this.c.style.top=this.H+"px",this.K&&a!==this.H&&this.K.D({property:"y"})))}});
Object.defineProperty(U.prototype,"top",{get:function(){return this.Rb},set:function(a){if("number"===typeof a||null===a)if(this.Rb=a,this.yc=!1,this.m&&null!==this.Rb){var b=this.H;this.H=a;this.c.style.top=this.H+"px";this.K&&b!==this.H&&this.K.D({property:"y"})}}});
Object.defineProperty(U.prototype,"right",{get:function(){return this.ya},set:function(a){if("number"===typeof a||null===a)if(this.ya=a,this.wc=!1,this.m&&null!==this.ya){var b=this.F;this.F=this.m.innerWidth-this.pixelWidth-a;this.c.style.left=this.F+"px";this.K&&b!==this.F&&this.K.D({property:"x"})}}});
Object.defineProperty(U.prototype,"bottom",{get:function(){return this.Ib},set:function(a){if("number"===typeof a||null===a)if(this.Ib=a,this.yc=!1,this.m&&null!==this.Ib){var b=this.H;this.H=this.m.innerHeight-this.pixelHeight-a;this.c.style.top=this.H+"px";this.K&&b!==this.H&&this.K.D({property:"y"})}}});
Object.defineProperty(U.prototype,"left",{get:function(){return this.va},set:function(a){if("number"===typeof a||null===a)if(this.va=a,this.wc=!1,this.m&&null!==this.va){var b=this.F;this.F=a;this.c.style.left=this.F+"px";this.K&&b!==this.F&&this.K.D({property:"x"})}}});Object.defineProperty(U.prototype,"alpha",{get:function(){return this.$d},set:function(a){"number"===typeof a&&a!==this.$d&&(this.$d=a,this.c.style.opacity=this.$d)}});
Object.defineProperty(U.prototype,"rotation",{get:function(){return this.ce},set:function(a){"number"===typeof a&&a!==this.ce&&(this.ce=a,this.c.style.transform="rotate("+this.ce+"deg)")}});Object.defineProperty(U.prototype,"background",{get:function(){return this.Qc},set:function(a){"string"===typeof a&&a!==this.Qc&&(this.Qc=a,this.c.style.background=this.Qc)}});
Object.defineProperty(U.prototype,"borderStyle",{get:function(){return this.Sc},set:function(a){-1!=="none dotted dashed solid double groove ridge inset outset".split(" ").indexOf(a)&&a!==this.Sc&&(this.Sc=a,!0===this.V?Kd(this,"borderStyle",a):this.c.style.borderStyle=this.Sc)}});
Object.defineProperty(U.prototype,"borderWidth",{get:function(){return this.N},set:function(a){if("number"===typeof a){var b=this.N;this.N=a;!0===this.V?Kd(this,"borderWidth",a):(this.c.style.borderWidth=this.N+"px",b===this.N&&!0!==this.ba||this.xf())}}});Object.defineProperty(U.prototype,"borderColor",{get:function(){return this.Rc},set:function(a){"string"===typeof a&&a!==this.Rc&&(this.Rc=a,this.c.style.borderColor=this.Rc)}});
Object.defineProperty(U.prototype,"borderRadius",{get:function(){return this.le},set:function(a){"number"!==typeof a&&"string"!==typeof a||a===this.le||("string"===typeof a&&(a=parseInt(a,10)),isNaN(a)||(this.le=a,this.c.style.borderRadius=this.le+"px"))}});Object.defineProperty(U.prototype,"globalOffset",{get:function(){var a=this.c,b=0,d=0;do b+=a.offsetTop||0,d+=a.offsetLeft||0,a=a.offsetParent;while(a);return{top:b,left:d}}});
Object.defineProperty(U.prototype,"tooltip",{get:function(){return this.qd},set:function(a){"string"===typeof a&&a!==this.qd&&(this.qd=a,this.c.title=this.qd)}});Object.defineProperty(U.prototype,"index",{get:function(){return this.ae},set:function(a){"number"===typeof a&&a!==this.ae&&(this.ae=a,this.c.style.zIndex=this.ae)}});Object.defineProperty(U.prototype,"fullscreen",{set:function(a){"boolean"===typeof a&&(!0===a?this.jj():this.kj())}});
Object.defineProperty(U.prototype,"pointer",{get:function(){this.xc||(this.xc=new V(this));return this.xc}});Object.defineProperty(U.prototype,"drag",{get:function(){this.vc||(this.vc=new zd(this));return this.vc}});Object.defineProperty(U.prototype,"onResize",{get:function(){this.Qb||(this.Qb=new p(this));return this.Qb}});Object.defineProperty(U.prototype,"onBorderResize",{get:function(){this.Nb||(this.Nb=new p(this));return this.Nb}});
Object.defineProperty(U.prototype,"onMove",{get:function(){this.K||(this.K=new p(this));return this.K}});Object.defineProperty(U.prototype,"onReady",{get:function(){this.wa||(this.wa=new p(this,!0));return this.wa}});Object.defineProperty(U.prototype,"onAddedToParent",{get:function(){this.Mb||(this.Mb=new p(this));return this.Mb}});Object.defineProperty(U.prototype,"onAddedToDom",{get:function(){this.Lb||(this.Lb=new p(this));return this.Lb}});
Object.defineProperty(U.prototype,"onShow",{get:function(){this.dd||(this.dd=new p(this));return this.dd}});Object.defineProperty(U.prototype,"onHide",{get:function(){this.Lc||(this.Lc=new p(this));return this.Lc}});Object.defineProperty(U.prototype,"onFullscreenEnter",{get:function(){this.Ob||(this.Ob=new p(this));return this.Ob}});Object.defineProperty(U.prototype,"onFullscreenExit",{get:function(){this.Pb||(this.Pb=new p(this));return this.Pb}});
function t(a,b,d,g){this.f=[];this.M="undefined"!==typeof g?g:null;this.B=null;this.vf=!1;this.fa="hidden";U.call(this,a,b,d||"DisplayObjectContainer")}t.prototype=Object.create(U.prototype);e=t.prototype;e.constructor=t;
e.Ea=function(){U.prototype.Ea.call(this);if("DisplayObjectContainer"===this.Ua){var a=!!this.M;!0===a&&(this.B={originalWidth:this.M.clientWidth,originalHeight:this.M.clientHeight,currentWidth:this.M.clientWidth,currentHeight:this.M.clientHeight,scaleWidth:1,scaleHeight:1,frameCount:0,frameInterval:10},this.u=this.B.currentWidth,this.c.style.width=this.pixelWidth+"px",this.o=this.B.currentHeight,this.c.style.height=this.pixelHeight+"px",this.c.style.position="absolute",this.M.appendChild(this.c));
this.i.display.register(this,a);Gd(this);Hd(this)}};e.ta=function(a){for(var b=0,d=this.f.length;b<d;b++){var g=this.f[b],h=a;!0===g.R&&g.Ab(g.R);Jd(g,h.property);Id(g)}U.prototype.ta.call(this,a)};e.Hd=function(){U.prototype.Hd.call(this);for(var a=0,b=this.f.length;a<b;a++)this.f[a].Hd()};e.hc=function(){U.prototype.hc.call(this);for(var a=0,b=this.f.length;a<b;a++)this.f[a].hc()};e.Id=function(){U.prototype.Id.call(this);for(var a=0,b=this.f.length;a<b;a++)this.f[a].Id()};
function Ld(a,b){if(!a.f)return-1;for(var d=0,g=a.f.length;d<g;d++)if(a.f[d]===b)return d;return-1}
e.update=function(){this.B.frameCount++;if(!(this.B.frameCount<this.B.frameInterval)){this.B.frameCount=0;var a=this.M.clientWidth,b=this.M.clientHeight,d=!1;a!==this.B.currentWidth&&(this.B.currentWidth=a,this.B.scaleWidth=this.B.currentWidth/this.B.originalWidth,d=!0);b!==this.B.currentHeight&&(this.B.currentHeight=b,this.B.scaleHeight=this.B.currentHeight/this.B.scaleHeight,d=!0);!0===d&&this.Sg(this.B.currentWidth,this.B.currentHeight)}};
e.Wb=function(a){if(a===this)throw"You can't add a $_DisplayObjectContainer to itself!";var b=a;a instanceof Element&&(b=new U(a));this.c.appendChild(b.dom);b.parent=this;a=this.f.push(b)-1;null===b.index&&(b.index=a)};e.Ym=function(a,b){var d=a;a instanceof Element&&(d=new U(a));this.c.appendChild(d.dom);d.parent=this;this.f.splice(b,0,d);d.index=b;b=0;for(d=this.f.length;b<d;b++)a=this.f[b],a.index=b};
e.ij=function(){var a=this.f;if(0<a.length){this.vf=!0;for(var b=0,d=a.length;b<d;b++)if(!0===a[b].gd()&&!0===a[b].visible){var g=Math.max(a[b].width+a[b].x,a[b].width+a[b].left,a[b].width+a[b].right),h=Math.max(a[b].height+a[b].y,a[b].height+a[b].top,a[b].height+a[b].bottom);g>this.pixelWidth&&(this.width=g);h>this.pixelHeight&&(this.height=h)}}null!==this.parent&&!0===B.T(this.parent,"DisplayObjectContainer")&&!0===this.parent.vf&&this.parent.ij()};
e.removeChild=function(a,b){a=Ld(this,a);-1!==a&&this.mg(a,b)};e.mg=function(a,b){if(0<=a&&a<this.f.length){var d=this.f[a];this.f.splice(a,1);this.c.removeChild(d.dom);"undefined"!==typeof b&&!0!==b||d.destroy();!0!==this.vf||this.f.length||(this.height=this.width=0)}};e.Rg=function(a){for(var b=this.f.length;b--;)this.mg(b,a)};e.tk=function(a){return-1!==Ld(this,a)};e.destroy=function(){this.Rg(!1);this.B=this.M=this.f=null;U.prototype.destroy.call(this)};
Object.defineProperty(t.prototype,"children",{get:function(){return this.f}});Object.defineProperty(t.prototype,"overflow",{get:function(){return this.fa},set:function(a){-1!==["hidden","visible","scroll"].indexOf(a)&&(this.fa=a,this.c.style.overflow=a)}});
function I(a,b,d){this.ra=b||null;this.ia=this.M="";this.fa=!1;this.ga=this.sa="";this.B=this.W=null;this.$=!1;this.ea=this.f=null;this.la="";this.P=this.ka=!1;this.pa=this.qa=!0;this.G=Md;this.J=this.S=this.j=null;U.call(this,a,null,d||"Image")}I.prototype=Object.create(U.prototype);I.prototype.constructor=I;var Nd={CSS:"css",Jb:"canvas"},Md=Nd.CSS;e=I.prototype;
e.Ea=function(){U.prototype.Ea.call(this);this.Kb=!0;this.G===Nd.CSS?this.c.style.backgroundRepeat="no-repeat":this.G===Nd.Jb&&(this.j=document.createElement("canvas"),this.j.style.position="absolute",this.j.style.top="0px",this.j.style.left="0px",this.c.appendChild(this.j));null!==this.ra&&this.load(this.ra);this.i.display.register(this);Gd(this)};
e.ta=function(a){var b=a.property;-1!==b.toLowerCase().indexOf("width")&&"autoWidth"!==b&&(this.qa=!1);-1!==b.toLowerCase().indexOf("height")&&"autoHeight"!==b&&(this.pa=!1);this.B&&(this.G===Nd.CSS?(Od(this),Pd(this)):this.G===Nd.Jb&&this.f&&this.Xc(this.f),!0===this.Kb&&(-1!==b.toLowerCase().indexOf("width")?(b=this.pixelWidth/this.f.w,b!==this.ma&&(this.ma=b,!0===this.Kb&&(this.na=b,this.height=this.f.h*this.na))):-1!==b.toLowerCase().indexOf("height")&&(b=this.pixelHeight/this.f.h,b!==this.na&&
(this.na=b,!0===this.Kb&&(this.ma=b,this.width=this.f.w*this.ma)))),U.prototype.ta.call(this,a))};e.xf=function(){this.G===Nd.CSS?this.c.style.backgroundPosition=-this.N+"px "+-this.N+"px":this.G===Nd.Jb&&(this.j.style.top=-this.N+"px",this.j.style.left=-this.N+"px");U.prototype.xf.call(this)};e.Be=function(){var a=this.M+"_"+this.i.i18n.locale;if(a!==this.sa&&(this.sa=a,!0===this.i.i18n.vb(this.ga))){var b=this.W.value;this.P=!1;this.i.load.image(a,b,this.Gd,this)}};
function Qd(a,b){a.f=b;!0===a.qa&&(a.u=a.f.w,a.C="px",a.c.style.width=a.pixelWidth+"px");!0===a.pa&&(a.o=a.f.h,a.A="px",a.c.style.height=a.pixelHeight+"px");a.G===Nd.CSS?(Od(a),Pd(a)):a.G===Nd.Jb&&a.Xc(a.f)}e.Xc=function(a){if(this.B&&!1!==this.$){this.j.width=this.innerWidth;this.j.height=this.innerHeight;var b=this.j.getContext("2d");b.clearRect(0,0,this.innerWidth,this.innerHeight);b.drawImage(this.B,a.x,a.y,a.w,a.h,0,0,this.innerWidth,this.innerHeight)}};
function Od(a){a.c.style.backgroundSize=a.pixelWidth/a.f.w*a.B.naturalWidth+"px "+a.pixelHeight/a.f.h*a.B.naturalHeight+"px"}function Pd(a){a.c.style.backgroundPosition=a.pixelWidth/a.f.w*(-a.f.x-a.N)+"px "+a.pixelHeight/a.f.h*(-a.f.y-a.N)+"px"}e.Gd=function(a){!1!==this.ib&&(this.B=a.data,this.G===Nd.CSS&&(this.c.style.backgroundImage="url('"+a.url+"')"),this.$=!0,Rd(this))};
e.bm=function(a){"undefined"!==typeof a.data.frames?this.ea=a.data.frames:this.warn("No frames found in file!");this.ka=!0;Rd(this)};function Rd(a){if(!0!==a.P&&!0===a.$&&!0===a.ka){a.P=!0;var b;a.f?b=a.f:a.ea?b=a.ea[0].frame:b={x:0,y:0,w:a.B.naturalWidth,h:a.B.naturalHeight};Qd(a,b);Id(a);Hd(a);a.J&&a.J.D()}}
e.load=function(a){this.ka=this.$=this.P=!1;"object"===typeof a&&a?(this.M=a.key||"",this.fa=a.i18n||!1,!0===this.fa?(this.ia="",this.ga=a.url):this.ia=a.url,this.f=a.frame||null,"string"===typeof a.frames?this.la=a.frames:"object"===typeof a.frames&&null!==a.frames&&(this.ea=a.frames),this.alpha=a.alpha,this.keepRatio=a.keepRatio,this.maximized=a.maximized,this.width=a.width,this.height=a.height):(this.ia=this.M="",this.fa=!1,"string"===typeof a&&(this.ia=a));a=this.M;var b=this.ia;if(!0===this.fa&&
"string"===typeof this.ga){this.W=new za(this.i,this.ga);!1===this.i.i18n.onLocaleChangeComplete.has(this.Be,this)&&this.i.i18n.onLocaleChangeComplete.add(this.Be,this);var d=this.i.i18n.locale;""!==d&&(a=this.M+"_"+d);!0===this.i.i18n.vb(this.ga)&&(b=this.W.value)}""!==b?(this.P=!1,this.i.load.image(a,b,this.Gd,this)):this.$=!0;"string"===typeof this.la&&""!==this.la?(a=this.la,this.P=!1,this.i.load.json(this.M+"-frames",a,this.bm,this)):this.ka=!0};
e.re=function(){this.c.style.backgroundImage="";this.B=null};e.destroy=function(a){if(!1!==this.ib){this.W&&(this.W.destroy(),this.W=null,this.i.i18n.onLocaleChangeComplete.remove(this.Be,this));this.S&&(this.S.destroy(),this.S=null);this.J&&(this.J.destroy(),this.J=null);this.B=null;if("undefined"===typeof a||!0===a)if(!0===this.fa){a=this.i.i18n.locales;for(var b,d=0,g=a.length;d<g;d++)b=this.M+"_"+a[d],this.i.cache.remove(A.IMAGE,b)}else this.i.cache.remove(A.IMAGE,this.M);U.prototype.destroy.call(this)}};
Object.defineProperty(I.prototype,"loaded",{get:function(){return this.P}});Object.defineProperty(I.prototype,"element",{get:function(){return this.B}});Object.defineProperty(I.prototype,"frame",{get:function(){return this.f},set:function(a){Qd(this,a)}});Object.defineProperty(I.prototype,"frames",{get:function(){return this.ea}});Object.defineProperty(I.prototype,"originalWidth",{get:function(){if(this.B)return this.B.naturalWidth}});Object.defineProperty(I.prototype,"originalHeight",{get:function(){if(this.B)return this.B.naturalHeight}});
Object.defineProperty(I.prototype,"onLoadStart",{get:function(){this.S||(this.S=new p(this));return this.S}});Object.defineProperty(I.prototype,"onLoadComplete",{get:function(){this.J||(this.J=new p(this));return this.J}});function hc(a,b){this.na=this.ma=1;this.I=null;I.call(this,a,b,"ImageScalable");this.Ea()}hc.prototype=Object.create(I.prototype);e=hc.prototype;e.constructor=hc;e.Ea=function(){this.warn(this.Ua+" test both render modes");this.G=Nd.Jb;I.prototype.Ea.call(this)};
e.Gd=function(a){var b=a.data;this.I=new Ia(b.naturalWidth,b.naturalHeight);I.prototype.Gd.call(this,a)};
e.Xc=function(a){this.log(a);this.G!==Nd.Jb?this.warn("Invalid render mode for "+this.Ua):this.B&&!1!==this.$&&(this.u=this.j.width=this.I.width*this.ma,this.c.style.width=this.j.width+"px",this.o=this.j.height=this.I.height*this.na,this.c.style.height=this.j.height+"px",a=this.j.getContext("2d"),a.clearRect(0,0,this.j.width,this.j.height),a.drawImage(this.B,0,0,this.I.width,this.I.height,0,0,this.j.width,this.j.height))};e.destroy=function(){this.I=null;I.prototype.destroy.call(this)};
Object.defineProperty(hc.prototype,"scaleWidth",{get:function(){return this.ma},set:function(a){a=Math.max(Number.EPSILON,a);this.ma!==a&&(this.ma=a,this.Xc(this.frame))}});Object.defineProperty(hc.prototype,"scaleHeight",{get:function(){return this.na},set:function(a){a=Math.max(Number.EPSILON,a);this.na!==a&&(this.na=a,this.Xc(this.frame))}});function ld(a,b){this.I=null;I.call(this,a,b,"Sprite")}ld.prototype=Object.create(I.prototype);e=ld.prototype;e.constructor=ld;
e.Ea=function(){this.G=Nd.Jb;I.prototype.Ea.call(this);this.I=new Sd(this);this.i.display.register(this,!0)};e.play=function(a,b,d){this.I.play(a,b,d)};e.pause=function(a){this.I.pause(a)};e.resume=function(a){this.I.resume(a)};e.stop=function(){this.I.stop()};e.update=function(){this.I.update()};e.destroy=function(){!1!==this.ib&&(this.I.destroy(),this.I=null,I.prototype.destroy.call(this))};Object.defineProperty(ld.prototype,"animations",{get:function(){return this.I}});
Object.defineProperty(ld.prototype,"animation",{get:function(){return this.I.currentAnimation}});function Td(a,b){this.f=null;this.W=b||null;this.j="";this.M=!1;this.B="";this.S=this.J=null;this.P=!1;this.G=this.I=null;U.call(this,a,null,"Iframe")}Td.prototype=Object.create(U.prototype);e=Td.prototype;e.constructor=Td;
e.Ea=function(){U.prototype.Ea.call(this);this.S=this.$l.bind(this);this.f=document.createElement("iframe");this.f.style.width="100%";this.f.style.height="100%";this.f.style.border=0;this.f.style.overflow="hidden";this.f.addEventListener("load",this.S,!!this&&!!this);this.f.setAttribute("allowFullScreen","");this.c.appendChild(this.f);null!==this.W&&this.load(this.W);this.i.display.register(this);Gd(this);Hd(this)};
e.Ae=function(){this.log("_localeChangeComplete");!0===this.i.i18n.vb(this.B)&&Ud(this,this.J.value)};function Ud(a,b){a.log("_loadIframe url: "+b);a.P=!1;a.I&&a.I.D();a.j=b;a.f.src=a.j}e.$l=function(){""!==this.j&&(this.log("_loadCompleteHandler url: "+this.j),this.P=!0,this.G&&this.G.D())};function Vd(a){!1===a.i.i18n.onLocaleChangeComplete.has(a.Ae,a)&&a.i.i18n.onLocaleChangeComplete.add(a.Ae,a)}
e.load=function(a){"object"===typeof a&&a?(this.M=a.i18n||!1,!0===this.M?(this.j="",this.B=a.url):this.j=a.url):(this.M=!1,this.j="","string"===typeof a&&(this.j=a));var b;!0===this.M&&"string"===typeof this.B&&""!==this.B?(this.J=new za(this.i,this.B),Vd(this),b=this.J.value):"string"===typeof this.j&&""!==this.j&&(b=this.j);"undefined"!==typeof b&&Ud(this,b)};
e.destroy=function(){!1!==this.ib&&(this.J&&(this.J.destroy(),this.J=null,this.i.i18n.onLocaleChangeComplete.remove(this.Ae,this)),this.I&&(this.I.destroy(),this.I=null),this.G&&(this.G.destroy(),this.G=null),this.S=this.f=null,U.prototype.destroy.call(this))};
Object.defineProperty(Td.prototype,"i18nUrl",{get:function(){return this.B},set:function(a){if("string"===typeof a){this.M=!0;this.B=a;var b;""!==this.B&&(this.J=new za(this.i,this.B),Vd(this),b=this.J.value);"undefined"!==typeof b&&Ud(this,b)}}});Object.defineProperty(Td.prototype,"url",{get:function(){return this.j},set:function(a){"string"===typeof a&&(this.M=!1,Ud(this,a))}});Object.defineProperty(Td.prototype,"loaded",{get:function(){return this.P}});
Object.defineProperty(Td.prototype,"onLoadStart",{get:function(){this.I||(this.I=new p(this));return this.I}});Object.defineProperty(Td.prototype,"onLoadComplete",{get:function(){this.G||(this.G=new p(this));return this.G}});
function T(a,b){this.fa=b;this.G="";this.j=!1;this.I=null;this.W="";this.ea="rgb(0, 0, 0)";this.P=this.S=!0;this.Ca=0;this.M=this.Da=!1;this.$=null;this.Pa=!1;this.Ba=this.za=this.Aa=this.sa=this.ra=this.qa=this.pa=this.Oa=this.Ka=this.Ma=this.La=this.Ja=this.Ha="";this.ia=this.ka=this.la=this.f=this.Fa=null;this.ga=!1;this.B=this.J=null;U.call(this,a,null,"TextField")}T.prototype=Object.create(U.prototype);e=T.prototype;e.constructor=T;
e.Ea=function(){U.prototype.Ea.call(this);this.la=this.Ol.bind(this);this.ka=this.yl.bind(this);this.ia=this.xl.bind(this);this.Fa=document.createElement("span");this.c.appendChild(this.Fa);"undefined"!==typeof this.fa&&null!==this.fa&&this.load(this.fa);this.i.display.register(this);Gd(this);Hd(this)};
e.ta=function(a){var b=a.property;-1!==b.toLowerCase().indexOf("width")&&"autoWidth"!==b&&(this.S=!1);-1!==b.toLowerCase().indexOf("height")&&"autoHeight"!==b&&(this.P=!1);U.prototype.ta.call(this,a)};e.hc=function(){Wd(this);U.prototype.hc.call(this)};function Xd(a,b){b!==a.W&&(a.W=String(b),a.Fa.innerHTML=b,Wd(a),Id(a),a.J&&a.J.D());if(!1===a.j||!0===a.j&&!0===a.I.loaded)a.ga=!0,a.B&&a.B.D()}
function Wd(a){if(!1!==a.gd()){if(!0===a.S){var b=a.pixelWidth;a.c.style.width="";var d=a.c.offsetWidth;0<d&&(d+=1);a.u=d;a.C="px";a.c.style.width=a.u+"px";b!==a.u&&a.ta({property:"autoWidth"})}!0===a.P&&(b=a.pixelHeight,a.c.style.height="",d=a.c.offsetHeight,0<d&&(d+=1),a.o=d,a.A="px",a.c.style.height=a.o+"px",b!==a.o&&a.ta({property:"autoHeight"}))}}function Yd(a){a.I||(a.I=new za(a.i,a.G));Xd(a,a.I.value)}
function Zd(a){!1===a.i.i18n.onLocaleChangeComplete.has(a.Je,a)&&a.i.i18n.onLocaleChangeComplete.add(a.Je,a)}e.Je=function(){this.log("_localeChangeComplete");!0===this.i.i18n.vb(this.G)&&(this.value=this.I.value)};
e.Ol=function(){!0!==this.M||this.f||(this.f=document.createElement("textarea"),this.f.style.position="absolute",this.f.style.top="0px",this.f.style.left="0px",this.f.style.width="100%",this.f.style.height="100%",this.f.style.resize="none",this.f.style.margin="0px",this.f.style.padding="0px",this.f.style.overflowX="hidden",this.f.style.overflowY="auto",this.f.style.boxSizing="border-box",this.f.value=this.W,this.f.addEventListener("input",this.ka,!1),this.f.addEventListener("blur",this.ia,!1),this.c.appendChild(this.f),
this.f.focus())};e.yl=function(){Xd(this,this.f.value)};e.xl=function(){this.tf()};e.tf=function(){this.f&&(this.f.removeEventListener("input",this.ka,!1),this.f.removeEventListener("blur",this.ia,!1),this.c.removeChild(this.f),this.f=null)};
e.load=function(a){this.ga=!1;"object"===typeof a&&a?(a.color&&(this.color=a.color),a.font&&(this.font=a.font),a.fontFamily&&(this.fontFamily=a.fontFamily),a.fontWeight&&(this.fontWeight=a.fontWeight),a.fontSize&&(this.fontSize=a.fontSize),a.fontStyle&&(this.fontStyle=a.fontStyle),a.fontVariant&&(this.fontVariant=a.fontVariant),a.textAlign&&(this.textAlign=a.textAlign),a.textShadow&&(this.textShadow=a.textShadow),a.textDecoration&&(this.textDecoration=a.textDecoration),a.textOverflow&&(this.textOverflow=
a.textOverflow),a.textTransform&&(this.textTransform=a.textTransform),a.whiteSpace&&(this.whiteSpace=a.whiteSpace),a.wordWrap&&(this.wordWrap=a.wordWrap),a.lineHeight&&(this.lineHeight=a.lineHeight),a.autoWidth&&(this.autoWidth=a.autoWidth),a.autoHeight&&(this.autoHeight=a.autoHeight),a.padding&&(this.padding=a.padding),a.selectable&&(this.selectable=a.selectable),a.editable&&(this.editable=a.editable),this.j=a.i18n||!1,!0===this.j?this.G=a.value:this.value=a.value):"string"===typeof a&&(this.j=!1,
this.value=a);!0===this.j&&"string"===typeof this.G&&""!==this.G&&(Yd(this),Zd(this))};e.destroy=function(){!1!==this.ib&&(this.I&&(this.I.destroy(),this.I=null,this.i.i18n.onLocaleChangeComplete.remove(this.Je,this)),this.tf(),this.B&&(this.B.destroy(),this.B=null),this.J&&(this.J.destroy(),this.J=null),U.prototype.destroy.call(this))};Object.defineProperty(T.prototype,"i18nValue",{get:function(){return this.G},set:function(a){"string"===typeof a&&(""===this.G&&Zd(this),this.j=!0,this.G=a,Yd(this))}});
Object.defineProperty(T.prototype,"i18n",{get:function(){return this.j}});Object.defineProperty(T.prototype,"value",{get:function(){return this.W},set:function(a){if("string"===typeof a||"number"===typeof a)this.j=!1,Xd(this,a)}});Object.defineProperty(T.prototype,"color",{get:function(){return this.ea},set:function(a){"string"===typeof a&&(this.ea=a,this.c.style.color=this.ea)}});
Object.defineProperty(T.prototype,"font",{get:function(){return this.pa},set:function(a){"string"!==typeof a||2>a.split(" ").toString().length||(this.pa=a.replace(/"/g,'"'),this.c.style.font=this.pa)}});Object.defineProperty(T.prototype,"fontFamily",{get:function(){return this.qa},set:function(a){"string"===typeof a&&(this.qa=a.replace(/"/g,'"'),this.c.style.fontFamily=this.qa,Wd(this))}});
Object.defineProperty(T.prototype,"fontSize",{get:function(){return this.ra},set:function(a){if("number"===typeof a||"string"===typeof a)"number"===typeof a&&(a+="px"),this.ra=a,this.c.style.fontSize=this.ra}});Object.defineProperty(T.prototype,"fontStyle",{get:function(){return this.sa},set:function(a){"string"===typeof a&&(this.sa=a,this.c.style.fontStyle=this.sa)}});
Object.defineProperty(T.prototype,"fontWeight",{get:function(){return this.Aa},set:function(a){"string"===typeof a&&"number"===typeof a&&(this.Aa=a,this.c.style.fontWeight=this.Aa)}});Object.defineProperty(T.prototype,"fontVariant",{get:function(){return this.za},set:function(a){"string"===typeof a&&(this.za=a,this.c.style.fontVariant=this.za)}});
Object.defineProperty(T.prototype,"lineHeight",{get:function(){return this.Ba},set:function(a){if("number"===typeof a||"string"===typeof a)"number"===typeof a&&(a+="px"),this.Ba=a,this.c.style.lineHeight=this.Ba}});Object.defineProperty(T.prototype,"textAlign",{get:function(){return this.Ha},set:function(a){"string"===typeof a&&(this.Ha=a,this.c.style.textAlign=this.Ha)}});
Object.defineProperty(T.prototype,"textShadow",{get:function(){return this.La},set:function(a){"string"===typeof a&&(this.La=a,this.c.style.textShadow=this.La)}});Object.defineProperty(T.prototype,"textDecoration",{get:function(){return this.Ja},set:function(a){"string"===typeof a&&(this.Ja=a,this.c.style.textDecoration=this.Ja)}});Object.defineProperty(T.prototype,"textTransform",{get:function(){return this.Ma},set:function(a){"string"===typeof a&&(this.Ma=a,this.c.style.textTransform=this.Ma)}});
Object.defineProperty(T.prototype,"autoWidth",{get:function(){return this.S},set:function(a){"boolean"===typeof a&&(this.S=a,Wd(this))}});Object.defineProperty(T.prototype,"autoHeight",{get:function(){return this.P},set:function(a){"boolean"===typeof a&&(this.P=a,Wd(this))}});
Object.defineProperty(T.prototype,"padding",{get:function(){return this.Ca},set:function(a){if("number"===typeof a||"string"===typeof a)this.Ca=a="string"===typeof a?a.split(" ",4).toString().replace(/,/g," "):a+"px",this.c.style.padding=this.Ca}});
Object.defineProperty(T.prototype,"selectable",{get:function(){return this.Da},set:function(a){"boolean"===typeof a&&(this.Da=a,!1===this.Da?(!1===this.M&&!0===this.Sa&&(this.Sa=this.pointer.enabled=!1),this.c.style.O="none",this.c.style.webkitUserSelect="none",this.c.style.c="none",this.c.style.f="none",this.c.style.j="none"):(!1===this.pointer.enabled&&(this.Sa=this.pointer.enabled=!0),this.c.style.O="text",this.c.style.webkitUserSelect="text",this.c.style.c="text",this.c.style.f="text",this.c.style.j=
"inherit"))}});Object.defineProperty(T.prototype,"wordWrap",{get:function(){return this.Pa},set:function(a){"boolean"===typeof a&&(this.Pa=a,this.c.style.wordWrap=!1===this.Pa?"normal":"break-word")}});Object.defineProperty(T.prototype,"whiteSpace",{get:function(){return this.Oa},set:function(a){"string"===typeof a&&(this.Oa=a,this.c.style.whiteSpace=this.Oa)}});
Object.defineProperty(T.prototype,"textOverflow",{get:function(){return this.Ka},set:function(a){"string"===typeof a&&(this.Ka=a,this.c.style.textOverflow=this.Ka)}});
Object.defineProperty(T.prototype,"editable",{get:function(){return this.M},set:function(a){a=!!a;this.M!==a&&(this.M=a,!1===this.M?(this.c.removeEventListener("click",this.la,!!this&&!!this),this.i.keyboard.ne(this.$),this.$=null,this.pointer.enabled=!0,this.c.style.cursor="text"):(this.c.addEventListener("click",this.la,!!this&&!!this),this.$=new P(this.i,[13,27],this.tf,null,null,null,this),this.i.keyboard.Cf(this.$),this.c.style.cursor="default"))}});
Object.defineProperty(T.prototype,"loaded",{get:function(){return this.ga}});Object.defineProperty(T.prototype,"onLoadComplete",{get:function(){this.B||(this.B=new p(this));return this.B}});Object.defineProperty(T.prototype,"onValueChange",{get:function(){this.J||(this.J=new p(this));return this.J}});function md(a,b){this.ga=b||null;this.G={};this.$=this.I=this.P="";this.j=this.J=null;this.S=this.W=!1;this.ea=0;t.call(this,a,null,"Button")}md.prototype=Object.create(t.prototype);e=md.prototype;
e.constructor=md;
e.Ea=function(){t.prototype.Ea.call(this);this.I="out";this.J=new I(this.i);this.J.onLoadComplete.add(this.Ed,this);this.J.onResize.add(this.Fd,this);this.Wb(this.J);this.j=new T(this.i);this.j.onLoadComplete.add(this.Ed,this);this.j.onResize.add(this.Fd,this);this.j.autoWidth=!0;this.j.autoHeight=!0;this.Wb(this.j);this.pointer.enabled=!0;this.pointer.cursor=Bd.Za;this.pointer.onEnter.add(this.fm,this);this.pointer.onLeave.add(this.gm,this);this.pointer.onPressStart.add(this.sk,this);this.pointer.onPressEnd.add(this.rk,
this);this.i.display.register(this);Gd(this);Hd(this);this.i.i18n.onLocaleChangeComplete.add(this.Kg,this);this.load(this.ga)};e.fm=function(){$d(this,"over")};e.gm=function(){$d(this,"out")};e.sk=function(){$d(this,"down")};e.rk=function(){$d(this,"over")};e.Kg=function(){$d(this,this.I)};e.Ed=function(a){this.log("_itemLoadComplete "+a.emitter.className);this.ea++;2===this.ea&&(this.log("_allItemsLoaded"),ae(this),be(this))};e.Fd=function(){ae(this);be(this)};function ce(a,b){a.P=b;$d(a,a.I)}
function $d(a,b){a.I=b;b=a.G[a.P];a.ea=0;var d=b.Bj(a.I);a.background=b.Qa("background",a.I);a.borderStyle=b.Qa("borderStyle",a.I);a.borderColor=b.Qa("borderColor",a.I);a.borderRadius=b.Qa("borderRadius",a.I);a.borderWidth=b.Qa("borderWidth",a.I);a.W=b.Qa("autoWidth",a.I);a.S=b.Qa("autoHeight",a.I);var g=b.Qa("label",a.I);"undefined"!==typeof g&&a.j.load(g);!0===d&&a.J.load(b.Qa("image",a.I))}
function ae(a){a.log("_updateLayout");var b=a.G[a.P],d=b.Qa("align",a.I),g=b.Qa("padding",a.I),h=b.Qa("spacing",a.I);"label"===b.Qa("first",a.I)?(b=a.j,a=a.J):(b=a.J,a=a.j);switch(d){case "left":b.left=g;b.verticalCenter=!0;a.left=b.left+h+b.pixelWidth;a.verticalCenter=!0;break;case "right":b.right=g;b.verticalCenter=!0;a.right=b.right+h+b.pixelWidth;a.verticalCenter=!0;break;case "top":b.top=g;b.horizontalCenter=!0;a.top=b.top+b.pixelHeight+h;a.horizontalCenter=!0;break;case "bottom":b.bottom=g;
b.horizontalCenter=!0;a.bottom=b.bottom+h+b.pixelHeight;a.horizontalCenter=!0;break;default:b.horizontalCenter=!0,b.verticalCenter=!0,a.horizontalCenter=!0,a.verticalCenter=!0}}
function be(a){a.log("_updateAutoSize");if(!1!==a.W||!1!==a.S){var b=a.G[a.P].Qa("padding",a.I);if(!0===a.W){var d=a.pixelWidth;a.u=Math.max(a.j.x+a.j.pixelWidth,a.J.x+a.J.pixelWidth)-Math.min(a.j.x,a.J.x)+2*b+2*a.N;a.C="px";a.c.style.width=a.u+"px";d!==a.pixelWidth&&a.ta({property:"autoWidth"})}!0===a.S&&(d=a.pixelHeight,a.o=Math.max(a.j.y+a.j.pixelHeight,a.J.y+a.J.pixelHeight)-Math.min(a.j.y,a.J.y)+2*b+2*a.N,a.A="px",a.c.style.height=a.o+"px",d!==a.pixelHeight&&a.ta({property:"autoHeight"}))}}
e.load=function(a){if("undefined"!==typeof a&&a){if(!0===B.Ga(a.skins,"ButtonSkin"))for(var b=0,d=a.skins.length;b<d;b++)this.jc(a.skins[b]);else if("object"===typeof a.skins&&0<a.skins.length)for(var d=0,g=a.skins.length;d<g;d++)b=new de(a.skins[d].name,a.skins[d].states),this.jc(b);B.T(a.skin,"ButtonSkin")?this.jc(a.skin):"object"===typeof a.skin&&(b=new de(a.skin.name,a.skin.states),this.jc(b));!0===B.T(a["default"],"string")&&!0===this.Cj(a["default"])&&(this.$=a["default"])}a=this.G||{};Object.keys(a).length||
(b=new de("default"),this.jc(b));""===this.$&&(this.$=this.G[Object.keys(a)[0]].name);ce(this,this.$)};e.jc=function(a,b){if(!1===B.T(a,"ButtonSkin"))throw"$_Button: Invalid button skin!";a.sg("out");this.G[a.name]=a;!0===b&&ce(this,a.name)};e.dk=function(a){"string"===typeof a&&!0===B.T(this.G[a],"ButtonSkin")?ce(this,a):!0===B.T(a,"ButtonSkin")&&(this.G[a.name]===a?ce(this,a.name):"undefined"!==typeof this.G[a.name]&&null!==this.G[a.name]||this.jc(a,!0))};e.Cj=function(a){return"undefined"!==typeof this.G[a]};
e.Sn=function(){this.G[this.P].sg("out");ce(this,this.P)};
e.destroy=function(){this.i.i18n.onLocaleChangeComplete.remove(this.Kg,this);if("undefined"!==typeof this.G&&0<this.G.length)for(var a in this.G)this.G.hasOwnProperty(a)&&this.G[a].destroy();this.G={};this.J&&(this.J.onLoadComplete.remove(this.Ed,this),this.J.onResize.remove(this.Fd,this),this.removeChild(this.J,!0),this.J=null);this.j&&(this.j.onLoadComplete.remove(this.Ed,this),this.j.onResize.remove(this.Fd,this),this.removeChild(this.j,!0),this.j=null);t.prototype.destroy.call(this)};
Object.defineProperty(md.prototype,"skins",{get:function(){return this.G}});Object.defineProperty(md.prototype,"skin",{get:function(){return this.G[this.P]},set:function(a){this.dk(a)}});Object.defineProperty(md.prototype,"autoWidth",{get:function(){return this.W},set:function(a){"boolean"===typeof a&&(this.W=a,be(this))}});Object.defineProperty(md.prototype,"autoHeight",{get:function(){return this.S},set:function(a){"boolean"===typeof a&&(this.S=a,be(this))}});
function de(a,b){this.j=a||"";this.f=B.kc(ee,{});this.c=B.kc(b||{},{out:{},over:{},down:{}});l.call(this,"ButtonSkin")}de.prototype=Object.create(l.prototype);de.prototype.constructor=de;
var fe={key:"",url:"",i18n:!1,keepRatio:!0,maximized:!1,alpha:1},ge={value:"",i18n:!1,color:"",fontFamily:"",fontWeight:""},he={name:"",background:"",borderStyle:"solid",borderColor:"",borderRadius:0,borderWidth:0,autoWidth:!0,autoHeight:!0,align:"center",padding:0,spacing:0,first:"image",image:fe,label:ge},ie={key:"",url:"",i18n:!1,keepRatio:!0,maximized:!1,alpha:1},je={value:"Button",i18n:!1,color:"",fontFamily:"",fontWeight:""},ee={name:"default",background:"#eee",borderStyle:"solid",borderColor:"#555",
borderRadius:5,borderWidth:2,autoWidth:!0,autoHeight:!0,align:"left",padding:5,spacing:0,first:"image",image:ie,label:je};de.prototype.sg=function(a){"undefined"!==typeof this.c[a]&&(this.f=this.c[a])};de.prototype.Qa=function(a,b){b=B.Xd(this.c,b+"."+a,B.Xd(this.f,a,B.Xd(he,a)));"object"===typeof b&&(b=B.kc(this.f[a],b));return b};de.prototype.Bj=function(a){a=this.Qa("image",a);return"undefined"!==typeof a&&"string"===typeof a.url&&""!==a.url};
de.prototype.m=function(a){a=this.Qa("label",a);return"undefined"!==typeof a&&"string"===typeof a.value&&""!==a.value};Object.defineProperty(de.prototype,"name",{get:function(){return this.j}});Object.defineProperty(de.prototype,"default",{get:function(){return this.f},set:function(a){this.f=a}});Object.defineProperty(de.prototype,"out",{get:function(){return this.c.out},set:function(a){this.c.out=a}});
Object.defineProperty(de.prototype,"over",{get:function(){return this.c.over},set:function(a){this.c.over=a}});Object.defineProperty(de.prototype,"down",{get:function(){return this.c.down},set:function(a){this.c.down=a}});function ia(a){U.call(this,a,document.createElement("canvas"),"Canvas")}ia.prototype=Object.create(U.prototype);ia.prototype.constructor=ia;ia.prototype.Ea=function(){U.prototype.Ea.call(this);this.i.display.register(this);Gd(this);Hd(this)};
Object.defineProperty(ia.prototype,"context2D",{get:function(){return this.c.getContext("2d")}});Object.defineProperty(ia.prototype,"context3D",{get:function(){return this.c.getContext("webgl")}});Object.defineProperty(ia.prototype,"element",{get:function(){return this.c}});
function K(a,b,d,g,h){this.i=a;this.Pc=b;this.$b=d||null;this.G=null;this.Oc=g||ke.Hb;this.Xa="";this.J=null;this.I=this.B=-1;this.Pa=null;this.ob=!1;this.gb=null;this.ac=!1;this.fb=1;this.Sa=!1;this.rc=0;this.Eb=null;this.Bb=h||!1;this.Hc=[0,1,2,3];this.qc=!1;this.Da=this.W=this.Ba=this.Ca=this.Fa=this.La=this.qa=this.za=this.Ja=this.Oa=this.ia=this.ga=this.Ha=this.Ma=this.M=this.Ka=this.ra=this.sa=this.ea=this.$=this.fa=this.Aa=this.la=this.pa=this.ka=null;this.Db=this.P=!1;this.pc=this.sc=0;this.cc=
this.dc=this.j=this.Fb=this.pb=this.ub=this.qb=this.sb=this.tb=this.rb=this.S=null;U.call(this,a,null,"VideoHTML5")}K.prototype=Object.create(U.prototype);e=K.prototype;e.constructor=K;
e.Ea=function(){U.prototype.Ea.call(this);!0===this.Bb&&!1===le(this)&&(this.log("$_VideoHTML5: can't manage ambisonic sound without Google Chrome Omnitone library and WebAudio API."),this.Bb=!1);this.O=this.Pc;ba(this);this.S=this.wm.bind(this);this.rb=this.xm.bind(this);this.tb=this.zm.bind(this);this.sb=this.ym.bind(this);this.qb=this.vm.bind(this);this.ub=this.Am.bind(this);this.pb=this.um.bind(this);this.Fb=this.Bm.bind(this);this.j=this.lm.bind(this);this.Pa=this.i.clock.create(!1);this.gb=
this.i.clock.create(!1);this.gb.Ke(500,this.wl,this);this.i.audio.onVolumeChange.add(this.Jh,this);this.i.audio.onDisable.add(this.Ih,this);this.W=new p(this,!0);null!==this.$b&&this.load(this.$b);this.i.display.register(this,le(this));Gd(this);Hd(this)};e.ta=function(a){var b=me(this);b&&null!==b.element&&(b.element.setAttribute("width",this.pixelWidth),b.element.setAttribute("height",this.pixelHeight));U.prototype.ta.call(this,a)};
function ne(a,b){for(var d,g=0,h=a.J.length;g<h;g++)if(d=a.J[g],d===b)return g;return-1}function oe(a,b){return a.J?(a=a.J[b])&&"undefined"!==typeof a?a:null:null}function pe(a){return oe(a,a.B)}function me(a){return oe(a,a.I)}function qe(a,b){return(a=me(a))&&null!==a.element?a.element[b]:0}
function re(a,b){if(-1!==b){a.log("_destroyVideoAt "+b);b=a.J[b];var d=b.element;if("undefined"!==typeof d&&null!==d){d.removeEventListener("loadstart",a.j,!1);d.removeEventListener("durationchange",a.j,!1);d.removeEventListener("loadedmetadata",a.j,!1);d.removeEventListener("loadeddata",a.j,!1);d.removeEventListener("progress",a.j,!1);d.removeEventListener("canplay",a.j,!1);d.removeEventListener("canplaythrough",a.j,!1);d.removeEventListener("play",a.j,!1);d.removeEventListener("pause",a.j,!1);d.removeEventListener("timeupdate",
a.j,!1);d.removeEventListener("volumechange",a.j,!1);d.removeEventListener("seeked",a.j,!1);d.removeEventListener("ended",a.j,!1);d.removeEventListener("error",a.j,!1);d.removeEventListener("waiting",a.j,!1);d.removeEventListener("stalled",a.j,!1);d.removeEventListener("playing",a.j,!1);d.removeEventListener("error",a.S,!1);d.pause();d.src="";for(var g,h=0,k=d.children.length;h<k;h++)g=d.children[h],g.removeEventListener("error",a.S,!1),g.src="",d.removeChild(g);d.load();d.parentNode===a.c&&a.c.removeChild(d)}b.element=
null;null!==b.buffer&&(b.buffer.destroy(),b.buffer=null);null!==b.played&&(b.played.destroy(),b.played=null)}}
function se(a,b,d){a.ob=d||!1;a.log("Requesting index: "+b+", force: "+a.ob);-1!==a.B&&a.B!==b&&te(a);d=b===a.B?!0:!1;a.B=b;a.Fa&&a.Fa.D(b);if(b!==a.I&&!0!==d){d=a.B;var g=document.createElement("video");g.setAttribute("webkit-playsinline","webkit-playsinline");g.setAttribute("width",a.pixelWidth);g.setAttribute("height",a.pixelHeight);g.volume=0;g.crossOrigin="anonymous";g.id="FORGE-VideoHTML5-"+a.O+"-"+d;var h=new ue(g,"buffered"),k=new ue(g,"played");d=a.J[d];d.element=g;d.buffer=h;d.played=k;
d.lastTimeStamp=0;d.requestCount++;g=a.G[a.B];-1<a.I&&(d.element.addEventListener("loadstart",a.rb,!1),d.element.addEventListener("error",a.S,!1));h=document.createElement("source");h.addEventListener("error",a.S,!1);h.src=g.url;h.type=g.mimeType;d.element.appendChild(h);a.dc=a.di.bind(a);!0===le(a)?(a.f=a.i.audio.context,a.Eb=Omnitone.createFOADecoder(a.f,d.element,{channelMap:a.Hc}),a.cc=a.Ql.bind(a),a.Eb.initialize().then(a.dc,a.cc)):a.di();-1===a.I?(a.log("No current video, set directly the current index"),
ve(a,b)):(a.Pa.add(2E4,a.Nm,a),a.Pa.start())}}e.di=function(){-1===this.B?me(this).element.load():pe(this).element.load()};e.Ql=function(){this.log("FOA decoder could not be initialized")};e.xm=function(){var a=pe(this).element;this.log("_onRequestLoadStart [readyState: "+a.readyState+"]");a.removeEventListener("loadstart",this.rb,!1);a.addEventListener("loadedmetadata",this.tb,!1)};
e.zm=function(){var a=pe(this).element;this.log("_onRequestLoadedMetaData [readyState: "+a.readyState+"]");a.removeEventListener("loadedmetadata",this.tb,!1);a.addEventListener("loadeddata",this.sb,!1)};e.ym=function(){var a=pe(this).element;this.log("_onRequestLoadedData [readyState: "+a.readyState+"]");a.removeEventListener("loadeddata",this.sb,!1);!0===N.Cc?(a.addEventListener("play",this.qb,!1),a.play()):ve(this,this.B,!0)};
e.vm=function(){var a=pe(this).element;this.log("_onRequestCanPlayBeforeSeek [readyState: "+a.readyState+"]");a.pause();a.removeEventListener("play",this.qb,!1);a.addEventListener("seeked",this.ub,!1);var b=this.currentTime;a.currentTime=!0===this.P&&!1===this.ob?b+6:b};
e.Am=function(){var a=pe(this).element;this.log("_onRequestSeeked [readyState: "+a.readyState+"]");a.removeEventListener("seeked",this.ub,!1);4===a.readyState?(a.removeEventListener("error",this.S,!1),we(this)):a.addEventListener("canplay",this.pb,!1)};e.um=function(){var a=pe(this).element;this.log("_onRequestCanPlayAfterSeek [readyState: "+a.readyState+"]");a.removeEventListener("canplay",this.pb,!1);a.removeEventListener("error",this.S,!1);we(this)};
function we(a){var b=me(a);b&&null!==b.element&&!1===a.ob&&(a.log("Current video listen to seek, wait both video to sync"),b.element.addEventListener("seeked",a.Fb,!1),a.Pa.Ke(10,a.Vm,a));for(var b=pe(a).element,d,g=0,h=b.children.length;g<h;g++)d=b.children[g],d.removeEventListener("error",a.S,!1);!0===a.ob&&ve(a,a.B)}e.Bm=function(){this.log("_onRequestSeekedWhileSync "+this.currentTime);var a=this.B;xe(this,!1);se(this,a)};
e.Vm=function(){this.log("_videoSyncTimerLoop "+this.B);var a=pe(this);a&&this.currentTime>=a.element.currentTime&&this.currentTime<a.element.currentTime+.05&&ve(this,this.B)};e.Nm=function(){this.log("_requestTimeOutHandler");xe(this,!0)};e.wm=function(a){this.log("_onRequestError");this.log(a);xe(this,!0)};
function ve(a,b,d){if(b!==a.I){a.c.innerHTML="";var g=pe(a);!0===a.P&&g.element.play();ye(a,g);g=me(a);a.B=-1;a.I=b;b=me(a);b.currentCount++;!0===d&&g&&(b.element.currentTime=g.element.currentTime);d=b.element;d.addEventListener("loadstart",a.j,!1);d.addEventListener("durationchange",a.j,!1);d.addEventListener("loadedmetadata",a.j,!1);d.addEventListener("loadeddata",a.j,!1);d.addEventListener("progress",a.j,!1);d.addEventListener("canplay",a.j,!1);d.addEventListener("canplaythrough",a.j,!1);d.addEventListener("play",
a.j,!1);d.addEventListener("pause",a.j,!1);d.addEventListener("timeupdate",a.j,!1);d.addEventListener("volumechange",a.j,!1);d.addEventListener("seeked",a.j,!1);d.addEventListener("ended",a.j,!1);d.addEventListener("error",a.j,!1);d.addEventListener("waiting",a.j,!1);d.addEventListener("stalled",a.j,!1);d.addEventListener("playing",a.j,!1);a.c.appendChild(b.element);g&&null!==g.element&&(g.element.removeEventListener("seeked",a.Fb,!1),d=ne(a,g),-1!==d&&re(a,d));a.Pa.stop(!0);a.Ca&&a.Ca.D(a.I);""===
a.Xa&&ze(a,a.Oc)}}
e.wl=function(){this.log("Auto quality timer loop");if(!1!==this.P&&-1===this.B){var a;a=me(this);var b=a.element.currentTime;!1===a.element.playing?a=!1:b===a.lastTimeStamp?(a.lastTimeStamp=0,a=!0):(a.lastTimeStamp=b,a=!1);!0===a?(this.log("AutoQuality downgrade quality"),me(this).leaveCount++,0<=this.I-1?se(this,this.I-1,!0):this.log("Can't downgrade video quality anymore!")):(a=me(this),!0===(a&&null!==a.buffer&&a.buffer.Mj(a.element.currentTime,6)?!0:!1)&&this.I!==this.G.length-1&&(a=this.I+1,
this.J[a].abortCount||this.J[a].leaveCount?this.log("AutoQuality do not attempt to load an already aborted video"):(this.log("AutoQuality upgrade quality"),se(this,a))))}};function ze(a,b){!1===N.Cc&&(b=ke.MANUAL,a.warn("Quality mode force to manual, you are not on desktop"));a.Xa===b||b!==ke.Hb&&b!==ke.MANUAL||(a.Xa=b,a.gb.stop(!1),a.Xa===ke.Hb&&a.gb.start(),a.Da&&a.Da.D(a.Xa))}function xe(a,b){var d=pe(a);d&&(!0===b&&d.abortCount++,te(a),a.Pa.stop(!0),a.Ba&&a.Ba.D())}
function te(a){var b=pe(a),d;b&&(d=b.element,d.removeEventListener("loadstart",a.rb,!1),d.removeEventListener("loadedmetadata",a.tb,!1),d.removeEventListener("loadeddata",a.sb,!1),d.removeEventListener("play",a.qb,!1),d.removeEventListener("seeked",a.ub,!1),d.removeEventListener("canplay",a.pb,!1),d.removeEventListener("error",a.S,!1),b=ne(a,b),-1!==b&&re(a,b),a.B=-1)}e.Jh=function(){ye(this)};
function ye(a,b){(b=b||me(a))&&null!==b.element&&!0===a.i.audio.enabled&&(b.element.volume=a.fb*a.i.audio.volume)}e.Ih=function(){var a=me(this);a&&null!==a.element&&!1===this.i.audio.enabled&&(a.element.volume=0)};
e.lm=function(a){var b=me(this).element;this.log(a.type+" [readyState: "+b.readyState+"]");switch(a.type){case "loadstart":this.ka&&this.ka.D(a);break;case "durationchange":this.fa&&1===b.readyState&&this.fa.D(a);break;case "loadedmetadata":this.qc=!0;this.pa&&this.pa.D(a);break;case "loadeddata":this.la&&this.la.D(a);break;case "progress":this.Aa&&this.Aa.D(a);break;case "canplay":this.Db=!0;this.$&&this.$.D(a);break;case "canplaythrough":this.Db=!0;this.ea&&this.ea.D(a);break;case "play":this.sa&&
this.sa.D(a);break;case "pause":this.P=!1;this.ra&&this.ra.D(a);break;case "timeupdate":this.Ka&&this.Ka.D(a);break;case "volumechange":this.Ma&&0!==b.readyState&&this.Ma.D(a);break;case "seeked":this.Db=!1;this.Ha&&this.Ha.D(a);break;case "ended":this.P=!1;this.c.currentTime=0;this.pc++;!0===this.ac&&this.play(0);this.ga&&this.ga.D(a);break;case "error":this.ia&&this.ia.D(a);break;case "waiting":this.Oa&&this.Oa.D(a);break;case "stalled":this.Ja&&this.Ja.D(a);break;case "playing":this.za&&this.za.D(a);
break;default:this.warn('The event "'+a.type+'" is not handled.')}};function le(a){return!0===a.Bb&&!0===a.i.audio.useWebAudio&&"undefined"!==typeof Omnitone}e.update=function(){this.Eb&&!0===this.P&&this.Eb.setRotationMatrixFromCamera(this.i.renderer.camera.modelViewInverse)};
e.load=function(a){if(null!==a)if(!0===B.T(a,"string")?a=[a]:!0===B.T(a,"VideoQuality")&&(a=[a]),!0===B.Ga(a,"string")){for(var b=[],d,g=0,h=a.length;g<h;g++)d=new Ae(a[g]),b.push(d);this.G=b}else!0===B.Ga(a,"VideoQuality")&&(this.G=a);this.W&&this.W.D(this.G);if(!this.G||!this.G.length)throw"$_VideoHTML5.load: Can't create video with no qualities set!";a=this.G.length;b=[];for(g=0;g<a;g++)d={index:g,element:null,buffer:null,played:null,requestCount:0,currentCount:0,abortCount:0,leaveCount:0,lastTimeStamp:0},
b[g]=d;this.J=b;se(this,0)};e.play=function(a,b){this.currentTime=a;this.loop=b;(a=me(this))&&null!==a.element&&(a.element.play(),this.P=!0,this.sc++)};e.pause=function(){var a=me(this);a&&null!==a.element&&(a.element.pause(),this.P=!1)};e.stop=function(){var a=me(this);a&&null!==a.element&&(a.element.pause(),a.element.currentTime=0,this.P=!1)};e.kl=function(){!0===this.P||!1===this.i.audio.enabled?this.pause():this.play()};
e.bb=function(){!0!==this.Sa&&!1!==this.i.audio.enabled&&(this.Sa=!0,this.rc=this.fb,this.fb=0,ye(this),this.qa&&this.qa.D())};e.Kh=function(a){!1!==this.Sa&&(a="number"===typeof a?a:this.rc,this.Sa=!1,this.fb=G.Z(a,0,1),ye(this),this.La&&this.La.D())};
e.destroy=function(){te(this);this.Pa.destroy();this.Pa=null;this.gb.destroy();this.gb=null;this.ka&&(this.ka.destroy(),this.ka=null);this.pa&&(this.pa.destroy(),this.pa=null);this.la&&(this.la.destroy(),this.la=null);this.Aa&&(this.Aa.destroy(),this.Aa=null);this.fa&&(this.fa.destroy(),this.fa=null);this.$&&(this.$.destroy(),this.$=null);this.ea&&(this.ea.destroy(),this.ea=null);this.sa&&(this.sa.destroy(),this.sa=null);this.ra&&(this.ra.destroy(),this.ra=null);this.Ka&&(this.Ka.destroy(),this.Ka=
null);this.M&&(this.M.destroy(),this.M=null);this.Ma&&(this.Ma.destroy(),this.Ma=null);this.Ha&&(this.Ha.destroy(),this.Ha=null);this.ga&&(this.ga.destroy(),this.ga=null);this.ia&&(this.ia.destroy(),this.ia=null);this.Oa&&(this.Oa.destroy(),this.Oa=null);this.Ja&&(this.Ja.destroy(),this.Ja=null);this.za&&(this.za.destroy(),this.za=null);this.qa&&(this.qa.destroy(),this.qa=null);this.La&&(this.La.destroy(),this.La=null);this.Fa&&(this.Fa.destroy(),this.Fa=null);this.Ca&&(this.Ca.destroy(),this.Ca=
null);this.Ba&&(this.Ba.destroy(),this.Ba=null);this.Da&&(this.Da.destroy(),this.Da=null);this.W&&(this.W.destroy(),this.W=null);for(var a=0,b=this.J.length;a<b;a++)re(this,a);this.j=this.Fb=this.pb=this.ub=this.qb=this.sb=this.tb=this.rb=this.S=this.cc=this.dc=null;this.i.audio.onVolumeChange.remove(this.Jh,this);this.i.audio.onDisable.remove(this.Ih,this);this.J=this.G=this.$b=null;U.prototype.destroy.call(this)};
Object.defineProperty(K.prototype,"quality",{get:function(){return this.G[this.I]},set:function(a){if("number"===typeof a&&0<=a&&a<this.G.length)ze(this,ke.MANUAL),se(this,a);else if(!0===B.T(a,"VideoQuality")){a:{for(var b,d=0,g=this.G.length;d<g;d++)if(b=this.G[d],b===a){a=d;break a}a=-1}if(-1!==a)ze(this,ke.MANUAL),se(this,a);else throw"Unknown quality";}else throw"Video quality "+a+" out of bounds";}});
Object.defineProperty(K.prototype,"qualityMode",{get:function(){return this.Xa},set:function(a){a!==ke.Hb&&a!==ke.MANUAL||ze(this,a)}});Object.defineProperty(K.prototype,"qualities",{get:function(){return this.G}});Object.defineProperty(K.prototype,"requestIndex",{get:function(){return this.B}});Object.defineProperty(K.prototype,"currentIndex",{get:function(){return this.I}});Object.defineProperty(K.prototype,"videos",{get:function(){return this.J}});
Object.defineProperty(K.prototype,"element",{get:function(){var a=me(this);return a&&null!==a.element?a.element:null}});Object.defineProperty(K.prototype,"buffer",{get:function(){var a=me(this);return a&&null!==a.buffer?a.buffer:null}});Object.defineProperty(K.prototype,"played",{get:function(){var a=me(this);return a&&null!==a.played?a.played:null}});Object.defineProperty(K.prototype,"originalWidth",{get:function(){return qe(this,"videoWidth")}});
Object.defineProperty(K.prototype,"originalHeight",{get:function(){return qe(this,"videoHeight")}});Object.defineProperty(K.prototype,"currentTime",{get:function(){return qe(this,"currentTime")},set:function(a){if("number"===typeof a){var b=me(this);b&&null!==b.element&&(b.element.currentTime=a,this.M&&this.M.D(a))}}});Object.defineProperty(K.prototype,"currentTimeMS",{get:function(){return 1E3*this.currentTime},set:function(a){this.currentTime=a/1E3}});
Object.defineProperty(K.prototype,"remainingTime",{get:function(){return this.duration-this.currentTime}});Object.defineProperty(K.prototype,"duration",{get:function(){return qe(this,"duration")}});Object.defineProperty(K.prototype,"durationMS",{get:function(){return Math.round(1E3*this.duration)}});Object.defineProperty(K.prototype,"playing",{get:function(){return this.P}});Object.defineProperty(K.prototype,"playCount",{get:function(){return this.sc}});
Object.defineProperty(K.prototype,"canPlay",{get:function(){return this.Db}});Object.defineProperty(K.prototype,"endCount",{get:function(){return this.pc}});Object.defineProperty(K.prototype,"metaDataLoaded",{get:function(){return this.qc}});Object.defineProperty(K.prototype,"loop",{get:function(){return this.ac},set:function(a){"boolean"===typeof a&&(this.ac=a)}});
Object.defineProperty(K.prototype,"volume",{get:function(){return this.fb},set:function(a){"number"===typeof a&&(this.fb=G.Z(a,0,1),this.Sa=!1,ye(this))}});Object.defineProperty(K.prototype,"muted",{get:function(){return this.Sa},set:function(a){!0===!!a?this.bb():this.Kh()}});Object.defineProperty(K.prototype,"ambisonic",{get:function(){return this.Bb}});Object.defineProperty(K.prototype,"onLoadStart",{get:function(){this.ka||(this.ka=new p(this));return this.ka}});
Object.defineProperty(K.prototype,"onLoadedMetaData",{get:function(){this.pa||(this.pa=new p(this));return this.pa}});Object.defineProperty(K.prototype,"onLoadedData",{get:function(){this.la||(this.la=new p(this));return this.la}});Object.defineProperty(K.prototype,"onProgress",{get:function(){this.Aa||(this.Aa=new p(this));return this.Aa}});Object.defineProperty(K.prototype,"onDurationChange",{get:function(){this.fa||(this.fa=new p(this));return this.fa}});
Object.defineProperty(K.prototype,"onCanPlay",{get:function(){this.$||(this.$=new p(this));return this.$}});Object.defineProperty(K.prototype,"onCanPlayThrough",{get:function(){this.ea||(this.ea=new p(this));return this.ea}});Object.defineProperty(K.prototype,"onPlay",{get:function(){this.sa||(this.sa=new p(this));return this.sa}});Object.defineProperty(K.prototype,"onPause",{get:function(){this.ra||(this.ra=new p(this));return this.ra}});
Object.defineProperty(K.prototype,"onTimeUpdate",{get:function(){this.Ka||(this.Ka=new p(this));return this.Ka}});Object.defineProperty(K.prototype,"onCurrentTimeChange",{get:function(){this.M||(this.M=new p(this));return this.M}});Object.defineProperty(K.prototype,"onVolumeChange",{get:function(){this.Ma||(this.Ma=new p(this));return this.Ma}});Object.defineProperty(K.prototype,"onSeeked",{get:function(){this.Ha||(this.Ha=new p(this));return this.Ha}});
Object.defineProperty(K.prototype,"onEnded",{get:function(){this.ga||(this.ga=new p(this));return this.ga}});Object.defineProperty(K.prototype,"onError",{get:function(){this.ia||(this.ia=new p(this));return this.ia}});Object.defineProperty(K.prototype,"onWaiting",{get:function(){this.Oa||(this.Oa=new p(this));return this.Oa}});Object.defineProperty(K.prototype,"onStalled",{get:function(){this.Ja||(this.Ja=new p(this));return this.Ja}});
Object.defineProperty(K.prototype,"onPlaying",{get:function(){this.za||(this.za=new p(this));return this.za}});Object.defineProperty(K.prototype,"onMute",{get:function(){this.qa||(this.qa=new p(this));return this.qa}});Object.defineProperty(K.prototype,"onUnmute",{get:function(){this.La||(this.La=new p(this));return this.La}});Object.defineProperty(K.prototype,"onQualityRequest",{get:function(){this.Fa||(this.Fa=new p(this));return this.Fa}});
Object.defineProperty(K.prototype,"onQualityChange",{get:function(){this.Ca||(this.Ca=new p(this));return this.Ca}});Object.defineProperty(K.prototype,"onQualityAbort",{get:function(){this.Ba||(this.Ba=new p(this));return this.Ba}});Object.defineProperty(K.prototype,"onQualityModeChange",{get:function(){this.Da||(this.Da=new p(this));return this.Da}});Object.defineProperty(K.prototype,"onQualitiesLoaded",{get:function(){this.W||(this.W=new p(this,!0));return this.W}});
function J(a,b,d,g){this.i=a;this.tl=b;this.Oc=d||null;this.Sa="";this.Fa=null;this.sl=g||ke.Hb;this.Oa="";this.j=null;this.Pc=!1;this.Ka=1;this.Ca=!1;this.Uh=0;this.Rh=!1;this.Xa=this.f=null;this.Se=this.Re=this.Ha=this.Pa=0;this.gb=this.Aa=this.sc=this.Hc=null;this.fb=this.Da=!1;this.Qh=this.Vh=0;this.Bb=this.Ue=this.ac=this.cc=this.Fb=this.pc=this.La=this.rb=this.dc=this.rc=this.qc=this.Db=this.Eb=this.pb=this.ob=this.qb=this.$b=this.tb=this.ub=this.sb=this.Ba=this.la=this.B=this.Ja=this.ka=this.pa=
this.ga=this.ra=this.P=this.M=this.qa=this.za=this.Ma=this.sa=this.ea=this.fa=this.I=this.G=this.J=this.ia=this.W=this.$=this.S=null;U.call(this,a,null,"VideoDash")}J.prototype=Object.create(U.prototype);J.prototype.constructor=J;var Be={VIDEO:"video",AUDIO:"audio"};e=J.prototype;
e.Ea=function(){U.prototype.Ea.call(this);if("undefined"===typeof dashjs)throw"$_VideoDash._boot: Can't create MPEG-DASH video stream without dash.js Media Player.";this.O=this.tl;ba(this);this.sb=this.nm.bind(this);this.qb=this.jm.bind(this);this.ub=this.fl.bind(this);this.tb=this.om.bind(this);this.$b=this.rm.bind(this);this.ob=this.im.bind(this);this.pb=this.dl.bind(this);this.Eb=this.hl.bind(this);this.Db=this.gl.bind(this);this.qc=this.Gm.bind(this);this.rc=this.Lm.bind(this);this.dc=this.Dm.bind(this);
this.rb=this.el.bind(this);this.La=this.km.bind(this);this.pc=this.Em.bind(this);this.Fb=this.qm.bind(this);this.cc=this.tm.bind(this);this.ac=this.sm.bind(this);this.Ue=this.Fm.bind(this);this.Bb=this.pm.bind(this);this.i.audio.onVolumeChange.add(this.Gh,this);this.i.audio.onDisable.add(this.Fh,this);this.B=new p(this,!0);null!==this.Oc&&this.load(this.Oc);this.i.display.register(this);Gd(this);Hd(this)};
e.ta=function(a){var b=this.j;b&&null!==b.element&&(b.element.setAttribute("width",this.pixelWidth),b.element.setAttribute("height",this.pixelHeight));U.prototype.ta.call(this,a)};function Ce(a,b){return(a=a.j)&&null!==a.element?a.element[b]:0}
e.nm=function(a){this.log("onLoadStart [readyState: "+this.j.element.readyState+"]");var b=this.Sa,d=this.f.getBitrateInfoListFor(Be.VIDEO),g=[],h;if(d){for(var k=0,q=d.length;k<q;k++)h=new Ae(b),h.id=d[k].qualityIndex,h.bitrate=d[k].bitrate,h.width=d[k].width,h.height=d[k].height,g.push(h);this.Fa=g;this.B&&this.B.D(g)}else this.destroy();this.S&&this.S.D(a)};e.Fm=function(a){this.log("_onSwitchCompleted [readyState: "+this.j.element.readyState+"]");this.Xa=a.toStreamInfo};
e.pm=function(a){this.log("_onMetricsChangedHandler [readyState: "+this.j.element.readyState+"]");this.Hc||(this.Hc=this.f.getMetricsFor(Be.VIDEO));this.sc||(this.sc=this.f.getMetricsFor(Be.AUDIO));this.Aa||(this.Aa=this.f.getDashMetrics());if(this.Ba){var b;a.mediaType===Be.VIDEO&&(b=De(this,Be.VIDEO,this.Hc,this.Aa))&&(this.gb={videoBitrate:b.bitrate,videoIndex:b.index,videoPendingIndex:b.Xj,videoMaxIndex:b.Rj,videoBufferLength:b.Ui,videoDroppedFrames:b.droppedFrames});a.mediaType===Be.AUDIO&&(b=
De(this,Be.AUDIO,this.sc,this.Aa))&&(this.gb={audioBitrate:b.bitrate,audioIndex:b.index,audioPendingIndex:b.Xj,audioMaxIndex:b.Rj,audioBufferLength:b.Ui,audioDroppedFrames:b.droppedFrames});this.Ba.D(a)}};
function De(a,b,d,g){if(d&&g){var h=a.Xa.index,k,q,v,x,E,zb;(k=g.getCurrentRepresentationSwitch(d))&&(q=Math.round(g.getBandwidthForRepresentation(k.to,h)/1E3));if(isNaN(q)||void 0===q)q=0;b===Be.VIDEO?(v=a.Pa+1,x=a.Ha+1):b===Be.AUDIO&&(v=a.Re+1,x=a.Se+1);if(isNaN(v)||void 0===v)v=0;if(isNaN(x)||void 0===x)x=0;a=g.getMaxIndexForBufferType(b,h);if(isNaN(a)||void 0===a)a=0;b=g.getCurrentBufferLevel(d);null!==b&&(E=b.toPrecision(5));if(isNaN(E)||void 0===E)E=0;if(d=g.getCurrentDroppedFrames(d))zb=d.droppedFrames;
return{bitrate:q,index:v,Xj:x,Rj:a,Ui:E,droppedFrames:zb}}return null}e.sm=function(a){this.log("onQualityChange [readyState: "+this.j.element.readyState+"]");a.mediaType===Be.AUDIO?this.Se=this.Re=a.newQuality:a.mediaType===Be.VIDEO&&(this.Ha=this.Pa=a.newQuality,this.ka&&this.ka.D(this.Ha))};
e.tm=function(a){this.log("onQualityRequest [readyState: "+this.j.element.readyState+"]");a.mediaType===Be.AUDIO?(this.Re=a.oldQuality,this.Se=a.newQuality):a.mediaType===Be.VIDEO&&(this.Pa=a.oldQuality,this.Ha=a.newQuality,this.pa&&this.pa.D(this.Ha))};e.jm=function(a){var b=this.j.element;this.log("onDurationChange [readyState: "+b.readyState+"]");this.J&&1===b.readyState&&this.J.D(a)};e.fl=function(a){this.log("onLoadedMetaData [readyState: "+this.j.element.readyState+"]");this.Rh=!0;this.$&&this.$.D(a)};
e.om=function(a){this.log("onLoadedData [readyState: "+this.j.element.readyState+"]");this.W&&this.W.D(a)};e.rm=function(a){this.ia&&this.ia.D(a)};e.im=function(a){this.log("onCanPlay [readyState: "+this.j.element.readyState+"]");this.fb=!0;this.G&&this.G.D(a)};e.dl=function(a){this.log("onCanPlayThrough [readyState: "+this.j.element.readyState+"]");this.fb=!0;this.I&&this.I.D(a)};e.hl=function(a){this.log("onPlay [readyState: "+this.j.element.readyState+"]");this.fa&&this.fa.D(a)};
e.gl=function(a){this.log("onPause [readyState: "+this.j.element.readyState+"]");this.Da=!1;this.ea&&this.ea.D(a)};e.Gm=function(a){this.sa&&this.sa.D(a)};e.Lm=function(a){var b=this.j.element;this.log("onVolumeChange [readyState: "+b.readyState+"]");this.za&&0!==b.readyState&&this.za.D(a)};e.Dm=function(a){this.log("onSeeked [readyState: "+this.j.element.readyState+"]");this.fb=!1;this.qa&&this.qa.D(a)};
e.el=function(a){this.log("onEnded [readyState: "+this.j.element.readyState+"]");this.Da=!1;this.Qh++;!0===this.Pc&&this.play();this.M&&this.M.D(a)};e.km=function(a){this.log("onError [readyState: "+this.j.element.readyState+"]");this.P&&this.P.D(a)};e.Em=function(a){this.log("onStalled [readyState: "+this.j.element.readyState+"]");this.ra&&this.ra.D(a)};e.qm=function(a){this.log("onPlaying [readyState: "+this.j.element.readyState+"]");this.ga&&this.ga.D(a)};
e.Fh=function(){var a=this.j;a&&null!==a.element&&!1===this.i.audio.enabled&&this.f.setVolume(0)};e.Gh=function(){Ee(this)};function Ee(a){var b=a.j;b&&null!==b.element&&!0===a.i.audio.enabled&&(a.f.setVolume(a.Ka*a.i.audio.volume),!0===a.Ca?a.f.setMute(!0):a.f.setMute(!1))}
function Fe(a,b){a.Ha=b;if(a.Xa&&a.f&&!0===a.f.isReady()&&a.Aa){var d=a.Xa.index,g=a.Aa.getMaxIndexForBufferType(Be.VIDEO,d),d=a.Aa.getMaxIndexForBufferType(Be.AUDIO,d),h=b;h>=g&&(h=g-1);0>h&&(h=0);b>=d&&(b=d-1);0>b&&(b=0);a.f.setQualityFor(Be.VIDEO,h);a.f.setQualityFor(Be.AUDIO,b)}Ee(a)}
function Ge(a,b){a.Oa===b||b!==ke.Hb&&b!==ke.MANUAL||(a.Oa=b,a.f&&!0===a.f.isReady()&&(b===ke.MANUAL?(a.f.setAutoSwitchQualityFor(Be.VIDEO,!1),a.f.setAutoSwitchQualityFor(Be.AUDIO,!1)):(a.f.setAutoSwitchQualityFor(Be.VIDEO,!0),a.f.setAutoSwitchQualityFor(Be.AUDIO,!0))),a.la&&a.la.D(a.Oa))}
e.load=function(a){null!==a&&(!0===B.T(a,"string")?a=[a]:!0===B.T(a,"VideoQuality")&&(a=[a]),!0===B.Ga(a,"string")?this.Sa=a[0]:!0===B.Ga(a,"VideoQuality")&&(this.Sa=a[0].url));if(""===this.Sa)throw"$_VideoDash : Can't create video with no manifest!";this.j={index:0,element:null,buffer:null,played:null};a=document.createElement("video");a.setAttribute("webkit-playsinline","webkit-playsinline");a.setAttribute("width",this.pixelWidth);a.setAttribute("height",this.pixelHeight);a.volume=0;a.crossOrigin=
"anonymous";a.id="FORGE-VideoDash-"+this.O;var b=new ue(a,"buffered"),d=new ue(a,"played"),g=this.j;g.element=a;g.buffer=b;g.played=d;g.lastTimeStamp=0;this.f=dashjs.MediaPlayer().create();this.f.getDebug().setLogToBrowserConsole(!1);this.f.initialize();this.f.setAutoPlay(!1);this.f.attachView(this.j.element);this.f.attachSource(this.Sa);!0===this.f.isReady()&&(this.f.on(dashjs.MediaPlayer.events.CAN_PLAY,this.ob),this.f.on(dashjs.MediaPlayer.events.ERROR,this.La),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_ENDED,
this.rb),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_ERROR,this.La),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_METADATA_LOADED,this.ub),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_PAUSED,this.Db),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_PROGRESS,this.$b),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_SEEKED,this.dc),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_STARTED,this.Eb),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_TIME_UPDATED,this.qc),this.f.on(dashjs.MediaPlayer.events.QUALITY_CHANGE_RENDERED,
this.ac),this.f.on(dashjs.MediaPlayer.events.QUALITY_CHANGE_REQUESTED,this.cc),this.f.on(dashjs.MediaPlayer.events.STREAM_INITIALIZED,this.sb),this.f.on(dashjs.MediaPlayer.events.PLAYBACK_PLAYING,this.Fb),this.f.on(dashjs.MediaPlayer.events.BUFFER_EMPTY,this.pc),this.f.on(dashjs.MediaPlayer.events.PERIOD_SWITCH_COMPLETED,this.Ue),this.f.on(dashjs.MediaPlayer.events.METRIC_CHANGED,this.Bb),this.j.element.addEventListener("loadeddata",this.tb,!1),this.j.element.addEventListener("durationchange",this.qb,
!1),this.j.element.addEventListener("canplaythrough",this.pb,!1),this.j.element.addEventListener("volumechange",this.rc,!1),this.c.innerHTML="",this.c.appendChild(this.j.element));""===this.Oa&&Ge(this,this.sl)};e.play=function(a,b){this.currentTime=a;this.loop=b;this.f&&!0===this.f.isReady()&&(this.f.play(),this.Da=!0,this.Vh++)};e.pause=function(){this.f&&!0===this.f.isReady()&&(this.f.pause(),this.Da=!1)};
e.stop=function(){this.f&&!0===this.f.isReady()&&(this.f.pause(),this.f.seek(0),this.j.element.currentTime=0,this.Da=!1)};e.jl=function(){!0===this.Da||!1===this.i.audio.enabled?this.pause():this.play()};e.bb=function(){!0!==this.Ca&&!1!==this.i.audio.enabled&&(this.Ca=!0,this.Uh=this.Ka,this.Ka=0,Ee(this))};e.Hh=function(a){!1!==this.Ca&&(a="number"===typeof a?a:this.Uh,this.Ca=!1,this.Ka=G.Z(a,0,1),Ee(this))};e.il=function(a){this.f&&!0===this.f.isReady()&&this.f.enableBufferOccupancyABR(a)};
e.destroy=function(){this.log("_destroyVideo");this.f&&!0===this.f.isReady()&&(this.f.off(dashjs.MediaPlayer.events.CAN_PLAY,this.ob),this.f.off(dashjs.MediaPlayer.events.ERROR,this.La),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_ENDED,this.rb),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_ERROR,this.La),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_METADATA_LOADED,this.ub),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_PAUSED,this.Db),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_PROGRESS,this.$b),
this.f.off(dashjs.MediaPlayer.events.PLAYBACK_SEEKED,this.dc),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_STARTED,this.Eb),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_TIME_UPDATED,this.qc),this.f.off(dashjs.MediaPlayer.events.QUALITY_CHANGE_RENDERED,this.ac),this.f.off(dashjs.MediaPlayer.events.QUALITY_CHANGE_REQUESTED,this.cc),this.f.off(dashjs.MediaPlayer.events.STREAM_INITIALIZED,this.sb),this.f.off(dashjs.MediaPlayer.events.PLAYBACK_PLAYING,this.Fb),this.f.off(dashjs.MediaPlayer.events.BUFFER_EMPTY,
this.pc),this.f.off(dashjs.MediaPlayer.events.PERIOD_SWITCH_COMPLETED,this.Ue),this.f.off(dashjs.MediaPlayer.events.METRIC_CHANGED,this.Bb),this.j.element.removeEventListener("loadeddata",this.tb,!1),this.j.element.removeEventListener("durationchange",this.qb,!1),this.j.element.removeEventListener("canplaythrough",this.pb,!1),this.j.element.removeEventListener("volumechange",this.rc,!1),this.f.pause(),this.f.reset());var a=this.j,b=a.element;"undefined"!==typeof b&&null!==b&&b.parentNode===this.c&&
this.c.removeChild(b);a.element=null;null!==a.buffer&&(a.buffer.destroy(),a.buffer=null);null!==a.played&&(a.played.destroy(),a.played=null);this.S&&(this.S.destroy(),this.S=null);this.$&&(this.$.destroy(),this.$=null);this.W&&(this.W.destroy(),this.W=null);this.ia&&(this.ia.destroy(),this.ia=null);this.J&&(this.J.destroy(),this.J=null);this.G&&(this.G.destroy(),this.G=null);this.I&&(this.I.destroy(),this.I=null);this.fa&&(this.fa.destroy(),this.fa=null);this.ea&&(this.ea.destroy(),this.ea=null);
this.sa&&(this.sa.destroy(),this.sa=null);this.Ma&&(this.Ma.destroy(),this.Ma=null);this.za&&(this.za.destroy(),this.za=null);this.qa&&(this.qa.destroy(),this.qa=null);this.M&&(this.M.destroy(),this.M=null);this.P&&(this.P.destroy(),this.P=null);this.ra&&(this.ra.destroy(),this.ra=null);this.ga&&(this.ga.destroy(),this.ga=null);this.pa&&(this.pa.destroy(),this.pa=null);this.ka&&(this.ka.destroy(),this.ka=null);this.Ja&&(this.Ja.destroy(),this.Ja=null);this.B&&(this.B.destroy(),this.B=null);this.la&&
(this.la.destroy(),this.la=null);this.Ba&&(this.Ba.destroy(),this.Ba=null);this.Bb=this.ac=this.cc=this.pc=this.Fb=this.La=this.rb=this.dc=this.rc=this.qc=this.Db=this.Eb=this.pb=this.ob=this.qb=this.$b=this.tb=this.ub=this.sb=null;this.i.audio.onVolumeChange.remove(this.Gh,this);this.i.audio.onDisable.remove(this.Fh,this);this.j=this.Fa=this.Oc=this.Xa=this.gb=this.Aa=this.sc=this.Hc=this.f=null;U.prototype.destroy.call(this)};Object.defineProperty(J.prototype,"monitoring",{get:function(){return this.gb}});
Object.defineProperty(J.prototype,"quality",{get:function(){return this.Fa[this.Pa]},set:function(a){if("number"===typeof a&&0<=a&&a<this.Fa.length)Ge(this,ke.MANUAL),Fe(this,a);else if(!0===B.T(a,"VideoQuality")){a:{for(var b,d=0,g=this.Fa.length;d<g;d++)if(b=this.Fa[d],b===a){a=d;break a}a=-1}if(-1!==a)Ge(this,ke.MANUAL),Fe(this,a);else throw"Unknown quality";}else throw"Video quality "+a+" out of bounds";}});
Object.defineProperty(J.prototype,"qualityMode",{get:function(){return this.Oa},set:function(a){a!==ke.Hb&&a!==ke.MANUAL||Ge(this,a)}});Object.defineProperty(J.prototype,"qualities",{get:function(){return this.Fa}});Object.defineProperty(J.prototype,"requestIndex",{get:function(){return this.Ha}});Object.defineProperty(J.prototype,"currentIndex",{get:function(){return this.Pa}});Object.defineProperty(J.prototype,"video",{get:function(){return this.j}});
Object.defineProperty(J.prototype,"element",{get:function(){var a=this.j;return a&&null!==a.element?a.element:null}});Object.defineProperty(J.prototype,"buffer",{get:function(){var a=this.j;return a&&null!==a.buffer?a.buffer:null}});Object.defineProperty(J.prototype,"played",{get:function(){var a=this.j;return a&&null!==a.played?a.played:null}});Object.defineProperty(J.prototype,"originalWidth",{get:function(){return Ce(this,"videoWidth")}});
Object.defineProperty(J.prototype,"originalHeight",{get:function(){return Ce(this,"videoHeight")}});Object.defineProperty(J.prototype,"currentTime",{get:function(){return this.f.time()},set:function(a){"number"===typeof a&&(this.f.seek(a),this.Ma&&this.Ma.D(a))}});Object.defineProperty(J.prototype,"currentTimeMS",{get:function(){return 1E3*this.currentTime},set:function(a){this.currentTime=a/1E3}});Object.defineProperty(J.prototype,"remainingTime",{get:function(){return this.duration-this.currentTime}});
Object.defineProperty(J.prototype,"duration",{get:function(){return this.f.duration()}});Object.defineProperty(J.prototype,"durationMS",{get:function(){return Math.round(1E3*this.duration)}});Object.defineProperty(J.prototype,"playing",{get:function(){return this.Da}});Object.defineProperty(J.prototype,"playCount",{get:function(){return this.Vh}});Object.defineProperty(J.prototype,"canPlay",{get:function(){return this.fb}});Object.defineProperty(J.prototype,"endCount",{get:function(){return this.Qh}});
Object.defineProperty(J.prototype,"metaDataLoaded",{get:function(){return this.Rh}});Object.defineProperty(J.prototype,"loop",{get:function(){return this.Pc},set:function(a){"boolean"===typeof a&&(this.Pc=a)}});Object.defineProperty(J.prototype,"volume",{get:function(){return this.Ka},set:function(a){"number"===typeof a&&(this.Ka=G.Z(a,0,1),this.Ca=!1,Ee(this))}});Object.defineProperty(J.prototype,"muted",{get:function(){return this.Ca},set:function(a){!0===!!a?this.bb():this.Hh()}});
Object.defineProperty(J.prototype,"onLoadStart",{get:function(){this.S||(this.S=new p(this));return this.S}});Object.defineProperty(J.prototype,"onLoadedMetaData",{get:function(){this.$||(this.$=new p(this));return this.$}});Object.defineProperty(J.prototype,"onLoadedData",{get:function(){this.W||(this.W=new p(this));return this.W}});Object.defineProperty(J.prototype,"onProgress",{get:function(){this.ia||(this.ia=new p(this));return this.ia}});
Object.defineProperty(J.prototype,"onDurationChange",{get:function(){this.J||(this.J=new p(this));return this.J}});Object.defineProperty(J.prototype,"onCanPlay",{get:function(){this.G||(this.G=new p(this));return this.G}});Object.defineProperty(J.prototype,"onCanPlayThrough",{get:function(){this.I||(this.I=new p(this));return this.I}});Object.defineProperty(J.prototype,"onPlay",{get:function(){this.fa||(this.fa=new p(this));return this.fa}});
Object.defineProperty(J.prototype,"onPause",{get:function(){this.ea||(this.ea=new p(this));return this.ea}});Object.defineProperty(J.prototype,"onTimeUpdate",{get:function(){this.sa||(this.sa=new p(this));return this.sa}});Object.defineProperty(J.prototype,"onCurrentTimeChange",{get:function(){this.M||(this.M=new p(this));return this.M}});Object.defineProperty(J.prototype,"onVolumeChange",{get:function(){this.za||(this.za=new p(this));return this.za}});
Object.defineProperty(J.prototype,"onSeeked",{get:function(){this.qa||(this.qa=new p(this));return this.qa}});Object.defineProperty(J.prototype,"onEnded",{get:function(){this.M||(this.M=new p(this));return this.M}});Object.defineProperty(J.prototype,"onError",{get:function(){this.P||(this.P=new p(this));return this.P}});Object.defineProperty(J.prototype,"onStalled",{get:function(){this.ra||(this.ra=new p(this));return this.ra}});Object.defineProperty(J.prototype,"onWaiting",{get:function(){return this.onStalled}});
Object.defineProperty(J.prototype,"onPlaying",{get:function(){this.ga||(this.ga=new p(this));return this.ga}});Object.defineProperty(J.prototype,"onQualityRequest",{get:function(){this.pa||(this.pa=new p(this));return this.pa}});Object.defineProperty(J.prototype,"onQualityChange",{get:function(){this.ka||(this.ka=new p(this));return this.ka}});Object.defineProperty(J.prototype,"onQualityAbort",{get:function(){this.Ja||(this.Ja=new p(this));return this.Ja}});
Object.defineProperty(J.prototype,"onMetricsChanged",{get:function(){this.Ba||(this.Ba=new p(this));return this.Ba}});Object.defineProperty(J.prototype,"onQualitiesLoaded",{get:function(){this.B||(this.B=new p(this,!0));return this.B}});Object.defineProperty(J.prototype,"onQualityModeChange",{get:function(){this.la||(this.la=new p(this));return this.la}});function ue(a,b){this.c=a;this.f=b;l.call(this,"VideoTimeRanges")}ue.prototype=Object.create(l.prototype);ue.prototype.constructor=ue;
ue.prototype.j=function(a){var b=this.c[this.f];if(!this.length)return this.warn("No available range for now"),null;if(a>this.length-1)return this.warn("Time range out of bounds, returning the last available range"),this.j(this.length-1);if(0>a)return this.warn("Time range out of bounds, returning the first available range"),this.j(0);var d=b.start(a);a=b.end(a);return{start:d,end:a}};
ue.prototype.Mj=function(a,b){"number"!==typeof b&&(b=0);for(var d=this.c[this.f],g,h,k=this.length;k--;)if(g=d.start(k),h=d.end(k),a>=g&&a+b<=h)return!0;return!1};Object.defineProperty(ue.prototype,"length",{get:function(){return this.c[this.f].length}});function Ae(a){this.m="";this.j=a||"";this.o=this.c="";this.f=this.u=this.A=0;l.call(this,"VideoQuality")}Ae.prototype=Object.create(l.prototype);Ae.prototype.constructor=Ae;
function He(a){var b=["mp4","webm","ogg"];a=Da(a);if(""!==a.extension&&-1!==b.indexOf(a.extension))return"video/"+a.extension;b=["mpd"];return""!==a.extension&&-1!==b.indexOf(a.extension)?"application/dash+xml":""}Object.defineProperty(Ae.prototype,"id",{get:function(){return this.m},set:function(a){if("number"===typeof a||"string"===typeof a)this.m=a}});Object.defineProperty(Ae.prototype,"url",{get:function(){return this.j},set:function(a){"string"===typeof a&&(this.j=a)}});
Object.defineProperty(Ae.prototype,"mimeType",{get:function(){""===this.c&&""!==this.j&&(this.c=He(this.j));return this.c}});Object.defineProperty(Ae.prototype,"name",{get:function(){return this.o},set:function(a){"string"===typeof a&&(this.o=a)}});Object.defineProperty(Ae.prototype,"framerate",{get:function(){return 0}});Object.defineProperty(Ae.prototype,"bitrate",{get:function(){return this.A},set:function(a){"number"===typeof a&&(this.A=a)}});
Object.defineProperty(Ae.prototype,"width",{get:function(){return this.u},set:function(a){"number"===typeof a&&(this.u=a)}});Object.defineProperty(Ae.prototype,"height",{get:function(){return this.f},set:function(a){"number"===typeof a&&(this.f=a)}});Object.defineProperty(Ae.prototype,"speed",{get:function(){return 1}});var ke={Hb:"auto",MANUAL:"manual"},Ma={Ne:"dash",rl:"html5",zd:"unknown"};
function Sd(a){this.m=a;this.f={};this.c=null;this.j=[];l.call(this,"SpriteAnimationManager");!1===this.m.loaded&&this.m.onLoadComplete.ca(this.Sm,this)}Sd.prototype=Object.create(l.prototype);e=Sd.prototype;e.constructor=Sd;e.Sm=function(){this.log("_spriteLoadComplete");for(var a,b,d=0,g=this.j.length;d<g;d++)a=this.j[d].method,b=this.j[d].args,Sd.prototype[a].apply(this,b);this.j=[]};
e.add=function(a,b,d,g,h){if(!1===this.m.loaded)this.j.push({method:"add",args:arguments});else{this.log("add");"string"!==typeof a&&(a="default");b=parseInt(b,10);d=parseInt(d,10);var k=this.m.frames;if("number"!==typeof b||!0===isNaN(b)||0>b||b>=k.length)b=0;if("number"!==typeof d||!0===isNaN(d)||0>d||d>=k.length)d=k.length;h="undefined"===typeof h?!1:!!h;this.f[a]=new X(this.m,a,k.slice(b,d),g||60);this.c=this.f[a]}};
e.play=function(a,b,d){if(!1===this.m.loaded)this.j.push({method:"play",args:arguments});else{var g=this.c;"string"===typeof a&&null!==a&&(g=this.get(a));g&&g.play(b,d)}};e.pause=function(a){var b=this.c;b&&b.pause(a)};e.resume=function(a){var b=this.c;b&&b.resume(a)};e.stop=function(){var a=this.c;a&&a.stop()};e.get=function(a){return!0===B.T(this.f[a],"SpriteAnimation")?this.f[a]:null};e.update=function(){this.c&&this.c.update()};
e.destroy=function(){for(var a in this.f)this.f[a].destroy(),this.f[a]=null;this.j=this.c=this.f=this.m=null;l.prototype.destroy.call(this)};Object.defineProperty(Sd.prototype,"currentAnimation",{get:function(){return this.c},set:function(a){!0===B.T(a,"SpriteAnimation")&&(this.c=a)}});
function X(a,b,d,g){this.B=a;this.M=b;this.C=d||[];this.N=0;this.U=g||60;this.J=!1;this.V=0;this.F=1E3/g;this.G=this.K=0;this.R=1;this.I=this.c=this.H=!1;this.f=this.A=this.j=this.u=this.m=this.o=null;l.call(this,"SpriteAnimation")}X.prototype=Object.create(l.prototype);e=X.prototype;e.constructor=X;function Ie(a,b){a.N="number"===typeof b&&0<=b&&b<a.C.length?b:0;a.B.frame=a.C[a.N].frame}
e.play=function(a,b){"boolean"===typeof a&&(this.J=a);this.H=!0;this.c=this.I=!1;this.V=0;this.K=this.B.viewer.clock.time+this.F;Ie(this,b);this.B.animations.io=this;this.o&&this.o.D()};e.pause=function(a){!0!==this.c&&(this.c=!0,"number"===typeof a&&Ie(this,a),this.m&&this.m.D())};e.resume=function(a){!1!==this.c&&(this.c=!1,"number"===typeof a&&Ie(this,a),this.H&&(this.K=this.B.viewer.clock.time+this.F),this.u&&this.u.D())};e.stop=function(){this.H=!1;this.I=!0;this.c=!1;Ie(this,0);this.A&&this.A.D()};
e.update=function(){if(!0!==this.c){var a=this.B.viewer.clock.time;!0===this.H&&a>=this.K&&(this.R=1,this.G=a-this.K,this.G>this.F&&(this.R=Math.floor(this.G/this.F),this.G-=this.R*this.F),this.K=a+(this.F-this.G),a=this.N+this.R,a>=this.C.length?!0===this.J?(a%=this.C.length,this.V++,this.j&&this.j.D(),Ie(this,a)):(Ie(this,this.C.length-1),this.H=!1,this.I=!0,this.c=!1,this.f&&this.f.D()):Ie(this,a))}};
e.destroy=function(){this.C=this.B=null;this.o&&(this.o.destroy(),this.o=null);this.m&&(this.m.destroy(),this.m=null);this.u&&(this.u.destroy(),this.u=null);this.f&&(this.f.destroy(),this.f=null);this.j&&(this.j.destroy(),this.j=null);this.A&&(this.A.destroy(),this.A=null);l.prototype.destroy.call(this)};Object.defineProperty(X.prototype,"name",{get:function(){return this.M}});Object.defineProperty(X.prototype,"frames",{get:function(){return this.C}});
Object.defineProperty(X.prototype,"frameIndex",{get:function(){return this.N}});Object.defineProperty(X.prototype,"frameRate",{get:function(){return this.U},set:function(a){"number"===typeof a&&(this.U=a,this.F=1E3/this.U)}});Object.defineProperty(X.prototype,"loop",{get:function(){return this.J},set:function(a){this.J=!!a}});Object.defineProperty(X.prototype,"loopCount",{get:function(){return this.V}});Object.defineProperty(X.prototype,"playing",{get:function(){return this.H}});
Object.defineProperty(X.prototype,"paused",{get:function(){return this.c},set:function(a){!0===!!a?this.pause():this.resume()}});Object.defineProperty(X.prototype,"complete",{get:function(){return this.I}});Object.defineProperty(X.prototype,"onPlay",{get:function(){this.o||(this.o=new p(this));return this.o}});Object.defineProperty(X.prototype,"onPause",{get:function(){this.m||(this.m=new p(this));return this.m}});
Object.defineProperty(X.prototype,"onResume",{get:function(){this.u||(this.u=new p(this));return this.u}});Object.defineProperty(X.prototype,"onLoop",{get:function(){this.j||(this.j=new p(this));return this.j}});Object.defineProperty(X.prototype,"onComplete",{get:function(){this.f||(this.f=new p(this));return this.f}});Object.defineProperty(X.prototype,"onStop",{get:function(){this.A||(this.A=new p(this));return this.A}});
function va(a){this.i=a;this.O=new Je;this.m=new Je;this.f=new Je;this.c=new Je;this.j=0}var A={JSON:"json",Tb:"xml",IMAGE:"image",nb:"sound"},Ke={Mc:["forge","forgejs","FORGE"]};Ke.JSON=["forge.story.config"].concat(Ke.Mc);Ke.Tb=[].concat(Ke.Mc);Ke.IMAGE=[].concat(Ke.Mc);Ke.nb=[].concat(Ke.Mc);function Le(a,b){var d=null;switch(b){case A.JSON:d=a.O;break;case A.Tb:d=a.m;break;case A.IMAGE:d=a.f;break;case A.nb:d=a.c}return d}
function Me(a,b,d){var g=Le(a,b),h=(d||"FORGE-cache")+"-"+a.j;a.j++;return!1===g.has(h)&&!1===Ne(b,h)?h:Me(a,b,d)}function Ne(a,b){var d=null;switch(a){case A.JSON:d=Ke.JSON;break;case A.Tb:d=Ke.Tb;break;case A.IMAGE:d=Ke.IMAGE;break;case A.nb:d=Ke.nb}return(a=d)?-1!==a.indexOf(b.toLowerCase()):!1}e=va.prototype;e.has=function(a,b){return(a=Le(this,a))?a.has(b):!1};e.get=function(a,b){return!0===this.has(a,b)&&(a=Le(this,a))?a.get(b):null};
e.add=function(a,b,d){var g;(g="string"!==typeof b||""===b)||(g=Le(this,a),g=!0===(!0===Ne(a,b)&&!0===g.has(b)));g&&(b=Me(this,a,a+"-cache"));return!1===this.has(b,a)&&(a=Le(this,a))?(a.set(b,d),!0):!1};e.remove=function(a,b){return!0===this.has(a,b)&&(a=Le(this,a))?(a.Ce(b),!0):!1};e.destroy=function(){this.c=this.f=this.O=this.i=null};function Oe(){}e=Oe.prototype;e.key="";e.url="";e.type="";e.data=null;e.Un=null;e.zb=!1;e.vk=!1;e.uk="";e.constructor=Oe;
function wa(a){this.i=a;l.call(this,"Loader")}wa.prototype=Object.create(l.prototype);e=wa.prototype;e.constructor=wa;e.json=function(a,b,d,g,h,k){var q=new Oe;q.type="json";q.key=a;q.url=b;q.c=d;q.f=g;q.O=h;q.j=k;Pe(this,q,"text",this.Wl,this.Xl)};
e.Wl=function(a,b){if(b.responseText){if(a.data=Object(JSON.parse(b.responseText)),!1===this.i.cache.has(A.JSON,a.key)?this.i.cache.add(A.JSON,a.key,a):this.log("$_Loader.json : JSON file already exists"),"function"===typeof a.c&&null!==a.f){b=a.c;var d=a.f;a.c=null;a.f=null;a.O=null;a.j=null;b.call(d,a)}}else throw"$_Loader.json : JSON file empty ?";};
e.Xl=function(a,b){if(b.responseText){if("function"===typeof a.O&&null!==a.j){b=a.O;var d=a.j;a.c=null;a.f=null;a.O=null;a.j=null;b.call(d,a)}}else throw"$_Loader.json : JSON file empty ?";};e.Bk=function(a,b,d,g,h,k){h=new Oe;h.type="xml";h.key=a;h.url=b;h.c=d;h.f=g;h.O=d;h.j=k;Pe(this,h,"document",this.Wm,this.Xm)};
e.Wm=function(a,b){if(b.responseXML){if(a.data=b.responseXML,!1===this.i.cache.has(A.Tb,a.key)?this.i.cache.add(A.Tb,a.key,a):this.log("$_Loader.xml : XML file already exists"),"function"===typeof a.c&&null!==a.f){b=a.c;var d=a.f;a.c=null;a.f=null;a.O=null;a.j=null;b.call(d,a)}}else throw"$_Loader.xml : XML file empty ?";};
e.Xm=function(a,b){if(b.responseXML){if("function"===typeof a.O&&null!==a.j){b=a.O;var d=a.j;a.c=null;a.f=null;a.O=null;a.j=null;b.call(d,a)}}else throw"$_Loader.xml : JSON file empty ?";};e.sound=function(a,b,d,g,h){var k=new Oe;k.type="sound";k.key=a;k.url=b;k.c=d;k.f=g;!0===this.i.audio.useWebAudio&&!0!==h?Pe(this,k,"arraybuffer",this.Ei):!0!==this.i.audio.useAudioTag&&!0!==h||Qe(k,this.Ei,this)};
e.Ei=function(a,b){!0===this.i.audio.useWebAudio&&"undefined"!==typeof b&&(a.data=b.response);this.i.cache.add(A.nb,a.key,a);"function"===typeof a.c&&null!==a.f&&a.c.call(a.f,a)};
function Qe(a,b,d){function g(){a.data.removeEventListener(h,g,!1);a.data.onerror=null;"function"===typeof b&&b.call(d,a)}a.data=new Audio;a.data.preload="auto";a.data.crossOrigin="anonymous";a.data.src=a.url;var h="canplaythrough";a.data.onerror=function(){a.data.removeEventListener(h,g,!1);a.data.onerror=null;throw"$_Loader._loadAudioTag : Could not load "+a.url;};"undefined"===typeof a.data.oncanplaythrough&&(h="canplay");a.data.addEventListener(h,g,!1);a.data.load()}
function Pe(a,b,d,g,h){b.zb=!0;var k=new XMLHttpRequest;k.open("GET",b.url,!0);k.responseType=d;k.onreadystatechange=function(){if(k.readyState===XMLHttpRequest.DONE){if(200!==k.status&&k.status)throw"$_Loader._xhr : Could not load "+b.url;this.onreadystatechange=null;"function"===typeof g&&(b.loaded=!0,g.call(this,b,k))}}.bind(a);k.onerror=function(){"function"===typeof h&&h.call(this,b,k)}.bind(a);k.send()}
e.image=function(a,b,d,g){var h=new Oe;h.type="image";h.key=a;h.url=b;h.data=new Image;h.data.crossOrigin="anonymous";h.data.onload=function(){h.data.onload=null;h.data.onerror=null;h.zb=!1;h.loaded=!0;this.i.cache.add(A.IMAGE,h.key,h);d.call(g,h)}.bind(this);h.data.onerror=function(){h.data.onload=null;h.data.onerror=null;throw"ERROR : $_Loader.image, failed to load image key : "+a+" at url "+b;};h.data.src=h.url;h.zb=!0};
e.rg=function(a,b,d){for(var g=document.getElementsByTagName("head")[0],h=g.getElementsByTagName("script"),k=0,q=h.length;k<q;k++)if(h[k].src===a){this.warn("Attempt to load an already loaded script!");b.call(d);return}var v=document.createElement("script");v.type="text/javascript";v.onload=function(){v.onload=null;b.call(d)};v.src=a;g.appendChild(v)};
e.Yi=function(a,b,d){var g=document.createElement("link");g.type="text/css";g.rel="stylesheet";"undefined"!==typeof b&&"undefined"!==typeof d&&(g.onload=function(){g.onload=null;b.call(d)});g.href=a;document.getElementsByTagName("head")[0].appendChild(g)};e.destroy=function(){this.i=null;l.prototype.destroy.call(this)};function ja(a){this.i=a;this.j=this.f=0;this.c=null;l.call(this,"DependencyManager")}ja.prototype=Object.create(l.prototype);ja.prototype.constructor=ja;
ja.prototype.add=function(a){"undefined"!==typeof a&&"string"===typeof a.url&&(this.f++,this.i.load.rg(a.url,this.m,this))};ja.prototype.m=function(){this.j++;this.f-this.j||(console.log("DependencyManager : all scripts loaded"),this.c&&this.c.D())};ja.prototype.destroy=function(){this.i=null;l.prototype.destroy.call(this)};Object.defineProperty(ja.prototype,"dependencies",{get:function(){return this.f}});
Object.defineProperty(ja.prototype,"onAllScriptsLoaded",{get:function(){this.c||(this.c=new p(this));return this.c}});function ka(a){this.i=a;this.f=0;this.c=null;l.call(this,"Clock");this.f=Date.now();this.c=[]}ka.prototype=Object.create(l.prototype);e=ka.prototype;e.constructor=ka;e.Hm=function(a){a:{if(this.c)for(var b,d=0,g=this.c.length;d<g;d++)if(b=this.c[d],b===a.emitter){a=d;break a}a=-1}-1!==a&&this.c.splice(a,1)};e.create=function(a){return this.add(new Y(this.i,a))};
e.add=function(a){this.c.push(a);a.onDestroy.add(this.Hm,this);return a};e.update=function(){this.f=Date.now();for(var a=0,b=this.c.length;a<b;a++)this.c[a].update(this.f)};e.destroy=function(){this.i=null;for(var a=this.c.length;a--;)this.c[a].destroy();this.c=null};Object.defineProperty(ka.prototype,"time",{get:function(){return this.f}});
function Y(a,b){this.i=a;this.J="undefined"!==typeof b?b:!0;this.B=0;this.j=!1;this.K=this.I=0;this.m=!1;this.f=0;this.G=!1;this.u=this.H=this.C=this.A=this.F=this.c=null;l.call(this,"Timer");this.c=[];this.f=Date.now()}Y.prototype=Object.create(l.prototype);e=Y.prototype;e.constructor=Y;function Re(a,b){for(var d=0;d<a.c.length;d++){var g=a.c[d];if(!1===g.f){var h=g.c-b;0>h&&(h=0);g.c=a.f+h}}b=a.o-b;a.o=0>b?a.f:a.f+b}function Se(a){0<a.c.length&&(a.c.sort(a.Rm),a.o=a.c[0].c)}
e.Rm=function(a,b){return a.c<b.c?-1:a.c>b.c?1:0};e.create=function(a,b,d,g,h,k){var q=a=Math.round(a);this.f?q+=this.f:q+=this.i.clock.time;a=new Te(0,a,q,d,b,g,h,k);this.c.push(a);Se(this);this.G=!1;return a};e.add=function(a,b,d,g){return this.create(a,!1,0,b,d,Array.prototype.splice.call(arguments,3))};e.cl=function(a,b,d,g){return this.create(a,!1,b,d,g,Array.prototype.splice.call(arguments,4))};e.Ke=function(a,b,d){return this.create(a,!0,0,b,d,Array.prototype.splice.call(arguments,3))};
e.remove=function(a){for(var b=0;b<this.c.length;b++)if(this.c[b]===a)return this.c[b].f=!0;return!1};e.start=function(){if(!0!==this.j){this.B=this.i.clock.time;this.j=!0;for(var a,b=0;b<this.c.length;b++)a=this.c[b],a.c=a.delay+this.B;this.F&&this.F.D()}};e.stop=function(a){this.j=!1;!1!==a&&(this.c.length=0);this.H&&this.H.D()};e.pause=function(){!1!==this.j&&!0!==this.m&&(this.I=this.i.clock.time,this.m=!0,this.A&&this.A.D())};
e.resume=function(){if(!1!==this.m){var a=this.i.clock.time;this.K+=a-this.f;this.f=a;Re(this,this.I);this.m=!1;this.C&&this.C.D()}};
e.update=function(a){if(!0!==this.m){var b=a-this.f;this.f=a;1E3<b&&Re(this,a-b);for(a=this.c.length;a--;)!0===this.c[a].f&&this.c.splice(a,1);a=this.c.length;var d=b=0;if(!0===this.j&&this.f>=this.o&&0<a){for(var g;b<a&&!0===this.j;)if(g=this.c[b],this.f>=g.c&&!1===g.f){var h=this.f+g.delay-(this.f-g.c);0>h&&(h=this.f+g.delay);!0===g.loop?g.c=h:0<g.O?(g.O--,g.c=h):(d++,g.f=!0);g.yb();b++}else break;this.c.length>d?Se(this):(this.G=!0,this.j=!1,this.u&&this.u.D())}this.G&&this.J&&this.destroy()}};
e.destroy=function(){this.j=!1;this.c=[];l.prototype.destroy.call(this)};Object.defineProperty(Y.prototype,"autoDestroy",{get:function(){return this.J}});Object.defineProperty(Y.prototype,"running",{get:function(){return this.j}});Object.defineProperty(Y.prototype,"paused",{get:function(){return this.m}});Object.defineProperty(Y.prototype,"next",{get:function(){return this.o}});Object.defineProperty(Y.prototype,"duration",{get:function(){return this.j&&this.o>this.f?this.o-this.f:0}});
Object.defineProperty(Y.prototype,"length",{get:function(){return this.c.length}});Object.defineProperty(Y.prototype,"ms",{get:function(){return this.j?this.f-this.B-this.K:0}});Object.defineProperty(Y.prototype,"seconds",{get:function(){return this.j?.001*this.ms:0}});Object.defineProperty(Y.prototype,"onStart",{get:function(){this.F||(this.F=new p(this));return this.F}});Object.defineProperty(Y.prototype,"onPause",{get:function(){this.A||(this.A=new p(this));return this.A}});
Object.defineProperty(Y.prototype,"onResume",{get:function(){this.C||(this.C=new p(this));return this.C}});Object.defineProperty(Y.prototype,"onStop",{get:function(){this.H||(this.H=new p(this));return this.H}});Object.defineProperty(Y.prototype,"onComplete",{get:function(){this.u||(this.u=new p(this));return this.u}});function Te(a,b,d,g,h,k,q,v){this.delay=b;this.c=d;this.O=g-1;this.loop=h;this.m=k;this.o=q;this.j=v;this.f=!1}Te.prototype.constructor=Te;
Te.prototype.yb=function(){this.m.apply(this.o,this.j)};function xa(a){this.i=a;this.c=[];l.call(this,"TweenManager")}xa.prototype=Object.create(l.prototype);e=xa.prototype;e.constructor=xa;e.Um=function(a){this.remove(a.emitter)};e.add=function(a){this.c.push(a);a.onDestroy.ca(this.Um,this)};e.remove=function(a){a:{for(var b=0,d=this.c.length;b<d;b++)if(a===this.c[b]){a=b;break a}a=-1}-1!==a&&this.c.splice(a,1)};e.update=function(){for(var a=0,b=this.c.length;a<b;a++)this.c[a].update()};
e.destroy=function(){for(var a=this.c.length;a--;)this.c[a].destroy();this.i=this.c=null;l.prototype.destroy.call(this)};function Bb(a,b){this.i=a;this.C=b;this.c=null;this.A=Gb.LINEAR;this.H=null;this.u=this.F=this.B=!1;this.o=this.f=this.j=this.m=null;l.call(this,"Tween")}Bb.prototype=Object.create(l.prototype);e=Bb.prototype;e.constructor=Bb;
e.Le=function(a,b,d){this.c||(this.c={});for(var g in a)this.c[g]={name:g,min:null,max:a[g],duration:"number"===typeof b?b:0,easing:"function"===typeof d?d:null,started:!1,complete:!1,startTime:null};return this};e.start=function(){this.H=Date.now();this.B=!0;this.u=this.F=!1;var a,b;for(b in this.c)a=this.c[b],a.min=this.C[b],a.max="string"===typeof this.c[b].max?a.min+parseInt(this.c[b].max,10):a.max,a.started=!0,a.startTime=this.H;this.m&&this.m.D();return this};
e.stop=function(){this.F=!0;this.o&&this.o.D();return this};e.update=function(){if(!1!==this.B&&!0!==this.u&&!0!==this.F){var a,b=0,d;for(d in this.c){a=this.c[d];if(!1===a.complete){var g=a,h=Date.now()-g.startTime;g.complete=h>=g.duration;!1===g.complete?(h=(null!==g.easing?g.easing:this.A)(h/g.duration),this.C[g.name]=h*(g.max-g.min)+g.min):this.C[g.name]=g.max}!1===a.complete&&b++}this.j&&this.j.D();b||(this.u=!0,this.f&&this.f.D())}};
e.destroy=function(){this.stop();this.A=this.c=this.C=this.i=null;this.m&&(this.m.destroy(),this.m=null);this.j&&(this.j.destroy(),this.j=null);this.f&&(this.f.destroy(),this.f=null);this.o&&(this.o.destroy(),this.o=null);l.prototype.destroy.call(this)};Object.defineProperty(Bb.prototype,"easing",{get:function(){return this.A},set:function(a){"function"===typeof a&&(this.A=a)}});Object.defineProperty(Bb.prototype,"complete",{get:function(){return this.u}});
Object.defineProperty(Bb.prototype,"onStart",{get:function(){this.m||(this.m=new p(this));return this.m}});Object.defineProperty(Bb.prototype,"onProgress",{get:function(){this.j||(this.j=new p(this));return this.j}});Object.defineProperty(Bb.prototype,"onComplete",{get:function(){this.f||(this.f=new p(this));return this.f}});Object.defineProperty(Bb.prototype,"onStop",{get:function(){this.o||(this.o=new p(this));return this.o}});
var Gb={LINEAR:function(a){return G.Z(a,0,1)},eo:function(a){return G.Z(1+Math.sin(Math.PI/2*(a-1)),0,1)},fo:function(a){return G.Z(.5*(1+Math.sin(Math.PI/2*(2*a-1))),0,1)},ho:function(a){return G.Z(Math.sin(Math.PI/2*a),0,1)},ao:function(a){return G.Z(a*a,0,1)},bo:function(a){return G.Z(.5>a?2*a*a:1-2*(a-1)*(a-1),0,1)},co:function(a){a=1-a;return G.Z(1-a*a,0,1)},Yn:function(a){return G.Z(a*a*a,0,1)},Zn:function(a){return G.Z(.5>a?4*a*a*a:1+4*(a-1)*(a-1)*(a-1),0,1)},$n:function(a){a=1-a;return G.Z(1-
a*a*a,0,1)},nl:function(a){a<1/2.75?a*=7.5625*a:a<2/2.75?(a-=1.5/2.75,a=7.5625*a*a+.75):a<2.5/2.75?(a-=2.25/2.75,a=7.5625*a*a+.9375):(a-=2.625/2.75,a=7.5625*a*a+.984375);return G.Z(a,0,1)},Xn:function(a){return 1-Gb.nl(1-a)}},B={lg:function(a){var b={value:null,Gc:null};if("string"===typeof a){var d=parseInt(a,10);!1===isNaN(d)&&(b.value=d);-1<a.indexOf("%")?b.Gc="%":-1<a.indexOf("px")&&(b.Gc="px")}return b},kc:function(a,b,d){var g={};a="undefined"!==typeof a?a:{};b="undefined"!==typeof b?b:{};for(var h in a)a.hasOwnProperty(h)&&
(g[h]=a[h]);for(var k in b)b.hasOwnProperty(k)&&(g[k]=!1!==d&&a&&null!==b[k]&&"undefined"!==typeof b[k]&&b[k].constructor===Object?B.kc(a[k],b[k],!0):b[k]);return g},ab:function(a){for(var b=arguments,d={},g=0,h=b.length;g<h;g++)d=B.kc(d,b[g],!0);return d},clone:function(a){if(!(a instanceof Object))return a;var b=new a.constructor,d;for(d in a)b[d]=B.clone(a[d]);return b},zn:function(a){return a&&"object"===typeof a&&"string"===typeof a.className&&-1!==Fd.indexOf(a.className)?!0:!1},T:function(a,
b){if("string"===typeof b&&(null!==a&&"object"===typeof a&&"string"===typeof a.className&&a.className.toLowerCase()===b.toLowerCase()||typeof a===b.toLowerCase()))return!0;if(!0===Array.isArray(b)&&!0===B.Ga(b,"string"))for(var d=0,g=b.length;d<g;d++)if(!0===B.T(a,b[d]))return!0;return!1},Cn:function(a,b,d){b=b.split(".");for(var g=0,h=b.length;g<h;g++){a=a[b[g]];if(g===h-1)return B.T(a,d);if("undefined"===typeof a)break}return!1},Ga:function(a,b){if("object"===typeof a&&!0===Array.isArray(a)){for(var d=
0,g=a.length;d<g;d++)if(!1===B.T(a[d],b))return!1;return!0}return!1},Xd:function(a,b,d){b=b.split(".");for(var g=0,h=b.length;g<h;g++){a=a[b[g]];if("undefined"===typeof a)break;if(g===h-1)return a}return d},nd:function(a,b){var d=b.split("."),g=d.length;a.sort(function(a,b){for(var h=0;h<g;)a=a[d[h]],b=b[d[h]],h++;return a<b?-1:a>b?1:0});return a},kd:function(a){a=a.slice();for(var b,d,g=a.length-1;0<g;g--)d=~~(Math.random()*(g+1)),b=a[g],a[g]=a[d],a[d]=b;return a},de:function(a,b,d){for(a=String(a);a.length<
d;)a=b+a;return a},Wj:function(a){a={input:a,hours:0,minutes:0,seconds:0};if("number"!==typeof a.input||isNaN(a.input))return a;a.wn=parseInt(a.input/3600,10)%24;a.En=parseInt(a.input/60,10)%60;a.seconds=parseInt(a.input%60,10);return a},gn:function(a,b){a=B.Wj(a);var d="string"===typeof b?b:"H:M:S";b=0;-1!==d.indexOf("H")?b=2:-1!==d.indexOf("h")&&(b=1);var g=0;-1!==d.indexOf("M")?g=2:-1!==d.indexOf("m")&&(g=1);var h=0;-1!==d.indexOf("S")?h=2:-1!==d.indexOf("s")&&(h=1);d=d.toLowerCase();0<b&&(d=d.replace("h",
B.de(a.wn,0,b)));0<g&&(d=d.replace("m",B.de(a.En,0,g)));0<h&&(d=d.replace("s",B.de(a.seconds,0,h)));return d},wg:function(a,b,d){return new THREE.Spherical(a,Math.PI/2-d,b)},kn:function(a){return{radius:a.radius,theta:a.theta,phi:Math.PI/2-a.phi}},Ti:function(a,b){return a.filter(function(a){return 0>b.indexOf(a)})},Hn:function(a,b){return b>=a.length?null:a.splice(b,1)},endsWith:function(a,b){return"function"!==typeof String.prototype.endsWith?-1!==a.indexOf(b,a.length-b.length):a.endsWith(b)}},
ha={bd:function(a,b){var d=window.getComputedStyle(a,null).getPropertyValue("display");a.style.display="none";b=window.getComputedStyle(a,null).getPropertyValue(b);a.style.display=d;return b},xj:function(a){a=ha.bd(a,"width");var b="px";-1<a.indexOf("%")&&(b="%");-1<a.indexOf("px")&&(b="px");return b},zj:function(a){a=parseInt(ha.bd(a,"width"),10);return isNaN(a)?0:a},wj:function(a){a=ha.bd(a,"height");var b="px";-1<a.indexOf("%")&&(b="%");-1<a.indexOf("px")&&(b="px");return b},yj:function(a){a=parseInt(ha.bd(a,
"height"),10);return isNaN(a)?0:a},has:function(a){return document.body.contains(a)},Zf:function(a){return a instanceof HTMLElement},nn:function(a){var b,d;d=["MouseEvent","PointerEvent","TouchEvent"];"object"===typeof a.srcEvent&&d.indexOf(a.srcEvent.constructor.toString())?(b=a.target.getBoundingClientRect(),d=a.srcEvent.clientX-b.left,a=a.srcEvent.clientY-b.top):(b=(a.currentTarget||a.target||a.srcElement).getBoundingClientRect(),d=a.clientX-b.left,a=a.clientY-b.top);return{x:d,y:a}}};
function Je(){this.f=0;this.c={}}e=Je.prototype;e.constructor=Je;e.set=function(a,b){if("undefined"!==typeof a)return void 0===this.c[a]&&this.f++,this.c[a]=b,this.f};e.Ce=function(a){if("undefined"!==typeof a&&void 0!==this.c[a])return delete this.c[a],--this.f};e.get=function(a){return this.c[a]};e.Ek=function(){var a=new kd,b;for(b in this.c)a.add(b);return a.pe()};e.Fk=function(){var a=new kd,b;for(b in this.c)a.add(this.c[b]);return a.pe()};
e.Dk=function(){var a=new kd,b;for(b in this.c){var d=[];d.push(b);d.push(this.c[b]);a.add(d)}return a.pe()};e.Ck=function(){for(var a in this.c)this.Ce(a)};e.has=function(a){return 0<this.f&&void 0!==this.c[a]};Object.defineProperty(Je.prototype,"size",{get:function(){return this.f}});function kd(){this.c=[]}e=kd.prototype;e.constructor=kd;e.add=function(a){this.c.push(a);return this.c.length};e.remove=function(a){for(var b=0,d=this.c.length;b<d;b++)this.c[b]===a&&this.c.splice(b,1)};e.get=function(a){return this.c[a]};
e.pe=function(){return this.c};Object.defineProperty(kd.prototype,"size",{get:function(){return this.c.length}});function Ue(a){this.j=a;this.c=this.F=this.f=this.A=this.u=this.C="";this.o=null;this.m="";l.call(this,"URL")}Ue.prototype=Object.create(l.prototype);Ue.prototype.constructor=Ue;
function Da(a){var b=new Ue;"string"!==typeof a&&(a=window.location.toString());b.j=a;a=document.createElement("a");a.href=b.j;b.C=a.protocol;b.u=a.hostname;b.A=a.port;b.f=a.pathname;b.F=a.search;b.c=a.hash;b.m=b.f.substr(b.f.lastIndexOf(".")+1);if(""!==b.c){a=b.c.replace("#","").split("&");var d={};d.slug=a[0];for(var g=1,h=a.length;g<h;g++){var k=a[g].split("=");d[k[0]]=decodeURIComponent(k[1])}b.o=d}return b}Object.defineProperty(Ue.prototype,"url",{get:function(){return this.j}});
Object.defineProperty(Ue.prototype,"protocol",{get:function(){return this.C}});Object.defineProperty(Ue.prototype,"host",{get:function(){return this.u}});Object.defineProperty(Ue.prototype,"port",{get:function(){return this.A}});Object.defineProperty(Ue.prototype,"path",{get:function(){return this.f}});Object.defineProperty(Ue.prototype,"query",{get:function(){return this.F}});Object.defineProperty(Ue.prototype,"hash",{get:function(){return this.c}});
Object.defineProperty(Ue.prototype,"hashParameters",{get:function(){return this.o}});Object.defineProperty(Ue.prototype,"extension",{get:function(){return this.m}});
var Z={Jn:function(a,b,d){a/=255;b/=255;d/=255;var g=Math.max(a,b,d),h=Math.min(a,b,d),k,q=(g+h)/2;if(g===h)k=h=0;else{var v=g-h,h=.5<q?v/(2-g-h):v/(g+h);switch(g){case a:k=(b-d)/v+(b<d?6:0);break;case b:k=(d-a)/v+2;break;case d:k=(a-b)/v+4}k/=6}return{h:k,s:h,l:q}},xn:function(a,b,d){if(b){var g=.5>d?d*(1+b):d+b-d*b,h=2*d-g;d=Z.Zd(h,g,a+1/3);b=Z.Zd(h,g,a);a=Z.Zd(h,g,a-1/3)}else d=b=a=d;return{r:255*d,g:255*b,b:255*a}},Zd:function(a,b,d){if(!(0>d||1<d)){if(d<1/6)return a+6*(b-a)*d;if(.5>d)return b;
if(d<2/3)return a+(b-a)*(2/3-d)*6}return a},Kn:function(a,b,d){a/=255;b/=255;d/=255;var g=Math.max(a,b,d),h=Math.min(a,b,d),k,q=g-h;if(g===h)k=0;else{switch(g){case a:k=(b-d)/q+(b<d?6:0);break;case b:k=(d-a)/q+2;break;case d:k=(a-b)/q+4}k/=6}return{h:k,s:g?q/g:0,v:g}},yn:function(a,b,d){var g,h,k,q=Math.floor(6*a),v=6*a-q;a=d*(1-b);var x=d*(1-v*b);b=d*(1-(1-v)*b);switch(q%6){case 0:g=d;h=b;k=a;break;case 1:g=x;h=d;k=a;break;case 2:g=a;h=d;k=b;break;case 3:g=a;h=x;k=d;break;case 4:g=b;h=a;k=d;break;
case 5:g=d,h=a,k=x}return{r:255*g,g:255*h,b:255*k}},Pd:function(a){a=a.toString(16);return 1===a.length?"0"+a:a},In:function(a,b,d){return"#"+Z.Pd(a)+Z.Pd(b)+Z.Pd(d)},hn:function(a){a=a.split("(")[1].split(")")[0].split(",");var b={r:parseInt(a[0],10),g:parseInt(a[1],10),b:parseInt(a[2],10)};3<a.length&&(b.a=parseInt(a[3],10));return b},vn:function(a){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,d,g,h){return d+d+g+g+h+h});return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?
{r:parseInt(a[1],16),g:parseInt(a[2],16),b:parseInt(a[3],16)}:null},Ln:function(a){a=new THREE.Vector3(a.r,a.g,a.b);var b=(new THREE.Matrix3).set(.299,.587,.114,-.169,-.331,.5,.5,-.419,-.081),d=new THREE.Vector3(0,128,128);a.applyMatrix3(b).add(d);return{Y:a.x,Cr:a.y,Cb:a.z}},Wn:function(a){a=new THREE.Vector3(a.Y,a.Cr,a.Cb);var b=new THREE.Vector3(0,-128,-128),d=(new THREE.Matrix3).set(1,0,1.4,1,-.343,-.711,1,1.765,0);a.add(b).applyMatrix3(d);return{r:a.x,g:a.y,b:a.z}},Vn:function(a,b){var d=G.da(b);
b=Math.cos(d);d=Math.sin(d);return{Y:a.Y,Cb:a.Cb*b-a.Cr*d,Cr:a.Cb*d+a.Cr*b}},distance:function(a,b){return Math.sqrt((a.Cb-b.Cb)*(a.Cb-b.Cb)+(a.Cr-b.Cr)*(a.Cr-b.Cr))}};function Qb(a,b,d,g){this.alpha=g}window.FORGE=window.FORGE||{};window.FORGE.BaseObject=l;window.FORGE.Viewer=r;window.FORGE.Tags=ca;window.FORGE.UID=n;window.FORGE.Story=w;window.FORGE.Group=D;window.FORGE.Scene=C;window.FORGE.SceneParser=F;window.FORGE.Rectangle=Ha;window.FORGE.Size=Ia;window.FORGE.Media=La;
window.FORGE.RenderManager=y;window.FORGE.RenderScene=ab;window.FORGE.RenderPipeline=Ra;window.FORGE.RenderDisplay=Pa;window.FORGE.RenderParams=qb;window.FORGE.BackgroundRenderer=rb;window.FORGE.BackgroundMeshRenderer=Ya;window.FORGE.BackgroundShaderRenderer=Xa;window.FORGE.PostProcessing=ta;window.FORGE.EffectComposer=bb;window.FORGE.TexturePass=fb;window.FORGE.ShaderPass=hb;window.FORGE.AdditionPass=kb;window.FORGE.RenderPass=db;window.FORGE.ViewBase=wb;window.FORGE.ViewGoPro=$a;
window.FORGE.ViewRectilinear=Za;window.FORGE.Timeline=xb;window.FORGE.Keyframe=yb;window.FORGE.Animation=Ab;window.FORGE.MetaAnimation=Eb;window.FORGE.Track=Ib;window.FORGE.Object3D=Jb;window.FORGE.ObjectRenderer=Qa;window.FORGE.Raycaster=Nb;window.FORGE.PickingDrawPass=Rb;window.FORGE.PickingManager=Oa;window.FORGE.HotspotManager=qa;window.FORGE.Hotspot3D=Vb;window.FORGE.HotspotSound=ac;window.FORGE.HotspotMaterial=Zb;window.FORGE.HotspotTransform=Xb;window.FORGE.HotspotAnimation=Yb;
window.FORGE.HotspotAnimationTrack=Wb;window.FORGE.Camera=L;window.FORGE.CameraAnimation=uc;window.FORGE.CameraGaze=ic;window.FORGE.ControllerManager=oa;window.FORGE.ControllerBase=Fc;window.FORGE.ControllerPointer=Dc;window.FORGE.ControllerKeyboard=Ec;window.FORGE.SoundManager=u;window.FORGE.Sound=M;window.FORGE.Playlist=Q;window.FORGE.PlaylistManager=z;window.FORGE.PlaylistTrack=Xc;window.FORGE.Director=sa;window.FORGE.DirectorTrack=tc;window.FORGE.ActionEventDispatcher=bc;window.FORGE.Action=Zc;
window.FORGE.ActionManager=ra;window.FORGE.Plugin=R;window.FORGE.PluginEngine=dd;window.FORGE.PluginManager=pa;window.FORGE.PluginObjectFactory=S;window.FORGE.Device=N;window.FORGE.RequestAnimationFrame=la;window.FORGE.History=na;window.FORGE.EventDispatcher=p;window.FORGE.Event=rd;window.FORGE.Listener=pd;window.FORGE.LocaleManager=ma;window.FORGE.LocaleString=za;window.FORGE.Locale=td;window.FORGE.Keyboard=ua;window.FORGE.KeyBinding=P;window.FORGE.Drag=zd;window.FORGE.Pointer=V;
window.FORGE.DisplayList=ga;window.FORGE.DisplayObject=U;window.FORGE.DisplayObjectContainer=t;window.FORGE.Image=I;window.FORGE.ImageScalable=hc;window.FORGE.Sprite=ld;window.FORGE.Iframe=Td;window.FORGE.TextField=T;window.FORGE.Button=md;window.FORGE.ButtonSkin=de;window.FORGE.Canvas=ia;window.FORGE.VideoHTML5=K;window.FORGE.VideoDash=J;window.FORGE.VideoTimeRanges=ue;window.FORGE.VideoQuality=Ae;window.FORGE.SpriteAnimationManager=Sd;window.FORGE.SpriteAnimation=X;window.FORGE.Cache=va;
window.FORGE.File=Oe;window.FORGE.Loader=wa;window.FORGE.DependencyManager=ja;window.FORGE.Clock=ka;window.FORGE.Timer=Y;window.FORGE.TimerEvent=Te;window.FORGE.TweenManager=xa;window.FORGE.Tween=Bb;window.FORGE.Map=Je;window.FORGE.Collection=kd;window.FORGE.URL=Ue;window.FORGE.ColorRGBA=Qb;l.prototype.log=l.prototype.log;l.prototype.warn=l.prototype.warn;l.prototype.destroy=l.prototype.destroy;r.prototype.update=r.prototype.update;r.prototype.pause=r.prototype.pause;r.prototype.resume=r.prototype.resume;
r.prototype.destroy=r.prototype.destroy;w.prototype.boot=w.prototype.boot;w.prototype.load=w.prototype.load;w.prototype.hasScenes=w.prototype.$k;w.prototype.hasGroups=w.prototype.mc;w.prototype.nextScene=w.prototype.al;w.prototype.previousScene=w.prototype.bl;w.prototype.notifySceneConfigLoadComplete=w.prototype.Uj;w.prototype.loadScene=w.prototype.hd;w.prototype.loadGroup=w.prototype.Oj;w.prototype.destroy=w.prototype.destroy;D.prototype.load=D.prototype.load;D.prototype.hasChild=D.prototype.we;
D.prototype.hasScene=D.prototype.Dc;D.prototype.hasGroup=D.prototype.cd;D.prototype.hasChildren=D.prototype.rn;D.prototype.hasTypeOfChild=D.prototype.Vf;D.prototype.hasScenes=D.prototype.xe;D.prototype.hasGroups=D.prototype.mc;D.prototype.getChildrenUids=D.prototype.ad;D.prototype.getChildren=D.prototype.Ud;D.prototype.nextScene=D.prototype.wk;D.prototype.previousScene=D.prototype.xk;D.prototype.destroy=D.prototype.destroy;C.prototype.addConfig=C.prototype.ha;C.prototype.load=C.prototype.load;
C.prototype.unload=C.prototype.re;C.prototype.hasGroup=C.prototype.cd;C.prototype.hasGroups=C.prototype.mc;C.prototype.destroy=C.prototype.destroy;F.prototype.extendConfiguration=F.prototype.fj;F.prototype.hasSoundSource=F.prototype.Dj;F.prototype.hasSoundTarget=F.prototype.Ej;F.prototype.isAmbisonic=F.prototype.Kj;F.prototype.destroy=F.prototype.destroy;La.prototype.destroy=La.prototype.destroy;y.prototype.render=y.prototype.render;y.prototype.screenToWorld=y.prototype.screenToWorld;
y.prototype.worldToScreen=y.prototype.worldToScreen;y.prototype.enableVR=y.prototype.Xk;y.prototype.setView=y.prototype.md;y.prototype.destroy=y.prototype.destroy;ab.prototype.setSize=ab.prototype.setSize;ab.prototype.destroy=ab.prototype.destroy;Ra.prototype.enablePicking=Ra.prototype.Of;Ra.prototype.addBackground=Ra.prototype.Mi;Ra.prototype.addRenderScenes=Ra.prototype.Oi;Ra.prototype.addGlobalFx=Ra.prototype.Ni;Ra.prototype.getShaderPassByUID=Ra.prototype.pn;Ra.prototype.setSize=Ra.prototype.setSize;
Ra.prototype.render=Ra.prototype.render;Ra.prototype.clear=Ra.prototype.Ie;Ra.prototype.destroy=Ra.prototype.destroy;Pa.prototype.enableVR=Pa.prototype.vh;Pa.prototype.getQuaternionFromPose=Pa.prototype.rj;Pa.prototype.getRenderParams=Pa.prototype.tj;Pa.prototype.setSize=Pa.prototype.setSize;Pa.prototype.submitFrame=Pa.prototype.wh;Pa.prototype.destroy=Pa.prototype.destroy;rb.prototype.updateAfterViewChange=rb.prototype.ec;rb.prototype.setSize=rb.prototype.setSize;rb.prototype.render=rb.prototype.render;
rb.prototype.destroy=rb.prototype.destroy;Ya.prototype.render=Ya.prototype.render;Ya.prototype.updateAfterViewChange=Ya.prototype.ec;Ya.prototype.destroy=Ya.prototype.destroy;Xa.prototype.render=Xa.prototype.render;Xa.prototype.updateAfterViewChange=Xa.prototype.ec;Xa.prototype.destroy=Xa.prototype.destroy;ta.prototype.parseShaderPasses=ta.prototype.ke;ta.prototype.getFxSetByUID=ta.prototype.Vd;ta.prototype.addConfig=ta.prototype.ha;ta.prototype.destroy=ta.prototype.destroy;bb.prototype.destroy=bb.prototype.destroy;
hb.prototype.render=hb.prototype.render;kb.prototype.destroy=kb.prototype.destroy;wb.prototype.shaderSTW=wb.prototype.Fc;wb.prototype.shaderWTS=wb.prototype.bc;wb.prototype.updateScreenToWorld=wb.prototype.oc;wb.prototype.worldToScreen=wb.prototype.worldToScreen;wb.prototype.screenToWorld=wb.prototype.screenToWorld;wb.prototype.destroy=wb.prototype.destroy;$a.prototype.shaderSTW=$a.prototype.Fc;$a.prototype.shaderWTS=$a.prototype.bc;$a.prototype.updateScreenToWorld=$a.prototype.oc;
$a.prototype.destroy=$a.prototype.destroy;Za.prototype.shaderSTW=Za.prototype.Fc;Za.prototype.shaderWTS=Za.prototype.bc;Za.prototype.updateScreenToWorld=Za.prototype.oc;Za.prototype.worldToScreen=Za.prototype.worldToScreen;Za.prototype.screenToWorld=Za.prototype.screenToWorld;Za.prototype.destroy=Za.prototype.destroy;xb.prototype.hasKeyframes=xb.prototype.sn;xb.prototype.addKeyframe=xb.prototype.xb;xb.prototype.getKeyframes=xb.prototype.mn;xb.prototype.getKeyframesIndexes=xb.prototype.Wd;
xb.prototype.getSideKeyframes=xb.prototype.uj;xb.prototype.getSideKeyframesIndexes=xb.prototype.vj;xb.prototype.emptyKeyframes=xb.prototype.fn;xb.prototype.destroy=xb.prototype.destroy;Ab.prototype.play=Ab.prototype.play;Ab.prototype.stop=Ab.prototype.stop;Ab.prototype.resume=Ab.prototype.resume;Ab.prototype.destroy=Ab.prototype.destroy;Eb.prototype.stop=Eb.prototype.stop;Eb.prototype.resume=Eb.prototype.resume;Eb.prototype.destroy=Eb.prototype.destroy;Ib.prototype.destroy=Ib.prototype.destroy;
Jb.prototype.click=Jb.prototype.click;Jb.prototype.over=Jb.prototype.Ee;Jb.prototype.out=Jb.prototype.od;Jb.prototype.destroy=Jb.prototype.destroy;Qa.prototype.register=Qa.prototype.register;Qa.prototype.unregister=Qa.prototype.unregister;Qa.prototype.createRenderScenes=Qa.prototype.Xi;Qa.prototype.getRaycastable=Qa.prototype.sj;Qa.prototype.getByMesh=Qa.prototype.pj;Qa.prototype.clear=Qa.prototype.Fe;Qa.prototype.destroy=Qa.prototype.destroy;Nb.prototype.start=Nb.prototype.start;
Nb.prototype.stop=Nb.prototype.stop;Nb.prototype.click=Nb.prototype.click;Nb.prototype.clear=Nb.prototype.uh;Rb.prototype.start=Rb.prototype.start;Rb.prototype.stop=Rb.prototype.stop;Rb.prototype.click=Rb.prototype.click;Rb.prototype.setSize=Rb.prototype.setSize;Rb.prototype.clear=Rb.prototype.eh;Rb.prototype.destroy=Rb.prototype.destroy;Oa.prototype.updateForViewType=Oa.prototype.lk;Oa.prototype.clear=Oa.prototype.fh;Oa.prototype.setSize=Oa.prototype.setSize;Oa.prototype.click=Oa.prototype.click;
Oa.prototype.start=Oa.prototype.start;Oa.prototype.stop=Oa.prototype.stop;Oa.prototype.destroy=Oa.prototype.destroy;qa.prototype.boot=qa.prototype.boot;qa.prototype.getByType=qa.prototype.ln;qa.prototype.addConfig=qa.prototype.ha;qa.prototype.addTracks=qa.prototype.Pi;qa.prototype.update=qa.prototype.update;qa.prototype.clear=qa.prototype.ye;qa.prototype.destroy=qa.prototype.destroy;Vb.prototype.update=Vb.prototype.update;Vb.prototype.destroy=Vb.prototype.destroy;ac.prototype.load=ac.prototype.load;
ac.prototype.update=ac.prototype.update;ac.prototype.destroy=ac.prototype.destroy;Zb.prototype.load=Zb.prototype.load;Zb.prototype.update=Zb.prototype.update;Zb.prototype.destroy=Zb.prototype.destroy;Xb.prototype.computeSizeFromAnglesAndMaterial=Xb.prototype.m;Xb.prototype.load=Xb.prototype.load;Xb.prototype.destroy=Xb.prototype.destroy;Yb.prototype.load=Yb.prototype.load;Yb.prototype.play=Yb.prototype.play;L.prototype.load=L.prototype.load;L.prototype.lookAt=L.prototype.Qj;L.prototype.update=L.prototype.update;
L.prototype.destroy=L.prototype.destroy;uc.prototype.play=uc.prototype.play;uc.prototype.destroy=uc.prototype.destroy;ic.prototype.load=ic.prototype.load;ic.prototype.start=ic.prototype.start;ic.prototype.stop=ic.prototype.stop;ic.prototype.update=ic.prototype.update;ic.prototype.destroy=ic.prototype.destroy;oa.prototype.notifyControlStart=oa.prototype.ge;oa.prototype.notifyControlEnd=oa.prototype.fe;oa.prototype.update=oa.prototype.update;oa.prototype.addConfig=oa.prototype.ha;
oa.prototype.destroy=oa.prototype.destroy;Fc.prototype.enable=Fc.prototype.enable;Fc.prototype.disable=Fc.prototype.Gb;Fc.prototype.destroy=Fc.prototype.destroy;Dc.prototype.enable=Dc.prototype.enable;Dc.prototype.disable=Dc.prototype.Gb;Dc.prototype.update=Dc.prototype.update;Dc.prototype.destroy=Dc.prototype.destroy;Ec.prototype.enable=Ec.prototype.enable;Ec.prototype.disable=Ec.prototype.Gb;Ec.prototype.update=Ec.prototype.update;Ec.prototype.destroy=Ec.prototype.destroy;u.prototype.boot=u.prototype.boot;
u.prototype.addConfig=u.prototype.ha;u.prototype.update=u.prototype.update;u.prototype.add=u.prototype.add;u.prototype.remove=u.prototype.remove;u.prototype.autoSuspend=u.prototype.Ff;u.prototype.autoResume=u.prototype.Ef;u.prototype.mute=u.prototype.bb;u.prototype.unmute=u.prototype.Ah;u.prototype.destroy=u.prototype.destroy;M.prototype.update=M.prototype.update;M.prototype.play=M.prototype.play;M.prototype.stop=M.prototype.stop;M.prototype.pause=M.prototype.pause;M.prototype.resume=M.prototype.resume;
M.prototype.mute=M.prototype.bb;M.prototype.unmute=M.prototype.Eh;M.prototype.destroy=M.prototype.destroy;Q.prototype.hasTracks=Q.prototype.Rk;Q.prototype.play=Q.prototype.play;Q.prototype.stop=Q.prototype.stop;Q.prototype.pause=Q.prototype.pause;Q.prototype.resume=Q.prototype.resume;Q.prototype.nextTrack=Q.prototype.jd;Q.prototype.previousTrack=Q.prototype.me;Q.prototype.destroy=Q.prototype.destroy;z.prototype.boot=z.prototype.boot;z.prototype.addConfig=z.prototype.ha;z.prototype.add=z.prototype.add;
z.prototype.addTrack=z.prototype.hh;z.prototype.hasPlaylists=z.prototype.tn;z.prototype.hasTracks=z.prototype.Lk;z.prototype.play=z.prototype.play;z.prototype.stop=z.prototype.stop;z.prototype.pause=z.prototype.pause;z.prototype.resume=z.prototype.resume;z.prototype.nextTrack=z.prototype.jd;z.prototype.previousTrack=z.prototype.me;z.prototype.destroy=z.prototype.destroy;Xc.prototype.play=Xc.prototype.play;Xc.prototype.stop=Xc.prototype.stop;Xc.prototype.pause=Xc.prototype.pause;
Xc.prototype.resume=Xc.prototype.resume;Xc.prototype.destroy=Xc.prototype.destroy;sa.prototype.load=sa.prototype.load;sa.prototype.play=sa.prototype.play;sa.prototype.stop=sa.prototype.stop;sa.prototype.destroy=sa.prototype.destroy;bc.prototype.addActions=bc.prototype.c;bc.prototype.dispatch=bc.prototype.D;bc.prototype.destroy=bc.prototype.destroy;Zc.prototype.execute=Zc.prototype.yb;Zc.prototype.destroy=Zc.prototype.destroy;ra.prototype.get=ra.prototype.get;ra.prototype.addConfig=ra.prototype.ha;
ra.prototype.destroy=ra.prototype.destroy;R.prototype.instantiate=R.prototype.Jj;R.prototype.notifyInstanceReady=R.prototype.Gn;R.prototype.update=R.prototype.update;R.prototype.resetInstance=R.prototype.$j;R.prototype.destroy=R.prototype.destroy;dd.prototype.load=dd.prototype.load;dd.prototype.getNewInstance=dd.prototype.qj;dd.prototype.destroy=dd.prototype.destroy;pa.prototype.boot=pa.prototype.boot;pa.prototype.addConfig=pa.prototype.ha;pa.prototype.getById=pa.prototype.Td;
pa.prototype.getByIndex=pa.prototype.oj;pa.prototype.get=pa.prototype.get;pa.prototype.remove=pa.prototype.remove;pa.prototype.update=pa.prototype.update;pa.prototype.render=pa.prototype.render;pa.prototype.destroy=pa.prototype.destroy;S.prototype.string=S.prototype.Pn;S.prototype.textField=S.prototype.Qn;S.prototype.sound=S.prototype.sound;S.prototype.displayObjectContainer=S.prototype.en;S.prototype.displayObject=S.prototype.Uk;S.prototype.image=S.prototype.image;S.prototype.sprite=S.prototype.Nn;
S.prototype.button=S.prototype.Tk;S.prototype.video=S.prototype.Wk;S.prototype.canvas=S.prototype.canvas;S.prototype.tween=S.prototype.Vk;S.prototype.destroyAllObjects=S.prototype.bj;S.prototype.destroy=S.prototype.destroy;la.prototype.boot=la.prototype.boot;la.prototype.start=la.prototype.start;la.prototype.stop=la.prototype.stop;la.prototype.destroy=la.prototype.destroy;na.prototype.addConfig=na.prototype.ha;na.prototype.destroy=na.prototype.destroy;p.prototype.add=p.prototype.add;
p.prototype.addOnce=p.prototype.ca;p.prototype.remove=p.prototype.remove;p.prototype.has=p.prototype.has;p.prototype.dispatch=p.prototype.D;p.prototype.destroy=p.prototype.destroy;pd.prototype.execute=pd.prototype.yb;pd.prototype.detach=pd.prototype.bh;pd.prototype.destroy=pd.prototype.destroy;ma.prototype.addConfig=ma.prototype.ha;ma.prototype.getValue=ma.prototype.Xb;ma.prototype.hasValue=ma.prototype.vb;ma.prototype.destroy=ma.prototype.destroy;za.prototype.destroy=za.prototype.destroy;
td.prototype.addConfig=td.prototype.ha;td.prototype.loadFiles=td.prototype.dg;td.prototype.getValue=td.prototype.Xb;td.prototype.hasValue=td.prototype.vb;td.prototype.getKey=td.prototype.dh;td.prototype.destroy=td.prototype.destroy;ua.prototype.update=ua.prototype.update;ua.prototype.isKeyPressed=ua.prototype.An;ua.prototype.isKeyOut=ua.prototype.ag;ua.prototype.addBinding=ua.prototype.Cf;ua.prototype.removeBinding=ua.prototype.ne;ua.prototype.hasBinding=ua.prototype.qn;ua.prototype.getBindings=ua.prototype.Rf;
ua.prototype.destroy=ua.prototype.destroy;P.prototype.hasKeyIn=P.prototype.Yd;P.prototype.hasKeyOut=P.prototype.Uf;P.prototype.down=P.prototype.ah;P.prototype.waitToHold=P.prototype.Tn;P.prototype.up=P.prototype.kk;P.prototype.hold=P.prototype.Gj;P.prototype.destroy=P.prototype.destroy;zd.prototype.enable=zd.prototype.enable;zd.prototype.disable=zd.prototype.Xg;zd.prototype.destroy=zd.prototype.destroy;V.prototype.enable=V.prototype.enable;V.prototype.disable=V.prototype.Ge;V.prototype.destroy=V.prototype.destroy;
ga.prototype.register=ga.prototype.register;ga.prototype.unregister=ga.prototype.unregister;ga.prototype.update=ga.prototype.update;ga.prototype.destroy=ga.prototype.destroy;U.prototype.show=U.prototype.Tg;U.prototype.hide=U.prototype.Fj;U.prototype.toggleVisibility=U.prototype.Rn;U.prototype.maximize=U.prototype.Ab;U.prototype.isInDom=U.prototype.gd;U.prototype.resize=U.prototype.Sg;U.prototype.fullscreenEnter=U.prototype.jj;U.prototype.fullscreenExit=U.prototype.kj;U.prototype.isFullscreen=U.prototype.fd;
U.prototype.destroy=U.prototype.destroy;t.prototype.update=t.prototype.update;t.prototype.addChild=t.prototype.Wb;t.prototype.addChildAt=t.prototype.Ym;t.prototype.fitToContent=t.prototype.ij;t.prototype.removeChild=t.prototype.removeChild;t.prototype.removeChildAt=t.prototype.mg;t.prototype.empty=t.prototype.Rg;t.prototype.hasChild=t.prototype.tk;t.prototype.destroy=t.prototype.destroy;I.prototype.load=I.prototype.load;I.prototype.unload=I.prototype.re;I.prototype.destroy=I.prototype.destroy;
hc.prototype.destroy=hc.prototype.destroy;ld.prototype.play=ld.prototype.play;ld.prototype.pause=ld.prototype.pause;ld.prototype.resume=ld.prototype.resume;ld.prototype.stop=ld.prototype.stop;ld.prototype.update=ld.prototype.update;ld.prototype.destroy=ld.prototype.destroy;Td.prototype.load=Td.prototype.load;Td.prototype.destroy=Td.prototype.destroy;T.prototype.load=T.prototype.load;T.prototype.destroy=T.prototype.destroy;md.prototype.load=md.prototype.load;md.prototype.addSkin=md.prototype.jc;
md.prototype.setSkin=md.prototype.dk;md.prototype.hasSkin=md.prototype.Cj;md.prototype.updateSkin=md.prototype.Sn;md.prototype.destroy=md.prototype.destroy;de.prototype.setDefaultFromState=de.prototype.sg;de.prototype.getProperty=de.prototype.Qa;de.prototype.hasImage=de.prototype.Bj;de.prototype.hasLabel=de.prototype.m;K.prototype.update=K.prototype.update;K.prototype.load=K.prototype.load;K.prototype.play=K.prototype.play;K.prototype.pause=K.prototype.pause;K.prototype.stop=K.prototype.stop;
K.prototype.togglePlayback=K.prototype.kl;K.prototype.mute=K.prototype.bb;K.prototype.unmute=K.prototype.Kh;K.prototype.destroy=K.prototype.destroy;J.prototype.load=J.prototype.load;J.prototype.play=J.prototype.play;J.prototype.pause=J.prototype.pause;J.prototype.stop=J.prototype.stop;J.prototype.togglePlayback=J.prototype.jl;J.prototype.mute=J.prototype.bb;J.prototype.unmute=J.prototype.Hh;J.prototype.enableBufferOccupancyABR=J.prototype.il;J.prototype.destroy=J.prototype.destroy;
ue.prototype.getTimeRange=ue.prototype.j;ue.prototype.isInRanges=ue.prototype.Mj;Sd.prototype.add=Sd.prototype.add;Sd.prototype.play=Sd.prototype.play;Sd.prototype.pause=Sd.prototype.pause;Sd.prototype.resume=Sd.prototype.resume;Sd.prototype.stop=Sd.prototype.stop;Sd.prototype.get=Sd.prototype.get;Sd.prototype.update=Sd.prototype.update;Sd.prototype.destroy=Sd.prototype.destroy;X.prototype.play=X.prototype.play;X.prototype.pause=X.prototype.pause;X.prototype.resume=X.prototype.resume;
X.prototype.stop=X.prototype.stop;X.prototype.update=X.prototype.update;X.prototype.destroy=X.prototype.destroy;va.prototype.has=va.prototype.has;va.prototype.get=va.prototype.get;va.prototype.add=va.prototype.add;va.prototype.remove=va.prototype.remove;va.prototype.destroy=va.prototype.destroy;Oe.prototype.key=Oe.prototype.key;Oe.prototype.url=Oe.prototype.url;Oe.prototype.type=Oe.prototype.type;Oe.prototype.data=Oe.prototype.data;Oe.prototype.xhr=Oe.prototype.Un;Oe.prototype.loading=Oe.prototype.zb;
Oe.prototype.loaded=Oe.prototype.vk;Oe.prototype.error=Oe.prototype.uk;wa.prototype.json=wa.prototype.json;wa.prototype.xml=wa.prototype.Bk;wa.prototype.sound=wa.prototype.sound;wa.prototype.image=wa.prototype.image;wa.prototype.script=wa.prototype.rg;wa.prototype.css=wa.prototype.Yi;wa.prototype.destroy=wa.prototype.destroy;ja.prototype.add=ja.prototype.add;ja.prototype.destroy=ja.prototype.destroy;ka.prototype.create=ka.prototype.create;ka.prototype.add=ka.prototype.add;ka.prototype.update=ka.prototype.update;
ka.prototype.destroy=ka.prototype.destroy;Y.prototype.create=Y.prototype.create;Y.prototype.add=Y.prototype.add;Y.prototype.repeat=Y.prototype.cl;Y.prototype.loop=Y.prototype.Ke;Y.prototype.remove=Y.prototype.remove;Y.prototype.start=Y.prototype.start;Y.prototype.stop=Y.prototype.stop;Y.prototype.pause=Y.prototype.pause;Y.prototype.resume=Y.prototype.resume;Y.prototype.update=Y.prototype.update;Y.prototype.destroy=Y.prototype.destroy;Te.prototype.execute=Te.prototype.yb;xa.prototype.add=xa.prototype.add;
xa.prototype.remove=xa.prototype.remove;xa.prototype.update=xa.prototype.update;xa.prototype.destroy=xa.prototype.destroy;Bb.prototype.to=Bb.prototype.Le;Bb.prototype.start=Bb.prototype.start;Bb.prototype.stop=Bb.prototype.stop;Bb.prototype.update=Bb.prototype.update;Bb.prototype.destroy=Bb.prototype.destroy;Je.prototype.set=Je.prototype.set;Je.prototype["delete"]=Je.prototype.Ce;Je.prototype.get=Je.prototype.get;Je.prototype.keys=Je.prototype.Ek;Je.prototype.values=Je.prototype.Fk;
Je.prototype.entries=Je.prototype.Dk;Je.prototype.clear=Je.prototype.Ck;Je.prototype.has=Je.prototype.has;kd.prototype.add=kd.prototype.add;kd.prototype.remove=kd.prototype.remove;kd.prototype.get=kd.prototype.get;kd.prototype.toArray=kd.prototype.pe;window.FORGE.Math=G;G.degToRad=G.da;G.radToDeg=G.Zb;G.round10=G.ld;G.clamp=G.Z;G.wrap=G.Ta;G.mix=G.Fn;G.smoothStep=G.Mn;G.rotationMatrixToEuler=G.ng;G.eulerToRotationMatrix=G.Rd;window.FORGE.Quaternion=H;H.toEuler=H.qe;H.fromEuler=H.lc;
H.toRotationMatrix=H.gk;H.fromRotationMatrix=H.jn;H.cancelRoll=H.cancelRoll;H.diffBetweenQuaternions=H.dn;H.angularDistance=H.Si;H.multiplyScalar=H.multiplyScalar;H.add=H.add;H.log=H.log;H.exp=H.exp;H.slerp=H.slerp;H.squad=H.On;H.nlerpNoInvert=H.Tj;H.slerpNoInvert=H.oe;H.squadNoInvert=H.ek;H.spline=H.ug;bb.getUniqueName=ub;tb.parseIncludes=tb.eb;Rb.colorFrom3DObject=Sb;de.isValid=function(a){return a?!0:!1};Ae.mimeTypeFromURL=He;window.FORGE.Utils=B;B.parseSizeString=B.lg;B.extendSimpleObject=B.kc;
B.extendMultipleObjects=B.ab;B.clone=B.clone;B.isDisplayObject=B.zn;B.isTypeOf=B.T;B.isTypeOfRecursive=B.Cn;B.isArrayOf=B.Ga;B.getObjectProperty=B.Xd;B.sortArrayByProperty=B.nd;B.randomize=B.kd;B.leftFill=B.de;B.parseTime=B.Wj;B.formatTime=B.gn;B.toTHREESpherical=B.wg;B.fromTHREESpherical=B.kn;B.arrayByDifference=B.Ti;B.removeItemFromArrayAtIndex=B.Hn;B.endsWith=B.endsWith;window.FORGE.Dom=ha;ha.getCssProperty=ha.bd;ha.getUnitWidth=ha.xj;ha.getValueWidth=ha.zj;ha.getUnitHeight=ha.wj;
ha.getValueHeight=ha.yj;ha.has=ha.has;ha.isHtmlElement=ha.Zf;ha.getMouseEventOffset=ha.nn;Ue.parse=Da;Ue.exists=function(a,b,d,g){var h=new XMLHttpRequest,k=null;h.onreadystatechange=function(){4===this.readyState&&200===this.status&&(clearTimeout(k),"function"===typeof b&&b.call(g))};h.onerror=function(a){console.log(a)};h.open("HEAD",a);h.send();k=window.setTimeout(function(){"function"===typeof d&&d.call(g)},500)};
Ue.isValid=function(a){return/((([A-Za-z]{3,9}:(?:\/\/)?)(?:[\-;:&=\+\$,\w]+@)?[A-Za-z0-9\.\-]+|(?:www\.|[\-;:&=\+\$,\w]+@)[A-Za-z0-9\.\-]+)((?:\/[\+~%\/\.\w\-]*)?\??(?:[\-\+=&;%@\.\w]*)#?(?:[\.\!\/\\\w]*))?)/.test(a)?!0:!1};window.FORGE.Color=Z;Z.rgbToHsl=Z.Jn;Z.hslToRgb=Z.xn;Z.hueToRgb=Z.Zd;Z.rgbToHsv=Z.Kn;Z.hsvToRgb=Z.yn;Z.componentToHex=Z.Pd;Z.rgbToHex=Z.In;Z.fromRgbaString=Z.hn;Z.hexToRgb=Z.vn;Z.rgbToYcbcr=Z.Ln;Z.ycbcrToRgb=Z.Wn;Z.ycbcrRotate=Z.Vn;Z.distance=Z.distance;N.canPlayAudio=N.bn;
N.canPlayVideo=N.cn;N.isLowBattery=N.Bn;N.os=N.cb;N.vita=N.zg;N.xbox=N.Jg;N.kindle=N.bg;N.windowsPhone=N.se;N.osVersion=N.Yb;N.android=N.Qi;N.chromeOS=N.Hf;N.iOS=N.Ec;N.linux=N.cg;N.macOS=N.fg;N.windows=N.Ig;N.ie=N.ed;N.edge=N.Qd;N.firefox=N.Pf;N.opera=N.opera;N.safari=N.og;N.chrome=N.chrome;N.browser=N.lb;N.browserVersion=N.$a;N.edgeVersion=N.dj;N.chromeVersion=N.If;N.firefoxVersion=N.hj;N.silk=N.tg;N.ieVersion=N.Yf;N.operaVersion=N.he;N.safariVersion=N.bk;N.isAndroidStockBrowser=N.Lj;
N.androidStockBrowserVersion=N.Ri;N.webApp=N.nk;N.quirksMode=N.Zj;N.pixelRatio=N.nc;N.iPhone=N.Hj;N.iPod=N.Ij;N.iPad=N.Xf;N.retina=N.ak;N.desktop=N.Cc;N.mobile=N.ee;N.tablet=N.vg;N.other=N.Vj;N.oggVideo=N.kg;N.h264Video=N.Tf;N.mp4Video=N.ig;N.webmVideo=N.Hg;N.vp9Video=N.Ag;N.hlsVideo=N.Wf;N.audioTag=N.Df;N.webAudio=N.Cg;N.ogg=N.jg;N.mp3=N.gg;N.opus=N.je;N.wav=N.Bg;N.aac=N.Bf;N.m4a=N.eg;N.mp4=N.hg;N.webm=N.Gg;N.weba=N.Fg;N.vibrate=N.xg;N.battery=N.Gf;N.canvas=N.canvas;N.canvasText=N.Vi;
N.canvasWinding=N.Wi;N.localStorage=N.localStorage;N.mediaSource=N.Sj;N.encryptedMedia=N.ej;N.applicationCache=N.applicationCache;N.addEventListener=N.addEventListener;N.raf=N.ko;N.webGL=N.Dg;N.webVR=N.Eg;N.geolocation=N.geolocation;N.history=N.history;N.svg=N.fk;N.contextMenu=N.contextMenu;N.isSecure=N.Nj;N.isIframe=N.$f;N.touch=N.hk;N.touchForce=N.ik;N.gamepad=N.nj;N.requestFullscreen=N.requestFullscreen;N.exitFullscreen=N.exitFullscreen;N.fullscreenKeyboard=N.lj;N.fullscreenElement=N.fullscreenElement;
N.fullscreenEnabled=N.fullscreenEnabled;N.visibilityState=N.visibilityState;N.visibilityChange=N.yg;N.orientation=N.orientation;N.screenOrientation=N.ck;N.lockOrientation=N.Pj;N.unlockOrientation=N.jk;N.file=N.file;N.fileSystem=N.gj;N.pointerLock=N.Yj;N.cssPointerEvents=N.$c;N.cssRgba=N.aj;N.cssAnimation=N.$i;N.css3D=N.Zi;N.deviceMotionRotationRate=N.Lf;N.deviceMotionAcceleration=N.Kf;N.deviceOrientationMagnetometer=N.Nf;N.deviceMotion=N.Jf;N.deviceOrientation=N.Mf;N.dpi=N.cj;N.screenWidth=N.qg;
N.screenHeight=N.pg;N.ua=N.aa;N.language=N.language;N.gyroscope=N.Aj;N.ready=N.ready;n.generate=n.Qf;n.validate=n.mk;n.register=n.register;n.unregister=n.unregister;n.getUids=n.Sf;n.filterType=n.Sd;n.get=n.get;n.isTypeOf=n.T;n.exists=n.Wa;ca.register=ca.register;ca.getUids=ca.Sf;ca.get=ca.get;ca.hasTypeOf=ca.un;ca.exists=ca.Wa;window.FORGE.VIEWERS=aa;window.FORGE.VERSION="0.3.0";window.FORGE.DEBUG=!1;window.FORGE.WARNING=!1;r.DEFAULT_CONFIG=fa;window.FORGE.Math=G;G.DEGREES=G.Na;G.RADIANS=G.mb;
G.DEG2RAD=G.Nh;G.RAD2DEG=G.Xh;G.TWOPI=G.ai;window.FORGE.MediaType=Ja;Ja.IMAGE=Ja.IMAGE;Ja.VIDEO=Ja.VIDEO;window.FORGE.MediaFormat=Ka;Ka.EQUIRECTANGULAR=Ka.Nc;Ka.CUBE=Ka.td;Ka.FLAT=Ka.Ph;Ka.HOTSPOT=Ka.ql;window.FORGE.BackgroundType=Na;Na.UNDEFINED=Na.yd;Na.SHADER=Na.xd;Na.MESH=Na.wd;window.FORGE.EffectComposerType=cb;cb.MAIN=cb.Sh;cb.RENDER=cb.Sb;cb.PICKING=cb.cf;window.FORGE.PassPosition=eb;eb.UNKNOWN=eb.zd;eb.BACKGROUND=eb.rd;eb.RENDER=eb.Sb;eb.GLOBAL=eb.Qe;window.FORGE.ViewType=Ta;
Ta.UNDEFINED=Ta.yd;Ta.RECTILINEAR=Ta.wb;Ta.GOPRO=Ta.fc;window.FORGE.PickingManager.modes=Wa;Wa.POINTER=Wa.Za;Wa.GAZE=Wa.uc;window.FORGE.HotspotMaterial.types=cc;cc.IMAGE=cc.IMAGE;cc.PLUGIN=cc.Wh;cc.GRAPHICS=cc.vd;window.FORGE.HotspotMaterial.presets=$b;$b.TRANSPARENT=$b.$h;$b.DEBUG=$b.Mh;window.FORGE.HotspotType=Ub;Ub.THREE_DIMENSIONAL=Ub.qf;L.RADIUS=50;L.DEFAULT_CONFIG=jc;window.FORGE.ControllerType=Ac;Ac.POINTER=Ac.Za;Ac.KEYBOARD=Ac.Ve;oa.DEFAULT_CONFIG=Bc;window.FORGE.SoundType=Ga;Ga.STEREO=Ga.vl;
Ga.SPATIAL=Ga.ul;Ga.AMBISONIC=Ga.Me;window.FORGE.Action.operation=$c;$c.SET=$c.mf;$c.ADD=$c.Lh;$c.SUBSTRACT=$c.Yh;$c.MULTIPLY=$c.Th;$c.DIVIDE=$c.Oh;$c.TOGGLE=$c.Zh;window.FORGE.Pointer.listenerTypes=W;W.NATIVE=W.Ra;W.HAMMER=W.ja;window.FORGE.Pointer.events=V.events;V.events.TAP=V.events.pf;V.events.DOUBLE_TAP=V.events.ud;V.events.PRESS_START=V.events.hf;V.events.PRESS_END=V.events.gf;V.events.PAN_START=V.events.bf;V.events.PAN_MOVE=V.events.af;V.events.PAN_END=V.events.$e;V.events.PINCH_START=V.events.ff;
V.events.PINCH_MOVE=V.events.ef;V.events.PINCH_END=V.events.df;V.events.ROTATE_START=V.events.lf;V.events.ROTATE_MOVE=V.events.kf;V.events.ROTATE_END=V.events.jf;V.events.SWIPE=V.events.nf;V.events.ENTER=V.events.Pe;V.events.LEAVE=V.events.We;V.events.OVER=V.events.Ze;V.events.OUT=V.events.Ye;V.events.MOVE=V.events.Xe;V.events.WHEEL=V.events.rf;window.FORGE.Pointer.cursors=Bd;Bd.DEFAULT=Bd.DEFAULT;Bd.POINTER=Bd.Za;Bd.GRAB=Bd.ol;Bd.GRABBING=Bd.pl;window.FORGE.Image.renderModes=Nd;Nd.CSS=Nd.CSS;
Nd.CANVAS=Nd.Jb;de.EMPTY_STATE_IMAGE=fe;de.EMPTY_STATE_LABEL=ge;de.EMPTY_STATE=he;de.DEFAULT_STATE_IMAGE=ie;de.DEFAULT_STATE_LABEL=je;de.DEFAULT_STATE=ee;window.FORGE.VideoDash.mediaType=Be;Be.VIDEO=Be.VIDEO;Be.AUDIO=Be.AUDIO;window.FORGE.VideoQualityMode=ke;ke.AUTO=ke.Hb;ke.MANUAL=ke.MANUAL;window.FORGE.VideoFormat=Ma;Ma.DASH=Ma.Ne;Ma.HTML5=Ma.rl;Ma.UNKNOWN=Ma.zd;A.JSON=A.JSON;A.XML=A.Tb;A.IMAGE=A.IMAGE;A.SOUND=A.nb;window.FORGE.Cache.reserved=Ke;Ke.COMMON=Ke.Mc;Ke.JSON=Ke.JSON;Ke.XML=Ke.Tb;
Ke.IMAGE=Ke.IMAGE;Ke.SOUND=Ke.nb;
  root.FORGE = window.FORGE;
}).call(this);

